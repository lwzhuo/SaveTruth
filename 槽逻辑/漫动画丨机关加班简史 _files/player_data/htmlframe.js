
/*! Txplayer - v3.0.0 - 2018-11-23 12:20:35
 * Copyright (c) 2018
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(142)},63:function(a,b){!function(a){function b(c){var d=[["resolve","done",a.Callbacks({once:1,memory:1}),"resolved"],["reject","fail",a.Callbacks({once:1,memory:1}),"rejected"],["notify","progress",a.Callbacks({memory:1})]],e="pending",f={state:function(){return e},always:function(){return g.done(arguments).fail(arguments),this},then:function(){var c=arguments;return b(function(b){a.each(d,function(d,e){var h=a.isFunction(c[d])&&c[d];g[e[1]](function(){var c=h&&h.apply(this,arguments);if(c&&a.isFunction(c.promise))c.promise().done(b.resolve).fail(b.reject).progress(b.notify);else{var d=this===f?b.promise():this,g=h?[c]:arguments;b[e[0]+"With"](d,g)}})}),c=null}).promise()},promise:function(b){return null!=b?a.extend(b,f):f}},g={};return a.each(d,function(a,b){var c=b[2],h=b[3];f[b[1]]=c.add,h&&c.add(function(){e=h},d[1^a][2].disable,d[2][2].lock),g[b[0]]=function(){return g[b[0]+"With"](this===g?f:this,arguments),this},g[b[0]+"With"]=c.fireWith}),f.promise(g),c&&c.call(g,g),g}if("function"!=typeof a.Deferred){var c=Array.prototype.slice;a.when=function(d){var e,f,g,h=c.call(arguments),i=h.length,j=0,k=1!==i||d&&a.isFunction(d.promise)?i:0,l=1===k?d:b(),m=function(a,b,d){return function(f){b[a]=this,d[a]=arguments.length>1?c.call(arguments):f,d===e?l.notifyWith(b,d):--k||l.resolveWith(b,d)}};if(i>1)for(e=new Array(i),f=new Array(i),g=new Array(i);j<i;++j)h[j]&&a.isFunction(h[j].promise)?h[j].promise().done(m(j,g,h)).fail(l.reject).progress(m(j,f,e)):--k;return k||l.resolveWith(g,h),l.promise()},a.Deferred=b}}(Zepto)},64:function(a,b){!function(a){"function"!=typeof a.Callbacks&&(a.Callbacks=function(b){b=a.extend({},b);var c,d,e,f,g,h,i=[],j=!b.once&&[],k=function(a){for(c=b.memory&&a,d=!0,h=f||0,f=0,g=i.length,e=!0;i&&h<g;++h)if(i[h].apply(a[0],a[1])===!1&&b.stopOnFalse){c=!1;break}e=!1,i&&(j?j.length&&k(j.shift()):c?i.length=0:l.disable())},l={add:function(){if(i){var d=i.length,h=function(c){a.each(c,function(a,c){"function"==typeof c?b.unique&&l.has(c)||i.push(c):c&&c.length&&"string"!=typeof c&&h(c)})};h(arguments),e?g=i.length:c&&(f=d,k(c))}return this},remove:function(){return i&&a.each(arguments,function(b,c){for(var d;(d=a.inArray(c,i,d))>-1;)i.splice(d,1),e&&(d<=g&&--g,d<=h&&--h)}),this},has:function(b){return!(!i||!(b?a.inArray(b,i)>-1:i.length))},empty:function(){return g=i.length=0,this},disable:function(){return i=j=c=void 0,this},disabled:function(){return!i},lock:function(){return j=void 0,c||l.disable(),this},locked:function(){return!j},fireWith:function(a,b){return!i||d&&!j||(b=b||[],b=[a,b.slice?b.slice():b],e?j.push(b):k(b)),this},fire:function(){return l.fireWith(this,arguments)},fired:function(){return!!d}};return l})}(Zepto)},65:function(a,b){!function(a){function b(){}function c(a){g=[a]}function d(a,b,c){return a&&a.apply(b.context||b,c)}function e(a){return/\?/.test(a)?"&":"?"}function f(f){function n(a){X++||(Y(),S&&(A[U]={s:[a]}),O&&(a=O.apply(f,[a])),d(L,f,[a,v,f]),d(N,f,[f,v]))}function F(a){X++||(Y(),S&&a!=w&&(A[U]=a),d(M,f,[f,a]),d(N,f,[f,a]))}f=a.extend({},C,f);var G,H,I,J,K,L=f.success,M=f.error,N=f.complete,O=f.dataFilter,P=f.callbackParameter,Q=f.callback,R=f.cache,S=f.pageCache,T=f.charset,U=f.url,V=f.data,W=f.timeout,X=0,Y=b;return y&&y(function(a){a.done(L).fail(M),L=a.resolve,M=a.reject}).promise(f),f.abort=function(){!X++&&Y()},d(f.beforeSend,f,[f])===!1||X?f:(U=U||j,V=V?"string"==typeof V?V:a.param(V,f.traditional):j,U+=V?e(U)+V:j,P&&(U+=e(U)+encodeURIComponent(P)+"=?"),!R&&!S&&(U+=e(U)+"_"+(new Date).getTime()+"="),U=U.replace(/=\?(&|$)/,"="+Q+"$1"),S&&(G=A[U])?G.s?n(G.s[0]):F(G):(x[Q]=c,I=a(u)[0],I.id=m+B++,T&&(I[i]=T),D&&D.version()<11.6?(J=a(u)[0]).text="document.getElementById('"+I.id+"')."+p+"()":I[h]=h,E&&(I.htmlFor=I.id,I.event=o),I[q]=I[p]=I[r]=function(a){if(!I[s]||!/i/.test(I[s])){try{I[o]&&I[o]()}catch(b){}a=g,g=0,a?n(a[0]):F(k)}},I.src=U,Y=function(a){K&&clearTimeout(K),I[r]=I[q]=I[p]=null,z[t](I),J&&z[t](J)},z[l](I,H=z.firstChild),J&&z[l](J,H),K=W>0&&setTimeout(function(){F(w)},W)),f)}var g,h="async",i="charset",j="",k="error",l="insertBefore",m="_jqjsp",n="on",o=n+"click",p=n+k,q=n+"load",r=n+"readystatechange",s="readyState",t="removeChild",u="<script>",v="success",w="timeout",x=window,y=a.Deferred,z=a("head")[0]||document.documentElement,A={},B=0,C={callback:m,url:location.href},D=x.opera,E=!!a("<div>").html("<!--[if IE]><i><![endif]-->").find("i").length;f.setup=function(b){a.extend(C,b)},a.jsonp=f}(Txplayer.$)},142:function(a,b,c){function d(a){return i=Txplayer.$,this.dataset={},this.context=a,!h.mobile&&window.jQuery&&c(146),i.Deferred||c(63),i.Callbacks||c(64),i.jsonp||c(65),this.context.config.createPlayerAfterCssLoaded?this.init():void this.init()}var e=c(143),f=c(144),g=c(145),h=Txplayer.util,i=Txplayer.$;d.prototype={init:function(){return this.dataset.defer=Txplayer.$.Deferred(),Txplayer.dataset.pluginsPreload&&!this.context.config.containerId?(this.dataset.defer.reject(),this.dataset.defer):this.context.config.containerId?(this.dataset.$container=i("#"+this.context.config.containerId),this.dataset.ipadClass="txp_player_pad",this.dataset.miniSkinClass="txp_player_desktop_mini",this.dataset.v4MiniSkinClass="txp_player_mini",this.dataset.v4XsSkinClass="txp_player_xs",this.context.dataset.isWindowFocus=!0,this.dataset.$container&&this.dataset.$container.length?(this.loadHTML5PlayerSkin(),this.write(),this.exportsModuleApis(),void this.addEventListener()):(h.showError("[HtmlFrame初始化错误]","没找到id="+this.context.config.containerId+"的dom节点!"),this.dataset.defer.reject(),this.dataset.defer)):(h.showError("[HtmlFrame初始化错误]","参数containerId没找到!"),this.dataset.defer.reject(),this.dataset.defer)},getModStyle:function(){function a(a){return a=a||"100%","number"==typeof a?parseInt(a)+"px":"string"==typeof a?a.indexOf("%")>-1?a:parseInt(a)+"px":a}var b=[];return b.push("width:"+a(this.context.config.width)),b.push("height:"+a(this.context.config.height)),b.join(";")},loadHTML5PlayerSkin:function(){if("flash"===this.context.config.playerType)return void this.dataset.defer.resolve();if(!Txplayer.dataset.disableLoadTxplayerCss){var a,b=this;return(a=Txplayer.dataset.H5PlayerStyleUrl[this.context.config.playerType])?void h.loadCss(a).done(function(){b.dataset.defer.resolve()}).fail(function(){h.showError("找不到播放器的皮肤样式文件",Txplayer.dataset.HdPlayerStyleUrl)}):void b.dataset.defer.resolve()}},write:function(){var a=this.context.config.useSVG?1:Txplayer.$.inArray(this.context.config.playerType,["html5hd","ipadh5","chromehls","safarihls"])>-1?1:0,b="flash"!==this.context.config.playerType?'tabindex="-1"':"";if(a){document.createElement("txpdiv")}var c={useSVG:a,ie:h.browser.ie,playerid:"txplayer_"+this.context.config.playerId,mod_stype:this.getModStyle(),tabindex:b,gradient_top:"txp-frame-gradient-top"};a&&0===Txplayer.$("body ._txplayer_svg_sprite").length&&Txplayer.$("body").append(Txplayer.$.tmpl(f,{}));var d,g=["HtmlFrame.write Error:"],i=this,j=function(){g=g.join("\n"),i.context.msg.broadcast(Txplayer.apiList.privateApi.reportError,{msg:g,code:Txplayer.define.reportCode.JS_ERROR,stack:d})};try{var k=Txplayer.$.tmpl(e,c);this.dataset.$container.html(k),this.dataset.$playermod=this.dataset.$container.find("#"+c.playerid),this.context.dataset.$playermod=this.dataset.$playermod,this.dataset.$gradientTop=this.dataset.$container.find('[data-role="'+c.gradient_top+'"]'),this.dataset.$gradientTop.addClass(Txplayer.dataset.hideClass),"v.qq.com"===location.hostname&&this.context.config.showLogo!==!0||this.dataset.$playermod.addClass("txp_player_external"),Txplayer.dataset.maxId++}catch(l){g.push(l.message),d=l.stack}return g.length>1?void j():("ipadh5"===this.context.config.playerType&&this.dataset.$playermod.addClass(this.dataset.ipadClass),this.dataset.defer.then(function(){i.updateMiniSkinClass()}),void this.context.msg.on("ready",function(){i.context.dataset.playerWidth=i.context.dataset.$playermod.width(),i.context.dataset.playerHeight=i.context.dataset.$playermod.height()}))},updateMiniSkinClass:function(){if(this.context.config.useMiniSkin)if("v4"===this.context.config.version){var a=this.context.dataset.$playermod.width(),b=this.context.dataset.$playermod.height();if(0===a&&0===b)return;b<=255||a<=400?this.dataset.$playermod.addClass(this.dataset.v4XsSkinClass).addClass(this.dataset.v4MiniSkinClass):b<=265||a<=470?this.dataset.$playermod.removeClass(this.dataset.v4XsSkinClass).addClass(this.dataset.v4MiniSkinClass):(this.dataset.$playermod.removeClass(this.dataset.v4XsSkinClass).removeClass(this.dataset.v4MiniSkinClass),this.context.config.useMiniSkin=!1)}else this.dataset.$playermod.addClass(this.dataset.miniSkinClass);else"v4"===this.context.config.version?this.dataset.$playermod.removeClass(this.dataset.v4XsSkinClass).removeClass(this.dataset.v4MiniSkinClass):this.dataset.$playermod.removeClass(this.dataset.miniSkinClass),this.context.config.useMiniSkin=!1},resize:function(a){"object"!==i.type(a)||i.isEmptyObject(a)||!a.hasOwnProperty("width")&&!a.hasOwnProperty("height")||(this.dataset.$playermod.css(a),this.context.dataset.playerWidth=this.dataset.$container.width(),this.context.dataset.playerHeight=this.dataset.$container.height(),this.broadCaseResizeMsg())},autoResize:function(a){a=a||"width";var b={width:this.context.dataset.videoWidth,height:this.context.dataset.videoHeight};if(!(b&&b.width&&b.height))return!1;if("width"===a){var c=this.dataset.$playermod.width();this.resize({height:parseInt(c*(b.height/b.width))})}else{var d=this.dataset.$playermod.height();this.resize({width:parseInt(d*(b.width/b.height))})}},broadCaseResizeMsg:function(){var a={width:this.context.dataset.$playermod.width(),height:this.context.dataset.$playermod.height()};this.context.dataset.playerWidth=a.width,this.context.dataset.playerHeight=a.height,this.context.msg.broadcast("resize",a);try{this.context.userMsg.broadcast("resize",a)}catch(b){}this.autoToggleMiniSkin()},autoToggleMiniSkin:function(){if(this.context.config.miniSkinAdaptive){var a=this,b=function(b){b!=a.context.config.useMiniSkin&&(a.context.config.useMiniSkin=b,a.updateMiniSkinClass(),a.context.msg.broadcast("miniSkinChange"))};if("v4"===this.context.config.version){var c=this.context.dataset.$playermod.width(),d=this.context.dataset.$playermod.height();if(0===c&&0===d)return void(a.dataset.hasTrigger=!1);b(d<=255||c<=400||d<=265||c<=470?!0:!1)}else b(this.context.dataset.playerWidth<=470?!0:!1)}},destroy:function(a){var b=this;if("all"===a)for(var c in Txplayer.dataset._instance)Txplayer.dataset._instance[c]&&"function"===Txplayer.$.type(Txplayer.dataset._instance[c].destroy)&&Txplayer.dataset._instance[c].destroy();else if("HtmlFrame"===a)Txplayer.$.each(this.dataset.moduleApis,function(a,c){b.context.msg.off(a,c)}),Txplayer.$.each(this,function(a,b){b=null});else if("string"===Txplayer.$.type(a))b.context.msg.broadcast("destroyPlugin",a);else{b.dataset.$container.html("");var d=b.context.dataset.playerId;b.context.msg.broadcast("destroyPlugin"),Txplayer.dataset._instance[d]&&(Txplayer.dataset._instance[d]=null,delete Txplayer.dataset._instance[d])}},getPlayerSize:function(){return{width:this.context.dataset.playerWidth,height:this.context.dataset.playerHeight}},isPlayerInScreen:function(){return!!h.isInScreen(this.dataset.$container)},isWindowFocus:function(){return this.context.dataset.isWindowFocus},addEventListener:function(){function a(){c.context.dataset.isWindowFullscreen||c.context.dataset.isBrowserFullscreen?(c.context.dataset.isControlShow&&c.dataset.$playermod.css({cursor:"auto"}),clearTimeout(b),b=setTimeout(function(){h.v4log("timeout hide mouse",c.context.dataset.isControlShow),!c.context.dataset.isWindowFullscreen&&!c.context.dataset.isBrowserFullscreen||c.context.dataset.isControlShow?c.dataset.$playermod.css({cursor:"auto"}):c.dataset.$playermod.css({cursor:"none"})},5e3)):c.dataset.$playermod.css({cursor:"auto"})}var b,c=this;this.dataset.$playermod.on("click",function(a){var b=a.target,d=i(b),e=d.attr("data-report");e||(e=d.parent().attr("data-report")),e||(e=d.parent().parent().attr("data-report")),e&&c.context.msg.broadcast("reportUsrAction",{usr_action:e});var f=d.attr("data-action");if(b.nodeName&&b.nodeName.toLowerCase&&"a"===b.nodeName.toLowerCase()&&f)if("openTxVideo"===f){var g=h.getTxVideoPageURLByVid(c.context.dataset.vid);g&&window.open(g)}else if("openVIP"===f){c.context.msg.broadcast("pause"),c.context.msg.broadcast("showUIVipGuide",{openvip:!0});try{c.context.userMsg.broadcast("showUIVipGuide",{openvip:!0})}catch(j){}}else if("shareVIP"===f)try{c.context.dataset.openAccountData&&c.context.dataset.openAccountData[d.attr("data-click")]&&c.context.userMsg.broadcast("playerEmitCommonMsg",{type:"accountBannedTip",data:c.context.dataset.openAccountData[d.attr("data-click")]})}catch(j){}else"clickTips"===f?c.context.msg.broadcast("uiTipsClicked",{type:"html5",target:a.target}):"customTips"===f&&c.context.userMsg.broadcast("customTipsClicked",{target:a.target})}).on("mousemove",a),i(document).on("show",function(){c.context.dataset.isWindowFocus=!0}),i(document).on("hide",function(){c.context.dataset.isWindowFocus=!1}),this.context.msg.on("windowFullscreenChange",function(b){c.dataset.playerFullScreenChangeTimer&&(clearTimeout(c.dataset.playerFullScreenChangeTimer),c.dataset.playerFullScreenChangeTimer=null),c.dataset.playerFullScreenChangeTimer=setTimeout(function(){c.broadCaseResizeMsg()},300),b?c.dataset.$gradientTop.removeClass(Txplayer.dataset.hideClass):c.dataset.$gradientTop.addClass(Txplayer.dataset.hideClass),a()}),this.context.msg.on("browserFullscreenChange",function(b){c.dataset.playerFullScreenChangeTimer&&(clearTimeout(c.dataset.playerFullScreenChangeTimer),c.dataset.playerFullScreenChangeTimer=null),c.dataset.playerFullScreenChangeTimer=setTimeout(function(){c.broadCaseResizeMsg()},100),b?c.dataset.$gradientTop.removeClass(Txplayer.dataset.hideClass):c.dataset.$gradientTop.addClass(Txplayer.dataset.hideClass),a()}),i(window).on("resize",function(){c.dataset.documentResizeTimer&&(clearTimeout(c.dataset.documentResizeTimer),c.dataset.documentResizeTimer=null),c.dataset.documentResizeTimer=setTimeout(function(){c.broadCaseResizeMsg()},150)}),this.context.msg.on([h.getUniqueMsgKey("videoPlay")],function(a){"film"!==a.playListType||c.dataset.hasTrigger||(c.dataset.hasTrigger=!0,c.broadCaseResizeMsg())}),this.context.msg.on([h.getUniqueMsgKey("beforeVideoPlay")],function(a){c.dataset.hasTrigger||(c.dataset.hasTrigger=!0,c.broadCaseResizeMsg())})},exportsModuleApis:function(){var a=this;this.dataset.moduleApis={},this.dataset.moduleApis.resize=function(){return a.resize.apply(a,arguments)},this.dataset.moduleApis.destroy=function(){return a.destroy.apply(a,arguments)},this.dataset.moduleApis.getPlayerSize=function(){return a.getPlayerSize.apply(a,arguments)},this.dataset.moduleApis.autoResize=function(){return a.autoResize.apply(a,arguments)},this.dataset.moduleApis.isPlayerInScreen=function(){return a.isPlayerInScreen.apply(a,arguments)},this.dataset.moduleApis.isWindowFocus=function(){return a.isWindowFocus.apply(a,arguments)},i.extend(this.context.userApi,this.dataset.moduleApis),this.dataset.dataApis={},this.dataset.dataApis.isPlayerInScreen=function(b,c){c.data=a.isPlayerInScreen()},i.each(this.dataset.dataApis,function(b,c){a.context.msg.setData(b,c)})}},Txplayer.v4errcode=g,Txplayer.register("HtmlFrame",d)},143:function(a,b){a.exports='<% if(!useSVG){ %>\n  <div class="txp_player" id="<%=playerid%>" style="<%=mod_stype%>">\n    <div style="width:1px;height:1px;display:block;-webkit-user-select: auto;user-select: auto;"></div>\n  </div>\n<% }else{%>\n  <txpdiv class="txp_player txp_player_desktop txp_autohide_progress" id="<%=playerid%>" style="<%=mod_stype%>" <%=tabindex%>>\n  <div style="width:1px;height:1px;display:block;-webkit-user-select: auto;user-select: auto;"></div>\n  <txpdiv class="txp_gradient_top" data-role="<%=gradient_top%>"></txpdiv>\n  <txpdiv class="txp_gradient_bottom"></txpdiv>\n  </txpdiv>\n<% } %>'},144:function(a,b){a.exports='<svg class="_txplayer_svg_sprite txp_svg_sprite" display="none" version="1.1" xmlns="http://www.w3.org/2000/svg">\n\n\t<symbol id="txp_svg_collect" viewBox="0 0 36 36">\n\t\t<path d="M32.5 26H29v3.5a1.5 1.5 0 0 1-3 0V26h-3.5a1.5 1.5 0 1 1 0-3H26v-3.469a1.5 1.5 0 1 1 3 0V23h3.5a1.5 1.5 0 1 1 0 3zm.319-11.407c-.139.684-.716 1.209-1.442 1.209a1.5 1.5 0 0 1-1.5-1.5c0-.083.035-.154.048-.234l-.014-.002c.243-1.122.145-2.386-.598-3.584-.655-1.055-2.288-2.461-3.803-2.461-2.045 0-3.443.622-4.661 1.806l-3.358 3.182-3.485-3.207c-1.113-1.054-3.172-1.786-4.736-1.786-1.259 0-2.803.987-3.654 2.57-.975 1.809-.986 4.04.755 5.962l11.116 9.485.001-.001 1.015.928c.02.019.041.035.06.054l.004.004-.001.001c.256.269.419.629.419 1.03a1.5 1.5 0 0 1-1.5 1.5c-.435 0-.819-.191-1.093-.487L4.46 18.931c-3.285-3.209-3.285-8.357-.049-11.52C5.998 5.857 8.116 5 10.371 5c2.257 0 4.374.856 5.963 2.411l1.153 1.128 1.152-1.128C20.227 5.856 22.345 5 24.602 5c2.256 0 4.374.856 5.962 2.411a7.992 7.992 0 0 1 2.283 7.187l-.028-.005z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_collected" viewBox="0 0 36 36">\n\t\t<path d="M27 14.5a9.5 9.5 0 0 0-9.5 9.5c0 1.515.364 2.941.994 4.211l-1.507 1.28L3.96 18.431C.675 15.222.675 10.074 3.911 6.911 5.498 5.357 7.616 4.5 9.871 4.5c2.257 0 4.374.856 5.963 2.411l1.153 1.128 1.152-1.128C19.727 5.356 21.845 4.5 24.102 4.5c2.256 0 4.374.856 5.962 2.411a7.99 7.99 0 0 1 1.755 8.912A9.445 9.445 0 0 0 27 14.5zm0 2a7.5 7.5 0 1 1 0 15 7.5 7.5 0 0 1 0-15zm-4.042 9.485l1.811 1.81c.054.082.09.172.161.244a1.45 1.45 0 0 0 1.075.421 1.44 1.44 0 0 0 1.067-.418c.066-.066.097-.148.147-.222l3.851-3.851a1.463 1.463 0 1 0-2.069-2.07l-3.008 3.007-.978-.978a1.455 1.455 0 0 0-2.057 2.057z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_share" viewBox="0 0 36 36">\n\t\t<path d="M32.946 23.601l.023.009C30.694 29.675 24.86 34 18 34 9.163 34 2 26.837 2 18c0-6.095 3.42-11.372 8.435-14.072a1.48 1.48 0 0 1 .982-.387 1.5 1.5 0 0 1 1.5 1.5c0 .557-.317 1.023-.767 1.282l.032.064C7.927 8.523 5 12.915 5 18c0 7.18 5.82 13 13 13 5.577 0 10.319-3.518 12.165-8.45l.047.017c.154-.665.722-1.171 1.434-1.171a1.5 1.5 0 0 1 1.5 1.5c0 .26-.084.492-.2.705zM32 14.5a1.5 1.5 0 1 1-3 0V9.086l-9.455 9.455a1.498 1.498 0 0 1-2.117-2.117L26.852 7H21.5a1.5 1.5 0 0 1 0-3h8.929a1.47 1.47 0 0 1 .64.115c.546.224.931.758.931 1.385v9z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_play" viewBox="0 0 36 36">\n\t\t<path d="M25.8 18c0 .6-.3 1.1-.8 1.3L12.5 27c-.2.1-.5.2-.8.2-.8 0-1.5-.6-1.5-1.5V10c0-.8.7-1.5 1.5-1.5.3 0 .5.1.8.2l12.7 7.9c.4.5.6.9.6 1.4z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_replay" viewBox="0 0 36 36">\n\t\t<path d="M17.9 28c-4.9 0-9-3.6-9.8-8.3V19.4c0-.8.7-1.4 1.5-1.4s1.5.6 1.5 1.4c.8 3.8 4.5 6.2 8.3 5.4s6.2-4.5 5.4-8.3c-.7-3.2-3.5-5.6-6.9-5.6-1.8 0-3.6.7-4.8 2h1.3c.8 0 1.5.7 1.5 1.5s-.6 1.6-1.5 1.6h-4c-.8 0-1.5-.7-1.5-1.5v-4c0-.8.7-1.5 1.5-1.5.7 0 1.2.5 1.4 1.1C13.6 8.7 15.7 8 17.9 8c5.5 0 10 4.5 10 10s-4.4 10-10 10z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_pause" viewBox="0 0 36 36">\n\t\t<path d="M12 9h1c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1h-1c-.6 0-1-.4-1-1V10c0-.6.4-1 1-1zm11 0h1c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1h-1c-.6 0-1-.4-1-1V10c0-.6.4-1 1-1z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_search" viewBox="0 0 24 24">\n\t\t<path d="M19.4 17.2L17.2 15c0.8-1.1 1.3-2.5 1.3-4 0-3.9-3.1-7-7-7s-7 3.1-7 7 3.1 7 7 7c1.5 0 2.8-0.4 3.9-1.2l2.2 2.2c0.5 0.5 1.3 0.5 1.8 0S19.9 17.7 19.4 17.2zM6.5 11c0-2.8 2.2-5 5-5s5 2.2 5 5 -2.2 5-5 5S6.5 13.8 6.5 11z"></path>\n\t</symbol>\n\t<symbol id="svg_icon_refresh" viewBox="0 0 20 20">\n\t\t<path d="M10 19a9 9 0 0 1-9-8.999V10a1 1 0 1 1 2 0 7 7 0 1 0 7-7 6.952 6.952 0 0 0-4.877 2H7a1 1 0 0 1 0 2H3a1 1 0 0 1-1-1V2a1 1 0 0 1 2 0v1.314A8.935 8.935 0 0 1 10 1c4.971 0 9 4.029 9 9s-4.029 9-9 9z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_next" viewBox="0 0 36 36">\n\t\t<path d="M26 9h1c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1h-1c-.6 0-1-.4-1-1V10c0-.6.4-1 1-1zm-14.8 1.3l9.2 6.6c.6.4.8 1.3.3 2-.1.1-.2.3-.3.3l-9.2 6.6c-.6.4-1.5.3-1.9-.3-.2-.3-.3-.6-.3-.9V11.4c0-.8.6-1.4 1.4-1.4.3 0 .6.1.8.3z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_stop" viewBox="0 0 36 36">\n\t\t<path d="M24 26H12c-1.1 0-2-0.9-2-2V12c0-1.1 0.9-2 2-2h12c1.1 0 2 0.9 2 2v12C26 25.1 25.1 26 24 26z" />\n\t</symbol>\n\t<symbol id="txp_svg_shop" viewBox="0 0 24 24">\n\t\t<path d="M18 13.836V14H8.793l-.552 2H18a2 2 0 1 1-2 2c0-.368.106-.707.278-1H8.722c.172.294.278.633.278 1a2 2 0 1 1-2-2h.206l.552-2H7v-.223L5.34 5H3V4h3v.01L6.147 4l.377 2H20v1h-.206L18 13.835zM18 19a1 1 0 1 0 0-2 1 1 0 0 0 0 2zM7 17a1 1 0 1 0 0 1.998 1 1 0 0 0 0-2zM6.714 7l1.134 6h9.357l1.575-6H6.714z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_eye" viewBox="0 0 24 24">\n\t\t<path d="M12 18c-5.468 0-9-6-9-6s3.533-6 9-6c5.467 0 9 6 9 6s-3.533 6-9 6zm0-11c-5.033 0-8 5-8 5s2.967 5 8 5c5.033 0 8-5 8-5s-2.967-5-8-5zm0 8a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0-5a2 2 0 1 0 0 3.998 2 2 0 0 0 0-4z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_volume" viewBox="0 0 20 20">\n\t\t<path d="M16.714 15.593l-.01-.01a1 1 0 0 1-1.705-.708c0-.287.124-.542.317-.724C16.354 13.073 17 11.614 17 10s-.645-3.072-1.682-4.151A.993.993 0 0 1 15 5.125a1 1 0 0 1 1-1c.3 0 .561.139.744.348l.017-.016A7.969 7.969 0 0 1 19 10c0 2.178-.874 4.15-2.286 5.593zm-3.999 3.122a.956.956 0 0 1-.688.28c-.009 0-.018.005-.027.005a.984.984 0 0 1-.75-.357L5.818 15H2a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h3.818l5.432-3.643A.984.984 0 0 1 12 1c.009 0 .017.005.026.005a.954.954 0 0 1 .968.967c.001.01.006.018.006.028v16c0 .009-.005.017-.005.026a.959.959 0 0 1-.28.689zM6.75 6.643A.984.984 0 0 1 6 7H3v6h3c.304 0 .567.143.75.357l4.25 2.85V3.792L6.75 6.643z"></path>\n\t</symbol>\n\t<symbol id="txp_svg_volume_mute" viewBox="0 0 20 20">\n\t\t<path d="M16.394 12.566A5.88 5.88 0 0 0 17 10a5.97 5.97 0 0 0-1.682-4.151.993.993 0 0 1-.318-.724 1 1 0 0 1 1-1c.3 0 .561.139.745.348l.016-.016A7.969 7.969 0 0 1 19 10a7.934 7.934 0 0 1-1.116 4.055l-1.49-1.489zM11 3.792L8.978 5.149 7.62 3.792l3.63-2.435A.984.984 0 0 1 12 1c.009 0 .017.005.026.005a.954.954 0 0 1 .968.967c.001.01.006.018.006.028v7.171l-2-2V3.792zm7.864 14.072a.999.999 0 0 1-1.414 0L2.136 2.55a1 1 0 1 1 1.415-1.415L18.864 16.45a1 1 0 0 1 0 1.414zM3.171 5l2 2H3v6h3c.304 0 .567.143.75.357l4.25 2.85v-3.379l2 2V18c0 .009-.005.017-.005.027a.955.955 0 0 1-.967.968c-.01 0-.019.005-.028.005a.984.984 0 0 1-.75-.357L5.818 15H2a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h1.171z"></path>\n\t</symbol>\n\n\t<symbol id="txp_svg_setting" viewBox="0 0 24 24">\n\t\t<path d="M21 11v2l-2 1v-.3c-.2.7-.5 1.5-.9 2.1l.2-.2.7 2.1-1.4 1.4-2.1-.7.2-.2c-.7.4-1.4.7-2.1.9h.4l-1 2h-2l-1-2h.3c-.7-.2-1.5-.5-2.1-.9l.2.2-2.1.7-1.4-1.4.7-2.1.2.2c-.4-.7-.7-1.4-.9-2.1v.3l-2-1v-2l2-1v.4c.2-.8.5-1.6 1-2.3l-.3.4-.7-2.2 1.4-1.4 2.1.7-.3.4c.7-.5 1.5-.8 2.3-1H10l1-2h2l1 2h-.4c.8.2 1.6.5 2.3.9l-.3-.3 2.1-.7 1.4 1.4-.7 2.1-.3-.3c.4.7.7 1.4.9 2.2V10l2 1zm-9-4c-2.8 0-5 2.2-5 5s2.2 5 5 5 5-2.2 5-5-2.2-5-5-5z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_bulb" viewBox="0 0 24 24">\n\t\t<path d="M15 16.317V17c0 .186-.065.35-.153.5.088.15.153.313.153.5v2a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-2c0-.186.064-.35.153-.5A.97.97 0 0 1 9 17v-.683A6.994 6.994 0 0 1 5 10a7 7 0 0 1 14 0 6.994 6.994 0 0 1-4 6.317zM10 20h4v-2h-4v2zm2-16a6 6 0 0 0-6 6c0 2.215 1.214 4.128 3 5.167V15c.452.36 1 .593 1 .593V17h4v-1.5s.462-.096 1-.5v.167c1.786-1.04 3-2.953 3-5.167a6 6 0 0 0-6-6z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_window" viewBox="0 0 24 24">\n\t\t<path d="M19 16H9a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1zm0-11H9v10h10V5zM5 19h10v-2h1v2a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h2v1H5v10z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_size_true" viewBox="0 0 24 24">\n\t\t<path d="M20 19H4c-.6 0-1-.4-1-1V6c0-.6.4-1 1-1h16c.6 0 1 .4 1 1v12c0 .6-.4 1-1 1zM5 7v10h14V7H5z" />\n\t</symbol>\n\t<symbol id="txp_svg_size" viewBox="0 0 24 24">\n\t\t<path d="M20 19H4c-.6 0-1-.4-1-1V6c0-.6.4-1 1-1h16c.6 0 1 .4 1 1v12c0 .6-.4 1-1 1zM5 17h10V7H5v10zM19 7h-2v10h2V7z" />\n\t</symbol>\n\t<symbol id="txp_svg_fake" viewBox="0 0 24 24">\n\t\t<path d="M20 20H4c-.6 0-1-.4-1-1V5c0-.6.4-1 1-1h16c.6 0 1 .4 1 1v14c0 .6-.4 1-1 1zM5 6v12h14V6H5zm12 11h-2c-.6 0-1-.4-1-1s.4-1 1-1h1v-1c0-.6.4-1 1-1s1 .4 1 1v2c0 .6-.4 1-1 1zm0-6c-.6 0-1-.4-1-1V9h-1c-.6 0-1-.4-1-1s.4-1 1-1h2c.6 0 1 .4 1 1v2c0 .6-.4 1-1 1zm-8 6H7c-.6 0-1-.4-1-1v-2c0-.6.4-1 1-1s1 .4 1 1v1h1c.6 0 1 .4 1 1s-.4 1-1 1zm0-8H8v1c0 .6-.4 1-1 1s-1-.4-1-1V8c0-.6.4-1 1-1h2c.6 0 1 .4 1 1s-.4 1-1 1z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_fake_true" viewBox="0 0 24 24">\n\t\t<path d="M20 20H4c-.6 0-1-.4-1-1V5c0-.6.4-1 1-1h16c.6 0 1 .4 1 1v14c0 .6-.4 1-1 1zM5 6v12h14V6H5zm12 9h-1v1c0 .6-.4 1-1 1s-1-.4-1-1v-2c0-.6.4-1 1-1h2c.6 0 1 .4 1 1s-.4 1-1 1zm0-4h-2c-.6 0-1-.4-1-1V8c0-.6.4-1 1-1s1 .4 1 1v1h1c.6 0 1 .4 1 1s-.4 1-1 1zm-8 6c-.6 0-1-.4-1-1v-1H7c-.6 0-1-.4-1-1s.4-1 1-1h2c.6 0 1 .4 1 1v2c0 .6-.4 1-1 1zm0-6H7c-.6 0-1-.4-1-1s.4-1 1-1h1V8c0-.6.4-1 1-1s1 .4 1 1v2c0 .6-.4 1-1 1z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_fullscreen" viewBox="0 0 24 24">\n\t\t<path d="M19.7 19.7c-.2.2-.5.3-.7.3h-4c-.6 0-1-.4-1-1s.4-1 1-1h1.6l-3.3-3.3c-.4-.4-.3-1.1.1-1.4.4-.4 1-.4 1.4 0l3.3 3.3V15c0-.6.4-1 1-1s1 .4 1 1v4c-.1.2-.2.5-.4.7zM19 10c-.6 0-1-.4-1-1V7.4l-3.3 3.3c-.4.4-1 .4-1.4 0-.4-.4-.4-1 0-1.4L16.6 6H15c-.6 0-1-.4-1-1s.4-1 1-1h4c.3 0 .5.1.7.3.2.2.3.5.3.7v4c0 .6-.4 1-1 1zM7.4 18H9c.6 0 1 .4 1 1s-.4 1-1 1H5c-.3 0-.5-.1-.7-.3-.2-.2-.3-.5-.3-.7v-4c0-.6.4-1 1-1s1 .4 1 1v1.6l3.3-3.3c.4-.4 1.1-.3 1.4.1.4.4.4 1 0 1.4L7.4 18zm1.9-7.3L6 7.4V9c0 .6-.4 1-1 1s-1-.4-1-1V5c0-.3.1-.5.3-.7.2-.2.5-.3.7-.3h4c.6 0 1 .4 1 1s-.4 1-1 1H7.4l3.3 3.3c.4.4.4 1 0 1.4-.4.4-1 .4-1.4 0z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_fullscreen_true" viewBox="0 0 24 24">\n\t\t<path d="M16.4 9H18c.6 0 1 .4 1 1s-.4 1-1 1h-4c-.3 0-.5-.1-.7-.3-.2-.2-.3-.5-.3-.7V6c0-.6.4-1 1-1s1 .4 1 1v1.6l3.3-3.3c.4-.4 1.1-.3 1.4.1.4.4.4 1 0 1.4L16.4 9zM10 19c-.6 0-1-.4-1-1v-1.6l-3.3 3.3c-.4.4-1 .4-1.4 0-.4-.4-.4-1 0-1.4L7.6 15H6c-.6 0-1-.4-1-1s.4-1 1-1h4c.3 0 .5.1.7.3.2.2.3.5.3.7v4c0 .5-.4 1-1 1zm0-8H6c-.6 0-1-.4-1-1s.4-1 1-1h1.6L4.3 5.7c-.4-.4-.4-1 .1-1.4.4-.4 1-.4 1.4 0L9 7.6V6c0-.6.4-1 1-1s1 .4 1 1v4c0 .3-.1.5-.3.7-.2.2-.5.3-.7.3zm4 2h4c.6 0 1 .4 1 1s-.4 1-1 1h-1.6l3.3 3.3c.4.4.4 1 0 1.4s-1 .4-1.4 0L15 16.4V18c0 .6-.4 1-1 1s-1-.4-1-1v-4c0-.3.1-.5.3-.7.2-.2.5-.3.7-.3z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_select" viewBox="0 0 12 12">\n\t\t<path d="M6 12c-3.3 0-6-2.7-6-6s2.7-6 6-6 6 2.7 6 6-2.7 6-6 6zM6 .9C3.2.9.9 3.2.9 6s2.3 5.1 5.1 5.1 5.1-2.3 5.1-5.1S8.8.9 6 .9z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_select_true" viewBox="0 0 12 12">\n\t\t<path d="M6 12c-3.3 0-6-2.7-6-6s2.7-6 6-6 6 2.7 6 6-2.7 6-6 6zM6 .9C3.2.9.9 3.2.9 6s2.3 5.1 5.1 5.1 5.1-2.3 5.1-5.1S8.8.9 6 .9zm-.3 7.4c-.3.3-.8.3-1.2 0L2.8 6.6c-.3-.3-.3-.8 0-1.2.3-.3.8-.3 1.2 0l1.2 1.2L8 3.7c.3-.3.8-.3 1.2 0 .3.3.3.8 0 1.2L5.7 8.3z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_link" viewBox="0 0 36 36">\n\t\t<path d="M26.5 26h-5c-.8 0-1.5-.7-1.5-1.5s.7-1.5 1.5-1.5h5c2.5 0 4.5-2 4.5-4.5S29 14 26.5 14h-5c-.8 0-1.5-.7-1.5-1.5s.7-1.5 1.5-1.5h5c4.1 0 7.5 3.4 7.5 7.5S30.6 26 26.5 26zM12 18.5c0-.8.7-1.5 1.5-1.5h9c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5h-9c-.8 0-1.5-.7-1.5-1.5zm2.5-4.5h-5C7 14 5 16 5 18.5S7 23 9.5 23h5c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5h-5C5.4 26 2 22.6 2 18.5S5.4 11 9.5 11h5c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_icon_like" viewBox="0 0 20 20">\n\t\t<path d="M18.4 8.5l-2 9.4c-0.2 0.6-0.2 1.1-0.6 1.3 -0.4 0.3-1 0.2-1.9 0.2 -2.9 0-10.4 0-10.4 0l0-12 2.1-5c0 0 0.6-2 1.7-2 1.4 0 1.2 2 1.2 2s0 1.3 0 3c0 0.7 0.2 1 1 1 6.5 0 6.9 0 6.9 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0 1.6-0.2 1.9 0.5C18.5 7.4 18.6 7.9 18.4 8.5zM1.5 19.5c-0.6 0-1-0.4-1-1v-10c0-0.6 0.4-1 1-1s1 0.4 1 1v10C2.5 19.1 2.1 19.5 1.5 19.5z"></path>\n\t</symbol>\n\t<symbol id="txp_svg_loop" viewBox="0 0 36 36">\n\t\t<path d="M13 13h8l-3-3-.8-.8c-.1-.1-.3-.2-.4-.2h-.5c-.2 0-.3.1-.3.3V11h-3c-2.8 0-5 2.2-5 5v4c0 2.4 1.7 4.4 4 4.9v-2.1c-1.2-.4-2-1.5-2-2.8v-4c0-1.7 1.3-3 3-3zm11-1.9v2.1c1.2.4 2 1.5 2 2.8v4c0 1.7-1.3 3-3 3h-8l3.1 3.1.8.8c.1.1.3.2.4.2h.5c.2 0 .3-.1.3-.3V25h3c2.8 0 5-2.2 5-5v-4c-.1-2.4-1.8-4.4-4.1-4.9z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_loop_off" viewBox="0 0 36 36">\n\t\t<path d="M16 11V9.3c0-.2.1-.3.3-.3h.5c.2 0 .3.1.4.2L21 13h-8c-1.7 0-3 1.3-3 3v4c0 1.7 1.3 3 3 3h1v2h-1c-2.8 0-5-2.2-5-5v-4c0-2.8 2.2-5 5-5h3zm4.1 11.2l2.8 2.8c.2.3.2.7 0 .9-.3.2-.7.2-.9 0l-2.8-2.8c-.2-.3-.2-.7 0-.9.3-.2.7-.2.9 0zM21 19c2.8 0 5 2.2 5 5s-2.2 5-5 5-5-2.2-5-5 2.2-5 5-5zm0 9c2.2 0 4-1.8 4-4s-1.8-4-4-4-4 1.8-4 4 1.8 4 4 4zm3-16.9c2.3.5 4 2.5 4 4.9v4c0 .6-.1 1.2-.3 1.8-.4-1-1-1.9-1.7-2.7V16c0-1.3-.8-2.4-2-2.8v-2.1z"></path>\n\t</symbol>\n\t<symbol id="txp_svg_selected" viewBox="0 0 16 16">\n\t\t<path d="M1 8l5 5 9-10 -1-1 -8 9.2L2 7 1 8z"></path>\n\t</symbol>\n\t<symbol id="txp_svg_icon_hot" viewBox="0 0 16 16">\n\t\t<path d="M8.5 4.25c-.547-1.879.5-3.11.5-3.11s-2.25.891-2.25 3.11c0 2.104 1.517 3.45-.068 3.45-.723-.022-1.228-.365-1.228-1.312 0-.851.546-1.619.546-1.619-1.313.696-3 2.153-3 5.556 0 2.517 2.289 4.811 4.5 4.811s4.5-2.105 4.5-4.622c0-4.046-2.975-4.493-3.5-6.264z"></path>\n\t</symbol>\n\t<symbol id="txp_svg_popup" viewBox="0 0 20 20">\n\t\t<path d="M17 18H3c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h5c.6 0 1 .4 1 1s-.4 1-1 1H3v12h14v-3c0-.6.4-1 1-1s1 .4 1 1v3c0 1.1-.9 2-2 2zm2-10c0 .6-.4 1-1 1s-1-.4-1-1V5.4l-4.4 4.4c-.4.4-1 .4-1.4 0-.4-.4-.4-1 0-1.3L15.6 4H13c-.6 0-1-.4-1-1s.4-1 1-1h5c.5 0 .9.4 1 .9V8z"></path>\n\t</symbol>\n\t<symbol id="txp_svg_hd" viewBox="0 0 28 28">\n\t\t<path d="M13 6h-2.8c0.1 0.7 0.2 1.4 0.2 2.4v3.6H2.8V8.5c0-1 0-1.6 0.2-2.4H0.1c0.1 0.7 0.2 1.3 0.2 2.4v10.1c0 1.1 0 1.7-0.2 2.4h2.8c-0.1-0.8-0.2-1.3-0.2-2.4v-4.3h7.6v4.3c0 1.1 0 1.7-0.2 2.4H13c-0.1-0.8-0.2-1.3-0.2-2.4V8.5C12.8 7.4 12.9 6.8 13 6z"\n\t\t/>\n\t\t<path d="M25.8 7.7C24.6 6.5 23.1 6 20.7 6h-3.4c-1.2 0-1.6 0-2.4-0.1 0.1 0.8 0.2 1.4 0.2 2.4v10.2c0 1.1 0 1.7-0.2 2.5 0.8 0 1.2-0.1 2.4-0.1h3.4c2.2 0 3.7-0.5 4.9-1.6 1.5-1.4 2.2-3.4 2.2-6C27.9 11 27.2 9 25.8 7.7zM23.9 17.6c-0.8 0.8-1.8 1.2-3.3 1.2h-3V8.3h3c1.6 0 2.6 0.3 3.4 1.1 0.9 0.9 1.3 2.2 1.3 4C25.3 15.2 24.8 16.6 23.9 17.6z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_lightning" viewBox="0 0 28 28">\n\t\t<path d="M24 12.3c-0.1-0.1-0.1-0.1-0.2-0.1C23.7 12 23.5 12 23.4 12h-6.9l2.3-10c0-0.1 0-0.2 0-0.3 0-0.2-0.1-0.3-0.2-0.5 -0.3-0.3-0.7-0.3-1 0L4.2 14.8C4.1 14.9 4 15.1 4 15.3c0 0.2 0.1 0.4 0.2 0.5 0.1 0.1 0.3 0.2 0.5 0.2h7.1l-2.4 9.9c0 0.1 0 0.1 0 0.2 -0.1 0.3 0 0.5 0.2 0.7 0.1 0.1 0.3 0.2 0.5 0.2 0.2 0 0.4-0.1 0.5-0.2L24 13.2c0.1-0.1 0.2-0.3 0.2-0.5C24.2 12.6 24.1 12.4 24 12.3L24 12.3z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_vip_star_lg" viewBox="0 0 28 28">\n\t\t<path d="M7.5 19.5C8.4 19.9 9.2 20 10 20c2.4 0 4.7-1 6.5-2.8 1.9-1.9 2.8-4.6 2.6-7.1l-1.4-0.2 -3.6-7.3L14 2.5c0 0-0.1 0-0.1 0.1l-3.6 7.3 -8.2 1.2c0 0-0.1 0-0.1 0.1v0.1l5.9 5.8L7.5 19.5zM7.3 20.6L6.6 25v0.1c0 0 0 0 0.1 0 0 0 0 0 0.1 0l6.5-3.5c-0.5 0.1-0.8 0.1-1.3 0.1C10.3 21.9 8.7 21.5 7.3 20.6zM18.7 19.2c-1.2 1.2-2.8 2-4.3 2.5l7 3.6c0 0 0 0 0.1 0h0.1c0 0 0.1-0.1 0-0.1l-1.3-7.9C19.8 17.9 19.3 18.6 18.7 19.2zM25.9 11.1l-4.7-0.7c0.5 2.2 0.1 4.4-1 6.5l5.8-5.5C26 11.3 26 11.3 25.9 11.1 26 11.1 25.9 11.1 25.9 11.1z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_clock" viewBox="0 0 28 28">\n\t\t<path d="M14 0.5c-6.6 0-12 5.4-12 12 0 6.6 5.4 12 12 12 0.4 0 0.7 0 1.1-0.1 0.1 0 0.3 0.1 0.4 0.1 0.8 0 1.5-0.7 1.5-1.5 0-0.8-0.7-1.5-1.5-1.5 -0.1 0-0.1 0-0.2 0l0-0.1c-0.4 0.1-0.9 0.1-1.3 0.1 -5 0-9-4-9-9 0-5 4-9 9-9 5 0 9 4 9 9 0 2-0.7 3.9-1.8 5.4l0.2 0.1C21.1 18.3 21 18.6 21 19c0 0.8 0.7 1.5 1.5 1.5 0.8 0 1.4-0.6 1.5-1.4 1.3-1.9 2-4.2 2-6.6C26 5.9 20.6 0.5 14 0.5zM18.4 12.5h-3.1l-2.5-4.3c-0.4-0.7-1.3-0.9-2-0.5 -0.7 0.4-0.9 1.2-0.5 1.9l3 5.2c0.2 0.4 0.6 0.6 1 0.7 0.1 0 0.3 0.1 0.4 0.1h3.8c0.9 0 1.6-0.7 1.6-1.5C20 13.2 19.3 12.5 18.4 12.5z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_update" viewBox="0 0 28 28">\n\t\t<path d="M13 16.4l0-5.9C13 9.7 13.7 9 14.5 9c0.8 0 1.5 0.6 1.4 1.4l0 4.6h2.4c0.9 0 1.6 0.7 1.6 1.5 0 0.8-0.7 1.5-1.6 1.5h-3.8c0 0-0.1 0-0.1 0 0 0 0 0 0 0 -0.8 0-1.5-0.6-1.5-1.4v0C13 16.5 13 16.5 13 16.4 13 16.5 13 16.5 13 16.4zM15 26c-6.7 0-12-5.4-12-12 0-1.9 0.4-3.7 1.2-5.2L2.9 9.1C2.1 9.3 1.3 8.8 1.1 8 0.9 7.2 1.3 6.4 2.1 6.2L7 4.9c0.8-0.2 1.6 0.3 1.8 1.1l1.3 4.8c0.2 0.8-0.3 1.6-1.1 1.8 -0.8 0.2-1.6-0.3-1.8-1.1l-0.4-1.4c-0.6 1.2-0.9 2.5-0.9 3.9 0 5 4 9 9 9 5 0 9-4 9-9 0-5-4-9-9-9 -0.1 0-0.1 0-0.2 0l0-0.1C14.6 5 14.6 5 14.5 5 13.6 5 13 4.3 13 3.5 13 2.7 13.6 2 14.5 2c0 0 0.1 0 0.1 0 0.1 0 0.3 0 0.4 0 6.7 0 12 5.4 12 12C27 20.6 21.6 26 15 26z"\n\t\t/>\n\t</symbol>\n\t<symbol id="txp_svg_close" viewBox="0 0 16 16">\n\t\t<path d="M9.275 8l4.461-4.461c0.352-0.352 0.352-0.923 0-1.275 -0.352-0.352-0.923-0.352-1.275 0L8 6.725 3.539 2.264c-0.352-0.352-0.923-0.352-1.275 0 -0.352 0.352-0.352 0.923 0 1.275L6.725 8l-4.461 4.461c-0.352 0.352-0.352 0.923 0 1.275 0.352 0.352 0.923 0.352 1.275 0L8 9.275l4.461 4.461c0.352 0.352 0.923 0.352 1.275 0 0.352-0.352 0.352-0.923 0-1.275L9.275 8z"></path>\n\t</symbol>\n\t<symbol id="txp_svg_icon_report" viewBox="0 0 20 20">\n\t\t<path d="M8 9c-.552 0-1-.448-1-1v-3c0-.552.448-1 1-1s1 .448 1 1v3c0 .552-.448 1-1 1zm0 3c-.552 0-1-.448-1-1s.448-1 1-1 1 .448 1 1-.448 1-1 1zm6.323-1.086c-.116.424-.487.742-.948.742-.552 0-1-.448-1-1 0-.148.036-.285.094-.412l-.019-.01c.34-.675.55-1.427.55-2.235 0-2.762-2.239-5-5-5-2.762 0-5 2.238-5 5 0 2.761 2.239 5 5 5 .766 0 1.484-.186 2.133-.494l.013.03c.128-.059.267-.097.417-.097.552 0 1 .448 1 1 0 .471-.332.847-.771.954-.858.378-1.795.608-2.792.608-3.866 0-7-3.134-7-7s3.134-7 7-7 7 3.134 7 7c-.001 1.047-.261 2.024-.677 2.914z"></path>\n\t</symbol>\n</svg>';
},145:function(a,b){var c={};c[445]=c[444]="网络连接似乎出现问题，",c[10001]=c[1]=c[2]=c[3]=c[4]=c[5]=c[30]=c[40]=c[41]=c[42]=c[50]=c[68]="视频获取途中出现问题，",c.defaultMsg=c[51]=c[52]=c[61]=c[62]=c[63]=c[65]=c[66]=c[69]=c[71]=c[73]=c[74]=c[76]=c[77]=c[81]=c[82]=c[86]=c["80.10"]=c[94]="这个视频被外星人劫走，暂时看不了了~",c[64]=c[100]="很遗憾，对此视频的访问暂时受限",c[80.3]=c["80.10"]=c[80.11]=c[84]="此视频包含敏感信息，已被管理员捉拿~",c[80]=c[83]="暂时没有获得该视频版权，努力为您争取中~",c[80.1]="很抱歉，由于版权限制，您所在的地区暂时无法播放该视频",c[80.2]=c[80.7]=c[80.9]="暂时没有获得该视频版权，努力为您争取中~",c[80.14]="受版权方保护要求，本片暂不支持在网页端播放",c.getPlatformErrorCode=function(a,b,c){var d="-",e="-",f="-";return c=c||"00",Txplayer.util.os.mac?d="62":Txplayer.util.os.windows&&(d="61"),"getinfo"===a?e="101":"getkey"===a?e="102":"ad"===a?e="215":"player"===a&&(e="200"),"neterror"===b?f="140":"cgiInnerError"===b?(f="13",c&&(c=""+c),2===c.length&&(c="0"+c)):"h5video"===b?f="111":"aderror"===b&&(f="150"),Txplayer.util.localLog&&Txplayer.util.localLog("VIDEO_ERROR",{platform:d,type:e,module:f,code:c}),d+e+"."+f+c},a.exports=c},146:function(a,b){!function(a,b){b(a,jQuery)}("undefined"!=typeof window?window:this,function(a,b,c){"use strict";function d(){"hidden"!==e&&(g.hidden=i.pageVisibility?g[e]:c)}for(var e,f,g=a.document,h=["webkit","o","ms","moz",""],i=b.support||{},j=("onfocusin"in g&&"hasFocus"in g?"focusin focusout":"focus blur");(f=h.pop())!==c;)if(e=(f?f+"H":"h")+"idden",i.pageVisibility=g[e]!==c,i.pageVisibility){j=f+"visibilitychange";break}d(),b(/blur$/.test(j)?a:g).on(j,function(a){var c=a.type;b(g).triggerHandler(e&&g[e]||/^(?:blur|focusout)$/.test(c)?"hide":"show"),d()})})}});
/*! Txplayer - v3.0.0 - 2018-11-23 12:20:35
 * Copyright (c) 2018
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(275)},275:function(a,b,c){function d(a){f=Txplayer.$,this.msg=new Txplayer.Events,this.dataset={},this.context=a,this.init()}var e=Txplayer.util,f=Txplayer.$;d.prototype={init:function(){this.updatePlayListIndex(0),this.setPlayState(-1),this.context.dataset.playbackRate=1,this.context.dataset.videoCurrentTime=0,this.dataset.retryTimes=0,this.dataset.saveRetryTimes=0,this.dataset.hlsRetryTimes=0,this.write(),this.addEventListener(),this.exportsModuleApis(),this.loadSubPlugins(),this.resetVideoStatus()},loadSubPlugins:function(){var a=[];this.context.pluginConfig&&"array"===f.type(this.context.pluginConfig.subPlugins)&&(a=this.context.pluginConfig.subPlugins.slice(0));var b={msg:this.context.msg,userMsg:this.context.userMsg,dataset:this.context.dataset,userApi:this.context.userApi,$mod:{$videomod:this.dataset.$videomod}};e.loadPlugins.call(this,a,b)},remove:function(){this.dataset.$videomod.remove()},addEventListener:function(){this.initVideoEvents(),this.dealFilmMsgMoudle()},exportsModuleApis:function(){this.initUserApis(),this.initPrivateMsg(),this.initDataApis()}},e.extend(d.prototype,c(276)),e.extend(d.prototype,c(278)),e.extend(d.prototype,c(279)),e.extend(d.prototype,c(280)),e.extend(d.prototype,c(281)),e.extend(d.prototype,c(282)),e.extend(d.prototype,c(283)),e.extend(d.prototype,c(284)),e.extend(d.prototype,c(285)),e.extend(d.prototype,c(286)),e.extend(d.prototype,c(287)),e.extend(d.prototype,c(288)),e.extend(d.prototype,c(289)),Txplayer.register("v4HdPlayer",d)},276:function(a,b,c){var d=c(277);a.exports={write:function(){this.dataset.hasVideoHtmlWrited=!0,this.context.dataset.$playermod.append(this.buildHTML()),this.dataset.$videomod=this.context.dataset.$playermod.find('[data-role="'+this.dataset.renderData.videomod+'"]'),this.context.dataset.$videomod=this.dataset.$videomod,this.dataset.$video=this.dataset.$videomod.find("video"),this.context.userMsg.emit("write")},buildHTML:function(){var a=this,b={videomod:"txp-video-wrapper",data:{attrs:a.getAttrs().join(" "),videoStyle:a.getVideoStyles()}};this.dataset.renderData=b;var c=Txplayer.$.tmpl(d,b);return c},getAttrs:function(){var a={isUsePlayinline:"webkit-playsinline",isUseAirplay:"x-webkit-airplay",isUseControl:'controls="controls"',isUsePreload:['preload="auto"','preload="none"'],muted:"muted",isUseCrossOrigin:'crossOrigin="anonymous"'},b=[];for(var c in a)Txplayer.$.isArray(a[c])?this.context.config[c]===!0?b.push(a[c][0]):b.push(a[c][1]):this.context.config[c]===!0&&b.push(a[c]);return b},setVideoClass:function(a){if(a){var b=this;"array"===Txplayer.$.type(a.removeList)&&Txplayer.$(a.removeList).each(function(a,c){b.dataset.$video.hasClass(c)&&b.dataset.$video.removeClass(c)}),"array"===Txplayer.$.type(a.addList)&&Txplayer.$(a.addList).each(function(a,c){b.dataset.$video.addClass(c)})}},getVideoStyles:function(){var a=[];return a.push("background-color:#000;width:100%;height:100%;"),a.join(";")}}},277:function(a,b){a.exports='<txpdiv data-role="<%=videomod%>" class="txp_video_container">\n  <video style="<%=data.videoStyle%>" <%=data.attrs%> data-role="txp_video_tag" />\n  <video style="<%=data.videoStyle%>" <%=data.attrs%> data-role="txp_video_tag" />\n</txpdiv>'},278:function(a,b){var c=Txplayer.util;a.exports={videoHelper:function(a,b,d){if(!(a&&a.error&&a.error.code&&"pause"===b)){d=d||[];var e,f="play"===b,g=this,h=function(){var c;if(!f||!a||a.paused)return c=d&&d.length?a[b].apply(a,d):a[b]()};if(e=h(),e&&e.then)this.dataset.videoDef=e,e.then(function(){g.dataset.videoDef=null})["catch"](function(a){c.showError("[videoHelper error]",a),g.dataset.videoDef=null});else{if(this.dataset.videoDef)return;h()}return e}},stopVideo:function(a){a&&(Txplayer.$(a).removeAttr("src"),a.load&&a.load())},updateCurrentVideoUrl:function(a){a&&(a.indexOf("blob:")>-1||a.indexOf("mediasource:")>-1||(this.context.dataset.currentVideoUrl=a))},updateVideoStatus:function(a,b){a&&(a.status=b)},getVideoBufferedTime:function(a){if(a=a||{},this.isChrome56WithBugOfMp4())return 0;var b=a.video;if(!b||!b.buffered||!b.buffered.length)return 0;var c=0,d=b.currentTime,e=b.buffered.length;if(1===e)c=b.buffered.end(0);else for(var f=0,g=e;f<g;f++)if(d>=b.buffered.start(f)&&d<=b.buffered.end(f))if(g>f+1)for(var h=f+1;h<g;h++){var i=b.buffered.start(h)-b.buffered.end(h-1);if(!(0<=i&&i<=.2)){c=b.buffered.end(h-1);break}c=b.buffered.end(h)}else c=b.buffered.end(f);return c},resetVideoStatus:function(){var a=this;this.dataset.$video.each(function(b,c){c.index=b,0===b?c.isFocus=!0:c.isFocus=!1,a.updateVideoStatus(c,"IDLE"),c.src&&a.stopVideo(c)}),this.updateVideoDisplay()},updateVideoDisplay:function(){this.dataset.$video.each(function(a,b){b.isFocus===!0?b.style.display="block":b.style.display="none"})},setVideoPlayTime:function(a,b,c){var d=Txplayer.$;if(c="undefined"===d.type(c)||c,"number"===d.type(b)&&!isNaN(b)){if(0==b&&c)return void(0===this.context.dataset.playListIndex?(this.seekTo(a,b),this.videoHelper(a,"play")):this.videoHelper(a,"play"));this.seekTo(a,b),c&&this.videoHelper(a,"play")}}}},279:function(a,b){var c=Txplayer.util;a.exports={isFocusVideoBufferComplete:function(a){if(this.isChrome56WithBugOfMp4())return!1;var b=a||this.getFocusVideoTag(),c=this.getFocusVideoBuffer(a);return parseInt(b.duration)===parseInt(c)||parseInt(b.duration)===Math.ceil(c)},checkTimeisInBufferdRange:function(a){var b=this.getFocusVideoTag();if(!(b&&b.buffered&&b.buffered.length))return!1;if(this.isChrome56WithBugOfMp4()&&!this.context.dataset.useChromeHls)return 0==a||Math.abs(b.currentTime-a)<6&&Math.abs(b.currentTime-a)>2;for(var c,d=0,e=b.buffered.length;d<e;d++)if(c=b.buffered.end(d),c-=this.context.dataset.useHls?1:3,a>=b.buffered.start(d)&&a<=c)return!0;return!1},getFocusVideoTag:function(){var a;return this.dataset.$video.each(function(b,c){if(c.isFocus)return a=c,!1}),a},getFocusVideoBuffer:function(a){var b=a||this.getFocusVideoTag();return b&&b.buffered&&b.buffered.length?b.buffered.end(b.buffered.length-1):0},clearFocusVideoUrl:function(){var a=this.getFocusVideoTag();this.videoHelper(a,"pause"),this.stopVideo(a),this.updateVideoStatus(a,"IDLE")},isFocusVideoReady:function(){var a=this.getFocusVideoTag();return!(!a||!a.src)},setFocusVideoPlay:function(){var a=this.getFocusVideoTag();a.src?(this.videoHelper(a,"play"),this.updateVideoStatus(a,"PLAYING")):c.showInfo("play fail, video.src is null!")},setFocusVideoPause:function(){var a=this.getFocusVideoTag();a.src?(this.dataset.cachePauseAction=!1,this.videoHelper(a,"pause"),this.updateVideoStatus(a,"PAUSE")):("undefined"==typeof a.src&&(this.dataset.cachePauseAction=!0),c.showInfo("pause fail, video.src is null!"))},setFocusVideoCurrentTime:function(a){var b=Txplayer.$,c=Txplayer.util;c.v4log("setFocusVideoCurrentTime",a);var d=this.getFocusVideoTag(),e=this;return a.time>d.duration&&!(e.context.dataset.useHls&&c.browser.safari&&a.time<=e.context.dataset.duration)?void c.showError("setFocusVideoCurrentTime Error","time="+a.time+",duration="+d.duration):this.context.dataset.useChromeHls?(a.time&&(this.context.dataset.videoCurrentTime=a.time),void(e.context.dataset.hlsLoadStartTime&&e.context.dataset.hlsLoadStartTime==a.time?a.autoplay&&(e.dataset.cachePauseAction?e.setFocusVideoPause():e.videoHelper(d,"play")):this.context.msg.broadcast("setHlsCurrenTime",{video:d,currentTime:a.time,autoplay:a.autoplay}))):void("number"!==b.type(a.time)||isNaN(a.time)||(this.context.dataset.videoCurrentTime=a.time,this.setVideoPlayTime(d,a.time,a.autoplay)))},setFocusVideoUrl:function(a){var b=Txplayer.$,c=Txplayer.util;"string"===b.type(a)&&(a={url:a}),a.preload=a.preload||!0,a.autoplay=a.autoplay||!1;var d=this,e=d.getFocusVideoTag(),f=function(f){var g="";if(g="string"===b.type(f)?f:f.url,d.startBufferControl({video:e,src:g,hlsLoadStartTime:d.context.dataset.hlsLoadStartTime}),d.updateCurrentVideoUrl(g),d.context.dataset.useChromeHls&&g&&"function"==b.type(g.indexOf)&&g.indexOf(".m3u8")!=-1){!a.currentTime&&d.context.dataset.hlsLoadStartTime&&(a.currentTime=d.context.dataset.hlsLoadStartTime);var h=[];d.context.dataset.filmVideoData[0].urlArray.forEach(function(a,b){h.push(a.url)}),d.context.msg.broadcast("loadHlsSource",{p2pConfig:c.getP2pConfig(d.context),src:g,m3u8:f.m3u8,video:e,currentTime:a.currentTime,autoplay:a.autoplay,fromSetDefinition:a.fromSetDefinition,m3u8Urls:h,reason:"setFocusVideoUrl"}),a.currentTime&&(d.context.dataset.videoCurrentTime=a.currentTime)}else{if(d.context.dataset.hlsLoadStartTime&&d.context.dataset.useHls&&(a.currentTime=d.context.dataset.hlsLoadStartTime,d.context.dataset.videoCurrentTime=a.currentTime,g=g.split("#t=")[0]+"#t="+Math.ceil(a.currentTime),d.updateCurrentVideoUrl(g),c.v4log("safari-hls setFocusVideoUrl dataset.hlsLoadStartTime",{src:g,hlsLoadStartTime:d.context.dataset.hlsLoadStartTime})),e.src!==g&&b(e).attr("src",g),a.preload)try{d.videoHelper(e,"load")}catch(i){c.showInfo(i,i.stack)}e.isFocus&&(c.showInfo("setFocusVideoUrl.setUrlAndPlay.isFocus"),a.autoplay=!0),a.currentTime&&!d.context.dataset.hlsLoadStartTime?(d.context.dataset.videoCurrentTime=a.currentTime,d.setVideoPlayTime(e,a.currentTime,a.autoplay)):a.autoplay&&(d.context.dataset.videoCurrentTime=d.context.dataset.hlsLoadStartTime||0,d.dataset.cachePauseAction?d.setFocusVideoPause():d.videoHelper(e,"play"))}};a&&a.hasOwnProperty("updateIndex")&&this.updatePlayListIndex(a.updateIndex),"string"===b.type(a.url)?f({url:a.url,m3u8:a.m3u8}):"function"!==b.type(a.getUrlSync)||a.preloading?a.preloading?(d.context.msg.broadcast("showLoading"),c.showInfo("正在预加载中",a)):c.showInfo("setFocusVideoUrl参数错误, 找不到getUrlSync",a):(c.showInfo("setFocusVideoUrl.getUrlSync","start"),a.getUrlSync().done(function(b){a.url=b,c.showInfo("setFocusVideoUrl.getUrlSync.setUrlAndPlay"),f(b)}).fail(function(a){}));var g=this.getPreloadVideoTag();g&&g.src&&this.clearPreloadVideoUrl()}}},280:function(a,b){var c=Txplayer.util;a.exports={isPreloadVideoBuffered:function(){var a=this.getPreloadVideoTag();return!!(a&&a.buffered&&a.buffered.length)},clearPreloadVideoUrl:function(){var a=this.getPreloadVideoTag();this.videoHelper(a,"pause"),this.stopVideo(a),this.updateVideoStatus(a,"IDLE")},getPreloadVideoTag:function(){var a=this.getFocusVideoTag(),b=this.dataset.$video.length,c=a.index,d=this,e=function(){return c++,c>=b&&(c=0),d.dataset.$video[c]};return e()},isPreloadVideoReady:function(a){a=a||{};var b=this.getPreloadVideoTag();if(!b)return c.error("checkPreloadVideoStatus error: can not find preload video!"),!1;if(!b.src)return!1;if(this.context.dataset.playList[this.context.dataset.playListIndex+1]&&this.context.dataset.playList[this.context.dataset.playListIndex+1].error)return!1;if("PRELOADING"===b.status)return!0;if("PRELOAD"===b.status){if(this.context.dataset.useChromeHls&&(b.src.indexOf("blob:")>-1||b.src.indexOf("mediasource:")>-1))return!0;var d=b.src,e=this.context.dataset.playListIndex+1;a.isPreloadFirstFilm&&(e=this.context.dataset.playListIndex),e>=this.context.dataset.playList.length&&(e=0);var f=this.context.dataset.playList[e];return d=d.split("#t=")[0],d===f.url}return!1},setPreloadVideoPlay:function(a){a=a||{};var b=this.getPreloadVideoTag(),d=this.getFocusVideoTag(),e=a.currentTime||b.currentTime;if(b&&d){if(!b.src)return void c.error("播放失败：预加载的视频没找到播放地址");a.isPreloadFirstFilm||a.noUpdateIndex||this.updatePlayListIndex(this.context.dataset.playListIndex+1),this.updateCurrentVideoUrl(this.context.dataset.playList[this.context.dataset.playListIndex].url),this.resetPlayListStatus("preloading"),d.isFocus=!1,b.isFocus=!0,this.updateVideoDisplay(),this.updateVideoStatus(b,"PLAYING"),this.updateVideoStatus(d,"IDLE"),this.videoHelper(d,"pause"),Txplayer.$(d).removeAttr("src"),"number"===Txplayer.$.type(e)&&this.setFocusVideoCurrentTime({time:e,autoplay:!0}),this.context.dataset.hasCallShowUIVipGuide=!1}},setPreloadVideoUrl:function(a){var b,c=this,d=Txplayer.$,e=Txplayer.util;a=a||{};var f=function(){return"string"===d.type(a)||!("object"!==d.type(a)||!a.url)};if((a.isPreloadFirstFilm||!this.isTheLastFilm()||f())&&this.context.dataset.playList){var g=this.getPreloadVideoTag(),h=this.context.dataset.playListIndex+1;a.isPreloadFirstFilm&&(h=0),h>=this.context.dataset.playList.length&&(h=this.context.dataset.playListIndex);var i=function(b){var f="";if(f="string"===d.type(b)?b:b.url,c.startBufferControl({video:g,src:f,hlsLoadStartTime:c.context.dataset.hlsLoadStartTime}),c.updateVideoStatus(g,"PRELOAD"),c.context.dataset.useChromeHls&&f&&"function"==d.type(f.indexOf)&&f.indexOf(".m3u8")!=-1){c.context.dataset.hlsLoadStartTime&&(a.currentTime=c.context.dataset.hlsLoadStartTime);var h=[];c.context.dataset.filmVideoData[0].urlArray.forEach(function(a,b){h.push(a.url)}),c.context.msg.broadcast("loadHlsSource",{p2pConfig:e.getP2pConfig(c.context),src:f,m3u8:b.m3u8,currentTime:a.currentTime,video:g,m3u8Urls:h,reason:"setPreloadVideoUrl"})}else{a.isPreloadFirstFilm&&c.context.msg.broadcast("setPreloadVideoUrlReport"),c.context.dataset.hlsLoadStartTime&&c.context.dataset.useHls&&(a.currentTime=c.context.dataset.hlsLoadStartTime,c.context.dataset.videoCurrentTime=a.currentTime,f=f.split("#t=")[0]+"#t="+Math.ceil(a.currentTime),e.v4log("safari-hls setPreloadVideoUrl dataset.hlsLoadStartTime",{src:f,hlsLoadStartTime:c.context.dataset.hlsLoadStartTime})),d(g).attr("src",f);try{c.videoHelper(g,"load")}catch(i){e.showInfo(i,i.stack)}}g.isFocus&&(e.showInfo("setPreloadVideoUrl.setUrlAndPlay.videoIsFocus"),a.autoplay=!0),f!=c.context.dataset.playList[c.context.dataset.playListIndex].url||a.isPreloadFirstFilm||(a.autoplay=!0,a.noUpdateIndex=!0),a.autoplay&&c.setPreloadVideoPlay(a),c.context.dataset.preloadStartTime=+new Date};b=a.url||this.context.dataset.playList[h];var j=a.m3u8||d.type("string"!==this.context.dataset.playList[h])&&this.context.dataset.playList[h].m3u8||"";"string"===d.type(b)?i({url:b,m3u8:j}):b&&b.url&&!a.preload&&b.url!==g.src?(b.preloading=!0,i({url:b.url,m3u8:j})):b&&"function"===d.type(b.getUrlSync)&&"PRELOADING"!=g.status&&(c.updateVideoStatus(g,"PRELOADING"),b.getUrlSync().done(function(c){b.url=c,e.showInfo("setPreloadVideoUrl.setUrlAndPlay",a),i(c)}).fail(function(a){c.updateVideoStatus(g,"IDLE")}))}}}},281:function(a,b){function c(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};s.v4log("onLoadedmetadata",{isFocus:a.isFocus}),a.isFocus&&this.context.msg.broadcast("videoLoadedMetaData",{videoTag:a})}function d(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};s.v4log("onCanplay",{isFocus:a.isFocus}),this.context.msg.broadcast("videoCanplay",{videoTag:a,playListType:this.context.dataset.currentPlayListType,index:this.context.dataset.playListIndex,isFocus:a.isFocus,src:a.src}),this.context.dataset.videoDuration=a.duration}function e(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};s.v4log("onCanplayThrough",{isFocus:a.isFocus}),a.isFocus&&this.context.msg.broadcast("onCanplayThrough",{videoTag:a})}function f(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};s.v4log("onPlay",{isFocus:a.isFocus,src:a.src}),a.src&&a.isFocus&&(this.context.msg.broadcast("videoPlay",{videoTag:a,playListType:this.context.dataset.currentPlayListType,index:this.context.dataset.playListIndex}),this.startWaitingFinder(),this.startVideoPlayingOnBadNet())}function g(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};a.isFocus&&(this.context.msg.broadcast("videoProgress",{videoTag:a}),a.buffered&&a.buffered.length&&a.buffered.end(a.buffered.length-1)===a.duration&&this.dataset.prevBuffered!==a.buffered.end(a.buffered.length-1)&&(this.dataset.prevBuffered=a.buffered.end(a.buffered.length-1),s.v4log("videoProgressDone",{isFocus:a.isFocus,Buffered:this.dataset.prevBuffered}),this.context.msg.broadcast("videoProgressDone",{videoTag:a,playListIndex:this.context.dataset.playListIndex,playListType:this.context.dataset.currentPlayListType})))}function h(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};s.v4log("onWaiting",{isFocus:a.isFocus}),a.isFocus&&(this.context.msg.broadcast("videoWaiting",{videoTag:a,index:this.context.dataset.playListIndex,playListType:this.context.dataset.currentPlayListType,seeking:a.seeking}),this.setPlayState(3))}function i(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};s.v4log("onSeeking",{isFocus:a.isFocus}),a.isFocus&&(this.context.dataset.isVideoSeeking=!0,this.context.msg.broadcast("videoSeeking",{videoTag:a,index:this.context.dataset.playListIndex,playListType:this.context.dataset.currentPlayListType,seeking:!0}))}function j(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};s.v4log("onSeeked",{isFocus:a.isFocus}),a.isFocus&&(this.context.dataset.isVideoSeeking=!1,this.context.msg.broadcast("videoSeeked",{videoTag:a,index:this.context.dataset.playListIndex,playListType:this.context.dataset.currentPlayListType,seeking:!1}))}function k(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};a.isFocus&&this.context.dataset.playbackRate&&a.playbackRate!=this.context.dataset.playbackRate&&(a.playbackRate=this.context.dataset.playbackRate)}function l(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};if(s.v4log("onPlaying",{isFocus:a.isFocus,src:a.src}),a.isFocus&&a.src){var b=this.context.dataset.playList[this.context.dataset.playListIndex];b&&(this.resetPlayListStatus("playing"),this.resetPlayListStatus("ended"),b.playing=!0),this.dataset.retryTimes=0,this.dataset.hlsRetryTimes=0,this.updateVideoStatus(a,"PLAYING"),this.setPlayState(1),this.context.msg.broadcast("videoPlaying",{videoTag:a,playListType:this.context.dataset.currentPlayListType,index:this.context.dataset.playListIndex}),this.setVideoPlaybackRate(),this.context.dataset.isSkippingTime||(this.context.dataset.isVideoSeeking=!1),this.context.dataset.isSkippingTime=!1}}function m(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};s.v4log("onPause",{isFocus:a.isFocus}),a.isFocus&&(this.updateVideoStatus(a,"PAUSE"),this.context.dataset.isMinbufferControlPause||(this.context.msg.broadcast("videoPause",{videoTag:a,playListType:this.context.dataset.currentPlayListType,index:this.context.dataset.playListIndex,end:a.ended}),a.ended||this.setPlayState(2)))}function n(){var a=this.context.dataset.playList[this.context.dataset.playListIndex+1];if(a&&!a.preloading){var b=0;if(this.context.dataset.canPlayTime){for(var c=0;c<=this.context.dataset.playListIndex+1;c++)b+=parseInt(this.context.dataset.playList[c].data.duration,10);if(b>this.context.dataset.canPlayTime)return}(this.isFocusVideoBufferComplete()||this.isChrome56PlayAtTimeCount())&&(s.v4log("正在自动预加载下一贴视频"),this.setPreloadVideoUrl(),a.preloading=!0)}}function o(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};if(!a.isFocus)return s.v4log("预加载的视频发现播放 立马暂停"),void this.videoHelper(a,"pause");var b=parseInt(a.currentTime);if(b&&b!==this.dataset.prevCurrentTime){this.dataset.prevCurrentTime=b;var c=this.getPlayListDurationFromGetinfo();if(!this.context.dataset.useHls&&this.context.dataset.filmVideoData&&this.context.dataset.filmVideoData.length>1&&s.browser.chrome&&c>-1&&a.currentTime-c>.2&&!a.ended)return this.context.dataset.videoCurrentTime=c,this.videoHelper(a,"pause"),void Txplayer.$(a).trigger("ended",{from:"timeupdate"});this.context.dataset.videoCurrentTime=a.currentTime>c&&c>-1?c:a.currentTime,0==this.context.dataset.videoCurrentTime&&(this.context.dataset.videoCurrentTime=this.context.dataset.currentTime||0);var d=this.getVideoBufferedTime({video:a});this.context.dataset.bufferHealth=d-a.currentTime<0?0:parseInt(d-a.currentTime),this.context.dataset.videoBufferedTime=d,this.context.dataset.bufferedTime=this.getBufferdTime(),n.call(this),this.context.msg.broadcast("videoTimeUpdate",{videoTag:a,playListType:this.context.dataset.currentPlayListType,isTheLastFilm:this.isTheLastFilm()});try{this.context.userMsg.broadcast("timeupdate",{videoTag:a,currentTime:this.context.dataset.currentTime})}catch(e){}}}function p(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};s.v4log("onEnd",{isFocus:a.isFocus});var b=arguments&&arguments[1]?arguments[1]:{};if(a.isFocus){if(this.context.dataset.isVideoSeeking=!1,a.duration===a.currentTime&&a.currentTime<this.context.dataset.duration-1&&this.context.dataset.useHls&&s.browser.safari&&!(this.context.dataset.canPlayTime&&this.context.dataset.currentTime>=this.context.dataset.canPlayTime))return void Txplayer.$(a).trigger("error");var c=this.context.dataset.playList[this.context.dataset.playListIndex];c&&(this.resetPlayListStatus("playing"),this.resetPlayListStatus("ended"),c.ended=!0);var d=this.isTheLastFilm();d?b.from&&"skipPrelude"==b.from&&(s.v4log("跳过片尾主动end","video.pause"),a.pause()):this.playTheNext(),this.updateVideoStatus(a,"IDLE"),s.v4log("broadcast-videoEnd",{isTheLastFilm:d,noHdAdPlugin:this.context.dataset.noHdAdPlugin||""}),d&&(this.context.dataset.isFilmEnded=!0),this.context.msg.broadcast("videoEnd",{videoTag:a,index:this.context.dataset.playListIndex,playListType:this.context.dataset.currentPlayListType,isTheLastFilm:d,isAllEnd:!!(d&&this.context.dataset.noHdAdPlugin||this.context.dataset.isEndingAdEnded),from:b&&b.from||"videoEvent"})}}function q(a,b,c){var d="";return a&&a.detail?"manifestLoadError"===a.detail||"levelLoadError"===a.detail?(d="05",d=Txplayer.v4errcode.getPlatformErrorCode("player","h5video",d)):"fragLoadError"===a.detail?(d="08",d=Txplayer.v4errcode.getPlatformErrorCode("player","h5video",d)):"manifestLoadLoadTimeOut"===a.detail||"levelLoadTimeOut"===a.detail?(d="06",d=Txplayer.v4errcode.getPlatformErrorCode("player","h5video",d)):"fragLoadTimeOut"===a.detail?(d="09",d=Txplayer.v4errcode.getPlatformErrorCode("player","h5video",d)):"timeout"===a.detail?(d="04",d=Txplayer.v4errcode.getPlatformErrorCode("player","h5video",d)):"keyIdChange"===a.detail&&(d="10",d=Txplayer.v4errcode.getPlatformErrorCode("player","h5video",d)):"film"==c&&b.error&&(d=Txplayer.v4errcode.getPlatformErrorCode("player","h5video","0"+(b.error.code-1))),d}function r(){var a=arguments&&arguments[0]&&arguments[0].target?arguments[0].target:{};this.context.dataset.videoWaitingReason=3,s.v4log("onError",arguments);var b=arguments&&arguments[1]?arguments[1]:{},c=a.isFocus?this.context.dataset.playListIndex:this.context.dataset.playListIndex+1,d=a.error&&a.error.code,e=3===d;!e||this.context.dataset.vid===u.vid&&this.context.config.playerType===u.playerType||(u.vid=this.context.dataset.vid,u.playerType=this.context.config.playerType,u.errorCode=d,u.isDecodeError=e,u.decodeErrorCount=0),e&&"undefined"!=typeof u.decodeErrorCount&&(u.decodeErrorCount++,u.decodeErrorCount<this.context.config.globalRetryTimes),!a.isFocus&&this.context.dataset.playList[this.context.dataset.playListIndex].preloading&&(c=this.context.dataset.playListIndex);var f=this.context.dataset.playList[c];if(f){var g=q(b,a,this.context.dataset.currentPlayListType);if(f.error=!0,f.errorCode=a.error&&a.error.code,(a.isFocus||(this.context.dataset.useChromeHls||this.stopVideo(a),this.context.dataset.useHls))&&(this.context.msg.broadcast("reportVideoError",{videoTag:a,type:this.context.dataset.currentPlayListType,index:this.context.dataset.playListIndex,code:g||a.error&&a.error.code||"",url:b.url||f.url||a.src||"",isFocus:a.isFocus}),!this.dataset.hasReportError)){if(this.dataset.retryTimes==this.context.config.globalRetryTimes||b.ckeyChange)return a._hlsDetail=b.detail||"",void this.triggerError(a,g,b);if(a.isFocus&&e&&u.decodeErrorCount>this.context.config.globalRetryTimes)return void this.triggerError(a,g,b);this.dataset.retryTimes++,1==this.dataset.retryTimes&&(this.dataset.saveRetryTimes++,this.saveRetryTimes(!0)),s.v4log("retryTimes",{retryTimes:this.dataset.retryTimes}),s.v4log("video出错重试，本次重试原因："+v[d]),f.error=!1,this.context.msg.broadcast("retryUrlsWhenErr",{currentTime:this.context.dataset.videoCurrentTime||0,index:this.context.dataset.playListIndex,isFocus:a.isFocus})}}}var s=Txplayer.util,t={},u={},v={1:"请求中止",2:"网络出错",3:"解码出错",4:"资源不支持"};t.triggerError=function(a,b){if(this.context.dataset.useChromeHls||!this.context.dataset.useChromeHls&&this.context.dataset.useHls&&s.browser.chrome){var c=a.error&&a.error.code||"",d=a.error&&a.error.message||"";return this.context.msg.broadcast("destroyHlsPlayer",{msg:a._hlsDetail+", code: "+c+", message: "+d}),this.clearPlaylist(),this.context.dataset.currentTime&&(this.context.dataset.connectionPlayTime=this.context.dataset.currentTime),this.dataset.hlsRetryTimes>=2?(this.dataset.retryTimes=0,s.v4log("chromehlsErrorSwitchToHtml5hd",{connectionPlayTime:this.context.dataset.connectionPlayTime}),delete this.context.dataset.hlsLoadStartTime,this.context.msg.broadcast("chromehlsErrorSwitchToHtml5hd",{code:b})):(this.dataset.retryTimes=0,s.v4log("chromehlsErrorSwitchToChromehls",{connectionPlayTime:this.context.dataset.connectionPlayTime}),this.context.msg.broadcast("chromehlsErrorSwitchToChromehls",{code:b})),void this.dataset.hlsRetryTimes++}var e={};a&&a.error?e.code=a.error.code:e.code=5,e.msg=Txplayer.v4errcode[e.code],e.type=this.context.dataset.currentPlayListType,e.videoTag=a,e.index=this.context.dataset.playListIndex,b&&(e.errCode=b),s.v4log("broadcast:error",e),this.context.msg.broadcast("error",e),e.flowId=this.context.dataset.flowid;try{this.context.userMsg.broadcast("error",e)}catch(f){}this.dataset.hasReportError=!0},t.initVideoEvents=function(){this.dataset.$video.on("loadedmetadata",c.bind(this)).on("canplay",d.bind(this)).on("canplaythrough",e.bind(this)).on("play",f.bind(this)).on("playing",l.bind(this)).on("progress",g.bind(this)).on("pause",m.bind(this)).on("timeupdate",o.bind(this)).on("ended",p.bind(this)).on("error",r.bind(this)).on("waiting",h.bind(this)).on("seeking",i.bind(this)).on("seeked",j.bind(this)).on("ratechange",k.bind(this))},a.exports=t},282:function(a,b){var c=Txplayer.util;a.exports={setVolume:function(a){var b;if("object"===Txplayer.$.type(a)?b=a.volume:(b=a,a={}),isNaN(b)||"number"!==Txplayer.$.type(b)||b>100&&b<0)return void c.showError("getVolume失败","player.setVolume(volume),volume必须为0-100的整数");0==b?this.mute({broadcast:!1,isUserAction:a.isUserAction}):this.unMute({broadcast:!1,isUserAction:a.isUserAction}),this.dataset.$video.each(function(a,c){c.volume=b/100});var d=b!==this.context.dataset.volume;this.context.dataset.volume=b,this.context.msg.broadcast("volumeChange",{volume:b,isUserAction:!!a.isUserAction});try{d&&this.context.userMsg.broadcast("volumeChange",{volume:b,isUserAction:!!a.isUserAction})}catch(e){}a.showTips&&this.context.msg.broadcast("showUiVolumeTip",{volume:b})},getVolume:function(){return this.context.dataset.volume},mute:function(a){if(a=a||{},a.hasOwnProperty("broadcast")||(a.broadcast=!0),this.dataset.$video.each(function(a,b){b.muted=!0}),this.context.dataset.muted=!0,a.broadcast){try{this.context.userMsg.broadcast("volumeChange",{volume:0,isUserAction:!!a.isUserAction})}catch(b){}this.context.msg.broadcast("volumeChange",{volume:0,isUserAction:!!a.isUserAction})}a.showTips&&this.context.msg.broadcast("showUiVolumeTip",{mute:!0})},unMute:function(a){if(a=a||{},a.hasOwnProperty("broadcast")||(a.broadcast=!0),this.dataset.$video.each(function(a,b){b.muted=!1,b.removeAttribute("muted")}),this.context.dataset.muted=!1,a.broadcast){try{this.context.userMsg.broadcast("volumeChange",{volume:this.context.dataset.volume,isUserAction:!!a.isUserAction})}catch(b){}this.context.msg.broadcast("volumeChange",{volume:this.context.dataset.volume,isUserAction:!!a.isUserAction})}a.showTips&&this.context.msg.broadcast("showUiVolumeTip",{mute:!1})},volumeUp:function(a){var b=5;"number"===Txplayer.$.type(a)&&(b=parseInt(a));var c=this.getVolume();c+=b,c>100&&(c=100),this.setVolume(c)},volumeDown:function(a){var b=5;"number"===Txplayer.$.type(a)&&(b=parseInt(a));var c=this.getVolume();c-=b,c<0&&(c=0),this.setVolume(c)}}},283:function(a,b){function c(){var a=this;this.context.msg.on(d.getUniqueMsgKey("beforeVideoPlay"),function(b,c){a.resetVideoStatus(),a.context.dataset.retryTimesInLast5Play=0,a.context.dataset.bufferTimesInLast5Play=0,a.updateMinBuffer(),a.dataset.saveRetryTimes=0,a.dataset.retryTimes=0,a.dataset.bufferTimes=0,a.dataset.hasReportError=null,a.dataset.BUFFERINGTIME=0,a.context.dataset.bufferHealth=null,a.context.dataset.videoCurrentTime=0,a.context.dataset.videoBufferedTime=0,a.context.dataset.bufferedTime=0,a.context.dataset.bfTimeStart4564=0,a.context.dataset.bfTimeEnd4564=0,a.context.dataset.isVideoSeeking=!1,a.dataset.minBufferSpan=1,a.context.dataset.isFilmEnded=!1,a.context.dataset.isEndingAdEnded=!1,a.context.dataset.loadEnoughBuffer=!1,a.context.dataset.isMinbufferControlPause=!1,a.setPlayState(-1),a.context.msg.broadcast("destroyHlsPlayer",{msg:"player init"}),a.context.msg.off("videoWaiting.loadEnoughBuffer"),a.clearFocusVideoUrl(),a.clearPlaylist("vidEnd",c)}),this.context.msg.on(d.getUniqueMsgKey("beforeVideoRePlay"),function(){a.clearPlaylist("vidEnd",a.context.dataset.vid)}),this.context.msg.on("loadEnoughBuffer",function(){a.context.msg.off("videoWaiting.loadEnoughBuffer"),a.context.msg.on("videoWaiting.loadEnoughBuffer",function(b){if(!b.seeking&&!a.context.dataset.isVideoSeeking&&!(a.context.dataset.isDefinitionSwitching||a.dataset.retryTimes>0)){a.dataset.bufferTimes++;var c=a.getFocusVideoTag();if(c){a.context.dataset.bfTimeStart4564=a.getVideoBufferedTime({video:c});var e=a.getVideoBufferedTime({video:c}),f=e-c.currentTime<0?0:parseInt(e-c.currentTime),g=a.context.dataset.canPlayTime||c.duration;d.v4log("缓冲策略 - videoWaiting ",{bufferHealth:f,duration:g,minBuffer:a.context.dataset.minBuffer,bufferedTime:e})}a.context.msg.off("videoCanplay.EndOfTs"),a.context.msg.on("videoCanplay.EndOfTs",function(){if(a.context.msg.off("videoCanplay.EndOfTs"),a.context.dataset.useHls&&!a.context.dataset.isVideoSeeking&&!(a.context.dataset.isDefinitionSwitching||a.dataset.retryTimes>0)){var b=a.getFocusVideoTag();if(b){var c=a.getVideoBufferedTime({video:b}),e=c-b.currentTime<0?0:parseInt(c-b.currentTime),f=a.context.dataset.canPlayTime||b.duration;d.v4log("缓冲策略 - videoCanplay ",{bufferHealth:e,duration:f,minBuffer:a.context.dataset.minBuffer,bufferedTime:c}),e<a.context.dataset.minBuffer&&f-c>a.context.dataset.minBuffer&&(a.context.msg.broadcast("pause",{from:"minbufferControl"}),a.context.dataset.isMinbufferControlPause=!0,a.context.msg.broadcast("minbufferControlStart"),a.context.msg.broadcast("showLoading"))}}}),a.context.msg.off("videoPlaying.minbufferControl"),a.context.msg.on("videoPlaying.minbufferControl",function(b){if(a.context.dataset.useHls&&(d.v4log("缓冲策略-videoPlaying-before",{seeking:a.context.dataset.isVideoSeeking,isDefinitionSwitching:a.context.dataset.isDefinitionSwitching,retryTimes:a.dataset.retryTimes}),a.context.msg.off("videoPlaying.minbufferControl"),!a.context.dataset.isVideoSeeking&&!(a.context.dataset.isDefinitionSwitching||a.dataset.retryTimes>0))){a.dataset.endVideoWaitingTime=+new Date;var c=b.videoTag,e=a.getVideoBufferedTime({video:c}),f=e-c.currentTime<0?0:parseInt(e-c.currentTime);f>=a.context.dataset.minBuffer&&(a.context.dataset.isMinbufferControlPause=!1,a.context.dataset.bfTimeEnd4564=e,a.context.dataset.videoWaitingReason=1,a.context.msg.broadcast("minbufferControlEnd"))}})}})}),this.context.msg.on("minbufferControlStart",function(){d.v4log("缓冲策略-手动暂停以后-开始监听下载事件minbufferControlStart"),a.context.msg.off("videoProgress.minbufferControl"),a.context.msg.on("videoProgress.minbufferControl",function(b){if(a.context.dataset.isMinbufferControlPause){var c=b.videoTag;if(!a.context.dataset.useHls)return a.context.dataset.isMinbufferControlPause&&(a.context.dataset.isMinbufferControlPause=!1,a.context.msg.broadcast("play",{from:"minbufferControl"})),d.v4log("缓冲策略-chromehlsTomp4"),
void a.context.msg.off("videoProgress.minbufferControl");var e=a.getVideoBufferedTime({video:c});a.context.dataset.bufferHealth=e-c.currentTime<0?0:parseInt(e-c.currentTime),a.context.dataset.bufferHealth>=a.context.dataset.minBuffer?(a.context.dataset.isMinbufferControlPause=!1,a.context.dataset.videoWaitingReason=2,a.context.dataset.bfTimeEnd4564=e,a.context.msg.broadcast("minbufferControlEnd"),a.context.msg.broadcast("play",{from:"minbufferControl"})):a.context.msg.broadcast("showLoading"),d.v4log("缓冲策略-下载进度videoProgress",{bufferHealth:a.context.dataset.bufferHealth,minBuffer:a.context.dataset.minBuffer,isMinbufferControlPause:a.context.dataset.isMinbufferControlPause})}})}),this.context.msg.on("minbufferControlEnd",function(){a.context.msg.broadcast("hideLoading"),d.v4log("缓冲策略-手动暂停恢复播放以后-结束监听下载事件minbufferControlEnd"),a.context.msg.off("videoProgress.minbufferControl"),a.saveBufferTimes(!0),d.v4log("缓冲策略-videoWaiting: ",{minBuffer:a.context.dataset.minBuffer,minBufferSpan:a.dataset.minBufferSpan}),a.context.dataset.minBuffer<14&&(a.context.dataset.minBuffer+=a.dataset.minBufferSpan,1===a.dataset.minBufferSpan&&(a.dataset.minBufferSpan=2))}),this.context.msg.on(d.getUniqueMsgKey("videoEnd"),function(b){(b.isAllEnd||b.isTheLastFilm)&&(a.updatePlayListIndex(0),a.clearPlaylist("vidEnd",a.context.dataset.vid),a.context.dataset.videoCurrentTime=0,a.context.dataset.currentTime=0,a.context.dataset.videoBufferedTime=0,a.context.dataset.bufferedTime=0),b.isAllEnd&&b.isTheLastFilm&&a.setPlayState(0),a.stopWaitingFinder(),a.stopVideoPlayingOnBadNet()}),this.context.msg.on(d.getUniqueMsgKey("error"),function(b){a.clearFocusVideoUrl(),a.clearPlaylist("vidEnd",a.context.dataset.vid),a.stopVideoPlayingOnBadNet(),a.stopWaitingFinder()}),this.context.msg.on("filmVideoShow",function(b){a.context.dataset.isPlayingAd=!1,a.context.msg.broadcast("isPlayingAdStatusChange",a.context.dataset.isPlayingAd,b),a.context.msg.broadcast("play",{isPreloadFirstFilm:!0})}),this.context.msg.on("filmVideoHide",function(b){a.context.dataset.isPlayingAd=!0,a.context.msg.broadcast("isPlayingAdStatusChange",a.context.dataset.isPlayingAd,b),a.context.msg.broadcast("pause")})}var d=Txplayer.util;a.exports={dealFilmMsgMoudle:c}},284:function(a,b){var c=Txplayer.util;a.exports={playTheNext:function(){if(!(this.context.dataset.canPlayTime>=this.context.dataset.currentTime)){if(this.isPreloadVideoReady())return void this.setPreloadVideoPlay();var a=this.context.dataset.playListIndex,b=(this.context.dataset.playList[a],this.context.dataset.playList[a+1]);if(b){if(this.updatePlayListIndex(a+1),b.error)return Txplayer.$(this.getFocusVideoTag()).trigger("error",{error:b.errorCode}),void this.resetPlayListStatus("error");c.showInfo("playTheNext",b),b.autoplay=!0,this.setFocusVideoUrl(b),this.resetPlayListStatus("playing"),b.playing=!0}}},play:function(a){if(this.context.dataset.playList&&0!=this.context.dataset.playList.length&&!this.context.dataset.disableHotKey){var b=this.context.dataset.playList[this.context.dataset.playListIndex];b&&(b.autoplay=!0,this.context.dataset.isDefinitionSwitching&&this.context.dataset.useChromeHls&&this.getFocusVideoTag().src&&(b.playing=!0),b.playing&&!b.error?this.setFocusVideoPlay():b.ended?this.playTheNext():b.error?Txplayer.$(this.getFocusVideoTag()).trigger("error"):b.preloading&&this.isPreloadVideoReady(a)?this.setPreloadVideoPlay(a):this.setFocusVideoUrl(b))}},stop:function(){this.setFocusVideoPause(),this.resetVideoStatus(),this.clearPlaylist(),this.setPlayState(0,{reason:"stop"});var a=this;["bufferedTime","currentTime","currentPlayListType","currentDefinitionFormat","currentDefinitionRate","currentVideoUrl","definition","bufferHealth","getinfoJSON","isLoadingAdEmpty","isDefinitionSwitching"].forEach(function(b){a.context.dataset[b]=null}),this.context.dataset.hasOwnProperty("isPlayingAd")&&(this.context.dataset.isPlayingAd=!1),this.context.msg.broadcast("userStopVideo",{})}}},285:function(a,b){var c=Txplayer.util;a.exports={resetFocusVideoUrl:function(a,b){var d=a.src;if(!this.context.dataset.useChromeHls&&!isNaN(b)){c.v4log("resetFocusVideoUrl",{time:b,src:d}),d=0==b?d.split("#t=")[0]:d.split("#t=")[0]+"#t="+Math.ceil(b);try{a.src=d,c.showInfo("resetFocusVideoUrl",d)}catch(e){}}},seekTo:function(a,b){var d=this,e=Txplayer.$,f=function(){try{if(d.checkTimeisInBufferdRange(b))return d.context.dataset.useChromeHls?void d.videoHelper(a,"play"):(a.currentTime=b,void d.videoHelper(a,"play"));if(d.context.dataset.retrySeekTo||c.browser.ie)return delete d.context.dataset.retrySeekTo,a&&a.duration&&(a.currentTime=b,d.videoHelper(a,"play")),void e(a).on("playing.HdPlayerSeekToPlayingHandler",function(){e(a).off("playing.HdPlayerSeekToPlayingHandler"),Math.abs(a.currentTime-b)>=5&&(a.currentTime=b,d.videoHelper(a,"play"))});c.v4log("seekTo resetFocusVideoUrl设置currentTime"),d.resetFocusVideoUrl(a,b),d.videoHelper(a,"play")}catch(f){}};f()}}},286:function(a,b){var c=Txplayer.util;a.exports={getPlayListDurationFromGetinfo:function(){var a=-1,b=this.context.dataset.playList[this.context.dataset.playListIndex];return b&&b.data&&b.data.duration&&(a=parseFloat(b.data.duration)),a},resetPlayListStatus:function(a){a&&Txplayer.$.each(this.context.dataset.playList||[],function(b,c){c.hasOwnProperty(a)&&(c[a]=!1)})},isTheLastOfPlayList:function(){if(!this.context.dataset.playList||0===this.context.dataset.playList.length)return!0;var a=this.context.dataset.playList[this.context.dataset.playListIndex+1];return!a},isTheLastFilm:function(){if(!this.context.dataset.playList||0===this.context.dataset.playList.length)return!0;var a=this.context.dataset.playList[this.context.dataset.playListIndex+1];return!a||(a.vid!=this.context.dataset.vid||!!(this.context.dataset.canPlayTime&&this.context.dataset.canPlayTime>=this.context.dataset.currentTime))},updatePlayListIndex:function(a){c.showInfo("updatePlayListIndex",a),"number"!==Txplayer.$.type(a)||a<0||this.context.dataset.playList&&this.context.dataset.playList.length&&a>=this.context.dataset.playList.length||(this.context.dataset.playListIndex=a,this.context.dataset.currentPlayListType="film")},addUrls2Player:function(a){var b={},d=this;if("array"===Txplayer.$.type(a)&&(b.data=a),"object"===Txplayer.$.type(a)&&"array"===Txplayer.$.type(a.data)&&(b=a),"array"!==Txplayer.$.type(b.data))return void c.showInfo("addUrls2Player 参数错误");if(d.context.dataset.playList&&!b.clear||(d.context.dataset.playList=[],0!==d.context.dataset.playListIndex&&d.updatePlayListIndex(0)),b.data&&b.repalcePlayList===!0){var e=d.context.dataset.playList.length;if(b.data.length===e){var f=0;Txplayer.$(d.context.dataset.playList).each(function(a,c){d.context.dataset.playList[a]=b.data[f],f++})}else 0===e?d.context.dataset.playList=d.context.dataset.playList.concat(b.data):d.context.dataset.playList=b.data}else d.context.dataset.playList=d.context.dataset.playList.concat(b.data)},clearPlaylist:function(a,b){if(!this.context.dataset.playList)return void(this.context.dataset.playList=[]);if("vidEnd"===a&&b){var c=[];return Txplayer.$.each(this.context.dataset.playList,function(a,d){d.vid!==b&&c.push(d)}),this.context.dataset.playList=c,void this.updatePlayListIndex(0)}a||(this.context.dataset.playList=[]),0!==this.context.dataset.playListIndex&&this.updatePlayListIndex(0)}}},287:function(a,b){var c=Txplayer.util;a.exports={setPlayState:function(a,b){if(b=b||{},"number"===Txplayer.$.type(a)&&a!==this.context.dataset.playState){this.context.dataset.playState=a,this.context.msg.broadcast("playStateChange",{state:a,vid:this.context.dataset.vid,reason:b.reason||""});try{this.context.userMsg.broadcast("playStateChange",{state:a,vid:this.context.dataset.vid,reason:b.reason||""})}catch(c){}}},getPlayState:function(){return this.context.dataset.playState},setInternalPlaybackRate:function(a){if(a>=4||a<=.4)return void this.context.msg.broadcast("showUiPlaybackRateTip",a);if(this.context.dataset.playbackRate!==a){a=Math.round(100*a)/100,this.context.dataset.playbackRate=a,this.setVideoPlaybackRate(a),this.context.msg.broadcast("showUiPlaybackRateTip",a),this.context.msg.broadcast("playbackRateChange",a);try{this.context.userMsg.broadcast("playbackRateChange",a)}catch(b){}}},setVideoPlaybackRate:function(a){a=a||this.context.dataset.playbackRate,this.dataset.$video.each(function(b,c){c.playbackRate=a})},getPlaybackRate:function(){return this.context.dataset.playbackRate},setPlaybackRate:function(a){this.context.msg.broadcast("setPlaybackRate",a)},isChrome56WithBugOfMp4:function(){return"chromehls"!==this.context.config.playerType&&(this.context.dataset&&this.context.dataset.filmVideoData&&this.context.dataset.filmVideoData.length>1&&c.browser.chrome&&c.compareVersion(c.browser.chrome.version,"56.0.2924.10")>0)},isChrome56PlayAtTimeCount:function(){var a,b;return!!(this.isChrome56WithBugOfMp4()&&(a=this.getPlayListDurationFromGetinfo(),b=this.getFocusVideoTag(),a-30<=b.currentTime&&a>0))},getBufferdTime:function(){if(this.context.dataset.isPlayingAd)return 0;if(this.isChrome56WithBugOfMp4())return 0;var a=this.context.dataset.playListIndex,b=0;return Txplayer.$(this.context.dataset.filmVideoData).each(function(c,d){return c!==a&&void(b+=d.duration)}),b+=this.context.dataset.videoBufferedTime},saveRetryTimes:function(a){if(this.context.dataset.useHls){var b=c.getData(Txplayer.dataset.localStorageKey.retryTimes)||"[]",d=JSON.parse(b);if(a){var e=0==d.length?0:d.length-1;d[e]=this.dataset.saveRetryTimes}else{6==d.length&&d.shift(),this.context.dataset.retryTimesInLast5Play=0;for(var f=0;f<d.length;f++)this.context.dataset.retryTimesInLast5Play+=d[f];d.push(0)}c.v4log("缓冲策略-saveRetryTimes",{retryArray:d,err:a}),c.setData(Txplayer.dataset.localStorageKey.retryTimes,JSON.stringify(d))}},saveBufferTimes:function(a){if(this.context.dataset.useHls){var b=c.getData(Txplayer.dataset.localStorageKey.bufferTimes)||"[]",d=JSON.parse(b);if(a){var e=0==d.length?0:d.length-1;d[e]=this.dataset.bufferTimes}else{6==d.length&&d.shift(),this.context.dataset.bufferTimesInLast5Play=0;for(var f=0;f<d.length;f++)this.context.dataset.bufferTimesInLast5Play+=d[f];d.push(0)}c.v4log("缓冲策略-savebufferTimes",{bufferTimes:d,update:a}),c.setData(Txplayer.dataset.localStorageKey.bufferTimes,JSON.stringify(d))}}}},288:function(a,b){a.exports={initUserApis:function(){var a=this;this.dataset.moduleApis={},this.dataset.moduleApis.mute=this.mute.bind(this),this.dataset.moduleApis.unMute=this.unMute.bind(this),this.dataset.moduleApis.isMuted=function(){return!!a.context.dataset.muted},this.dataset.moduleApis.getPlayerState=this.getPlayState.bind(this),this.dataset.moduleApis.setVolume=this.setVolume.bind(this),this.dataset.moduleApis.getVolume=this.getVolume.bind(this),this.dataset.moduleApis.volumeUp=this.volumeUp.bind(this),this.dataset.moduleApis.volumeDown=this.volumeDown.bind(this),this.dataset.moduleApis.getPlaybackRate=this.getPlaybackRate.bind(this),this.dataset.moduleApis.setPlaybackRate=this.setPlaybackRate.bind(this),this.dataset.moduleApis.stop=this.stop.bind(this),this.dataset.moduleApis.showPcClientPop=function(b){a.context.msg.broadcast("showPcClientPop",b)},Txplayer.$.extend(this.context.userApi,this.dataset.moduleApis)},initPrivateMsg:function(){var a=this;this.dataset.privateApis={},this.dataset.privateApis.setVolume=this.setVolume.bind(this),this.dataset.privateApis.mute=this.mute.bind(this),this.dataset.privateApis.unMute=this.unMute.bind(this),this.dataset.privateApis.setInternalPlaybackRate=this.setInternalPlaybackRate.bind(this),this.dataset.privateApis.addUrls2Player=this.addUrls2Player.bind(this),this.dataset.privateApis.play=this.play.bind(this),this.dataset.privateApis.pause=this.setFocusVideoPause.bind(this),this.dataset.privateApis.setFocusVideoCurrentTime=this.setFocusVideoCurrentTime.bind(this),this.dataset.privateApis.setFocusVideoUrl=this.setFocusVideoUrl.bind(this),this.dataset.privateApis.setPreloadVideoUrl=this.setPreloadVideoUrl.bind(this),this.dataset.privateApis.setVideoClass=this.setVideoClass.bind(this),Txplayer.$.each(this.dataset.privateApis,function(b,c){a.context.msg.on(b,c)})},initDataApis:function(){var a=this;this.dataset.dataApis={},this.dataset.dataApis.getFocusVideoTag=function(b,c){c.data=a.getFocusVideoTag()},this.dataset.dataApis.checkTimeisInBufferdRange=function(b,c){c.data=a.checkTimeisInBufferdRange(b)},Txplayer.$.each(this.dataset.dataApis,function(b,c){a.context.msg.setData(b,c)})}}},289:function(a,b){var c=Txplayer.util;a.exports={startBufferControl:function(a){var b=this;if(!b.context.dataset.useHls)return void b.stopBufferControl();var c=Txplayer.util;if(b.context.dataset.loadEnoughBuffer)return void b.stopBufferControl();c.v4log("缓冲策略-开始定时判断是否到首次可播状态",a);var d=a.video||b.getFocusVideoTag();b.stopBufferControl(),this.dataset.bufferControl_TIMER=setInterval(function(){if(c.v4log("step30-bufferControl_TIMER",{buffered:d.buffered.length}),d.buffered&&d.buffered.length){var e=d.buffered.end(d.buffered.length-1)-d.buffered.start(d.buffered.length-1);c.v4log("缓冲策略-首次加载Buffer进度",{hasBuffer:e,minBuffer:b.context.dataset.minBuffer}),c.v4log("step30-首次加载buffer进度",{hasBuffer:e,minBuffer:b.context.dataset.minBuffer}),e>3&&(c.v4log("缓冲策略-首次加载Buffer完成-抛出loadEnoughBuffer事件"),b.context.msg.broadcast("loadEnoughBuffer",{src:a.src}),b.context.dataset.loadEnoughBuffer=!0,b.stopBufferControl())}},100)},stopBufferControl:function(){var a=this;a.dataset.bufferControl_TIMER&&(clearInterval(a.dataset.bufferControl_TIMER),a.dataset.bufferControl_TIMER=null)},updateMinBuffer:function(){var a=this;a.context.dataset.useHls&&(0==this.context.dataset.retryTimesInLast5Play&&this.context.dataset.bufferTimesInLast5Play<=3?this.context.dataset.minBuffer=5:this.context.dataset.retryTimesInLast5Play<=2&&this.context.dataset.bufferTimesInLast5Play<=6?this.context.dataset.minBuffer=6:this.context.dataset.retryTimesInLast5Play<=3&&this.context.dataset.bufferTimesInLast5Play<=10?this.context.dataset.minBuffer=8:(this.context.dataset.retryTimesInLast5Play>3||this.context.dataset.bufferTimesInLast5Play>9)&&(this.context.dataset.minBuffer=10),a.context.msg.off("getVideoUrlSuccess.updateMinBuffer"),a.context.msg.once("getVideoUrlSuccess.updateMinBuffer",function(){a.context.dataset.useHls&&a.context.dataset.duration&&a.context.dataset.duration<600&&(a.context.dataset.minBuffer-=2,c.v4log("缓冲策略-updateMinBuffer-减2",{minBuffer:a.context.dataset.minBuffer,duration:a.context.dataset.duration||{}}))}),c.v4log("缓冲策略-updateMinBuffer",{minBuffer:this.context.dataset.minBuffer,duration:this.context.dataset.duration||{}}))},startWaitingFinder:function(){this.dataset.waitingFinder_TIMER&&this.stopWaitingFinder();var a=this.getFocusVideoTag();if(a){var b,c=this;this.dataset.waitingFinder_TIMER=setInterval(function(){if(a.isFocus||(a=c.getFocusVideoTag()),b!==a.currentTime||a.paused||a.ended)c.dataset.isBadNetWork&&c.context.msg.broadcast("networkBadEnd",{videoTag:a,playListType:c.context.dataset.currentPlayListType,index:c.context.dataset.playListIndex}),c.dataset.isBadNetWork=!1;else{if(c.dataset.isBadNetWork)return;c.context.msg.broadcast("networkBadStart",{videoTag:a,playListType:c.context.dataset.currentPlayListType,isOnWaiting:3===c.getPlayState(),index:c.context.dataset.playListIndex}),c.dataset.isBadNetWork=!0}b=a.currentTime},1500)}},stopWaitingFinder:function(){this.dataset.waitingFinder_TIMER&&(clearInterval(this.dataset.waitingFinder_TIMER),this.dataset.waitingFinder_TIMER=null)},startVideoPlayingOnBadNet:function(){this.dataset.keepPlaying_TIMER&&this.stopVideoPlayingOnBadNet();var a,b,d,e=0,f=this,g=0,h=0;this.dataset.keepPlaying_TIMER=setInterval(function(){if(d=f.getFocusVideoTag(),0!=f.context.dataset.playState&&f.context.dataset.playState!=-1&&2!=f.context.dataset.playState&&!d.error&&d.src&&!d.paused&&!d.ended){if("BUFFERING"===d.status)return void f.addBufferingTime(d);a=f.getFocusVideoBuffer(),b=f.context.dataset.videoCurrentTime||0,h===a&&g===b?(f.updateVideoStatus(d,"BUFFER-CONFORM"),e++):(h=a,g=b,e=0,f.updateVideoStatus(d,"PLAYING")),e<5||(f.updateVideoStatus(d,"BUFFERING"),f.context.dataset.useChromeHls||(c.v4log("缓冲控制-startVideoPlayingOnBadNet-卡顿监听超过5s-reloadFocusVideoUrl",{status:d.status}),f.resetFocusVideoUrl(d,b),f.videoHelper(d,"load"),f.videoHelper(d,"play")),e=0,f.dataset.BUFFERINGTIME=0)}},1e3)},addBufferingTime:function(a){if(this.dataset.BUFFERINGTIME||(this.dataset.BUFFERINGTIME=0),this.dataset.BUFFERINGTIME++,this.dataset.BUFFERINGTIME>=30){if(this.context.dataset.useChromeHls&&this.dataset.BUFFERINGTIME<120)return;Txplayer.util.v4log("triggererror","startVideoPlayingOnBadNet"),Txplayer.$(a).trigger("error",{detail:"timeout"}),this.dataset.BUFFERINGTIME=0}},stopVideoPlayingOnBadNet:function(){this.dataset.keepPlaying_TIMER&&(clearInterval(this.dataset.keepPlaying_TIMER),this.dataset.keepPlaying_TIMER=null)}}}});
/*! Txplayer - v3.0.0 - 2018-11-23 12:20:35
 * Copyright (c) 2018
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(241)},241:function(a,b,c){function d(a){e=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=Txplayer.$,f=Txplayer.util,g=c(242);d.prototype={init:function(){this.write(),this.addEventListerner()},write:function(){var a={shadow:"txp-shadow-mod"};this.dataset.renderData=a;var b=e.tmpl(g,a);this.context.$mod.$videomod.append(b),this.context.dataset.$shadow=this.context.$mod.$videomod.find("[data-role="+a.shadow+"]")},remove:function(){this.context.dataset.$shadow.remove()},initHDPlayerEvent:function(){var a=0,b=200,c=!1,d=this,e=function(){d.handlerClick()},f=function(){d.handlerDblClick()};this.context.dataset.$shadow.off("click.uishadow").off("dblclick.uishadow").on("click.uishadow",function(){d.context.dataset.isRightClickMenu||(a=setTimeout(function(){c||e(),c=!1},b))}).on("dblclick.uishadow",function(){clearTimeout(a),c=!0,f()})},handlerClick:function(){var a,b=this;try{b.context.userMsg.broadcast("userClickPlayBtn")}catch(c){}return b.context.dataset.getinfoJSON?(a&&clearTimeout(a),void(a=setTimeout(function(){a=null,1===b.context.dataset.playState?(b.context.msg.broadcast("pause"),b.context.msg.broadcast("userPausePlayer"),b.context.userMsg.broadcast("pause")):(b.context.msg.broadcast("playControl",{connectionPlayType:1}),b.context.msg.broadcast("userPlayPlayer"))},300))):(b.context.msg.broadcast("beforeVideoRePlay"),b.context.msg.broadcast("playControl",{playStartTime:b.context.dataset.playStartTime,playEndTime:b.context.dataset.playEndTime,vid:b.context.dataset.vid,connectionPlayType:1}),void b.context.msg.broadcast("userPlayPlayer"))},handlerDblClick:function(){this.context.msg.broadcast("UiShadownDblClick")},addEventListerner:function(){f.mobile||this.initHDPlayerEvent()}},Txplayer.register("UiShadow",d)},242:function(a,b){a.exports='<txpdiv data-role="<%=shadow%>" class="txp_shadow"></txpdiv>'}});
/*! Txplayer - v3.0.0 - 2018-11-23 12:20:35
 * Copyright (c) 2018
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(266)},215:function(a,b){a.exports={AD_DEBUG_URL:location.protocol+"//ca.gtimg.com/adplugin/js/gph5adplayer.js",AD_URL_PREFIX:location.protocol+"//vm.gtimg.cn/tencentvideo/txp/js/plugins/",RFID:"gp-rfid",LIVE_TYPE:0,AD_STATUS:{NOT_START:"not_start",REQUEST:"request",REQUEST_DONE:"request_done",READY:"ready",PLAYING:"playing",END:"end"},AD_LOC_TIME:{1:{type:"ivb",area:1}},PC_AD_TYPE:{"前贴":"LD|KB|PVL","中插":"ZC","后贴":"HT","暂停":"ZT","口播":"KB","压流":"PSJ",PPB:"PPB",PVL:"PVL",ivb:"ZI",PDF:"PDF"},MOBILE_AD_TYPE:{"前贴":"WL|WK","中插":"WC","后贴":"WH","暂停":"WZ","口播":"WK",ivb:"WI","压流":"WSJ"},VIDEO_AD_TYPE:"LD|KB|ZC|HT"}},266:function(a,b,c){function d(){var a=Array.prototype.slice.call(arguments);a.unshift("v4-hd-adapter"),(i.getUrlParam("debugad")||i.getUrlParam("debug"))&&window.console&&window.console.log&&window.console.log.apply(window.console,a)}function e(a){f=Txplayer.$,this.context=a,this.context.adApi={},this.dataset={adReportData:{},adCreateParams:{},loadAdJsCount:0,hasRequestEndingAd:!1,beforeInsertAdInterval:null,currentIvbPoint:-1,currentAdType:"",currentVideoAdType:"",videoEndForInsertAd:!1,isVideoPause:!1,adFirstPlay:!0,adMsg:new Txplayer.Events,adapterApi:{},adapterEvent:{},adEvent:{},adPlayer:null,adList:new l,startLoadAdMap:{}},this.dataset.adReportData.LD=new m,this.context.dataset.isPlayingAd=!1,g=j.getPfEx(i),h="pc"===g?k.PC_AD_TYPE:k.MOBILE_AD_TYPE,this.init()}var f,g,h,i=Txplayer.util,j=c(267),k=c(215),l=c(268),m=c(269),n=c(270),o=k.AD_LOC_TIME,p=k.LIVE_TYPE,q=k.AD_STATUS,r=i.getUniqueMsgKey,s=e.prototype;s.init=function(){var a,b="true"===Txplayer.util.getUrlParam("useAd");this.render(f),this.initAdapterApi(),this.initAdapterEvent(),this.initAdEvent(),this.exportsModuleApis(),this.exportsAdApis(),a=b?k.AD_DEBUG_URL:Txplayer.hashMaps["v4gph5adplayer.js"]?Txplayer.dataset.jsBasePath+"plugins/"+Txplayer.hashMaps["v4gph5adplayer.js"]:Txplayer.dataset.jsBasePath+"plugins/v4gph5adplayer.js"},s.render=c(271),s.initAdapterApi=function(){var a=this.dataset.adapterApi,b=this;this.dataset.loadAdJsCount=0;var c=this.context;a.makeAdPlayer=function(a,c){if("undefined"!=typeof window.gpgp&&"undefined"!=typeof window.gpgp.HdPlayerAd){if(!b.dataset.adPlayer)try{c(new window.gpgp.HdPlayerAd(a))}catch(e){d(e),b.handleAdCatch({adtype:"前贴",msg:e.message,method:"new window.gpgp.HdPlayerAd"})}}else b.context.msg.on(r("pluginReady"),function(e){if("v4GpH5Adplayer"===e.name&&"undefined"!=typeof window.gpgp&&"undefined"!=typeof window.gpgp.HdPlayerAd&&!b.dataset.adPlayer)try{c(new window.gpgp.HdPlayerAd(a))}catch(f){d(f),b.handleAdCatch({adtype:"前贴",msg:f.message,method:"new window.gpgp.HdPlayerAd"})}})},a.initAd=function(){var a="";b.context.config&&"function"===f.type(b.context.config.getUserType)&&(a=b.context.config.getUserType());try{b.handleAdJsErrorTimeout("","initAd"),b.dataset.adPlayer&&"function"===f.type(b.dataset.adPlayer.init)&&(b.dataset.adPlayer.init({vid:c.dataset.vid,duration:c.dataset.duration,passThrought:{v:Txplayer.dataset.ver,flowid:c.dataset.flowid,pt:c.dataset.businessId||"",trailerMode:c.dataset.trailerMode||!1,playerType:c.config.playerType,adext:c.dataset.adext||c.config.adext,coverid:c.dataset.cid||"",guid:c.dataset.guid,chid:b.getAdChannelId(),pu:a}}),b.context.msg.broadcast("adPlayerInited"))}catch(e){d(e),b.handleAdCatch({adtype:"",msg:e.message,method:"initAd"})}},a.requestAdOrder=function(a){if(!c.dataset.noHdAdPlugin){var d=a.adtype;if(!d)return i.showError("广告请求参数错误，没有adtype");if(!j.isSupportAdType(d,c.dataset.isBrowserFullscreen,i))return i.showError("该平台不支持这个广告类型："+d);var e=j.getDefaultAdRequestParams(b.getAdRequestParam(d));"undefined"!=typeof a.zcindex&&(e.zcindex=a.zcindex);var f=(c.getinfo,j.getRequestor(a.adtype));f&&c.getinfo[f]&&!function(a){c.getinfo[f](e).always(function(b){b=b||{},b.adtype=a,c.msg.broadcast("onAdOrderDataReady",b)})}(d)}},a.preLoadAd=function(c,e){b.dataset.adFirstPlay&&(a.initAd(),b.dataset.adFirstPlay=!1),b.handleAdJsErrorTimeout("$压流","preloadAd");try{b.dataset.adPlayer&&"function"===f.type(b.dataset.adPlayer.preLoadAd)?b.dataset.adPlayer.preLoadAd(j.getAdEn(c),e):b.handleAdCatch({adtype:c,msg:"no method",method:"preLoadAd"})}catch(g){d(g),b.handleAdCatch({adtype:"$压流",msg:g.message,method:"preLoadAd"})}},a.loadAd=function(c){if("暂停"!==c.adtype||1!=b.context.dataset.playState){d("loadAd: ",c);try{b.dataset.adFirstPlay&&(a.initAd(),b.dataset.adFirstPlay=!1),b.handleAdJsErrorTimeout(c.adtype,"loadAd"),b.dataset.adPlayer&&"function"===f.type(b.dataset.adPlayer.loadAd)?(c.adtype=j.getAdEn(c.adtype),b.dataset.adPlayer.loadAd(c)):b.handleAdCatch({adtype:c.adtype,msg:"no method",method:"loadAd"})}catch(e){d(e),b.handleAdCatch({adtype:c.adtype,msg:e.message,method:"loadAd"})}}},a.playAd=function(a){try{b.dataset.adPlayer&&"function"===f.type(b.dataset.adPlayer.playAd)?b.dataset.adPlayer.playAd(j.getAdEn(a),c.dataset.currentTime):b.handleAdCatch({adtype:a,msg:"no method",method:"playAd"})}catch(e){d(e),b.handleAdCatch({adtype:a,msg:e.message,method:"playAd"})}b.handleAdTimeout({adtype:a,actionType:"play"})},a.playSuperAd=function(a,d){try{b.dataset.adPlayer&&"function"===f.type(b.dataset.adPlayer.playAd)?b.dataset.adPlayer.playAd(j.getAdEn(a),c.dataset.currentTime,d):b.handleAdCatch({adtype:"$压流",msg:"no method",method:"playSuperAd"})}catch(e){b.handleAdCatch({adtype:"$压流",msg:e.message,method:"playSuperAd"})}},a.pauseAd=function(a){try{b.dataset.adPlayer&&"function"===f.type(b.dataset.adPlayer.pauseAd)?b.dataset.adPlayer.pauseAd(j.getAdEn(a)):b.handleAdCatch({adtype:a,msg:"no method",method:"pauseAd"})}catch(c){d(c),b.handleAdCatch({adtype:a,msg:c.message,method:"pauseAd"})}},a.stopAd=function(a,c){try{"前贴"!==a&&"中插"!==a&&"后贴"!==a||(b.context.dataset.isPlayingAd=!1),b.dataset.adPlayer&&"function"===f.type(b.dataset.adPlayer.stopAd)?b.dataset.adPlayer.stopAd(j.getAdEn(a),b.context.dataset.currentTime,c):b.handleAdCatch({adtype:a,msg:"no method",method:"stopAd"})}catch(e){d(e),b.handleAdCatch({adtype:a,msg:e.message,method:"stopAd"})}},a.stopAllAd=function(){b.context.msg.broadcast("cancelP2PPreload");try{b.context.dataset.isPlayingAd=!1,b.dataset.adPlayer&&"function"===f.type(b.dataset.adPlayer.stopAd)?b.dataset.adPlayer.stopAd(!0):b.handleAdCatch({adtype:"",msg:"no method",method:"stopAllAd"})}catch(a){d(a),b.dataset.$videoAdLayer.empty().addClass(Txplayer.dataset.hideClass),b.handleAdCatch({adtype:"",msg:a.message,method:"stopAllAd"})}},a.setVolume=function(c){if(b.dataset.adPlayer&&"function"===f.type(b.dataset.adPlayer.setVolume)){try{b.dataset.adPlayer.setVolume(c,!b.context.config.disableCacheVolume)}catch(e){d(e)}a.mute(0===c)}else b.dataset.volumeCache=c;b.context.dataset.isPlayingAd||(b.dataset.volumeCache=c)},a.mute=function(a){if(b.dataset.adPlayer&&"function"===f.type(b.dataset.adPlayer.mute))try{b.dataset.adPlayer.mute(a,!b.context.config.disableCacheVolume)}catch(c){d(c)}},a.resize=function(a,c,e,g){if(b.dataset.adPlayer&&"function"===f.type(b.dataset.adPlayer.resize))try{b.dataset.adPlayer.resize(a,c,e,g)}catch(h){d(h)}},a.setFullScreen=function(a){if(b.dataset.adPlayer&&"function"===f.type(b.dataset.adPlayer.setFullScreen))try{b.dataset.adPlayer.setFullScreen(a)}catch(c){d(c)}},a.setSmallWindow=function(a){b.dataset.adPlayer&&"function"===f.type(b.dataset.adPlayer.setSmallWindow)&&setTimeout(function(){try{var c=b.context.dataset.$playermod.width(),e=b.context.dataset.$playermod.height();b.dataset.adPlayer.resize(c,e,0,0),b.dataset.adPlayer.setSmallWindow({isSmallWindow:a,width:c,height:e})}catch(f){d(f)}},50)},a.setPos=function(a){if(b.dataset.adPlayer&&"function"===f.type(b.dataset.adPlayer.setPos))try{b.dataset.adPlayer.setPos(a)}catch(c){}},a.report=function(a,c){if(b.dataset.adPlayer&&"function"===f.type(b.dataset.adPlayer.report))try{b.dataset.adPlayer.report(j.getAdEn(a),c)}catch(e){d(e)}}},s.getVideoType=function(){var a="";return window.COVER_INFO&&window.COVER_INFO.typeid?a=+window.COVER_INFO.typeid:window.VIDEO_INFO&&window.VIDEO_INFO.type&&(a=+window.VIDEO_INFO.type),a},s.initAdapterEvent=function(){var a=this.dataset.adapterEvent,b=this.dataset.adapterApi,c=this.context,e=this;c.msg.once(r("adPlayerInited"),function(){if("undefined"!=typeof e.dataset.volumeCache&&e.dataset.adPlayer){var a=Math.min(80,e.dataset.volumeCache);e.dataset.volumeCache=void 0,b.setVolume(a)}}),a[r("adVideoShow")]=function(){e.dataset.$videoAdLayer.removeClass(Txplayer.dataset.hideClass)},a[r("adVideoHide")]=function(){e.context.dataset.disableHotKey=!1,e.dataset.$videoAdLayer.addClass(Txplayer.dataset.hideClass)},a[r("onAdOrderDataReady")]=function(a){a=a||{};var f=a.adtype;if(a.adtype||(f="前贴"),e.dataset.pvlOrderData={},d(f," 订单数据: ",a),a.adList&&a.adLoc)"前贴"===f&&(a.adList.item&&a.adList.item.length>0&&a.adList.item.forEach(function(a){if("PVL"===a.type)return e.dataset.pvlOrderData=a,!1}),e.dataset.adList.getList(f).push({id:r(j.getAdMsgName(f)),status:q.REQUEST_DONE}),j.handleInsertAdStartTime(i,a.adLoc.breakTime,e.dataset.adList.getList("中插"),e.context.msg.getData("calcTotalPlayList","film"),e.context.dataset.duration),a.adLoc.mult&&a.adLoc.mult.ivb&&j.handleMultTime(i,a.adLoc.mult.ivb,e.dataset.adList.getList("ivb")),e.dataset.hasSceneInfo=a.adList.has_scene_info,e.context.dataset.isLoadingAdEmpty=!1),e.updateAdList(f,{status:q.REQUEST_DONE,data:a,time:e.context.dataset.currentTime,point:e.dataset.currentIvbPoint});else{if(e.context.dataset.disableHotKey=!1,"后贴"!==f){var g=j.getAdMsgName(f);e.context.msg.broadcast(g+"End")}else e.dataset.isEndingAdEmpty=!0;"前贴"===f&&(e.context.dataset.isLoadingAdEmpty=!0)}var h={vid:"",isPreload:!1};h.adtype=f,h.vid="",h.isPreload=!1,c.dataset.nextVid&&c.dataset.nextVideoInfo&&c.dataset.nextVideoInfo.vid&&(h.vid=c.dataset.nextVideoInfo.vid,h.isPreload=!0),h.autoPlay=!1,a.adList&&a.adLoc&&(h.adJson=a),h.adcost=a.adList&&a.adLoc?a.adcost?a.adcost:"":-1,h.errorcode=a.adList&&a.adLoc?"":a.adcost?2102:2101,e.reportAd({reportType:"info",step:1,adtype:j.getAdEn(f),errorCode:h.errorcode,stepDuration:a.adcost>32e3?32e3:a.adcost,retryTimes:a.retryTimes||0,domain:a.domain||""}),h.channel=e.getVideoType(),h.live=0,e.dataset.adPlayer?b.loadAd(h):e.createAdPlayer(h)},a[r("loadingAdEnd")]=function(){e.context.dataset.p2pLoadingAdLoadComplete=!1},a[r("cancelP2PPreload")]=function(){e.dataset.canPreloadP2P&&(d("preload 可以结束p2p预加载广告"),e.context.msg.broadcast("setChromeHlsData",{k:"videoPreLoadFinish",v:{keyid:"hls."+e.context.dataset.getinfoJSON.vl.vi[0].lnk+"."+e.context.dataset.currentDefinitionFormat,adLeaveTime:""}}),e.dataset.canPreloadP2P=!1)},a[r("videoTimeUpdate")]=function(a){var d=(c.dataset.skipPrelude,c.dataset.currentTime),f=c.dataset.duration,g=c.dataset.playEndTime||f,h=j.isSupportAdType("中插",c.dataset.isBrowserFullscreen,i),k=a&&"film"===a.playListType&&a.isTheLastFilm&&!e.dataset.hasRequestEndingAd,l=e.dataset.adList.getList("ivb"),m=j.getAdPlayPoint(d,l),n=e.dataset.adList.getList("压流"),p=j.getSuperAdPoint(d,n);if(e.dataset.playedTime||(e.dataset.playedTime=0),e.dataset.playedTime++,10===e.dataset.playedTime&&"0"!==e.dataset.hasSceneInfo&&b.requestAdOrder({adtype:"压流"}),e.dataset.adMsg.broadcast("videoTimeUpdate",a),k){var s=!c.dataset.skipPrelude&&f&&f-d<=5,t=c.dataset.skipPrelude&&g>0&&g-d<=5,u=c.dataset.skipPrelude&&g>0&&d>g;if(s||t||u){var v=e.dataset.adList.getList("后贴");v.push({id:r(j.getAdMsgName("后贴")),status:q.REQUEST}),b.requestAdOrder({adtype:"后贴"}),e.dataset.hasRequestEndingAd=!0;var w=e.dataset.adList.adIsReady("中插",{time:d});w&&(clearInterval(e.dataset.beforeInsertAdInterval),e.context.dataset.$shadow.css("pointer-events","initial"),e.dataset.$countdownNum.text(""),e.dataset.$countdown.addClass(Txplayer.dataset.hideClass),b.stopAd("中插"))}}if(h&&!e.dataset.hasRequestEndingAd){var x=e.dataset.adList.getList("中插"),y=j.getInsertAdPoint(d,x)||{};y.hasPoint&&y.status===q.NOT_START&&(b.requestAdOrder({adtype:"中插",zcindex:y.zcindex}),e.updateAdList("中插",{time:c.dataset.currentTime,status:q.REQUEST}))}e.dataset.currentIvbPoint=m.currentIvbPoint,m.currentIvbPoint>-1&&m.status===q.NOT_START&&(b.requestAdOrder({adtype:o[l[m.currentIvbPoint].type].type,zcindex:m.zcindex}),e.updateAdList("ivb",{point:m.currentIvbPoint,status:q.REQUEST})),p.length>0&&p.forEach(function(a){var c=a.id,d=a.status;a.point!==-1&&a.status===q.NOT_START?(b.preLoadAd("压流",a.id),d=q.REQUEST):2===a.point&&!e.dataset.isVideoPause&&[q.READY,q.PLAYING,q.END].indexOf(a.status)>-1?(b.playSuperAd("压流",a.id),d=q.PLAYING):a.point===-1&&a.status===q.PLAYING&&(b.stopAd("压流",a.id),d=q.END),d!==a.status&&e.updateAdList("压流",{id:c,status:d})})},a[r("videoEnd")]=function(a){try{if(e.dataset.isEndingAdEmpty&&!a.isAllEnd&&a.isTheLastFilm)return c.msg.broadcast("endingAdEnd"),e.dataset.videoEndForInsertAd=!1,void e.resetData();!a.isAllEnd&&a.isTheLastFilm&&(e.dataset.videoEndForInsertAd=!0,e.dataset.adList.adIsReady("后贴")?(c.msg.broadcast("endingAdStart"),b.playAd("后贴")):e.dataset.hasRequestEndingAd?e.dataset.endingAdTimeoutHandler=setTimeout(function(){e.context.dataset.isPlayingAd||(c.msg.broadcast("endingAdEnd"),e.dataset.videoEndForInsertAd=!1,e.resetData())},5500):setTimeout(function(){c.msg.broadcast("endingAdEnd"),e.dataset.videoEndForInsertAd=!1,e.resetData()},500)),a.isAllEnd&&e.resetData()}catch(f){d(f)}},a[r("userSeekStart")]=function(){e.dataset.adList&&e.dataset.adList.map&&e.dataset.adList.map["压流"]&&e.dataset.adList.map["压流"].length>0&&e.dataset.adapterApi.stopAd("压流")},a[r("seekStart")]=function(){e.dataset.adList&&e.dataset.adList.map&&e.dataset.adList.map["压流"]&&e.dataset.adList.map["压流"].length>0&&e.dataset.adapterApi.stopAd("压流")},a[r("userPausePlayer")]=function(){if(e.context.dataset.currentTime&&!e.context.dataset.isPlayingAd&&!e.context.dataset.disableHotKey){e.dataset.isVideoPause=!0;var a=e.dataset.adList.getList("暂停");a.splice(0,a.length),a.push({id:r(j.getAdMsgName("暂停")),status:q.REQUEST}),b.requestAdOrder({adtype:"暂停"}),e.dataset.adList&&e.dataset.adList.map&&e.dataset.adList.map["压流"]&&e.dataset.adList.map["压流"].length>0&&b.pauseAd("压流")}},a[r("videoPlaying")]=function(){e.dataset.isVideoPause=!1,e.dataset.isShowPauseAd&&b.stopAd("暂停")},a[r("userStopVideo")]=function(){e.dataset.adapterApi.stopAllAd(),e.resetData()},a[r("beforeVideoRePlay")]=function(){e.dataset.adapterApi.stopAllAd(),e.resetData()},a[r("vidChange")]=function(){e.dataset.adapterApi.stopAllAd(),e.resetData()},a[r("error")]=function(){e.dataset.adapterApi.stopAllAd(),e.resetData()},a[r("smallWindowModeChange")]=function(a){b.setSmallWindow(a.isSmallWindow)},a[r("windowFullscreenChange")]=function(a){b.setFullScreen(a)},a[r("videoScreenPercentChange")]=function(a){a/=100,setTimeout(function(){var c=e.context.dataset.$playermod.width(),f=e.context.dataset.$playermod.height(),g=c*a,h=f*a,i=g/a,j=h/a,k=(i-g)/2,l=(j-h)/2;b.resize(g,h,k,l),d("videoScreenPercentChange resize: ",g,h)},250)},a[r("resize")]=function(a){b.resize(a.width,a.height,a.left||0,a.top||0),d("resize resize: ",a.width,a.height)},a[r("beforeUiControlShow")]=function(){e.context.dataset.isControlShow||b.setPos({bottom:50})},a[r("hideUiControl")]=function(){e.context.dataset.isControlShow&&b.setPos({bottom:5})},a[r("volumeChange")]=function(a){if(a&&"undefined"!==f.type(a.volume)){var c=Math.min(80,a.volume);b.setVolume(c)}},a[r("adPluginMsg")]=function(a){if("requestCgi"===a.name&&a.params){var c=a.params,d=c.toLowerCase()+"AdDataReady";if(!j.isSupportAdType(c,e.context.dataset.isBrowserFullscreen,i))return void i.showError("该平台不支持这个广告类型："+c);var g=j.getDefaultAdRequestParams(e.getAdRequestParam(c)),h=(e.context.getinfo,j.getRequestor(c));"function"===f.type(e.context.getinfo[h])&&e.context.getinfo[h](g).then(function(a){a=a||{};var b=a.adList&&a.adList.item||[];e.context.msg.broadcast(d,b);var f=e.dataset.adList.getList(c);f.push({id:r(j.getAdMsgName(c)),status:q.REQUEST,data:a})})}else if("reportAd"===a.name){var k=a.adtype||"",l=a.params||{};"array"===f.type(a.params)&&a.params.length>0&&(l=a.params[0]),b.report&&b.report(k,l)}},f.each(a,function(a,b){c.msg.on(a,b)}),this.context.userMsg.on("1080pVipGuideClose.hdplayerad",function(a){a&&"closeSkipAd"===a.action&&e.dataset.currentVideoAdType&&b.playAd(e.dataset.currentVideoAdType)})},s.initAdEvent=function(){var a=this.context,b=this.dataset.adEvent,c=this.dataset.adapterApi,e=this,g=this.dataset.adReportData.LD;b.getAdInfoEvt=function(b){clearTimeout(e.dataset.adJsErrorTimeoutHandle),b.adtype=j.getAdCn(b.adtype);var c=b.adtype,f=j.getAdMsgName(b.adtype);if(b.actionType="getAdInfo",d("preload adinfo: ",b),"前贴"!==c&&"后贴"!==c||(b.duration>0?"前贴"===c&&(e.context.dataset.isPlayingAd=!0,e.dataset.canPreloadP2P=!1,e.handleAdTimeout(b)):"前贴"===c&&(0===b.duration?e.context.dataset.isLoadingAdEmpty=!0:e.context.dataset.isLoadingAdEmpty=!1)),0!==b.duration||"中插"!==c&&"后贴"!==c||("后贴"===c?(e.dataset.isEndingAdEmpty=!0,0===e.context.dataset.playState&&(a.dataset.isPlayingAd=!1,a.msg.broadcast(f+"End"))):(a.dataset.isPlayingAd=!1,a.msg.broadcast(f+"End"))),"暂停"===b.adtype&&(e.dataset.isShowPauseAd=!0),b.relateAd&&b.relateAd.adtype){var g=b.relateAd,h=j.getAdMsgName(g.adtype);a.dataset.loadingImageAdData=e.dataset.pvlOrderData,a.msg.broadcast(h+"Start",g.src)}if("压流"===c&&b.playList&&b.playList.length>0){var i=e.dataset.adList.getList("压流");b.playList.forEach(function(a){i.push({status:q.NOT_START,start:parseInt(a.begin,10)/1e3,end:parseInt(a.end,10)/1e3,duration:parseInt(a.duration,10)/1e3,isSceneAd:a.isSceneAd,id:a.cid,data:a})})}},b.loadStartEvt=function(a){var d=a.adtype;a.index=+a.index,a.adtype=j.getAdCn(a.adtype),clearTimeout(e.dataset.adJsErrorTimeoutHandle),e.dataset.startLoadAdMap[d]||(e.dataset.startLoadAdMap[d]=[]),e.dataset.startLoadAdMap[d].push({duration:parseInt(a.duration,10),index:a.index,vid:a.vid,time:+new Date}),"前贴"===a.adtype&&g.addStep25({vid:a.vid,duration:parseInt(a.duration/1e3,10),index:a.index,loadStartTime:+new Date}),"ivb"===a.adtype&&(e.context.dataset.isControlShow?c.setPos({bottom:50}):c.setPos({bottom:5})),i.browser.firefox&&i.compareVersion(i.browser.firefox.version,"45.0")<1&&("前贴"!==a.adtype&&"中插"!==a.adtype&&"后贴"!==a.adtype||(a.adtype=d,setTimeout(function(){b.loadReadyEvt(a)},1500)))},b.loadReadyEvt=function(b){b.adtype=j.getAdCn(b.adtype);var d=b.adtype;if(clearTimeout(e.dataset.adJsErrorTimeoutHandle),e.updateAdList(d,{status:q.READY,ivbPoint:e.dataset.currentIvbPoint,time:a.dataset.currentTime,id:b.cid||""}),"前贴"===d)e.dataset.adList.adIsEnd("前贴")||e.context.dataset.playState!==-1?(c.stopAd("前贴"),a.msg.broadcast("cancelP2PPreload"),a.msg.broadcast("loadingAdEnd")):(b.actionType="play",a.msg.broadcast("loadingAdStart"),c.playAd("前贴")),e.context.config.disableCacheVolume&&e.dataset.adapterApi.setVolume(e.dataset.volumeCache);else if("中插"===d){var f=e.dataset.adList.adIsReady("中插",{time:e.context.dataset.currentTime});f&&1===e.context.dataset.playState&&(e.context.dataset.disableHotKey=!0,e.context.msg.broadcast("disableProgress"),e.context.msg.broadcast("disablePlayBtn"),e.context.msg.broadcast("disableDefinitionBtn"),e.beforeInsertAdCountDown()),e.context.config.disableCacheVolume&&e.dataset.adapterApi.setVolume(e.dataset.volumeCache)}else"后贴"===d?(e.dataset.videoEndForInsertAd&&(a.msg.broadcast("endingAdStart"),c.playAd("后贴")),e.context.config.disableCacheVolume&&e.dataset.adapterApi.setVolume(e.dataset.volumeCache)):"ivb"===d&&e.context.config.disableCacheVolume&&e.dataset.adapterApi.setVolume(e.dataset.volumeCache)},b.loadProgressEvt=function(a){a.adtype=j.getAdCn(a.adtype),"前贴"===a.adtype&&e.context.msg.broadcast("adLoadProgress",{speed:+a.speed})},b.loadCompleteEvt=function(a){d("preload loadCompleteEvt: ",a),a.adtype=j.getAdCn(a.adtype),a.index=+a.index,e.dataset.canPreloadP2P&&1===a.index&&"前贴"===a.adtype&&(e.context.dataset.p2pLoadingAdLoadComplete=!0,e.context.msg.broadcast("p2pLoadingAdLoadComplete")),"前贴"===a.adtype&&(g.step25({index:a.index,loadCompleteTime:+new Date}),a.isAllEnd&&(e.context.msg.broadcast("cancelP2PPreload"),e.context.msg.broadcast("loadingAdLoadComplete",a)))},b.playStartEvt=function(a){a.reportType="playStart",e.reportAd(a),a.adtype=j.getAdCn(a.adtype),a.index=+a.index,["前贴","中插","后贴","暂停"].indexOf(a.adtype)>-1&&("前贴"===a.adtype&&(e.context.dataset.hasLdAd=!0),e.dataset.currentVideoAdType=a.adtype),e.dataset.currentAdType=a.adtype,"前贴"===a.adtype&&g.step25({index:a.index,vid:a.vid,playStartTime:+new Date}),a.actionType="start",e.handleAdTimeout(a),e.updateAdList(a.adtype,{status:q.PLAYING,index:a.index})},b.pauseAdEvt=function(a){clearTimeout(e.dataset.adTimeoutHandle)},b.resumeAdEvt=function(a){a.adtype=j.getAdCn(a.adtype),a.actionType="resume",e.handleAdTimeout(a)},b.playProgressEvt=function(a){a.adtype=j.getAdCn(a.adtype),"undefined"!==f.type(a.playTime)&&(a.actionType="progress",e.handleAdTimeout(a))},b.playEndEvt=function(a){if(a.adtype=j.getAdCn(a.adtype),a.index=+a.index,"前贴"===a.adtype){var b=g.getItem({step:25,index:a.index}),c=+new Date;g.step25({index:a.index,playEndTime:c,playduration:b&&b.playStartTime?parseFloat((c-b.playStartTime)/1e3,10):""})}},b.playErrorEvt=function(b){b.reportType="playError",e.reportAd(b),b.adtype=j.getAdCn(b.adtype),b.index=+b.index,b.actionType="error";var d=g.getItem({step:25,index:b.index}),f=+new Date;g.step25({index:b.index,playEndTime:f,errorCode:b.errorCode||"",playduration:d&&d.playStartTime?parseInt((f-d.playStartTime)/1e3,10):""}),"前贴"===b.adtype&&b.isAllEnd&&b.errorCode&&!e.context.dataset.isPlayingAd&&(c.stopAd("前贴"),a.msg.broadcast("cancelP2PPreload"),e.context.msg.broadcast("loadingAdEnd")),Txplayer.util.localLog("AD_PLAY_ERROR","ERROR_CODE:"+b.errorCode)},b.stopAdEvt=function(a){a.adtype=j.getAdCn(a.adtype);try{if("前贴"!==a.adtype&&"后贴"!==a.adtype&&"中插"!==a.adtype||(e.context.dataset.isPlayingAd=!1),a.actionType="stop",e.handleAdTimeout(a),clearTimeout(e.dataset.adJsErrorTimeoutHandle),"前贴"===a.adtype){var b=+new Date,c=g.getItem({step:25,index:-1});g.addStep35({loadingAdEndTime:b}),g.step25({index:-1,playEndTime:b,playduration:c&&c.playStartTime?parseInt((b-c.playStartTime)/1e3,10):""})}"暂停"===a.adtype&&(e.dataset.isShowPauseAd=!1)}catch(f){d(f)}},f.each(b,function(a,b){e.dataset.adMsg.on(a,b)})},s.reportAd=function(a){a=a||{};var b,c,d=a.adtype,e=0,f=+new Date,g=0,i=this.dataset.startLoadAdMap[d];if(!a.stepDuration&&i&&i.length>0&&(i.forEach(function(d){if(d.index==a.index){if(!d.vid||!a.vid)return b=d,!1;if(d.vid===a.vid)return b=d,!1;g=1,i.forEach(function(b){b.vid&&b.vid===a.vid&&(c=b.duration)})}}),b?(e=f-b.time,b.duration&&e>b.duration&&(e=b.duration)):g&&c&&(e=c)),1==a.step){if(a.stepDuration<=0)return}else if(a.stepDuration<=0&&e<=0)return;var k=window.performance&&window.performance.now()||0,l=h[j.getAdCn(a.adtype)];l===h["前贴"]&&(l="LD");var m="undefined"!=typeof a.errorType?a.errorType:"";m="undefined"!=typeof a.vid?m+";vid:"+a.vid:m,m="undefined"!=typeof a.reportType?m+";actionType:"+a.reportType:m,m=g?m+";durationfixed:1":m,m="undefined"!=typeof a.retryTimes?m+";retryTimes:"+a.retryTimes:m,m="undefined"!=typeof a.domain?m+";domain:"+a.domain:m,this.context.msg.broadcast("reportAdInfo",{adtype:l,step:a.step||2,step_duration:a.stepDuration||e,step_code:a.errorCode||0,step_index:a.index||1,firstview_duration:parseInt(k,10),ext_info:m})},s.exportsAdApis=function(){var a=this;this.dataset.adApis={};var b=this.dataset.adApis;b.getAdRequestParam=function(b){b=b||"前贴";var c=j.getDefaultAdRequestParams(a.getAdRequestParam(b));return c},b.getAdCreateParams=function(){return a.dataset.adCreateParams},b.getAdReportData=function(){var b=a.dataset.adReportData.LD,c={adtype:"前贴",adDuration:0,playAdDuration:0,list:[]};return b&&b.map&&f.each(b.map,function(a,d){if("step25"===a){var e=b.map.step25||[];e.forEach(function(a){a.loadCompleteTime||(a.loadCompleteTime=a.playStartTime),c.list.push(a),a.duration&&(c.adDuration+=a.duration),a.playduration&&(c.playAdDuration+=a.playduration)})}else if("step35"===a){var f=b.map.step35||[];f.forEach(function(a){c.loadingAdEndTime=a.loadingAdEndTime})}}),c},b.getAdTagConfig=function(a){return"undefined"!=typeof window.gpgp&&"undefined"!=typeof window.gpgp.getconfig&&window.gpgp.getconfig(a?"adflag."+a:"adflag")},b.getAdTagConfigAsync=function(a){return n(a)},f.extend(this.context.adApi,b)},s.exportsModuleApis=function(){this.dataset.moduleApis={};var a=this.dataset.moduleApis,b=this;a.pauseAd=function(a){a=a||b.dataset.currentAdType,b.dataset.adapterApi.pauseAd(a)},a.muteAd=function(a){b.dataset.adapterApi.mute(a)},f.extend(this.context.userApi,a)},s.handleAdJsErrorTimeout=function(a,b){var c=this.context,e=j.getAdMsgName(a),f=this;clearTimeout(f.dataset.adJsErrorTimeoutHandle),f.dataset.adJsErrorTimeoutHandle=setTimeout(function(){d("handleAdJsErrorTimeout: ",e,b),"loadingAd"===e&&f.context.msg.broadcast("cancelP2PPreload"),c.msg.broadcast(e+"End")},5e3)},s.handleAdTimeout=function(a){var b=this,c=this.dataset.adapterApi,e=a.actionType,f=a.adtype,g=j.getAdMsgName(a.adtype);if(clearTimeout(b.dataset.adTimeoutHandle),["stop"].indexOf(e)>-1)return d(e,g+"End"),"后贴"===f?(this.dataset.isEndingAdEmpty=!0,this.dataset.videoEndForInsertAd&&(this.context.dataset.isPlayingAd=!1,this.context.msg.broadcast(g+"End"))):("前贴"!==f&&"中插"!==f||(this.context.dataset.isPlayingAd=!1),"前贴"===f&&this.context.msg.broadcast("cancelP2PPreload"),this.context.msg.broadcast(g+"End")),void b.updateAdList(f,{status:q.END,time:this.context.dataset.currentTime,index:a.index});var h=+new Date;["getAdInfo","play","start","resume","progress"].indexOf(e)>-1&&(b.dataset.adTimeoutHandle=setTimeout(function(){var i=+new Date;d(f+e+" timeout "),b.updateAdList(f,{status:q.END,time:b.context.dataset.currentTime,index:a.index}),"后贴"===f?(b.dataset.isEndingAdEmpty=!0,b.dataset.videoEndForInsertAd&&(b.context.dataset.isPlayingAd=!1,b.context.msg.broadcast(g+"End"))):("loadingAd"===g&&b.context.msg.broadcast("cancelP2PPreload"),c.stopAd(f),"前贴"===f&&(a.errorCode=5,a.stepDuration=i-h,a.stepDuration>1e4&&(a.stepDuration=1e4),a.errorType="player detect timeout",a.reportType=e,a.adtype=j.getAdEn(a.adtype),b.reportAd(a)),b.context.msg.broadcast(g+"End"))},1e4))},s.handleAdCatch=function(a){d("handleAdCatch: ",a.msg,a.method);var b=j.getAdMsgName(a.adtype);"后贴"===a.adtype?(this.dataset.isEndingAdEmpty=!0,this.dataset.videoEndForInsertAd&&(this.context.dataset.isPlayingAd=!1,this.context.msg.broadcast(b+"End"))):("前贴"===a.adtype&&(this.context.dataset.isLoadingAdEmpty=!0,this.context.msg.broadcast("cancelP2PPreload")),this.context.msg.broadcast(b+"End"))},s.createAdPlayer=function(a){var b=this,c=this.dataset.adapterApi,d=this.dataset,e=this.context,g={css:{},dom:{player:e.dataset.$videomod,videoAdLayer:d.$videoAdLayer,interactiveAdLayer:d.$interactiveAdLayer},msg:this.dataset.adMsg,api:{showOpenVIPGuide:function(){return i.mobile&&!i.os.ipad?function(){i.txLoginOnMobile&&"function"===f.type(i.txLoginOnMobile.isLogin)&&i.txLoginOnMobile.isLogin(function(a){0===a?i.txLoginOnMobile.goLogin():location.href="http://film.qq.com/weixin/upay.html?aid=V0$$4:1"})}:"function"===f.type(e.config.showOpenVIPGuide)?function(){b.context.dataset.isWindowFullscreen&&b.context.msg.broadcast("exitWindowFullscreen"),b.context.dataset.isBrowserFullscreen&&b.context.msg.broadcast("exitBrowserFullscreen"),e.config.showOpenVIPGuide()}:void 0}(),getUserType:e.config.getUserType||function(){},getAdChannelId:b.getAdChannelId,getControlStatus:function(){return b.context.dataset.isControlShow},getPlayState:function(){return b.context.dataset.playState},userPlay:function(){b.context.userApi.play&&b.context.userApi.play()},userPausePlayer:function(){b.context.msg.broadcast("pause"),b.context.msg.broadcast("userPausePlayer")},toggleWindowFullScreen:function(){b.context.userApi.toggleWindowFullScreen&&b.context.userApi.toggleWindowFullScreen()},isLogin:function(a){b.context.config.loginHandler&&"function"==f.type(b.context.config.loginHandler.isLogin)&&b.context.config.loginHandler.isLogin(a)},isSmallWindow:function(){return b.context.dataset.isSmallWindowMode},isWindowFullscreen:function(){return b.context.userApi.isWindowFullscreen&&b.context.userApi.isWindowFullscreen()},upBarrageZindex:function(){b.context.dataset.$barrageMod&&b.context.dataset.$barrageMod.css("z-index",5)},resetBarrageZindex:function(){b.context.dataset.$barrageMod&&b.context.dataset.$barrageMod.css("z-index",3)}},dataset:{volume:Math.min(80,e.dataset.volume),config:{},pf:j.getPf(b.getAdChannelId()),chid:b.getAdChannelId(),vid:e.dataset.vid,cid:e.dataset.cid,pt:e.dataset.businessId||"",trailerMode:e.dataset.trailerMode||!1,playerType:e.config.playerType,playerWidth:e.dataset.$playermod&&e.dataset.$playermod.width()||e.dataset.playerWidth,playerHeight:e.dataset.$playermod&&e.dataset.$playermod.height()||e.dataset.playerHeight,isControlShow:e.dataset.isControlShow,isBrowserFullscreen:e.dataset.isBrowserFullscreen,isSkipPrelude:e.dataset.skipPrelude,vptag:i.getPTAG()},util:i};this.dataset.adCreateParams=g,c.makeAdPlayer(g,function(d){b.dataset.adPlayer=d,c.loadAd(a)})},s.resetData=function(){var a=this,b=this.dataset;b.hasRequestEndingAd=!1,b.adFirstPlay=!0,b.currentAdType="",b.currentVideoAdType="",b.currentIvbPoint=-1,b.videoEndForInsertAd=!1,b.isEndingAdEmpty=!1,b.isShowPauseAd=!1,b.isVideoPause=!1,b.playedTime=0,b.adReportData.LD.clear(),b.adList.clear(),b.$countdownNum.text(""),b.$countdown.addClass(Txplayer.dataset.hideClass),b.startLoadAdMap={},a.context.dataset.hasLdAd=!1,clearInterval(b.beforeInsertAdInterval),clearTimeout(b.endingAdTimeoutHandler),this.context.dataset.p2pLoadingAdLoadComplete=!1,this.context.dataset.$shadow.css("pointer-events","initial")},s.getAdChannelId=function(){var a=this;return a.context.config&&a.context.config.hasOwnProperty("chid")&&""!==a.context.config.chid?a.context.config.chid:i.getAdChannelId()},s.updateAdList=function(a,b){this.dataset.adList.updateList(a,b)},s.beforeInsertAdCountDown=function(){var a=10,b=this,c=this.dataset.$countdown,d=this.dataset.$countdownNum;d.text(a),c.removeClass(Txplayer.dataset.hideClass),this.context.dataset.$shadow.css("pointer-events","none"),this.dataset.beforeInsertAdInterval=setInterval(function(){a-=1,a>=0&&d.text(a),0==a&&(clearInterval(b.dataset.beforeInsertAdInterval),b.context.dataset.$shadow.css("pointer-events","initial"),d.text(""),c.addClass(Txplayer.dataset.hideClass),b.context.dataset.playState!==-1&&0!==b.context.dataset.playState&&(b.context.msg.broadcast("insertAdStart"),b.dataset.adapterApi.playAd("中插")))},1e3)},s.getAdRequestParam=function(a){var b=this,c={adtype:a};c.ad_type=h[c.adtype],c.chid=b.getAdChannelId(),c.channelId=b.context.config.channelId,c.pf=j.getPf(c.chid),c.pf_ex=j.getExtensionPlatform(i),"mac"===c.pf_ex&&(c.pf_ex="pc"),c.adaptor=2,c.live=p,c.cid=c.cid||b.context.dataset.cid||"",c.vid=c.vid||b.context.dataset.vid||"",c.rfid=i.getData(k.RFID),c.pt=b.context.dataset.businessId||"",c.flowid=b.context.dataset.flowid||"",c.trailerMode=b.context.dataset.trailerMode,c.isAnNewPlayAction=b.context.dataset.isAnNewPlayAction,c.adext=b.context.dataset.adext||b.context.config.adext,c.playerType=b.context.config.playerType,c.vptag=i.getPTAG(),c.guid=b.context.dataset.guid,c.platform=b.context.dataset.platform,c.adPage=b.context.config.adPage,c.tpid=b.context.config.tpid,b.context.config&&"function"===f.type(b.context.config.getUserType)&&(c.pu=b.context.config.getUserType()||"");var d=this.context.dataset.txplayerAuth.ad();return i.extend(c,d),c},Txplayer.register("v4HdAdapter",e)},267:function(a,b,c){var d=c(215),e=d.AD_STATUS,f=d.AD_LOC_TIME;d.AD_TYPE;a.exports={removeUrlParams:function(a){if("string"==typeof a){var b=document.createElement("a");return b.href=a,b.protocol+"//"+b.host+b.pathname}},getDefaultAdRequestParams:function(a){var b=this.removeUrlParams(document.referrer)||"";if(!b&&top!==window)try{b=this.removeUrlParams(top.location.href)||""}catch(c){}var d={pf:a.pf,ad_type:a.ad_type,
pf_ex:a.pf_ex,url:this.removeUrlParams(location.href),refer:b,ty:"web",plugin:"1.0.0",v:Txplayer.dataset.ver,coverid:a.cid,vid:a.vid,pt:a.pt,flowid:a.flowid,vptag:a.vptag,pu:a.pu,chid:a.chid,adaptor:a.adaptor,dtype:1,live:a.live,resp_type:"json",guid:a.guid,req_type:1};if(a.uid&&(d.uid=a.uid),a.tkn&&(d.tkn=a.tkn),a.lt&&(d.lt=a.lt),a.platform&&(d.platform=a.platform),a.opid&&(d.opid=a.opid),a.atkn&&(d.atkn=a.atkn),a.appid&&(d.appid=a.appid),a.adauthext&&(d.adauthext=a.adauthext),a.tpid&&(d.tpid=a.tpid),"前贴"===a.adtype&&a.rfid&&(d.rfid=a.rfid),a.trailerMode&&(d.page="traileMode",d.trailerMode=1),"coolOpen"===a.playerType&&(d.page="coolOpen",a.isAnNewPlayAction?d.channelId=1:d.channelId=2),"page_langSwitch"===a.adext)d.page="langSwitch";else if(a.adext){var e=a.adext;e=e.split("|");for(var f=/(\w+)\_(\w+)/,g=0,h=e.length;g<h;g++){var i=e[g].match(f);3===i.length&&(d[i[1]]=i[2])}}return a.adPage&&(d.page=a.adPage),a.channelId&&(d.channelId=a.channelId),d},getAdMsgName:function(a){var b="";switch(a){case"前贴":b="loadingAd";break;case"后贴":b="endingAd";break;case"中插":b="insertAd";break;case"暂停":b="pauseAd";break;case"ivb":b="ivbAd";break;case"PVL":b="pvlAd";break;case"压流":b="yaliuAd"}return b},adEn:{"前贴":"QT","后贴":"HT","中插":"ZC","暂停":"ZT",ivb:"IVB","压流":"PSJ"},adCn:{QT:"前贴",HT:"后贴",ZC:"中插",ZT:"暂停",IVB:"ivb",PSJ:"压流"},getAdEn:function(a){return this.adEn[a]},getAdCn:function(a){return this.adCn[a]},getRequestor:function(a){var b="";switch(a){case"前贴":b="loadingAd";break;case"后贴":b="requestEndingAd";break;case"中插":b="requestInsertAd";break;case"暂停":b="requestPauseAd";break;case"PPB":b="requestPpbAd";break;case"PDF":b="requestPdfAd";break;case"ivb":b="requestIvbAd";break;case"压流":b="requestYaliuAd"}return b},getPfEx:function(a){var b=this.getExtensionPlatform(a);return"mac"===b||"pc"===b?"pc":b},getExtensionPlatform:function(a){return a.os.iphone?"iphone":a.os.ipad?"ipad":a.os.android?"android":a.os.mac?"mac":a.os.windows?"pc":""},getPf:function(a){var b=location.hostname;return"v.qq.com"===b||"film.qq.com"===b||8===a?"in":"out"},isSupportAdType:function(a,b,c){var d={pc:["前贴","后贴","中插","暂停","PPB","PDF","PVL","ivb","压流"],mac:["前贴","后贴","中插","暂停","PPB","PDF","PVL","ivb","压流"],ipad:["前贴","后贴","暂停","ivb","压流"],mobile:["前贴","后贴","暂停","ivb","压流"]};return!(!c.os.windows&&!c.os.mac)||(c.os.ipad?d.ipad.indexOf(a)>-1:!!(c.mobile&&d.mobile.indexOf(a)>-1)&&("暂停"!==a||b))},handleMultTime:function(a,b,c){b=b||[],b.forEach(function(b){if(b&&b.time){b.time/1e3;c.push({id:a.getUniqueMsgKey("ivbAd"),time:parseInt(b.time/1e3),type:b.type,area:f[b.type].area,data:{},status:e.NOT_START})}})},getSuperAdPoint:function(a,b){if(!b||0===b.length)return{};var c=[];b.filter(function(b){var d=-1;a>=b.start-6&&a<b.start?d=1:a>=b.start&&a<=b.end&&(d=2),b.point=d,c.push(b)});return c},getAdPlayPoint:function(a,b){if(!b||0===b.length)return{};var c,d,e,f=-1,g=-1;return b.forEach(function(b,h){return a<b.time-b.area?(f=h,-1):a===b.time+b.area?(g=h,c=b.status,d=b.time,e=h,h):void 0}),{time:d,status:c,nextPoint:f,currentIvbPoint:g,zcindex:e}},getInsertTime:function(a,b,c){if(b>=2){var d=a%300;(d>=285||d<=15)&&(a+=30,a>=c&&(a-=60))}return parseInt(a)},handleInsertAdStartTime:function(a,b,c,d,f){if(b&&b.hasOwnProperty("t")&&null!=b.t){var g=[];g="string"==typeof b.t?[b.t]:b.t;var h=this;g.forEach(function(b){var g=+b;d>=2&&(g=h.getInsertTime(g,d,f)),0!==g&&c.push({id:a.getUniqueMsgKey("insertAd"),startTime:g,status:e.NOT_START,data:{}})})}},getInsertAdPoint:function(a,b){var c,d,e,f=!1;return b.forEach(function(b,g){if(a>=b.startTime-15&&a<=b.startTime+15)return c=b.startTime,f=!0,d=b.status,e=g,!1}),{hasPoint:f,point:c,status:d,zcindex:e}}}},268:function(a,b,c){function d(){this.map={}}var e=c(215),f=(e.PC_AD_TYPE,e.AD_STATUS),g=d.prototype;g.getList=function(a){var b=this.map[a];return b||(b=[],this.map[a]=b),b},g.adIsReady=function(a,b){var c=this.map[a]||[],d=!1;return"中插"===a&&c.length>0?c.forEach(function(a){if(b.time>=a.startTime-15&&b.time<=a.startTime+15+8)return d=a.status===f.READY,!1}):"后贴"===a&&c.length>0&&(d=c[0].status===f.READY),d},g.adIsEnd=function(a,b){var c=this.map[a]||[];if("前贴"===a&&c.length>0)return c[0].status===f.END},g.updateList=function(a,b){var c=this.map[a]||[];"前贴"===a||"后贴"===a||"暂停"===a?c.length>0&&(b.data&&(c[0].data=b.data),b.adPlayerInstance&&(c[0].adPlayerInstance=b.adPlayerInstance),c[0].status=b.status):"ivb"===a?c.forEach(function(a,c){if(c===b.point)return b.data&&(a.data=b.data),b.adPlayerInstance&&(a.adPlayerInstance=b.adPlayerInstance),a.status=b.status,!1}):"中插"===a?c.forEach(function(a,c){if(b.time>=a.startTime-15&&b.time<=a.startTime+15+8)return b.data&&(a.data=b.data),b.adPlayerInstance&&(a.adPlayerInstance=b.adPlayerInstance),a.status=b.status,!1}):"压流"===a&&b.id&&c.forEach(function(a,c){a.id===b.id&&(a.status=b.status)})},g.getAdPlayerInstance=function(a,b){var c,d=this.map[a]||[];return"前贴"===a||"后贴"===a||"暂停"===a?d.length>0&&(c=d[0].adPlayerInstance):"ivb"===a?d.forEach(function(a,d){if(d===b.point)return c=a.adPlayerInstance,!1}):"中插"===a&&d.forEach(function(a,d){if(a.startTime>b.time-15&&a.startTime<b.time+15)return c=a.adPlayerInstance,!1}),c},g.clear=function(){this.map={}},a.exports=d},269:function(a,b){function c(){this.map={}}var d=c.prototype;d.add=function(a){var b="step"+a.step;this.map[b]||(this.map[b]=[]),delete a.step;var c=this.map[b],d=0;c.forEach(function(b,c){b.index===a.index&&(d=1)}),d||c.push(a)},d.clear=function(){this.map={}},d.addStep25=function(a){a&&(a.step=25),this.add(a)},d.addStep35=function(a){a&&(a.step=35),this.add(a)},d.getItem=function(a){var b=this.map["step"+a.step]||[],c={};return a.index===-1?b.length>0?b[b.length-1]:{}:(b.forEach(function(b){if(b.index===a.index)return c=b,!1}),c)},d.step25=function(a){var b=this.map.step25||[],c=b[b.length-1];if(b.forEach(function(b,c){if(b.index===a.index)for(var d in a)a.hasOwnProperty(d)&&(b[d]=a[d])}),a.index===-1&&c)for(var d in a)a.hasOwnProperty(d)&&"index"!==d&&(c[d]=a[d])},a.exports=c},270:function(a,b){function c(a,b){f().done(function(c){a.resolve(e(g(c),b))}).fail(function(){a.reject()})}function d(a){var b=j.Deferred(),d=h("dp3config");if(d)try{var f=j.parseJSON(d),g=+new Date;g-f.t>36e5?c(b,a):b.resolve(e(f,a))}catch(i){b.reject()}else c(b,a);return b}function e(a,b){if("string"!=typeof b)return null;var c=b.split("."),d=c[0],e="";c.length>1&&(e=c[1]);var f=a.store;if(f.hasOwnProperty(d)){if(!e)return f[d];if(f[d].hasOwnProperty(e))return f[d][e]}}function f(){var a=j.Deferred(),b=new XMLHttpRequest,c="//dp3.qq.com/dynamic?pf=h5&sdktype=3&chid=-1&appversion=171101&get_type=sdkconfig";return b.open("GET",c),b.onreadystatechange=function(){if("200"==b.status&&4==b.readyState){var c=b.responseText,d={adflag:{}};try{var e=document.createElement("div");e.innerHTML=c,Array.prototype.forEach.call(e.querySelectorAll(".item"),function(a){var b=a.querySelector(".key").innerText,c=a.querySelector(".value").innerText;d.adflag[b]=c}),e=null}catch(f){}var g=Object.keys(d.adflag);g&&g.length?a.resolve(d):a.resolve({adflag:{PSJ:1,PPB:0,PVL:0,PDF:0}})}},b.onerror=b.ontimeout=function(){a.resolve({adflag:{PSJ:0,PPB:0,PVL:0,PDF:0}})},b.send(null),a}function g(a){var b=+new Date,c={store:a,t:b};return i("dp3config",JSON.stringify(c)),c}function h(a){return Txplayer.util.getData(a)}function i(a,b){Txplayer.util.setData(a,b)}var j=Txplayer.$,k=function(a){var b=a?"adflag."+a:"adflag";return d(b)};a.exports=k},271:function(a,b,c){var d=c(272),e=c(273),f=c(274);a.exports=function(a){var b={adLayer:"hd-adapter-adlayer",adInterActiveLayer:"hd-adapter-interactivelayer",countdown:"hd-adapter-countdown",countdownNum:"hd-adapter-countdown-num"},c=this.context.dataset.$videomod;c.after(a.tmpl(d,b)),c.after(a.tmpl(e,b)),c.after(a.tmpl(f,b));var g=this.context.dataset.$videomod.parent();this.dataset.$videoAdLayer=g.find('[data-role="'+b.adLayer+'"]'),this.dataset.$interactiveAdLayer=g.find('[data-role="'+b.adInterActiveLayer+'"]'),this.dataset.$countdown=g.find('[data-role="'+b.countdown+'"]'),this.dataset.$countdownNum=g.find('[data-role="'+b.countdownNum+'"]'),this.dataset.$countdown.addClass(Txplayer.dataset.hideClass),this.dataset.$videoAdLayer.css({position:"absolute",top:0,right:0,width:"100%",height:"100%",zIndex:4,backgroundColor:"#000"}).addClass(Txplayer.dataset.hideClass),this.dataset.$interactiveAdLayer.css({position:"absolute",top:0,right:0,width:"100%",height:"100%",zIndex:4,pointerEvents:"none"}).addClass(Txplayer.dataset.hideClass)}},272:function(a,b){a.exports='<txpdiv data-role="<%=adLayer%>"></txpdiv>'},273:function(a,b){a.exports='<txpdiv data-role="<%=adInterActiveLayer%>"></txpdiv>'},274:function(a,b){a.exports='<txpdiv class="txp_ad_control" data-role="<%=countdown%>">\r\n    <txpdiv class="txp_ad_skip">\r\n        <txpdiv class="txp_ad_countdown" data-role="<%=countdownNum%>"></txpdiv>\r\n        <txpdiv class="txp_ad_skip_text">进入广告</txpdiv>\r\n    </txpdiv>\r\n</txpdiv>'}});
/*! Txplayer - v3.0.0 - 2018-11-23 12:20:35
 * Copyright (c) 2018
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(224)},95:function(a,b){a.exports='<txpdiv data-role="<%=poster%>" class="txp_poster"></txpdiv>'},224:function(a,b,c){function d(a){e=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=Txplayer.$,f=Txplayer.util,g=c(95);d.prototype={init:function(){this.dataset.showPoster=!0,this.context.config.poster===!1?this.dataset.showPoster=!1:"string"===e.type(this.context.config.poster)&&(this.context.dataset.poster=this.context.config.poster),this.write(),this.initDisplay(),this.addEventListerner(),this.exportsModuleApis()},initDisplay:function(){function a(){if(c.context.dataset.poster||(f.mobile?c.context.dataset.poster=f.getMobileVideoPosterByVid(b,0):c.context.dataset.poster=f.getPcVideoPosterByVid(b)),c.context.dataset.poster){var a={"background-image":"url("+c.context.dataset.poster+")","background-size":"cover"};c.dataset.$poster.css(a),c.show()}}if((!this.context.config.official||!this.context.dataset.autoplay&&!this.context.config.autoplay)&&this.dataset.showPoster){var b=this.context.dataset.vid||this.context.config.vid,c=this;b?a():this.context.msg.on("ready",function(){b=c.context.dataset.vid,a()})}},write:function(){var a={poster:"txp-ui-poster"};this.dataset.renderData=a;var b=e.tmpl(g,a);this.context.dataset.$playermod.append(b),this.dataset.$poster=this.context.dataset.$playermod.find('[data-role="'+a.poster+'"]')},remove:function(){this.dataset.$poster.remove&&this.dataset.$poster.remove()},setPoster:function(a){"string"===e.type(a)&&(this.context.dataset.poster=a,this.initDisplay())},getPoster:function(){return this.context.dataset.poster},hide:function(){this.dataset.$poster.addClass(Txplayer.dataset.hideClass)},show:function(){this.dataset.$poster.removeClass(Txplayer.dataset.hideClass)},addEventListerner:function(){var a=this,b=this.context.dataset.playState,c=this.context.dataset.isPlayingAd;(e.inArray(b,[0,1,3])>-1||c)&&this.hide(),this.dataset.eventsList={},this.dataset.eventsList[f.getUniqueMsgKey("videoPlaying")]=function(){a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("videoPlay")]=function(){f.mobile||a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("vidChange")]=function(){a.context.dataset.poster=null,a.initDisplay(),a.context.dataset.autoplay&&a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("playStateChange")]=function(b){b=b||{},0===b.state&&(f.mobile||(a.context.dataset.poster=null),a.initDisplay())},e.each(this.dataset.eventsList,function(b,c){a.context.msg.on(b,c)}),this.dataset.$poster.on("click",function(){a.context.dataset.$shadow.trigger("click")}).on("dblclick",function(){a.context.dataset.$shadow.trigger("dblclick")})},exportsModuleApis:function(){this.dataset.moduleApis={},this.dataset.moduleApis.getPoster=this.getPoster.bind(this),this.dataset.moduleApis.setPoster=this.setPoster.bind(this),e.extend(this.context.userApi,this.dataset.moduleApis)}},Txplayer.register("UiPoster",d)}});
/*! Txplayer - v3.0.0 - 2018-11-23 12:20:35
 * Copyright (c) 2018
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(265)},265:function(a,b){function c(a){d=Txplayer.$,this.dataset={},this.context=a,this.init()}var d=Txplayer.$,e=Txplayer.util;c.prototype={init:function(){this.addEventListener()},getDefaultParams:function(){this.dataset.format=this.context.dataset.currentDefinitionFormat||"",this.dataset.rate=this.context.dataset.currentDefinitionRate||"",this.dataset.cdnID=this.context.dataset.cdnID;var a=e.getLoginID(),b=this.context.dataset.txplayerAuth.raw(),c=this.context.dataset.platform,d={hc_main_login:b.main_login,hc_vuserid:b.vuserid,hc_openid:b.openid,hc_appid:b.appid,loginid:a.loginId,loginex:a.loginIdEx,logintype:a.logintype,guid:this.context.dataset.guid||"",longitude:"",latitude:"",vip:this.isVip(),online:navigator.onLine?1:0,p2p:this.context.dataset.useP2P?1:0,downloadkit:0,resolution:[screen.width,screen.height,window.devicePixelRatio||1].join("*"),testid:this.context.dataset.reportTestId||"",osver:[e.os.name,e.os.version].join(" "),playerver:"",playertype:1,uip:this.context.dataset.reportUsrIP||"",confid:"",cdnip:"",cdnid:this.dataset.cdnID||"",cdnuip:"",freetype:"",sstrength:"",network:"",speed:"",device:"",appver:Txplayer.dataset.ver,p2pver:"",url:location.href,refer:document.referrer,ua:e.getReportUA(),ptag:e.getPTAG(),flowid:this.context.dataset.flowid,platform:c||"",dltype:this.context.dataset.useHls?this.context.dataset.dltype||3:1,vid:this.context.dataset.vid||this.context.config.vid,fmt:this.dataset.format||"",rate:this.dataset.rate||"",clip:this.context.dataset.reportClip||"",status:this.context.dataset.reportStatus||"",type:this.context.dataset.reportType||"",duration:this.context.dataset.duration||"",ext:{dltype:this.context.dataset.useHls?this.context.dataset.dltype||3:1,m3u8:0}};if(this.context.dataset.getinfoJSON){d.ext.dltype=this.context.dataset.getinfoJSON.dltype;var f=this.context.dataset.getinfoJSON.vl;f&&f.vi&&f.vi[0]&&f.vi[0].ul&&f.vi[0].ul.m3u8&&(d.ext.m3u8=1)}return d.ext.dltype&&(d.ext=JSON.stringify(d.ext)),d},isVip:function(){var a="";return this.context&&this.context.config&&"function"===d.type(this.context.config.getUserType)&&(a=2==this.context.config.getUserType()?1:0),a},resetDataset:function(){this.dataset={},this.context.dataset.cdnID="",this.context.dataset.currentVideoUrl="",this.context.dataset.urlIndex=0},report:function(a,b){if(b=b||"4501",this.dataset.hasOwnProperty("sequence")||(this.dataset.sequence=-1),"4564"!=b&&++this.dataset.sequence,a.hasOwnProperty("seq")&&""!==a.seq||(a.seq=this.dataset.sequence||0),"4564"==b)for(var c in a)(70!=a.step&&d.inArray(c,["step","flowid","data"])==-1||70==a.step&&d.inArray(c,["step","flowid","data","ftime","vid","url","refer","loginid","logintype","ua"])==-1)&&delete a[c];var e=new Image,f="//btrace.video.qq.com/kvcollect?BossId=4501&Pwd=142347456&";"4564"==b&&(f="//btrace.video.qq.com/kvcollect?BossId=4564&Pwd=213967996&"),f+=d.param(a),e.src=f},step0:function(){var a={code:"",quic:this.context.dataset.isQuic||!1,stime:this.context.config.pageInitTime};a=d.extend(this.getDefaultParams(),{data:JSON.stringify(a)}),a.step=0,this.report(a)},step5:function(){var a=this.context.config.playerInitTime||this.context.dataset.playerCreateStartTime,b={quic:this.context.dataset.isQuic||!1,stime:a,etime:this.context.dataset.playerCreateEndTime,code:this.context.dataset.errorCodeOfStep5||""};b=d.extend(this.getDefaultParams(),{data:JSON.stringify(b)}),b.step=5,this.report(b)},step15:function(a){a=a||{};var b={ip:this.context.dataset.reportUsrIP,quic:this.context.dataset.isQuic||!1,stime:a.startTime,etime:a.endTime,code:""};"timeout"===a.err?b.code=Txplayer.v4errcode.getPlatformErrorCode("getinfo","neterror","03"):a.err&&!a.hasOwnProperty("code")?b.code=Txplayer.v4errcode.getPlatformErrorCode("getinfo","neterror","01"):a.err&&a.hasOwnProperty("code")&&(b.code=Txplayer.v4errcode.getPlatformErrorCode("getinfo","cgiInnerError",a.code+"")),b=d.extend(this.getDefaultParams(),{data:JSON.stringify(b)}),b.step=15,this.report(b)},step20:function(a){a=a||{};var b={ip:this.context.dataset.reportUsrIP,quic:this.context.dataset.isQuic||!1,stime:a.startTime,etime:a.endTime,code:a.errCode||""};b=d.extend(this.getDefaultParams(),{data:JSON.stringify(b)}),b.step=20,this.report(b)},step25:function(){if(this.dataset.adReportData&&this.dataset.adReportData.list&&0!=this.dataset.adReportData.list.length){var a=[],b=this;this.dataset.adReportData.list.forEach(function(c,d){c.playStartTime&&c.loadStartTime&&c.playStartTime-c.loadStartTime<=200&&(c.loadStartTime=c.loadCompleteTime=c.playStartTime),a.push({vid:c.vid||"",format:"",stime:c.loadStartTime||"",letime:c.loadCompleteTime||"",pstime:c.playStartTime||"",petime:c.playEndTime||"",playduration:c.playduration||0,duration:c.duration||0,quic:b.context.dataset.isQuic||!1,code:c.errorCode||""})});var c=d.extend(this.getDefaultParams(),{data:JSON.stringify(a)});c.step=25,this.report(c)}},step30:function(a){a=a||{};var b={stime:this.dataset.playTime||"",etime:this.dataset.playingTime||+new Date,p2p_ctime:this.context.dataset.connectionPlayTime,p2p_pretime:this.context.dataset.skipPrelude?this.context.dataset.playStartTime:0,bufferduration:"",vt:this.context.dataset.cdnID||"",url:a.url||this.context.dataset.currentVideoUrl||"",urlindex:this.context.dataset.urlIndex,quic:this.context.dataset.isQuic||!1,code:this.dataset.errorCodeOfStep30||""};this.dataset.hlsPlayTimeTheFirstTime&&(b.stime=this.dataset.hlsPlayTimeTheFirstTime),this.dataset.hlsFirstFragementLoadEndTime&&(this.context.dataset.hasLdAd&&(b.etime=this.dataset.hlsFirstFragementLoadEndTime),e.v4log("step30-首次加载视频耗时(m3u8开始到第一个ts30%下载完)",{stime:this.dataset.hlsPlayTimeTheFirstTime,etiem:this.dataset.hlsFirstFragementLoadEndTime,costtime:this.dataset.hlsFirstFragementLoadEndTime-this.dataset.hlsPlayTimeTheFirstTime})),e.v4log("step30-首次加载视频耗时(每隔100ms轮询video的buffer，等buffer时长大于3秒",{stime:this.dataset.hlsPlayTimeTheFirstTime,etiem:this.dataset.playingTime,costtime:this.dataset.playingTime-this.dataset.hlsPlayTimeTheFirstTime}),b=d.extend(this.getDefaultParams(),{data:JSON.stringify(b)}),b.step=30,this.report(b)},step31:function(){var a={type:this.context.dataset.useChromeHls?2:1,stime:this.dataset.switchDefnPlayTime,etime:this.dataset.switchDefnPlayingTime,bufferduration:"",url:"",urlindex:this.context.dataset.urlIndex,vt:this.context.dataset.cdnID,quic:this.context.dataset.isQuic||!1,code:this.dataset.errorCodeOfStep31||""};a=d.extend(this.getDefaultParams(),{data:JSON.stringify(a)}),a.step=31,this.report(a)},step35:function(){if(!(this.dataset.waitingStartTime&&this.dataset.waitingEndTime&&this.dataset.waitingEndTime-this.dataset.waitingStartTime<=200)&&!(this.dataset.waitingDuration<200)&&this.context.dataset.currentTime&&!(this.context.dataset.bfTimeStart4564&&this.context.dataset.bfTimeStart4564-this.context.dataset.currentTime>=5)){this.context.dataset.useChromeHls&&this.context.msg.broadcast("reportChromeHlsError",0);var a=this.context.dataset.currentVideoUrl,b={val:[{reason:"",scene:1!=this.context.dataset.playbackRate?2:1,format:this.context.dataset.currentDefinitionFormat||"",ptime:this.context.dataset.currentTime||"",stime:this.dataset.waitingStartTime||"",etime:this.dataset.waitingEndTime||"",code:this.dataset.errorCodeOfStep35||"",quic:this.context.dataset.isQuic||!1,url:a}],tcount:1,tduration:this.dataset.waitingDuration||""};e.v4log("缓冲策略-reportstep35",b),b=d.extend(this.getDefaultParams(),{data:JSON.stringify(b)}),b.step=35,this.report(b)}},step40:function(a){a=a||{};var b={tcount:1,tbcount:0,tbduration:this.dataset.seekWaitingDuration||0,quic:this.context.dataset.isQuic||!1,val:{format:this.context.dataset.currentDefinitionFormat,pstime:a.currentTimeWhenSeekStart||this.dataset.currentTimeWhenSeekStart||"",petime:a.currentTimeWhenSeekEnd||"",code:this.dataset.errorCodeOfStep40||""}};this.dataset.seekWaitingStartTime&&a.isSeekOfWaiting?(b.val.lstime=this.dataset.seekWaitingStartTime,b.val.letime=this.dataset.seekEndTime,b.tbcount=1):(b.val.lstime=0,b.val.letime=0,b.tbduration=0),b.val=[b.val],b=d.extend(this.getDefaultParams(),{data:JSON.stringify(b)}),b.step=40,this.report(b),delete this.dataset.seekWaitingDuration},step45:function(){var a={reason:"",auto:1,format:this.context.dataset.currentDefinitionFormat||"",pstime:this.dataset.switchDefnStartVideoTime||"",petime:this.dataset.switchDefnEndVideoTime||"",lstime:this.dataset.switchDefnPlayTime||"",letime:this.dataset.switchDefnPlayingTime||+new Date,url:this.context.dataset.currentVideoUrl||"",urlindex:this.context.dataset.urlIndex,vt:this.context.dataset.cdnID,quic:this.context.dataset.isQuic||!1,code:this.dataset.errorCodeOfStep45||""};a=d.extend(this.getDefaultParams(),{data:JSON.stringify(a)}),a.step=45,this.report(a)},step50:function(a){var b=a||this.getStep50Data();try{var c=JSON.parse(b.data);c.code&&c.code.indexOf("13083")>0?(this.report(b,"4564"),c.code="",b.data=JSON.stringify(c),this.report(b)):(b.data.quic=this.context.dataset.isQuic||!1,this.report(b))}catch(d){}this.handlerStep50Data("delete",b.vid)},getStep50Data:function(a){a=a||{};var b={reason:a.reason||0,etime:+new Date,playduration:this.dataset.userPlayedTime,quic:this.context.dataset.isQuic||!1,code:this.dataset.errorCodeOfStep50||""};return b=d.extend(this.getDefaultParams(),{data:JSON.stringify(b)}),b.step=50,b.seq=this.dataset.sequence?this.dataset.sequence+1:1,b},autoReportStep50:function(a){a=a||{},a.hasOwnProperty("limitTime")||(a.limitTime=!0);var b=this.handlerStep50Data("get");if("object"==d.type(b))for(var c in b)if("object"===d.type(b[c])&&(!a.prevVid||a.prevVid===c)){if(a.limitTime&&+new Date-b[c].updateTime<3e4)continue;delete b[c].updateTime,this.step50(b[c]),this.handlerStep50Data("delete",b[c].vid)}},autoSaveStep50Data:function(){var a=this.getStep50Data({reason:1});a&&a.vid&&(a.updateTime=+new Date,this.handlerStep50Data("save",this.context.dataset.vid,a))},handlerStep50Data:function(a,b,c){if("delete"!==a&&"save"!==a||b){var f,g,h,i=Txplayer.dataset.localStorageKey.userPlayedTime;f=e.getData(i),f||(f="{}");try{g=JSON.parse(f)}catch(j){h=!0}if(h||!g||"object"!=d.type(g))return void e.delData(i);if("delete"===a&&g[b])delete g[b],e.setData(i,JSON.stringify(g));else{if("get"===a)return b?g[b]:g;"save"===a&&c&&(g[b]=c,e.setData(i,JSON.stringify(g)))}}},deleteErrorCodes:function(){for(var a in this.dataset)a&&0==a.indexOf("errorCodeOfStep")&&delete this.dataset[a]},step36:function(a){a=a||{};var b={type:a.type,format:this.context.dataset.currentDefinitionFormat,tcount:a.retryTimes,ptime:this.context.dataset.currentTime,stime:this.dataset.playTime,etime:+new Date,url:a.url||"",code:a.code||"",appver:Txplayer.dataset.ver,guid:this.context.dataset.guid||""};this.dataset.hlsPlayTime&&(b.stime=this.dataset.hlsPlayTime),b=d.extend(this.getDefaultParams(),{data:JSON.stringify(b)}),b.step=36,this.report(b,"4564")},step15_4564:function(a){a=a||{};var b={stime:a.startTime,etime:a.endTime,code:a.errCode||"",ip:this.context.dataset.reportUsrIP||"",url:a.url||""};b=d.extend(this.getDefaultParams(),{data:JSON.stringify(b)}),b.step=15,this.report(b,"4564")},step20_4564:function(a){a=a||{};var b={stime:a.startTime,etime:a.endTime,code:a.errCode||"",ip:this.context.dataset.reportUsrIP||"",url:a.url||""};b=d.extend(this.getDefaultParams(),{data:JSON.stringify(b)}),b.step=20,this.report(b,"4564")},step35_4564:function(){if(!(this.dataset.waitingStartTime&&this.dataset.waitingEndTime&&this.dataset.waitingEndTime-this.dataset.waitingStartTime<=200)&&!(this.dataset.waitingDuration<200)&&this.context.dataset.currentTime){var a="1."+this.context.dataset.videoWaitingReason,b={reason:a||"",appver:Txplayer.dataset.ver,stime:this.dataset.waitingStartTime||"",etime:this.dataset.waitingEndTime||"",ptime:this.context.dataset.currentTime||"",btime:this.context.dataset.bfTimeStart4564||"",betime:this.context.dataset.bfTimeEnd4564||"",duration:this.dataset.waitingDuration||"",code:this.dataset.errorCodeOfStep35||"",ip:this.context.dataset.reportUsrIP||"",url:this.context.dataset.currentVideoUrl||"",format:this.context.dataset.currentDefinitionFormat||"",scene:this.context.dataset.playbackRate||"",dltype:this.context.dataset.useHls?this.context.dataset.dltype||3:1};b=d.extend(this.getDefaultParams(),{data:JSON.stringify(b)}),b.step=35,this.context.dataset.bfTimeStart4564=0,this.context.dataset.bfTimeEnd4564=0,this.context.dataset.videoWaitingReason="",this.report(b,"4564")}},addEventListener:function(){var a=this,b=0;this.autoReportStep50(),this.context.msg.on("beforeVideoPlay",function(){a.dataset.hlsPlayTimeTheFirstTime=null,a.dataset.hlsPlayTime=null,a.dataset.hasReportAd=!1,a.dataset.hlsFirstFragementLoadStartTime=null,a.dataset.hlsFirstFragementLoadEndTime=null}),this.context.msg.on("getVideoUrlSuccess",function(){delete a.dataset.switchDefnPlayingTime,delete a.dataset.switchDefnPlayTime}),this.context.config.pageInitTime&&this.step0(),this.context.dataset.isReady?a.step5():this.context.msg.on("ready",function(){a.step5()}),this.context.msg.on("getinfoFinish",function(b){a.step15_4564({startTime:b.startTime,endTime:b.endTime,url:b.getinfoURL,errCode:b.errCode||""}),b&&b.err&&!b.isLastRetry||a.step15(b)}),this.context.msg.on("getkeyFinish",function(b){a.step20_4564({startTime:b.startTime,endTime:b.endTime,url:b.getkeyURL,errCode:b.errCode||""}),b&&b.err&&!b.isLastRetry&&!b.em||a.step20(b)}),this.context.msg.on("videoPlaying",function(b){if(b=b||{},"film"===b.playListType){if(a.dataset.hasReportAd)return;a.dataset.adReportData=a.context.adApi&&a.context.adApi.getAdReportData(),a.step25(),a.dataset.hasReportAd=!0,a.context.msg.broadcast("setChromeHlsData",{k:"onplay",v:""})}}),this.context.msg.on("videoPlay.h5report-step30",function(b){"film"===b.playListType&&(a.dataset.playTime||(a.dataset.playTime=+new Date,e.v4log("videoPlay.h5report-step30",{playTime:a.dataset.playTime})),a.dataset.currentVideoIndex=b.index)}),this.context.msg.on("setPreloadVideoUrlReport.h5report-step30",function(){a.dataset.playTime||(a.dataset.playTime=+new Date,e.v4log("setPreloadVideoUrlReport.h5report-step30",{playTime:a.dataset.playTime}))}),this.context.msg.on("hlsStartPlay.h5report-step30",function(b){a.dataset.hlsPlayTimeTheFirstTime||(a.dataset.hlsPlayTimeTheFirstTime=+new Date),b.forceUpdate&&(a.dataset.hlsPlayTimeTheFirstTime=b.stime),e.v4log("hlsStartPlay",{hlsPlayTime:a.dataset.hlsPlayTimeTheFirstTime}),a.dataset.hlsPlayTime=+new Date}),this.context.msg.on("hlsFirstFragementLoadFinish",function(b){a.dataset.hlsFirstFragementLoadEndTime||(e.v4log("step30-加载完第一帧画面",{time:b.time,loaded:b.loaded}),a.dataset.hlsFirstFragementLoadEndTime=b.time)}),this.context.msg.on("loadEnoughBuffer.h5report-step30",function(b){var c=a.dataset.hasOwnProperty("playingTime");e.v4log("april-loadEnoughBuffer",+new Date),a.dataset.playingTime=+new Date,e.v4log("loadEnoughBuffer",{playingTime:a.dataset.playingTime}),e.v4log("step30-loadEnoughBuffer: ",{time:a.dataset.playingTime}),a.deleteErrorCodes(),c||a.step30({url:b.src})}),this.context.msg.on("videoCanplay.h5report-step30",function(c){if(e.v4log("april-videoCanplay",+new Date),b=0,"film"===c.playListType&&!a.context.dataset.useHls){var d=a.dataset.hasOwnProperty("playingTime");a.dataset.playingTime=+new Date,a.deleteErrorCodes(),d||(e.v4log("MP4videoCanplay",{playingTime:a.dataset.playingTime}),a.step30({url:c.src}))}}),this.context.msg.on("setDefinitionStart",function(b){a.dataset.switchDefnStartVideoTime=a.context.dataset.currentTime;var c=function(){a.context.msg.off("videoPlay.h5report-step31"),a.context.msg.off("videoPlaying.h5report-step31"),a.context.msg.off("reportVideoError.h5report-step31")};a.context.msg.once("videoPlay.h5report-step31",function(b){a.dataset.switchDefnPlayTime=+new Date}),a.context.msg.once("videoPlaying.h5report-step31",function(b){a.dataset.switchDefnHasReported=a.dataset.hasOwnProperty("switchDefnPlayingTime"),a.dataset.switchDefnPlayingTime=+new Date,a.dataset.currentVideoIndex=b.index,c()})}),this.context.msg.on("setDefinitionDone",function(b){b&&b.hasOwnProperty("hlsDefinitionEndTime")&&(a.dataset.switchDefnPlayTime=a.dataset.switchDefnPlayingTime=b.hlsDefinitionEndTime),a.dataset.switchDefnEndVideoTime=a.context.dataset.currentTime,a.step45(),a.dataset.switchDefnHasReported||a.step31()}),this.context.msg.on("setDefinitionFail",function(b){a.dataset.switchDefnEndVideoTime=a.context.dataset.currentTime,b.errCode&&(a.dataset.errorCodeOfStep45=b.errCode,a.step45(),delete a.dataset.errorCodeOfStep45)});var c=function(){a.dataset.hasOwnProperty("waitingTimes")||(a.dataset.waitingTimes=0),a.dataset.waitingTimes++},f=function(){var b=a.dataset.waitingEndTime-a.dataset.waitingStartTime;b>3e4&&(b=3e4),"number"!==d.type(a.dataset.waitingDuration)&&(a.dataset.waitingDuration=0),a.dataset.waitingDuration=b},g=function(b){e.v4log("缓冲控制-step35更新缓冲开始时间",{waitingTimes:a.dataset.waitingTimes}),a.dataset.waitingTimes>20||(a.dataset.waitingStartTime=+new Date,c(),a.context.dataset.loadEnoughBuffer||(a.context.msg.off("videoPlaying.h5report-step35"),a.context.msg.once("videoPlaying.h5report-step35",function(){a.dataset.waitingEndTime=+new Date,f(),delete a.dataset.errorCodeOfStep35,a.step35(),a.context.dataset.videoWaitingReason=8,a.step35_4564()})))};this.context.msg.on("videoWaiting",function(b){e.v4log("videoWaiting",{isVideoSeeking:a.context.dataset.isVideoSeeking}),b&&!b.seeking&&"film"===b.playListType&&a.dataset.hasOwnProperty("playingTime")&&(a.context.dataset.isVideoSeeking||a.context.dataset.isDefinitionSwitching||g(b))}),this.context.msg.on("networkBadStart",function(b){"film"===b.playListType&&(b.isOnWaiting||a.context.dataset.isVideoSeeking||a.context.dataset.isDefinitionSwitching||a.dataset.hasOwnProperty("playingTime")&&g(b))}),this.context.msg.on("minbufferControlEnd",function(b){a.context.dataset.loadEnoughBuffer&&(a.dataset.hasOwnProperty("waitingTimes")&&a.dataset.waitingTimes>20||a.dataset.hasOwnProperty("waitingStartTime")&&(a.dataset.waitingEndTime=+new Date,f(),delete a.dataset.errorCodeOfStep35,a.step35(),a.step35_4564()))});var h=function(){return a.dataset.userSeekTimes>32||(a.dataset.hasOwnProperty("userSeekTimes")||(a.dataset.userSeekTimes=1),!1)};this.context.msg.on("seekStart",function(b){b&&b.isUserAction===!1||h()||(b.currentTimeWhenSeekStart&&(a.dataset.currentTimeWhenSeekStart=b.currentTimeWhenSeekStart),a.dataset.seekStartTime=+new Date,"number"!==d.type(a.dataset.seekTimes)&&(a.dataset.seekTimes=0),a.dataset.seekTimes+=1,a.context.msg.off("videoWaiting.h5report-step40"),a.context.msg.off("reportVideoError.h5report-step40"),a.context.msg.once("videoPlaying.h5report-step40",function(b){b&&b.seeking&&"film"===b.playListType&&(a.context.msg.off("videoWaiting.h5report-step40"),a.context.msg.off("reportVideoError.h5report-step40"))}))}),this.context.msg.on("seekEnd",function(b){if((!b||b.isUserAction!==!1)&&!h()&&(a.dataset.seekEndTime=+new Date,a.context.msg.off("videoWaiting.h5report-step40"),a.context.msg.off("reportVideoError.h5report-step40"),b&&b.seekStartTime&&b.seekEndTime)){var c=b.seekEndTime-b.seekStartTime,d=c>200;d&&(a.dataset.seekWaitingDuration=c,a.dataset.seekWaitingStartTime=b.seekStartTime),delete a.dataset.errorCodeOfStep40,a.step40({currentTimeWhenSeekStart:b.currentTimeWhenSeekStart,currentTimeWhenSeekEnd:b.currentTimeWhenSeekEnd,isSeekOfWaiting:d}),delete a.dataset.seekWaitingStartTime,a.dataset.userSeekTimes+=1}}),this.context.msg.on("videoTimeUpdate",function(b){return b&&"film"===b.playListType?("number"!=typeof a.dataset.userPlayedTime&&(a.dataset.userPlayedTime=0),a.dataset.userPlayedTime++,void a.autoSaveStep50Data()):void a.autoSaveStep50Data()}),this.context.msg.on("videoEnd.h5report-step50",function(b){b&&"film"===b.playListType&&b.isTheLastFilm&&(e.v4log("videoEnd-step50"),a.step50(),delete a.dataset.userPlayedTime)}),this.context.msg.on("error.h5report-step50",function(b){b&&"film"!==b.type&&"cgi"!==b.type||(b&&b.errCode&&(a.dataset.errorCodeOfStep50=b.errCode,a.dataset.hasOwnProperty("playingTime")||(a.dataset.errorCodeOfStep30=b.errCode)),!a.dataset.hasOwnProperty("playingTime")&&a.dataset.errorCodeOfStep30?(a.step30(),delete a.dataset.errorCodeOfStep30):a.dataset.hasOwnProperty("playingTime")&&(a.dataset.errorCodeOfStep31?(a.step31(),a.dataset.errorCodeOfStep45=a.dataset.errorCodeOfStep31,a.step45(),delete a.dataset.errorCodeOfStep45,delete a.dataset.errorCodeOfStep31):a.dataset.errorCodeOfStep40?(a.step40(),delete a.dataset.errorCodeOfStep40):a.dataset.errorCodeOfStep35&&(a.step35(),a.step35_4564(),delete a.dataset.errorCodeOfStep35)),a.dataset.step50_TIMER&&(clearTimeout(a.dataset.step50_TIMER),a.dataset.step50_TIMER=null),a.dataset.step50_TIMER=setTimeout(function(){a.step50(),delete a.dataset.errorCodeOfStep50},50))}),this.context.msg.on("vidChange",function(c,d){e.v4log("vidChange-autoReportStep50"),a.autoReportStep50({limitTime:!1,prevVid:d}),b=0,a.resetDataset()}),this.context.msg.on("bulletNumShow",function(){var b=a.context.msg.listeners("playStateChange.float").length,c="";d("script").each(function(a,b){b.src&&b.src.indexOf("vplay")!=-1&&(c=b.src)});var e={open:1,event:b,type:3,"switch":a.context.dataset.flashBulletSwitchStatus?1:0,state:a.context.dataset.playState>0?a.context.dataset.playState:100,vplaysrc:c};e=d.extend(a.getDefaultParams(),{data:JSON.stringify(e)}),e.step=70,a.report(e,"4564")}),this.context.msg.on("reportVideoError",function(c){if(c=c||{},"film"===c.type){var d;a.dataset.hasOwnProperty("playingTime")?a.context.dataset.isDefinitionSwitching?(d=3,a.dataset.errorCodeOfStep31=c.code):a.context.dataset.isVideoSeeking?(d=2,a.dataset.errorCodeOfStep40=c.code):(d=1,a.dataset.errorCodeOfStep35=c.code):(d=0,a.dataset.errorCodeOfStep30=c.code),c.url&&c.url.indexOf&&c.url.indexOf("blob:")>-1&&(c.url=a.context.dataset.currentVideoUrl),a.step36({type:d,code:c.code,url:c.url,retryTimes:b++})}})}},Txplayer.register("v4H5Report",c)}});
/*! Txplayer - v3.0.0 - 2018-11-23 12:20:35
 * Copyright (c) 2018
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(304)},78:function(a,b){var c={unstarted:-1,ended:0,playing:1,paused:2,buffering:3,cued:4,stop:5},d={msd:"流畅180P",sd:"标清270P",hd:"高清480P",shd:"超清720P",fhd:"蓝光1080P"};a.exports={playerstate:c,definitionMap:d}},304:function(a,b,c){function d(a){e=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=Txplayer.$,f=Txplayer.util;c(78).definitionMap;d.prototype={init:function(){this.dataset.dataKey=Txplayer.dataset.localStorageKey.playTime,this.dataset.videoPlayedIndex=-1,this.addEventListener(),this.exportsModuleApis()},resetDataset:function(){if(this.dataset.isGetinfoDone){var a=["videoPlayedIndex","isGetinfoDone","dataKey","prevDefinition","setDefinitionStartTime","hasReportLoadingadLoadTime","filmFirstPlayingTime"];for(var b in this.dataset)e.inArray(b,a)>-1||("realPlayTime_TIMER"!==b&&"totalPlayTime_TIMER"!==b||clearInterval(this.dataset[b]),delete this.dataset[b])}},resetDatasetOnVidChange:function(){var a=["hasGetVplayPageRecoReport","isGetinfoDone","setDefinitionStartTime","hasReportLoadingadLoadTime","filmFirstPlayingTime","timeupdateCounter"],b=this;e.each(a,function(a,c){delete b.dataset[c]}),"coolOpen"===this.context.config.playerType&&(Txplayer.dataset.vplayPageRecoReport=null)},getVplayPageRecoReport:function(){try{var a=sessionStorage.getItem("report_recomm_player");a?Txplayer.dataset.vplayPageRecoReport=a:"coolOpen"===this.context.config.playerType&&(Txplayer.dataset.vplayPageRecoReport=a),sessionStorage.removeItem("report_recomm_player")}catch(b){}},getDefaultReportData:function(){var a=this;!this.dataset.hasGetVplayPageRecoReport&&this.context.config.reportRecomm&&(this.dataset.hasGetVplayPageRecoReport=!0,"coolOpen"===this.context.config.playerType?setTimeout(function(){a.getVplayPageRecoReport()}):this.getVplayPageRecoReport());var b=this.context.dataset.txplayerAuth.raw(),c={uin:Txplayer.util.getQQFromCookie(),vid:this.context.dataset.vid||"",coverid:this.context.dataset.cid||"",pid:this.context.dataset.playerId||"",guid:this.context.dataset.guid||"",cmid:this.context.dataset.guid||"",unid:this.context.dataset.unid||"",vt:this.getCDNChannelId(),type:this.getBusinessType(),url:document.URL,bi:this.getCurrentVideoDuration(),bt:this.context.dataset.duration||"",version:Txplayer.dataset.ver||"",platform:this.context.dataset.platform,format:this.context.dataset.currentDefinitionFormat||"",defn:this.context.dataset.definition||"",ctime:f.dateFormat(),ptag:f.getPTAG(),isvip:-1,tpid:this.context.dataset.tpid||"",pversion:this.context.config.playerType,hc_uin:Txplayer.util.getQQFromCookie(),hc_main_login:b.main_login,hc_vuserid:b.vuserid,hc_openid:b.openid,hc_appid:b.appid,hc_pvid:Txplayer.util.cookie.get("pgv_pvid"),hc_ssid:Txplayer.util.cookie.get("psessionid"),hc_qq:Txplayer.util.getQQFromCookie(),ua:f.getReportUA(),hh_ua:f.getReportUA(),ckey:this.context.dataset.ckey||"",iformat:this.context.dataset.currentDefinitionFormat||"",hh_ref:f.getTopFrameUrl(),vurl:this.context.dataset.currentVideoUrl||"",v_idx:this.dataset.videoPlayedIndex||0,rcd_info:Txplayer.dataset.vplayPageRecoReport||"",extrainfo:this.context.config.extrainfo||""};return this.context&&this.context.config&&"function"===e.type(this.context.config.getUserType)&&(c.isvip=2==this.context.config.getUserType()?1:0),c},reportStep3:function(a){var b={step:3,val:0===this.context.dataset.connectionPlayType?1:2,idx:this.context.dataset.connectionPlayType,c_info:this.context.config.getOuterReportData(),pcplatform:f.getPcPlatform()},c={width:this.context.dataset.playerWidth,height:this.context.dataset.playerHeight};c&&c.width&&c.height&&(b.diagonal=parseInt(Math.sqrt(Math.pow(c.width,2)+Math.pow(c.height,2)))),b.isfocustab=this.context.dataset.isWindowFocus,b.isvisible=this.context.msg.getData("isPlayerInScreen"),b.isfocustab=b.isfocustab?1:0,b.isvisible=b.isvisible?1:0,this.doBossReport(b)},reportStep4:function(){var a={step:4,val:this.context.dataset.playList.length,val1:1,bi:this.context.dataset.hasOwnProperty("isPlayingAd")?2:1,idx:this.context.dataset.connectionPlayType,c_info:this.context.config.getOuterReportData(),pcplatform:f.getPcPlatform()},b={width:this.context.dataset.playerWidth,height:this.context.dataset.playerHeight};b&&b.width&&b.height&&(a.diagonal=parseInt(Math.sqrt(Math.pow(b.width,2)+Math.pow(b.height,2)))),a.isfocustab=this.context.dataset.isWindowFocus,a.isvisible=this.context.msg.getData("isPlayerInScreen"),a.isfocustab=a.isfocustab?1:0,a.isvisible=a.isvisible?1:0,a.reportFrom=this.context.config.reportFrom,this.doBossReport(a)},reportStep5:function(a){a=a||{};var b;a.isEnd?b={step:5,val:1e3*a.realtime,val1:a.isEnd?1:2,bi:a.totaltime}:(b=a,b.val1=a.isEnd?1:2,b.val=1e3*a.realtime,b.bi=a.totaltime,b.step=5,delete b.isEnd,delete b.realtime,delete b.totaltime),b.idx=this.context.dataset.connectionPlayType;var c={width:this.context.dataset.playerWidth,height:this.context.dataset.playerHeight};c&&c.width&&c.height&&(b.diagonal=parseInt(Math.sqrt(Math.pow(c.width,2)+Math.pow(c.height,2)))),a.vid&&(b.vid=a.vid),b.isfocustab=this.context.dataset.isWindowFocus,b.isvisible=this.context.msg.getData("isPlayerInScreen"),b.isfocustab=b.isfocustab?1:0,b.isvisible=b.isvisible?1:0,b.c_info=this.context.config.getOuterReportData(),b.pcplatform=f.getPcPlatform(),this.doBossReport(b)},reportStep6:function(a){var b={step:6,val:a.firstLoadTime,val1:this.getReport6Status(),val2:1,idx:this.context.dataset.connectionPlayType,bi:"",bt:"",c_info:this.context.config.getOuterReportData(),pcplatform:f.getPcPlatform()},c={width:this.context.dataset.playerWidth,height:this.context.dataset.playerHeight};if(c&&c.width&&c.height&&(b.diagonal=parseInt(Math.sqrt(Math.pow(c.width,2)+Math.pow(c.height,2)))),b.isfocustab=this.context.dataset.isWindowFocus,b.isvisible=this.context.msg.getData("isPlayerInScreen"),b.isfocustab=b.isfocustab?1:0,b.isvisible=b.isvisible?1:0,this.dataset.adReportData&&this.dataset.adReportData.list.length>0&&this.dataset.adReportData.loadingAdEndTime&&this.dataset.adReportData.loadingadProgressedTime){var d=this.dataset.adReportData.list[0].playEndTime,e=this.dataset.adReportData.list[0].loadCompleteTime;d&&e&&(b.bi=d-e)}this.doBossReport(b)},reportStep7:function(a){var b={step:7,val:0,val1:0,idx:this.context.dataset.connectionPlayType,c_info:this.context.config.getOuterReportData(),pcplatform:f.getPcPlatform()};this.doBossReport(b)},reportStep70:function(a){var b={step:70,val:a};this.doBossReport(b)},reportStep30:function(a){var b={step:30,val:a.loadTime,val1:a.hasOwnProperty("val1")?a.val1:0,val2:2,bi:this.context.dataset.videoDuration};this.context.dataset.useHls?b.val2=3:"html5hd"===this.context.config.playerType?b.val2=1:"ipadh5"!==this.context.config.playerType&&"h5"!==this.context.config.playerType||(b.val2=2),this.doBossReport(b)},reportStep50:function(a){var b={step:50,val:a.loadTime||"",val1:a.hasOwnProperty("val1")?a.val1:0,val2:1,bi:this.context.dataset.videoDuration};this.context.dataset.useHls?b.val2=3:"html5hd"===this.context.config.playerType?b.val2=1:"ipadhtml5"!==this.context.config.playerType&&"h5"!==this.context.config.playerType||(b.val2=2),this.doBossReport(b)},reportStep60:function(a){var b={step:60,val:a.seekCostTime,val1:a.hasOwnProperty("val1")?a.val1:0,val2:1,bi:this.context.dataset.videoDuration};this.context.dataset.useHls?b.val2=3:"html5hd"===this.context.config.playerType?b.val2=1:"ipadh5"!==this.context.config.playerType&&"h5"!==this.context.config.playerType||(b.val2=2),this.doBossReport(b)},reportStep31_51:function(a){if(a.hasOwnProperty("waitingTime")){var b=a.waitingTime>1e4;a.waitingTime=b?1e4:a.waitingTime;var c={step:a.step,val:a.waitingTime,val1:b,val2:1,bi:this.context.dataset.videoDuration||this.context.dataset.duration,bt:this.context.dataset.duration};this.context.dataset.useHls?c.val2=3:"html5hd"===this.context.config.playerType?c.val2=1:"ipadh5"!==this.context.config.playerType&&"h5"!==this.context.config.playerType||(c.val2=2),this.doBossReport(c)}},reportStep35:function(a){a=a||{};var b;this.dataset.loadingadEndTime=this.dataset.adReportData.loadingAdEndTime,this.context.dataset.adDuration=this.dataset.adReportData.adDuration,"number"!==e.type(this.dataset.filmFirstPlayingTime)||"number"!==e.type(this.dataset.loadingadEndTime)&&"number"!==e.type(this.dataset.filmFirstPlayTime)||(b=this.dataset.filmFirstPlayingTime-(this.dataset.loadingadEndTime||this.dataset.filmFirstPlayTime)),Txplayer.util.v4log("4298-Step35-loading广告切正片耗时",{swtichTime:b,filmFirstPlayingTime:this.dataset.filmFirstPlayingTime,filmFirstPlayTime:this.dataset.filmFirstPlayTime,loadingadEndTime:this.dataset.loadingadEndTime});var c={step:35,val:a.swtichTime||b,val1:"",val2:this.context.dataset.adDuration||0,bi:this.context.dataset.videoDuration};"number"===e.type(this.context.dataset.preloadStartTime)&&"number"===e.type(this.dataset.loadingadEndTime)&&(c.val1=this.dataset.loadingadEndTime-this.context.dataset.preloadStartTime),this.doBossReport(c)},reportStep55:function(a){var b={step:55,val:a.swtichTime,val1:"",val2:a.prevFilmDuration,bi:this.context.dataset.videoDuration};this.doBossReport(b)},reportStep100:function(a){var b={step:100,val:a.costTime,val1:a.val1,val2:1,bi:this.context.dataset.videoDuration,predefn:a.predefn};this.context.dataset.useHls?b.val2=3:"html5hd"===this.context.config.playerType?b.val2=1:"ipadh5"!==this.context.config.playerType&&"h5"!==this.context.config.playerType||(b.val2=2),this.doBossReport(b)},reportStep1011:function(a){var b={step:"1011",val1:0,val2:0,vt:0};b.val=a.costTime,a.err?a.code?(b.val1=3,b.val2=a.code):(b.val1=2,b.val2=444):b.val1=1,this.doBossReport(b)},reportStep1003:function(a){var b={step:"1003",val1:0,val2:0,vt:0};b.val=a.costTime,a.err?a.code?(b.val1=3,b.val2=a.code):a.code||!a.filename||a.key?(b.val1=2,b.val2=445):(b.val1=4,b.val2=445):b.val1=1,this.doBossReport(b)},getCDNChannelId:function(){var a=this.context.dataset.filmVideoData,b=this.context.dataset.playListIndex;return a&&a[b]?a[b].vt:""},getCurrentVideoDuration:function(){var a=this.context.dataset.filmVideoData,b=this.context.dataset.playListIndex;return a&&a[b]?a[b].duration:""},getBusinessType:function(){var a=this.context.dataset.getinfoJSON;return a&&a.vl&&a.vl.vi&&a.vl.vi[0]&&"object"===e.type(a.vl.vi[0])&&a.vl.vi[0].hasOwnProperty("type")?a.vl.vi[0].type:""},doBossReport:function(a){var b,c,d={};if(d=e.extend(this.getDefaultReportData(),a),d&&d.bi&&(d.bi=parseInt(d.bi)),d&&d.bt&&(d.bt=parseInt(d.bt)),"html5hd"!==this.context.config.playerType&&f.mobile?"ipadh5"===this.context.config.playerType||f.os.ipad?(b="4299",c="694498052"):"h5"===this.context.config.playerType||f.os.android||f.os.ios?(b="2865",c="1698957057"):(b="2865",c="1698957057"):(b="4298",c="686148428"),"4298"===b&&(d.cpay=this.context.dataset.isNeedPay?1:0,d.tpay=this.context.dataset.userPayStatus||0,d.dltype=this.context.dataset.useHls?this.context.dataset.dltype||3:1,this.context.config.clientReportInfo)){var g=this.context.config.clientReportInfo;for(var h in g)g.hasOwnProperty(h)&&"undefined"!=typeof g[h]&&(d["clt_"+h]=g[h]||"")}var i="//btrace.video.qq.com/kvcollect?BossId={bossid}&Pwd={pwd}".replace("{bossid}",b).replace("{pwd}",c);i+="&"+e.param(d),f.report(i)},playTimeHeartBeatStart:function(){var a=this;this.dataset.realPlayTime_TIMER||(this.dataset.realPlayTime_TIMER=setInterval(function(){a.dataset.realPlayTime||(a.dataset.realPlayTime=0),a.dataset.realPlayTime+=5,a.saveData()},5e3)),this.dataset.totalPlayTime_TIMER||(this.dataset.totalPlayTime_TIMER=setInterval(function(){a.dataset.totalPlayTime||(a.dataset.totalPlayTime=0),a.dataset.totalPlayTime+=5,a.context.dataset.userTotalPlayedTime=a.dataset.totalPlayTime},5e3))},playTimeHeartBeatStop:function(a){clearInterval(this.dataset.totalPlayTime_TIMER),delete this.dataset.totalPlayTime_TIMER,a&&(clearInterval(this.dataset.realPlayTime_TIMER),delete this.dataset.realPlayTime_TIMER)},saveData:function(){var a,b=f.getData(this.dataset.dataKey),c=this.context.dataset.vid;if(b)try{a=JSON.parse(b)}catch(d){a={}}else a={};return c?(a[c]={lastupdate:+new Date,realtime:this.dataset.realPlayTime,totaltime:this.dataset.totalPlayTime},a[c]=e.extend(this.getDefaultReportData(),a[c]),void f.setData(this.dataset.dataKey,JSON.stringify(a))):void f.showError("saveData Error","找不到vid")},getData:function(){var a,b=f.getData(this.dataset.dataKey),c=this.context.dataset.vid;if(b)try{a=JSON.parse(b)}catch(d){a={}}else a={};return c?a[c]:void f.showError("getData Error","找不到vid")},clearData:function(a){var b,c=f.getData(this.dataset.dataKey);if(a=a||this.context.dataset.vid,c)try{b=JSON.parse(c)}catch(d){b={}}else b={};return a?(b[a]&&delete b[a],void f.setData(this.dataset.dataKey,JSON.stringify(b))):void f.showError("clearData Error","找不到vid")},reportPlayTimeWhenPageInit:function(){var a,b=f.getData(this.dataset.dataKey),c=this,d=function(a,b){if(a){var d=parseInt(+new Date/1e3),e=parseInt(parseInt(a.lastupdate)/1e3);d-e<=180||(a.isEnd=!1,c.reportStep5(a),c.clearData(b))}};try{a=JSON.parse(b)}catch(e){a={}}for(var g in a)d(a[g],g)},reportPlayTimeOnEnded:function(){var a,b=f.getData(this.dataset.dataKey),c=this,d=this.context.dataset.vid,e=function(a,b){a=a&&a[b]?a[b]:null,a&&(a.isEnd=!0,c.reportStep5(a),c.clearData(b))};try{a=JSON.parse(b)}catch(g){a={}}e(a,d)},reportPlayTimeOnBeforeVideoPlay:function(a){if(a){var b,c=f.getData(this.dataset.dataKey),d=this,e=a,g=function(a,b){a=a&&a[b]?a[b]:null,a&&(a.isEnd=!0,a.vid=b,d.reportStep5(a),d.clearData(b))};try{b=JSON.parse(c)}catch(h){b={}}g(b,e)}},getVideoAreaLevel:function(){var a=this.context.dataset.getinfoJSON;return a&&a.vl&&a.vl.vi&&a.vl.vi.length&&a.vl.vi[0]?a.vl.vi[0].level:""},reportLoginUserPlayTime:function(a){if(a=a||!1,"v.qq.com"===location.hostname||"film.qq.com"===location.hostname){var b;if(this.context.config&&"function"===e.type(this.context.config.getUserType))try{b=this.context.config.getUserType()}catch(c){}"number"!==e.type(b)||b<=0||this.context.msg.broadcast("reportLoginUserPlayTime",{isend:a})}},getReport6Status:function(){return this.context.dataset.isLoadingAdEmpty||this.context.dataset.noHdAdPlugin?1:this.dataset.isFilmBuffered?2:3},reportPlayView:function(){var a="";if(f.inWhichDomain("qzone")&&(a=f.inNewIframe()?f.removeUrlParams(document.referrer):f.removeUrlParams(location.href)),(f.os.mac||f.os.windows)&&(f.isInIframe()||!f.isInIframe()&&"v.qq.com"!==location.hostname)){var b={lv_irt_id:f.cookie.get("uuid")||"",dm:"v.qq.com",ua:navigator.userAgent,r:+new Date,vid:this.context.dataset.vid,sr:screen.width+"x"+screen.height,ul:navigator.language||navigator.browserLanguage||"",tv:"0.0.7",pt:this.context.dataset.title||"腾讯视频",guid:this.context.dataset.guid||"",url:"https://v.qq.com/x/page/"+this.context.dataset.vid+".html",from:f.inNewIframe()?f.removeUrlParams(document.referrer):"https://v.qq.com/x/page/"+this.context.dataset.vid+".html",playing_url:a},c=new Image;c.src="//tj.video.qq.com/fcgi-bin/set_cookie?"+e.param(b)}},reportIrs:function(){var a=this.context.config.playerType||"";if(a=a.toLowerCase(),f.inArray(["h5","h5tiny"],a)===-1&&("v.qq.com"===location.hostname||"film.qq.com"===location.hostname)){var b=new Image(1,1);this.context.dataset.vid&&(b.src="//v12-"+this.context.dataset.vid.toLowerCase()+".z.irs01.com?p=v12&ts="+ +new Date)}},addEventListener:function(){var a=this;this.addAdReport(),this.context.msg.on("beforeVideoPlay",function(b,c){b=b||{},a.dataset.videoPlayedIndex++,a.reportStep3(b.isNewPlay),a.reportIrs(),a.reportPlayView(),a.reportPlayTimeOnBeforeVideoPlay(c)}),this.context.msg.on("vidChange",function(b,c){a.resetDataset()}),this.context.msg.on("getVideoUrlSuccess",function(b,c){a.resetDataset(),setTimeout(function(){a.reportStep4(),a.dataset.isGetinfoDone=!0,a.context.dataset.reportVideoLevel=a.getVideoAreaLevel(),a.context.dataset.reportCDNChannelId=a.getCDNChannelId(),a.context.dataset.reportBusinessType=a.getBusinessType()},0)}),this.context.msg.on("vidChange",function(){a.resetDatasetOnVidChange()}),this.context.msg.on("videoPause",function(){a.context.dataset.isPlayingAd||a.playTimeHeartBeatStop()}),this.context.msg.on("videoPlay",function(b){"film"!==b.playListType||0!==b.index||a.dataset.filmFirstPlayTime||(a.dataset.filmFirstPlayTime=+new Date),"film"===b.playListType&&b.index>0&&(a.dataset.filmPlayTime||(a.dataset.filmPlayTime={}),a.dataset.filmPlayTime[b.index]||(a.dataset.filmPlayTime[b.index]=+new Date))}),this.context.msg.on("videoPlaying",function(b){b&&"film"===b.playListType&&(a.dataset.filmFirstPlayingTime||(a.dataset.filmFirstPlayingTime=+new Date,a.dataset.adReportData=a.getAdReportData(),a.reportStep6({firstLoadTime:a.dataset.filmFirstPlayingTime-a.dataset.filmFirstPlayTime}),a.reportStep35())),b&&"film"===b.playListType&&a.playTimeHeartBeatStart(),b&&"film"===b.playListType&&0===b.index&&!a.dataset.filmPlayingTime&&a.dataset.filmFirstPlayTime&&(a.dataset.filmPlayingTime=+new Date,a.reportStep30({loadTime:a.dataset.filmPlayingTime-(a.dataset.preloadStartTime||a.dataset.filmFirstPlayTime)})),b&&"film"===b.playListType&&b.index>0&&a.dataset.filmPlayTime&&(a.dataset.filmPlayingTime||(a.dataset.filmPlayingTime={}),a.dataset.filmPlayingTime[b.index]||(a.dataset.filmPlayingTime[b.index]=+new Date,a.reportStep50({loadTime:a.dataset.filmPlayingTime[b.index]-a.dataset.filmPlayTime[b.index]})))}),this.context.msg.on("videoWaiting",function(b){if(!a.context.dataset.isPlayingAd&&!("film"!==b.playListType||b&&b.videoTag&&0===b.videoTag.buffered.length)){var c=a.context.dataset.isVideoSeeking;if(!c&&!b.seeking&&(a.dataset.waitingTimes||(a.dataset.waitingTimes=0),1!==a.dataset.waitingTimes)){a.dataset.waitingTimes++;var d,e="videoTimeUpdate.waiting_report",f=+new Date;a.context.msg.off(e),a.context.msg.once(e,function(){var c;d=+new Date,c=0===b.index?31:51,a.reportStep31_51({step:c,waitingTime:d-f})})}}}),this.context.msg.on("networkBadStart",function(b){if("film"===b.playListType&&!b.isOnWaiting){var c=a.context.dataset.isVideoSeeking;if(!c){a.dataset.waitingTimes?a.dataset.waitingTimes++:a.dataset.waitingTimes=1;var d,e="networkBadEnd.waiting_report",f=+new Date;a.context.msg.off(e),a.context.msg.once(e,function(){var c;d=+new Date,c=0===b.index?31:51,a.reportStep31_51({step:c,waitingTime:d-f})})}}}),this.context.msg.on("videoEnd",function(b){if("film"===b.playListType&&(a.dataset.waitingTimes=0),"film"===b.playListType&&!b.isTheLastFilm){var c,d=+new Date,e=b.videoTag.duration||a.context.dataset.videoDuration;a.context.msg.once("videoPlaying.switch_film_section_report",function(){c=+new Date,a.reportStep55({swtichTime:c-d,prevFilmDuration:e})})}"film"===b.playListType&&b.isTheLastFilm&&(a.playTimeHeartBeatStop(!0),a.reportPlayTimeOnEnded(),a.reportLoginUserPlayTime(!0))}),this.context.msg.on("videoTimeUpdate",function(b){b&&"film"===b.playListType&&(a.dataset.timeupdateCounter?a.dataset.timeupdateCounter+=1:a.dataset.timeupdateCounter=1,a.dataset.timeupdateCounter%300===0&&a.reportLoginUserPlayTime(!1))}),this.context.msg.on("getinfoFinish",function(b){b=b||{},a.reportStep1011(b)}),this.context.msg.on("getkeyStart",function(){a.dataset.getkeyStartTime=+new Date}),this.context.msg.on("getkeyFinish",function(b){b=b||{},a.dataset.getkeyEndTime=+new Date,a.reportStep1003(b)}),this.context.msg.on("ready",function(){a.reportPlayTimeWhenPageInit()}),this.context.msg.on("seekStart",function(){a.dataset.filmSeekStartTime=+new Date}),this.context.msg.on("seekEnd",function(){a.dataset.filmSeekEndTime=+new Date,a.reportStep60({seekCostTime:a.dataset.filmSeekEndTime-a.dataset.filmSeekStartTime})}),this.context.msg.on("seekFail",function(){a.dataset.filmSeekFailTime=+new Date,a.reportStep60({val1:1,seekCostTime:a.dataset.filmSeekFailTime-a.dataset.filmSeekStartTime})}),this.context.msg.on("setDefinitionStart",function(){a.dataset.setDefinitionStartTime=+new Date,a.dataset.prevDefinition=a.context.dataset.duration}),this.context.msg.on("setDefinitionDone",function(){a.dataset.setDefinitionDoneTime=+new Date,a.reportStep100({costTime:a.dataset.setDefinitionDoneTime-a.dataset.setDefinitionStartTime,val1:2,predefn:a.dataset.prevDefinition})}),this.context.msg.on("setDefinitionFail",function(b){a.dataset.setDefinitionFailTime=+new Date,a.reportStep100({costTime:a.dataset.setDefinitionFailTime-a.dataset.setDefinitionStartTime,val1:3,predefn:a.dataset.prevDefinition})}),this.context.msg.on("videoPlay",function(b){if(b=b||{},!b||"film"===b.playListType){var c=+new Date;a.dataset.hasOwnProperty("_1_bufferFailTime")||0!==b.index||(a.context.msg.off("error._1_bufferFailTime"),a.context.msg.once("error._1_bufferFailTime",function(b){a.context.msg.off("videoPlaying._1_bufferFailTime"),a.dataset._1_bufferFailTime=+new Date,a.reportStep30({loadTime:a.dataset._1_bufferFailTime-c,val1:1})}),a.context.msg.once("videoPlaying._1_bufferFailTime",function(){a.context.msg.off("error._1_bufferFailTime")})),!a.dataset.hasOwnProperty("_2_bufferFailTime")&&b.index>0&&(a.context.msg.once("error._2_bufferFailTime",function(b){a.context.msg.off("videoPlaying._2_bufferFailTime"),a.dataset._2_bufferFailTime=+new Date,a.reportStep50({loadTime:a.dataset._2_bufferFailTime-c,val1:1})}),a.context.msg.once("videoPlaying._2_bufferFailTime",function(){a.context.msg.off("error._2_bufferFailTime")}))}})},setExtrainfo:function(a){this.context.config.extrainfo=a||""},setClientReportInfo:function(a){this.context.config.clientReportInfo=a||{}},setOuterReportData:function(a){this.context.config.outerReportData=a},exportsModuleApis:function(){this.dataset.moduleApis={},this.dataset.moduleApis.setExtrainfo=this.setExtrainfo.bind(this),this.dataset.moduleApis.setClientReportInfo=this.setClientReportInfo.bind(this),this.dataset.moduleApis.setOuterReportData=this.setOuterReportData.bind(this),e.extend(this.context.userApi,this.dataset.moduleApis)},addAdReport:function(){var a=this;this.context.msg.on("loadingAdStart",function(b,c){a.dataset.loadingadPlayingTime||(a.dataset.loadingadPlayingTime=+new Date,a.reportStep7())})},getAdReportData:function(){return this.context.adApi&&this.context.adApi.getAdReportData()}},Txplayer.register("v4HdPlayerReport",d)}});
/*! Txplayer - v3.0.0 - 2018-11-23 12:20:35
 * Copyright (c) 2018
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(193)},193:function(a,b,c){function d(a){e=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=Txplayer.$,f=Txplayer.util,g=c(194);d.prototype={init:function(){this.write(),this.addEventListerner()},write:function(){var a={loading:"txp-ui-loading",continuePlay:"txp-ui-continue-play",hide:Txplayer.dataset.hideClass},b=e.tmpl(g,a);this.context.dataset.$playermod.append(b),this.dataset.$loading=this.context.dataset.$playermod.find('[data-role="'+a.loading+'"]'),this.dataset.$continue=this.context.dataset.$playermod.find('[data-role="'+a.continuePlay+'"]')},remove:function(){this.dataset.$loading.remove()},isNeedShowLoading:function(){if(1==this.context.dataset.playState||0==this.context.dataset.playState||2==this.context.dataset.playState)return!1;var a=this.context.msg.getData("checkTimeisInBufferdRange",this.context.dataset.videoCurrentTime);if(!a||3==this.context.dataset.playState)return!this.context.dataset.isPlayingAd},stopTimer:function(){this.dataset.timer&&(clearTimeout(this.dataset.timer),this.dataset.timer=null)},hide:function(){this.stopTimer(),this.dataset.isShowing&&(this.context.dataset.isMinbufferControlPause||(this.dataset.$loading.addClass(Txplayer.dataset.hideClass),this.dataset.isShowing=!1))},show:function(){if(!this.dataset.isShowing&&this.dataset.isPlayed){var a=this,b=function(){a.dataset.$loading.removeClass(Txplayer.dataset.hideClass),a.dataset.isShowing=!0};this.stopTimer(),this.dataset.timer=setTimeout(function(){a.isNeedShowLoading()&&b()},50)}},addEventListerner:function(){var a=this;this.dataset.eventsList={},this.dataset.eventsList[f.getUniqueMsgKey("videoPlaying")]=function(){a.hide(),a.dataset.isPlayed=!0},this.dataset.eventsList[f.getUniqueMsgKey("isPlayingAdStatusChange")]=function(b){b&&(a.dataset.isPlayed=!0,a.hide())},this.dataset.eventsList[f.getUniqueMsgKey("videoSeeked")]=function(){a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("networkBadEnd")]=function(){a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("videoLoadstart")]=function(){a.show()},this.dataset.eventsList[f.getUniqueMsgKey("videoSeeking")]=function(){a.show()},this.dataset.eventsList[f.getUniqueMsgKey("videoWaiting")]=function(){a.show()},this.dataset.eventsList[f.getUniqueMsgKey("networkBadStart")]=function(){a.show()},this.dataset.eventsList[f.getUniqueMsgKey("showLoading")]=function(){a.context.dataset.isPlayingAd||(a.dataset.$loading.removeClass(Txplayer.dataset.hideClass),a.dataset.isShowing=!0)},this.dataset.eventsList[f.getUniqueMsgKey("hideLoading")]=function(){a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("showContinuePlay")]=function(b){if("number"==typeof b){var c=parseInt(b/60),d=parseInt(b%60),e="上次观看至"+(c?c+"分":"")+d+"秒，正在为你续播";a.dataset.$continue.text(e),a.dataset.$continue.removeClass(Txplayer.dataset.hideClass),setTimeout(function(){a.dataset.$continue.addClass(Txplayer.dataset.hideClass)},3e3)}},this.dataset.eventsList[f.getUniqueMsgKey("error")]=function(){a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("vidChange")]=function(){a.dataset.isPlayed=null},e.each(this.dataset.eventsList,function(b,c){a.context.msg.on(b,c)})}},Txplayer.register("UiLoading",d)},194:function(a,b){a.exports='<txpdiv  class="txp_overlay_loading">\n  <txpdiv class="txp_text <%=hide%>" data-role="<%=continuePlay%>"></txpdiv>\n  <txpdiv class="txp_icon_loading <%=hide%>" data-role="<%=loading%>"></txpdiv>\n</txpdiv>'}});
/*! Txplayer - v3.0.0 - 2018-11-23 12:20:35
 * Copyright (c) 2018
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(195)},195:function(a,b,c){function d(a){e=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=Txplayer.$,f=Txplayer.util,g=c(196),h=c(197);d.prototype={init:function(){this.write(),this.addEventListerner()},write:function(){var a={loading:"txp-ui-loading-with-ad",speed:"txp-ui-loading-with-ad-speed",canvas:"txp-ui-loading-with-ad-canvas",loadingImg:"txp-ui-loading-with-ad-image",adFlag:"txp-ui-loading-with-ad-flag",hide:Txplayer.dataset.hideClass,hideLoadingSlogan:this.context.config.hideLoadingSlogan},b=e.tmpl(g,a);this.context.dataset.$playermod.append(b),this.dataset.$loading=this.context.dataset.$playermod.find('[data-role="'+a.loading+'"]'),this.context.dataset.$loading=this.dataset.$loading,this.dataset.$speed=this.context.dataset.$playermod.find('[data-role="'+a.speed+'"]'),this.dataset.$canvas=this.context.dataset.$playermod.find('[data-role="'+a.canvas+'"]'),this.dataset.$loadingImg=this.context.dataset.$playermod.find('[data-role="'+a.loadingImg+'"]'),this.dataset.$adflag=this.context.dataset.$playermod.find('[data-role="'+a.adFlag+'"]'),this.loadCanvas()},remove:function(){this.dataset.$loading.remove()},updateLoadingImage:function(){var a=this;this.dataset.loadingImageAdUrl?this.dataset.$loadingImg.attr("src",this.dataset.loadingImageAdUrl).css("opacity",0).show(function(){a.updateAdFlagInHtml()}).animate({opacity:"1"},300):(this.dataset.$loadingImg.removeAttr("src").hide(),this.dataset.$adflag.addClass("txp_none"))},loadCanvas:function(){},fanvasPlayOrPause:function(a){this.dataset.$canvas&&this.dataset.$canvas.get(0)&&window.fanvas&&window.fanvas[a]&&("replay"!=a||this.dataset.fanvasIsPlayed?window.fanvas[a](this.dataset.$canvas.get(0)):(this.dataset.fanvasIsPlayed=!0,window.fanvas.play(this.dataset.$canvas.get(0),h,{cache:!1,autoPlay:!0})))},getSpeedStart:function(){if(!this.dataset.timer){var a=this;this.dataset.timer=setInterval(function(){var b=a.context.dataset.videoDownloadSpeed||0;b<=0||a.dataset.$speed.html(f.formatDownloadSpeed(b))},200)}},getSpeedStop:function(){this.dataset.timer&&(clearInterval(this.dataset.timer),this.dataset.timer=null)},isNeedShowLoading:function(){if(1==this.context.dataset.playState||0==this.context.dataset.playState||2==this.context.dataset.playState)return!1;var a=this.context.msg.getData("checkTimeisInBufferdRange",this.context.dataset.videoCurrentTime);if(!a)return!0},hide:function(){this.dataset.showTimer&&(clearTimeout(this.dataset.showTimer),this.dataset.showTimer=null),this.context.dataset.isImgAdLoadingShowing&&(this.context.dataset.disableCalcDownloadSpeed=!0,this.dataset.$loading.addClass(Txplayer.dataset.hideClass),this.dataset.$speed.html(""),this.getSpeedStop(),this.context.dataset.isImgAdLoadingShowing=!1,this.dataset.loadingImageAdUrl=null,this.updateLoadingImage(),this.fanvasPlayOrPause("pause"))},show:function(){if(!this.context.dataset.isImgAdLoadingShowing&&!this.dataset.isPlayed&&!this.dataset.showTimer){var a=this;this.dataset.showTimer=setTimeout(function(){a.dataset.showTimer=null,a.isNeedShowLoading()&&(f.v4log("showLoadingWithad"),a.context.dataset.disableCalcDownloadSpeed=!1,a.dataset.$loading.removeClass(Txplayer.dataset.hideClass),a.getSpeedStart(),a.updateLoadingImage(),a.context.dataset.isImgAdLoadingShowing=!0,a.fanvasPlayOrPause("replay"))},50)}},updateAdFlagInHtml:function(){var a=this;this.dataset.$adflag&&this.context.adApi.getAdTagConfigAsync&&this.context.adApi.getAdTagConfigAsync("PVL").then(function(b){"1"==b?a.dataset.$adflag.removeClass("txp_none"):a.dataset.$adflag.addClass("txp_none")}).fail(function(b){a.dataset.$adflag.addClass("txp_none")})},addEventListerner:function(){var a=this;this.dataset.eventsList={},this.dataset.eventsList[f.getUniqueMsgKey("videoPlaying")]=function(){a.dataset.isPlayed=!0,a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("videoTimeUpdate")]=function(){a.dataset.isPlayed=!0,a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("isPlayingAdStatusChange")]=function(b){b&&(a.dataset.isPlayed=!0,a.hide())},this.dataset.eventsList[f.getUniqueMsgKey("hlsStartPlay")]=function(){a.dataset.isPlayed||a.show()},this.dataset.eventsList[f.getUniqueMsgKey("videoPlay")]=function(){a.show()},this.dataset.eventsList[f.getUniqueMsgKey("userPlayPlayer")]=function(){a.show()},this.dataset.eventsList[f.getUniqueMsgKey("beforeVideoPlay")]=function(){a.show()},this.dataset.eventsList[f.getUniqueMsgKey("error")]=function(){a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("showUIVipGuide")]=function(){a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("vidChange")]=function(){a.reset()},this.dataset.eventsList[f.getUniqueMsgKey("loadingImageAdPreloadError")]=function(){a.updateLoadingImage()},this.dataset.eventsList[f.getUniqueMsgKey("loadingImageAdUrlReady")]=function(b){if(a.context.dataset.isImgAdLoadingShowing&&b&&b.url){a.context.msg.broadcast("adPluginMsg",{name:"reportAd",adtype:"PVL",params:a.context.dataset.loadingImageAdData||{}}),a.dataset.loadingImageAdUrl=b.url;var c=new Image;c.onerror=function(){a.dataset.loadingImageAdUrl=null,a.context.msg.broadcast("loadingImageAdPreloadError")},c.src=a.dataset.loadingImageAdUrl,a.updateLoadingImage()}},e.each(this.dataset.eventsList,function(b,c){a.context.msg.on(b,c)})},reset:function(){this.context.dataset.disableCalcDownloadSpeed=!0,this.dataset.isPlayed=null}},Txplayer.register("UiLoadingWithAD",d)},196:function(a,b){a.exports='<txpdiv data-role="<%=loading%>" class="txp_overlay_loading <%=hide%>">\n  <txpdiv class="txp_overlay_loading_content">\n    <txpdiv class="txp_overlay_loading_ad">\n      <img data-role="<%=loadingImg%>" width="200" class="txp_img">\n      <txpdiv data-role="<%=adFlag%>" class="txp_ad_mark txp_none">广告</txpdiv>\n    </txpdiv>\n    <% if (!hideLoadingSlogan) { %>\n    <img class="txp_overlay_loading_slogan" src="//vm.gtimg.cn/tencentvideo/txp/style/img/slogan.png" width="165">\n    <txpdiv class="txp_overlay_loading_name">腾讯视频 v.qq.com</txpdiv>\n    <% } %>\n    <txpdiv data-role="<%=speed%>" class="txp_overlay_loading_speed"></txpdiv>\n    <txpdiv  class="txp_overlay_loading_canvas">\n      <canvas data-role="<%=canvas%>" width="800" height="450"></canvas>\n    </txpdiv>\n  </txpdiv>\n</txpdiv>'},197:function(a,b){var c={frameRate:24,stageHeight:450,stageWidth:600,bgColor:null,definitionPool:[{frameActionList:[[0,["pE",{filters:[{blurY:95,quality:3,type:"BF",blurX:95}],n:"1-2",y:245,t:"MC",id:2,a:0,d:0,x:382.8}],["tE","1-2",4,{alpha:.23,y:229.3,scaleX:1.15,scaleY:1.15,x:377}],["pE",{filters:[{blurY:62,quality:3,type:"BF",blurX:62}],n:"3-4",y:270.7,t:"MC",id:4,a:0,d:1,x:207.3}],["pE",{n:"5-5",y:293,t:"MC",id:5,a:0,d:2,x:405}],["pE",{n:"7-6",y:259,t:"MC",id:6,a:0,d:3,x:193}],["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"9-7",y:270.7,t:"MC",id:7,a:0,d:4,x:190.7}],["pE",{n:"11-9",y:313,t:"MC",id:9,a:0,d:5,x:257}],["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"13-10",y:322.6,t:"MC",id:10,sY:.81,a:0,d:6,sX:.81,x:287.6}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:285.6,t:"MC",id:11,sY:.92,a:0,d:7,sX:.92,x:229.2}],["pE",{filters:[{blurY:63,quality:3,type:"BF",blurX:63}],n:"17-12",y:269,t:"MC",id:12,a:0,d:8,x:363.1}]],[5,["pE",{filters:[{blurY:95,quality:3,type:"BF",blurX:95}],n:"1-2",y:225.4,sX:1.19,sY:1.19,a:.29,x:375.5}]],[6,["pE",{filters:[{blurY:95,quality:3,type:"BF",blurX:95}],n:"1-2",y:221.5,sX:1.23,sY:1.23,a:.36,x:374.1}],["tE","1-2",3,{alpha:.53,y:209.7,scaleX:1.34,scaleY:1.34,x:369.8}],["pE",{filters:[{blurY:62,quality:3,type:"BF",blurX:62}],n:"3-4",y:267.3,sX:1.03,sY:1.03,a:.09,x:205.5}]],[7,["pE",{filters:[{blurY:62,quality:3,type:"BF",blurX:62}],n:"3-4",y:263.9,sX:1.05,sY:1.05,a:.17,x:203.6}]],[8,["pE",{filters:[{blurY:62,quality:3,type:"BF",blurX:62}],n:"3-4",y:260.4,sX:1.08,sY:1.08,a:.26,x:201.8}]],[9,["pE",{filters:[{blurY:62,quality:3,type:"BF",blurX:62}],n:"3-4",y:257,sX:1.1,sY:1.1,a:.34,x:199.9}],["pE",{n:"5-5",y:324,a:0,x:423}],["tE","5-5",30,{alpha:.86,y:250.5,scaleX:1,scaleY:1,x:440.4}]],[10,["pE",{filters:[{blurY:95,quality:3,type:"BF",blurX:95}],n:"1-2",y:205.8,sX:1.38,sY:1.38,a:.59,x:368.3}],["pE",{filters:[{blurY:62,quality:3,type:"BF",blurX:62}],n:"3-4",y:253.6,sX:1.13,sY:1.13,a:.43,x:198.1}],["tE","3-4",2,{alpha:.6,y:246.7,scaleX:1.18,scaleY:1.18,x:194.4}]],[11,["pE",{filters:[{blurY:95,quality:3,type:"BF",blurX:95}],n:"1-2",y:202,sX:1.42,sY:1.42,a:.65,x:366.9}],["tE","1-2",2,{alpha:.55,y:196.9,scaleX:1.36,scaleY:1.36,x:369.9}]],[13,["pE",{filters:[{blurY:62,quality:3,type:"BF",blurX:62}],n:"3-4",y:243.3,sX:1.2,sY:1.2,a:.68,x:192.5}]],[14,["pE",{filters:[{blurY:95,quality:3,type:"BF",blurX:95}],n:"1-2",y:194.3,sX:1.32,sY:1.32,a:.5,x:371.4}],["tE","1-2",5,{alpha:.25,y:181.7,scaleX:1.16,scaleY:1.16,x:378.7}],["pE",{filters:[{blurY:62,quality:3,type:"BF",blurX:62}],n:"3-4",y:239.9,sX:1.23,sY:1.23,a:.77,x:190.7}]],[15,["pE",{filters:[{blurY:62,quality:3,type:"BF",blurX:62}],n:"3-4",y:236.4,sX:1.25,sY:1.25,a:.86,x:188.8}]],[16,["pE",{filters:[{blurY:62,quality:3,type:"BF",blurX:62}],n:"3-4",y:233,sX:1.28,sY:1.28,a:.94,x:187}],["tE","3-4",8,{alpha:.11,y:193.1,scaleX:1.28,scaleY:1.28,x:199.5}]],[20,["pE",{filters:[{blurY:95,quality:3,type:"BF",blurX:95}],n:"1-2",y:179.2,sX:1.13,sY:1.13,a:.2,x:380.2}],["pE",{n:"7-6",y:256.8,sX:1.01,sY:1.01,a:.04,x:192.6}],["tE","7-6",4,{alpha:.2,y:248,scaleX:1.04,scaleY:1.04,x:190.9}]],[21,["pE",{filters:[{blurY:95,quality:3,type:"BF",blurX:95}],n:"1-2",y:176.7,sX:1.1,sY:1.1,a:.15,x:381.6}]],[22,["pE",{filters:[{blurY:95,quality:3,type:"BF",blurX:95}],n:"1-2",y:174.2,sX:1.06,sY:1.06,a:.1,x:383.2}]],[23,["pE",{filters:[{blurY:95,quality:3,type:"BF",blurX:95}],n:"1-2",y:171.6,sX:1.03,sY:1.03,a:.05,x:384.7}]],[24,["pE",{filters:[{blurY:95,quality:3,type:"BF",blurX:95}],n:"1-2",y:169,a:0,x:386}]],[25,["pE",{filters:[{blurY:62,quality:3,type:"BF",blurX:62}],n:"3-4",y:188,sX:1.28,sY:1.28,a:0,x:201}],["pE",{n:"7-6",y:245.8,sX:1.05,sY:1.05,a:.25,x:190.4}]],[26,["pE",{n:"7-6",y:243.6,sX:1.06,sY:1.06,a:.29,x:190.1}],["tE","7-6",4,{alpha:.45,y:234.8,scaleX:1.1,scaleY:1.1,x:188.3}]],[31,["pE",{n:"7-6",y:232.5,sX:1.1,sY:1.1,a:.49,x:188}]],[32,["pE",{n:"7-6",y:230.4,sX:1.11,sY:1.11,a:.53,x:187.5}],["tE","7-6",4,{alpha:.7,y:221.5,scaleX:1.15,scaleY:1.15,x:185.8}]],[35,["pE",{n:"11-9",y:309.1,sX:1.02,sY:1.02,a:.04,x:257.8}],["tE","11-9",9,{alpha:.4,y:273.5,scaleX:1.21,scaleY:1.21,x:265.4}]],[37,["pE",{n:"7-6",y:219.3,sX:1.16,sY:1.16,a:.74,x:185.4}]],[38,["pE",{n:"7-6",y:217.1,sX:1.17,sY:1.17,a:.78,x:185}],["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"13-10",y:316.9,sX:.82,sY:.82,a:.04,x:286.9}],["tE","13-10",8,{alpha:.36,y:271.2,scaleX:.92,scaleY:.92,x:281.2}]],[39,["pE",{n:"7-6",y:214.9,sX:1.17,sY:1.17,a:.82,x:184.5}],["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"9-7",y:267.3,a:.02,x:189.3}],["tE","9-7",13,{alpha:.29,y:223.4,scaleX:1,scaleY:1,x:171.4}]],[40,["pE",{n:"5-5",y:248,a:.89,x:441}],["tE","5-5",30,{alpha:.03,y:192.9,scaleX:1,scaleY:1,x:423.6}],["pE",{n:"7-6",y:212.7,sX:1.18,sY:1.18,a:.86,x:184.2}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:310,sX:.92,sY:.92,a:0,x:229.2}]],[41,["pE",{n:"7-6",y:210.5,sX:1.19,sY:1.19,a:.9,x:183.7}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:306.4,sX:.95,sY:.95,a:.02,x:227.3}]],[42,["pE",{n:"7-6",y:208.3,sX:1.2,sY:1.2,a:.94,x:183.3}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:302.9,sX:.98,sY:.98,a:.04,x:225.2}]],[43,["pE",{n:"7-6",y:204.9,sX:1.19,sY:1.19,a:.9,x:183.7}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:299.2,sX:1.01,sY:1.01,a:.06,x:223.2}]],[44,["pE",{n:"7-6",y:201.6,sX:1.18,sY:1.18,a:.87,x:184}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:295.6,sX:1.04,sY:1.04,a:.08,x:221.2}],["tE","15-11",7,{alpha:.22,y:270.6,scaleX:1.26,scaleY:1.26,x:207.2}]],[45,["pE",{n:"7-6",y:198.3,sX:1.18,sY:1.18,a:.83,x:184.5}],["tE","7-6",11,{alpha:.41,y:161.6,scaleX:1.09,scaleY:1.09,x:188.8}],["pE",{n:"11-9",y:269.5,sX:1.24,sY:1.24,a:.44,x:266.2}],["tE","11-9",2,{alpha:.52,y:261.7,scaleX:1.28,scaleY:1.28,x:267.9}]],[47,["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"13-10",y:265.4,sX:.93,sY:.93,a:.4,x:280.4}]],[48,["pE",{n:"11-9",y:257.8,sX:1.3,sY:1.3,a:.56,x:268.8}],["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"13-10",y:259.8,sX:.94,sY:.94,a:.44,x:279.8}],["tE","13-10",2,{alpha:.52,y:248.3,scaleX:.97,scaleY:.97,x:278.3}],["pE",{filters:[{blurY:63,quality:3,type:"BF",blurX:63}],n:"17-12",y:267.1,sX:1.02,sY:1.02,a:.02,x:364}]],[49,["pE",{n:"11-9",y:254.4,sX:1.28,sY:1.28,a:.54,x:268.7}],["pE",{filters:[{blurY:63,quality:3,type:"BF",blurX:63}],n:"17-12",y:265,sX:1.04,sY:1.04,a:.04,x:364.8}]],[50,["pE",{n:"11-9",y:250.9,sX:1.25,sY:1.25,a:.51,x:268.5}],["pE",{filters:[{blurY:63,quality:3,type:"BF",blurX:63}],n:"17-12",y:263.1,sX:1.06,sY:1.06,a:.06,x:365.7}]],[51,["pE",{n:"11-9",y:247.5,sX:1.23,sY:1.23,a:.48,x:268.4}],["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"13-10",y:242.6,sX:.98,sY:.98,a:.56,x:277.6}],["tE","13-10",5,{alpha:.37,y:210.7,scaleX:.84,scaleY:.84,x:284.7}],["pE",{filters:[{blurY:63,quality:3,type:"BF",blurX:63}],n:"17-12",y:261.1,sX:1.08,sY:1.08,a:.08,x:366.6}]],[52,["pE",{n:"11-9",y:244,sX:1.21,sY:1.21,a:.46,x:268.3}],["tE","11-9",2,{alpha:.41,y:237.2,scaleX:1.16,scaleY:1.16,x:268.1}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:267,sX:1.29,sY:1.29,a:.24,x:205.3}],["pE",{filters:[{blurY:63,quality:3,type:"BF",blurX:63}],n:"17-12",y:259.2,sX:1.1,sY:1.1,a:.1,x:367.5}],["tE","17-12",8,{alpha:.26,y:243.4,scaleX:1.25,scaleY:1.25,x:374.5}]],[53,["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"9-7",y:220,a:.31,x:170}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:260.6,sX:1.34,sY:1.34,a:.21,x:206.9}],["tE","15-11",4,{alpha:.12,y:234.6,scaleX:1.57,scaleY:1.57,x:213.6}]],[54,["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"9-7",y:216.6,sX:.98,sY:.98,a:.29,x:171.5}]],[55,["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"9-7",y:213,sX:.96,sY:.96,a:.27,x:172.9}],["tE","9-7",13,{alpha:.02,y:167.5,scaleX:.71,scaleY:.71,x:191.8}],["pE",{n:"11-9",y:233.8,sX:1.14,sY:1.14,a:.39,x:268}],["tE","11-9",4,{alpha:.29,y:220.1,scaleX:1.05,scaleY:1.05,x:267.5}]],[57,["pE",{n:"7-6",y:158.3,sX:1.08,sY:1.08,a:.38,x:189.1}],["tE","7-6",2,{alpha:.3,y:151.7,scaleX:1.06,scaleY:1.06,x:189.9}],["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"13-10",y:204.3,sX:.81,sY:.81,a:.34,x:286.2}]],[58,["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"13-10",y:197.9,sX:.78,sY:.78,a:.3,x:287.5}],["tE","13-10",5,{alpha:.11,y:166,scaleX:.64,scaleY:.64,x:294.6}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:228,sX:1.62,sY:1.62,a:.09,x:215.3}]],[59,["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:221.6,sX:1.68,sY:1.68,a:.07,x:217}]],[60,["pE",{n:"7-6",y:148.3,sX:1.06,sY:1.06,a:.26,x:190.3}],["tE","7-6",4,{alpha:.11,y:135,scaleX:1.02,scaleY:1.02,x:191.9}],["pE",{n:"11-9",y:216.7,sX:1.02,sY:1.02,a:.27,x:267.4}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:215.1,sX:1.73,sY:1.73,a:.05,x:218.7}]],[61,["pE",{n:"11-9",y:213.2,sX:1,sY:1,a:.24,x:267.2}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:208.5,sX:1.79,sY:1.79,a:.02,x:220.3}],["pE",{filters:[{blurY:63,quality:3,type:"BF",blurX:63}],n:"17-12",y:241.4,sX:1.27,sY:1.27,a:.28,x:375.4}],["tE","17-12",9,{alpha:.03,y:197,scaleX:1.67,scaleY:1.67,x:358}]],[62,["pE",{n:"11-9",y:209.9,sX:.98,sY:.98,a:.22,x:267.1}],["tE","11-9",2,{alpha:.17,y:203,scaleX:.93,scaleY:.93,x:266.9}],["pE",{filters:[{blurY:40,quality:3,type:"BF",blurX:40}],n:"15-11",y:202,sX:1.84,sY:1.84,a:0,x:222}]],[64,["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"13-10",y:159.6,sX:.61,sY:.61,a:.07,x:296}]],[65,["pE",{n:"7-6",y:131.6,sX:1.02,sY:1.02,a:.07,x:192.3}],["pE",{n:"11-9",y:199.6,sX:.91,sY:.91,a:.14,x:266.7}],["tE","11-9",5,{alpha:.02,y:182.4,scaleX:.79,scaleY:.79,x:266.1}],["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"13-10",y:153.2,sX:.58,sY:.58,a:.04,x:297.4}]],[66,["pE",{n:"7-6",y:128.4,sX:1.01,sY:1.01,a:.04,x:192.7}],["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"13-10",y:146.9,sX:.55,sY:.55,a:0,x:298.8}]],[67,["pE",{n:"7-6",y:125,a:0,x:193}]],[69,["pE",{filters:[{blurY:5,quality:1,type:"BF",blurX:5}],n:"9-7",y:164,sX:.69,sY:.69,a:0,x:193.3}]],[71,["pE",{n:"5-5",y:191,a:0,x:423}],["pE",{n:"11-9",y:179,sX:.77,sY:.77,a:0,x:266}],["pE",{filters:[{blurY:63,quality:3,type:"BF",blurX:63}],n:"17-12",y:192,sX:1.71,sY:1.71,a:0,x:356}]]],totalFrames:72,rect:{x:190.7,y:245,height:100.3,width:273.5}},{graphics:[["f","#70DF00"],["p","ACKEVQg5AAgpgpQgogogAg5QAAg5AogpQApgoA5AAQA6gAAoAoQApApAAA5QAAA5gpAoQgoApg5AA"],["ef"]],rect:{x:0,y:0,height:27.7,width:27.7}},{frameActionList:[[0,["pE",{n:"1-1",t:"SH",id:1,sY:2.94,d:0,sX:2.94}]]],totalFrames:1,rect:{x:0,y:0,height:81.4,width:81.4}},{graphics:[["f","#FF920B"],["p","AAADrQAAhhBFhFQBFhEBiAAQBiAABFBFQBFBFAABiQAABihFBFQhFBFhhAAQhhAAhFhFQhEhFAAhh"],["ef"]],rect:{x:0,y:0,height:47,width:47}},{frameActionList:[[0,["pE",{n:"1-3",t:"SH",id:3,sY:1.04,d:0,sX:1.04}]]],totalFrames:1,rect:{x:0,y:0,height:49,width:49}},{frameActionList:[[0,["pE",{n:"1-1",t:"SH",id:1,sY:.38,d:0,sX:.38}]]],totalFrames:1,rect:{x:0,y:0,height:10.5,width:10.5}},{frameActionList:[[0,["pE",{n:"1-3",t:"SH",id:3,sY:.16,d:0,sX:.16}]]],totalFrames:1,rect:{x:0,y:0,height:7.5,width:7.5}},{frameActionList:[[0,["pE",{n:"1-1",t:"SH",d:0,id:1}]]],totalFrames:1,rect:{x:0,y:0,height:27.7,width:27.7}},{graphics:[["f","#44BFFB"],["p","AH4D8QAABphKBKQhKBKhoAAQhoAAhKhKQhJhKAAhoQAAhoBKhKQBKhJBpAAQBpAABKBKQBKBKAABp"],["ef"]],rect:{x:0,y:0,height:50.4,width:50.4}},{frameActionList:[[0,["pE",{n:"1-8",t:"SH",id:8,sY:.17,d:0,sX:.17}]]],totalFrames:1,rect:{x:0,y:0,height:8.5,width:8.5}},{frameActionList:[[0,["pE",{n:"1-3",t:"SH",id:3,sY:.6,d:0,sX:.6}]]],totalFrames:1,rect:{x:0,y:0,height:28,width:28}},{frameActionList:[[0,["pE",{n:"1-8",t:"SH",d:0,id:8}]]],totalFrames:1,rect:{x:0,y:0,height:50.4,width:50.4}},{frameActionList:[[0,["pE",{n:"1-3",t:"SH",d:0,id:3}]]],totalFrames:1,rect:{x:0,y:0,height:47,width:47}}]};a.exports=c}});
/*! Txplayer - v3.0.0 - 2018-11-23 12:20:35
 * Copyright (c) 2018
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(126)},126:function(a,b){function c(a){d=Txplayer.$,this.dataset={},this.context=a,this.init()}var d=Txplayer.$,e=(Txplayer.apiList,Txplayer.util);c.prototype={init:function(){this.dataset.maxHistoryPlayTimeList=50,this.dataset.useConnectionPlay=this.context.config.useConnectionPlay,this.context.dataset.historyDefinition=this.getHistoryDefinition(),this.context.config&&"v3"==this.context.config.version&&(this.dataset.adMuteHistory=this.getAdMuteHistory()),this.context.dataset.historyPlayTime=this.getHistoryPlayTime(),this.addEventListener()},savePlaytimeData:function(a){var b,c=e.getData(Txplayer.dataset.localStorageKey.historyPlayTime),d=this.context.dataset.vid,f=0;if(c)try{b=JSON.parse(c)}catch(g){b={}}else b={};if(!d)return void e.showError("savePlaytimeData Error","找不到vid");for(var h in b)f++;f>=this.dataset.maxHistoryPlayTimeList&&(b={}),b[d]=a,this.context.dataset.historyPlayTime=JSON.stringify(b),e.setData(Txplayer.dataset.localStorageKey.historyPlayTime,JSON.stringify(b))},getHistoryPlayTime:function(){var a,b=e.getData(Txplayer.dataset.localStorageKey.historyPlayTime),c=this.context.dataset.vid;if(c||(c=this.context.config.vid),b)try{a=JSON.parse(b)}catch(d){a={}}else a={};return c?a[c]:void e.showError("getHistoryPlayTime Error","找不到vid")},clearPlaytimeData:function(){var a,b=e.getData(Txplayer.dataset.localStorageKey.historyPlayTime),c=this.context.dataset.vid;if(b)try{a=JSON.parse(b)}catch(d){a={}}else a={};return c?(delete a[c],this.context.dataset.historyPlayTime=JSON.stringify(a),void e.setData(Txplayer.dataset.localStorageKey.historyPlayTime,JSON.stringify(a))):void e.showError("clearPlaytimeData Error","找不到vid")},saveDefinitionData:function(a){a&&(this.context.dataset.historyDefinition=a,e.setData(Txplayer.dataset.localStorageKey.historyDefinition,a))},getHistoryDefinition:function(){var a=e.getData(Txplayer.dataset.localStorageKey.historyDefinition);return"mp4"==a&&(a=""),a},saveAdMuteData:function(a){this.dataset.adMuteHistory=JSON.stringify(a),e.setData(Txplayer.dataset.localStorageKey.adMuteHistory,a)},getAdMuteHistory:function(){return this.dataset.adMuteHistory=e.getData(Txplayer.dataset.localStorageKey.adMuteHistory),e.getData(Txplayer.dataset.localStorageKey.adMuteHistory)},addEventListener:function(){var a=this;this.dataset.eventsList={},this.context.config&&"v3"==this.context.config.version&&(this.dataset.eventsList[e.getUniqueMsgKey("videoPlay")]=function(b){if(b&&"film"!==b.playListType){var c="true"===a.dataset.adMuteHistory;a.context.msg.broadcast("adMuteStateUpdate",{mute:c})}},this.dataset.eventsList[e.getUniqueMsgKey("adMuteChange")]=function(b){b&&b.hasOwnProperty("mute")&&a.saveAdMuteData(b.mute)}),this.dataset.eventsList[e.getUniqueMsgKey("videoTimeUpdate")]=function(b){if(b)if(b.currentTime&&parseInt(b.currentTime)%3===0)a.savePlaytimeData(parseInt(b.currentTime));else{if(b&&"film"!==b.playListType)return;if(b&&b.videoTag&&b.videoTag.currentTime&&parseInt(b.videoTag.currentTime)%3===0){var c=a.context.dataset.currentTime;a.savePlaytimeData(parseInt(c))}}},this.dataset.eventsList[e.getUniqueMsgKey("videoEnd")]=function(b){"film"===b.playListType&&(b.isAllEnd||b.isTheLastFilm)&&a.clearPlaytimeData()},this.dataset.eventsList[e.getUniqueMsgKey("definitionChange")]=function(b){a.saveDefinitionData(b)},d.each(this.dataset.eventsList,function(b,c){a.context.msg.on(b,c)})}},Txplayer.register("HdPlayerHistory",c)}});
/*! Txplayer - v3.0.0 - 2018-11-23 12:20:35
 * Copyright (c) 2018
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(129)},129:function(a,b,c){function d(a){g=Txplayer.$,this.context=a,this.context.dataset.hasChromeHlsPlugin=!0,this.dataset={},this._hls=null,this._video=null,this.addEventListener()}var e,f,g=Txplayer.$,h=Txplayer.util,i=c(130),j={debug:1==h.getUrlParam("debughls"),manifestLoadingMaxRetry:2,manifestLoadingRetryDelay:100,manifestLoadingTimeOut:1e4,levelLoadingMaxRetry:2,levelLoadingRetryDelay:100,levelLoadingTimeOut:1e4,fragLoadingRetryDelay:10,fragLoadingMaxRetry:3,fragLoadingTimeOut:3e4,maxBufferLength:240,maxMaxBufferLength:240,autoStartLoad:!1};d.prototype={destroyHlsPlayer:function(){this._hls&&(this._hls.destroy(),this._hls=null),this._video&&(this._video=null)},createHlsPlayer:function(a,b){b.video.isFocus&&this.destroyHlsPlayer(),e=null,f=null,a=a||j,a.p2pConfig=b.p2pConfig,this._hls=new i(a),this.initHlsEvent()},loadHlsSource:function(a){if(a.src&&a.video){g.extend({},j);if(a.fromSetDefinition&&this._hls)h.v4log("setInfo",{p2pConfig:a.p2pConfig}),this._hls&&this._hls.setInfo&&this._hls.setInfo(a.p2pConfig),this.addDefinition(a);else{h.v4log("setInfo",{p2pConfig:a.p2pConfig}),this._hls&&this._hls.setInfo&&this._hls.setInfo(a.p2pConfig),this.createHlsPlayer(null,a),this._hls.attachMedia(a.video);var b=a.src;a.m3u8?(this.initSetCurrenTime(a),this._hls.loadSource({m3u8:a.m3u8,url:a.src})):(this._hls.loadSource({url:b}),this.initSetCurrenTime(a)),this.dataset.level=0,this.dataset.urlsNum=1,this.dataset.hasSetDefinitionFail=null}}},dealSrc:function(a){var b="#EXTM3U\n#EXT-X-STREAM-INF:PROGRAM-ID=1,BANDWIDTH="+this.context.dataset.currentDefinitionRate+",NAME="+this.context.dataset.definition+"\n"+a+"\n";return"data:appliction/x-mpegurl,"+encodeURIComponent(b)},addDefinition:function(a){this.dataset.urlsNum++;var b="#EXTM3U\n#EXT-X-STREAM-INF:PROGRAM-ID=1,BANDWIDTH="+this.context.dataset.currentDefinitionRate+",NAME="+this.context.dataset.definition+"\n"+a.src+"\n",c=this._hls.coreComponents[0].parseMasterPlaylist(b,encodeURIComponent(b));c[0].url=[c[0].url],c[0].urlId=0,this._hls.levelController._levels.push(c[0]),this._hls.nextLevel=this.dataset.urlsNum-1,a.autoplay&&this._video&&this._video.play()},_startLoad:function(a){var b=this;if(a.currentTime){b._hls.config.startPosition=a.currentTime;var c,d=function(a){if(!b._video)return c&&window.clearInterval(c),void(c=window.setInterval(function(){d(a)},50));if(window.clearInterval(c),c=null,b._hls.startLoad(a.currentTime),b._hls.config.startPosition=0,a.autoplay){var e=a.video.play();e&&e["catch"]&&e["catch"](function(a){h.v4log("hls-play-catch2",a)})}};d(a)}else b._hls.startLoad(),b.setCurrenTime(a)},initSetCurrenTime:function(a){if(a.video){h&&h.v4log("hls-initSetCurrenTime",{src:a.src,currentTime:a.currentTime});var b=this;this._hls.on(i.Events.MANIFEST_PARSED,function(c,d){b._startLoad(a);var e=d&&d.levels&&d.levels[0]&&d.levels[0].details;e&&b.context.msg.broadcast("videoHlsManifestParsed",e)})}},setCurrenTime:function(a){h&&h.v4log("hls-setCurrenTime",a);var b;a.hasOwnProperty("currentTime")&&!isNaN(a.currentTime)?a.autoplay?(b=a.video.play(),b&&b.then?b.then(function(){a.video.currentTime=a.currentTime})["catch"](function(b){a.video.currentTime=a.currentTime,h.v4log("hls-play-catch",b)}):a.video.currentTime=a.currentTime):a.video.currentTime=a.currentTime:a.autoplay&&(b=a.video.play(),b&&b["catch"]&&b["catch"](function(a){h.v4log("hls-play-catch1",a)}))},initHlsEvent:function(){var a=this;this._hls.on(i.Events.LEVEL_SWITCHED,function(b,c){h.v4log("LEVEL_SWITCHED",{urlsNum:a.dataset.urlsNum,level:a.dataset.level,currentLevel:a._hls&&a._hls.currentLevel}),a._hls&&a.dataset.urlsNum>1&&a.dataset.level!=a._hls.currentLevel&&a.context.dataset.useChromeHls&&(h.v4log("已成功为您切换清晰度"),a.dataset.level=a._hls.currentLevel,a.context.dataset.playList[a.context.dataset.playListIndex].playing=!0,a.context.msg.broadcast("videoPlaying.h5report-step31",{index:0}),a.context.msg.broadcast("videoPlaying.switch_definition",{hlsDefinitionEndTime:+new Date}),a.context.msg.broadcast("showUiTips",{text:"已成功为您切换清晰度",time:3}))}),this._hls.on(i.Events.MEDIA_ATTACHING,function(a,b){h.v4log("hls-MEDIA_ATTACHING",{stime:+new Date})}),this._hls.on(i.Events.MEDIA_ATTACHED,function(b,c){h.v4log("hls-MEDIA_ATTACHED",{stime:+new Date}),a._video=c.media}),this._hls.on(i.Events.MANIFEST_LOADING,function(b,c){h.v4log("hls-MANIFEST_LOADING",{stime:+new Date}),a.context.msg.broadcast("hlsStartPlay",{stime:+new Date})}),this._hls.on(i.Events.MEDIA_DETACHED,function(b,c){a._video=null}),this._hls.on(i.Events.ERROR,function(b,c){if(h.v4log("Hls.Events.ERROR",c),c.fatal)switch(c.tsUrl="",c.frag&&c.frag.url&&(c.tsUrl=c.frag.url),c.type){case i.ErrorTypes.MEDIA_ERROR:"bufferAppendError"==c.details&&(a.context.dataset.videoWaitingReason=4,g(a._video).trigger("waiting"),g(a._video).trigger("error",{detail:c.details,url:c.tsUrl})),"bufferStalledError"==c.details&&(a.context.dataset.videoWaitingReason=5,g(a._video).trigger("waiting"),g(a._video).trigger("error",{detail:c.details,url:c.tsUrl}));break;case i.ErrorTypes.NETWORK_ERROR:h.v4log("NETWORK_ERROR",{detail:c.details}),a.context.dataset.videoWaitingReason=6,g(a._video).trigger("waiting"),g(a._video).trigger("error",{detail:c.details,url:c.tsUrl});break;default:a.context.dataset.videoWaitingReason=7,g(a._video).trigger("error",{detail:c.details,url:c.tsUrl})}}),this._hls.on(i.Events.FRAG_LOAD_PROGRESS,function(b,c){c&&c.stats&&a.context.msg.broadcast("hlsProgress",{loaded:c.stats.loaded,total:c.stats.total}),c&&c.stats&&c.stats.loaded>0&&c.frag&&0===c.frag.loadIdx&&(c.stats.loaded/c.stats.total>.3&&a.context.msg.broadcast("hlsFirstFragementLoadFinish",{time:+new Date,loaded:c.stats.loaded}),h.v4log("step30-当前加载进度",{time:+new Date,loaded:c.stats.loaded,percent:c.stats.loaded/c.stats.total}))}),this._hls.on(i.Events.BUFFER_FULL_ERROR,function(a,b){h.v4log("BUFFER_FULL_ERROR",b)})},handleMediaError:function(a){var b=this,c=(new Date).getTime();!e||c-e>3e3?(e=(new Date).getTime(),this._hls.recoverMediaError()):!f||c-f>3e3?(f=(new Date).getTime(),this._hls.swapAudioCodec(),this._hls.recoverMediaError()):g(b._video).trigger("error",{detail:a.details,url:a.tsUrl})},addEventListener:function(){var a=this;a.context.msg.on("loadHlsSource",function(b){h.v4log("hlshelper-broadcast:loadHlsSource"),a.loadHlsSource(b)}),a.context.msg.on("destroyHlsPlayer",function(){h.v4log("hlshelper-broadcast:destroyHlsPlayer"),a.destroyHlsPlayer()}),a.context.msg.on("setHlsCurrenTime",function(b){h.v4log("hlshelper-broadcast:setHlsCurrenTime"),a.setCurrenTime(b)}),a.context.msg.on("reportChromeHlsLog",function(b){a.context.dataset.useChromeHls&&(h.v4log("hlshelper-broadcast:ReportHlsLog"),i.postLog&&i.postLog(b&&b.code||0))}),a.context.msg.on("reportChromeHlsError",function(a){h.v4log("hlshelper-broadcast:ReportHlsError",a),i.setPlayerError&&i.setPlayerError(a)})}},Txplayer.register("HlsHelper",d)},130:function(a,b){!function(c){if("object"==typeof b&&"undefined"!=typeof a)a.exports=c();else if("function"==typeof define&&define.amd)define([],c);else{var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,d.Hls=c()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||a<0||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;var k=new Error('Uncaught, unspecified "error" event. ('+b+")");throw k.context=b,k}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:f=Array.prototype.slice.call(arguments,1),c.apply(this,f)}else if(g(c))for(f=Array.prototype.slice.call(arguments,1),j=c.slice(),d=j.length,i=0;i<d;i++)j[i].apply(this,f);return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned&&(c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,"function"==typeof console.trace)),this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-- >0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(d<0)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else if(c)for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.prototype.listenerCount=function(a){if(this._events){var b=this._events[a];if(e(b))return 1;if(b)return b.length}return 0},d.listenerCount=function(a,b){return a.listenerCount(b)}},{}],2:[function(b,c,d){!function(b){var e=/^((?:[^\/;?#]+:)?)(\/\/[^\/\;?#]*)?(.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,f=/^([^\/;?#]*)(.*)$/,g=/(?:\/|^)\.(?=\/)/g,h=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,i={buildAbsoluteURL:function(a,b,c){if(c=c||{},a=a.trim(),b=b.trim(),!b){if(!c.alwaysNormalize)return a;var d=this.parseURL(a);if(!g)throw new Error("Error trying to parse base URL.");return d.path=i.normalizePath(d.path),i.buildURLFromParts(d)}var e=this.parseURL(b);if(!e)throw new Error("Error trying to parse relative URL.");if(e.scheme)return c.alwaysNormalize?(e.path=i.normalizePath(e.path),i.buildURLFromParts(e)):b;var g=this.parseURL(a);if(!g)throw new Error("Error trying to parse base URL.");if(!g.netLoc&&g.path&&"/"!==g.path[0]){var h=f.exec(g.path);g.netLoc=h[1],g.path=h[2]}g.netLoc&&!g.path&&(g.path="/");var j={scheme:g.scheme,netLoc:e.netLoc,path:null,params:e.params,query:e.query,fragment:e.fragment};if(!e.netLoc&&(j.netLoc=g.netLoc,"/"!==e.path[0]))if(e.path){var k=g.path,l=k.substring(0,k.lastIndexOf("/")+1)+e.path;j.path=i.normalizePath(l)}else j.path=g.path,e.params||(j.params=g.params,e.query||(j.query=g.query));return null===j.path&&(j.path=c.alwaysNormalize?i.normalizePath(e.path):e.path),i.buildURLFromParts(j)},parseURL:function(a){var b=e.exec(a);return b?{scheme:b[1]||"",netLoc:b[2]||"",path:b[3]||"",params:b[4]||"",query:b[5]||"",fragment:b[6]||""}:null},normalizePath:function(a){for(a=a.split("").reverse().join("").replace(g,"");a.length!==(a=a.replace(h,"")).length;);return a.split("").reverse().join("")},buildURLFromParts:function(a){return a.scheme+a.netLoc+a.path+a.params+a.query+a.fragment}};"object"==typeof d&&"object"==typeof c?c.exports=i:"function"==typeof a&&a.amd?a([],function(){return i}):"object"==typeof d?d.URLToolkit=i:b.URLToolkit=i}(this)},{}],3:[function(a,b,c){var d=arguments[3],e=arguments[4],f=arguments[5],g=JSON.stringify;b.exports=function(a,b){function c(a){q[a]=!0;for(var b in e[a][1]){var d=e[a][1][b];q[d]||c(d)}}for(var h,i=Object.keys(f),j=0,k=i.length;j<k;j++){var l=i[j],m=f[l].exports;if(m===a||m&&m["default"]===a){h=l;break}}if(!h){h=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var n={},j=0,k=i.length;j<k;j++){var l=i[j];n[l]=l}e[h]=[Function(["require","module","exports"],"("+a+")(self)"),n]}var o=Math.floor(Math.pow(16,8)*Math.random()).toString(16),p={};p[h]=h,e[o]=[Function(["require"],"var f = require("+g(h)+");(f.default ? f.default : f)(self);"),p];var q={};c(o);var r="("+d+")({"+Object.keys(q).map(function(a){return g(a)+":["+e[a][0]+","+g(e[a][1])+"]"}).join(",")+"},{},["+g(o)+"])",s=window.URL||window.webkitURL||window.mozURL||window.msURL,t=new Blob([r],{type:"text/javascript"});if(b&&b.bare)return t;var u=s.createObjectURL(t),v=new Worker(u);return v.objectURL=u,v}},{}],4:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c.hlsDefaultConfig=void 0;var e=a(5),f=d(e),g=a(8),h=d(g),i=a(9),j=d(i),k=a(10),l=d(k),m=a(59),n=d(m),o=a(7),p=d(o),q=a(6),r=d(q),s=a(50),t=d(s),u=a(16),v=d(u),w=a(15),x=d(w),y=a(14),z=d(y);c.hlsDefaultConfig={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,maxSeekHole:2,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,fragLoadingLoopThreshold:3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:n["default"],fLoader:void 0,pLoader:void 0,xhrSetup:void 0,fetchSetup:void 0,abrController:f["default"],bufferController:h["default"],capLevelController:j["default"],fpsController:l["default"],audioStreamController:r["default"],audioTrackController:p["default"],subtitleStreamController:z["default"],subtitleTrackController:x["default"],timelineController:v["default"],cueHandler:t["default"],enableCEA708Captions:!0,enableWebVTT:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",stretchShortVideoTrack:!1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0}},{10:10,14:14,15:15,16:16,5:5,50:50,59:59,6:6,7:7,8:8,9:9}],5:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(35),j=d(i),k=a(34),l=d(k),m=a(37),n=d(m),o=a(33),p=a(54),q=a(52),r=d(q),s=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,j["default"].FRAG_LOADING,j["default"].FRAG_LOADED,j["default"].FRAG_BUFFERED,j["default"].ERROR));return c.lastLoadedFragLevel=0,c._nextAutoLevel=-1,c.hls=a,c.timer=null,c._bwEstimator=null,c.onCheck=c._abandonRulesCheck.bind(c),c}return g(b,a),h(b,[{key:"destroy",value:function(){this.clearTimer(),l["default"].prototype.destroy.call(this)}},{key:"onFragLoading",value:function(a){var b=a.frag;if("main"===b.type){if(this.timer||(this.timer=setInterval(this.onCheck,100)),!this._bwEstimator){var c=this.hls,d=a.frag.level,e=c.levels[d].details.live,f=c.config,g=void 0,h=void 0;e?(g=f.abrEwmaFastLive,h=f.abrEwmaSlowLive):(g=f.abrEwmaFastVoD,h=f.abrEwmaSlowVoD),this._bwEstimator=new r["default"](c,h,g,f.abrEwmaDefaultEstimate)}this.fragCurrent=b}}},{key:"_abandonRulesCheck",value:function(){var a=this.hls,b=a.media,c=this.fragCurrent,d=c.loader,e=a.minAutoLevel;if(!d||d.stats&&d.stats.aborted)return p.logger.warn("frag loader destroy or aborted, disarm abandonRules"),void this.clearTimer();var f=d.stats;if(b&&(!b.paused&&0!==b.playbackRate||!b.readyState)&&c.autoLevel&&c.level){var g=performance.now()-f.trequest,h=Math.abs(b.playbackRate);if(g>500*c.duration/h){var i=a.levels,k=Math.max(1,f.bw?f.bw/8:1e3*f.loaded/g),l=i[c.level],m=l.realBitrate?Math.max(l.realBitrate,l.bitrate):l.bitrate,o=f.total?f.total:Math.max(f.loaded,Math.round(c.duration*m/8)),q=b.currentTime,r=(o-f.loaded)/k,s=(n["default"].bufferInfo(b,q,a.config.maxBufferHole).end-q)/h;if(s<2*c.duration/h&&r>s){var t=void 0,u=void 0;for(u=c.level-1;u>e;u--){var v=i[u].realBitrate?Math.max(i[u].realBitrate,i[u].bitrate):i[u].bitrate;if(t=c.duration*v/(6.4*k),t<s)break}t<r&&(p.logger.warn("loading too slow, abort fragment loading and switch to level "+u+":fragLoadedDelay["+u+"]<fragLoadedDelay["+(c.level-1)+"];bufferStarvationDelay:"+t.toFixed(1)+"<"+r.toFixed(1)+":"+s.toFixed(1)),a.nextLoadLevel=u,this._bwEstimator.sample(g,f.loaded),d.abort(),this.clearTimer(),a.trigger(j["default"].FRAG_LOAD_EMERGENCY_ABORTED,{frag:c,stats:f}))}}}}},{key:"onFragLoaded",value:function(a){var b=a.frag;if("main"===b.type&&!isNaN(b.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=b.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var c=this.hls.levels[b.level],d=(c.loaded?c.loaded.bytes:0)+a.stats.loaded,e=(c.loaded?c.loaded.duration:0)+a.frag.duration;c.loaded={bytes:d,duration:e},c.realBitrate=Math.round(8*d/e)}if(a.frag.bitrateTest){var f=a.stats;f.tparsed=f.tbuffered=f.tload,this.onFragBuffered(a)}}}},{key:"onFragBuffered",value:function(a){var b=a.stats,c=a.frag;if(!(b.aborted===!0||1!==c.loadCounter||"main"!==c.type||isNaN(c.sn)||c.bitrateTest&&b.tload!==b.tbuffered)){var d=b.tparsed-b.trequest;p.logger.log("latency/loading/parsing/append/kbps:"+Math.round(b.tfirst-b.trequest)+"/"+Math.round(b.tload-b.tfirst)+"/"+Math.round(b.tparsed-b.tload)+"/"+Math.round(b.tbuffered-b.tparsed)+"/"+Math.round(8*b.loaded/(b.tbuffered-b.trequest))),this._bwEstimator.sample(d,b.loaded),b.bwEstimate=this._bwEstimator.getEstimate(),c.bitrateTest?this.bitrateTestDelay=d/1e3:this.bitrateTestDelay=0}}},{key:"onError",value:function(a){switch(a.details){case o.ErrorDetails.FRAG_LOAD_ERROR:case o.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}}},{key:"clearTimer",value:function(){clearInterval(this.timer),this.timer=null}},{key:"_findBestLevel",value:function(a,b,c,d,e,f,g,h,i){for(var j=e;j>=d;j--){var k=i[j],l=k.details,m=l?l.totalduration/l.fragments.length:b,n=!!l&&l.live,o=void 0;o=j<=a?g*c:h*c;var q=i[j].realBitrate?Math.max(i[j].realBitrate,i[j].bitrate):i[j].bitrate,r=q*m/o;if(p.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+j+"/"+Math.round(o)+"/"+q+"/"+m+"/"+f+"/"+r),o>q&&(!r||n&&!this.bitrateTestDelay||r<f))return j}return-1}},{key:"nextAutoLevel",get:function(){var a=this._nextAutoLevel,b=this._bwEstimator;if(!(a===-1||b&&b.canEstimate()))return a;var c=this._nextABRAutoLevel;return a!==-1&&(c=Math.min(a,c)),c},set:function(a){this._nextAutoLevel=a}},{key:"_nextABRAutoLevel",get:function(){var a=this.hls,b=a.maxAutoLevel,c=a.levels,d=a.config,e=a.minAutoLevel,f=a.media,g=this.lastLoadedFragLevel,h=this.fragCurrent?this.fragCurrent.duration:0,i=f?f.currentTime:0,j=f&&0!==f.playbackRate?Math.abs(f.playbackRate):1,k=this._bwEstimator?this._bwEstimator.getEstimate():d.abrEwmaDefaultEstimate,l=(n["default"].bufferInfo(f,i,d.maxBufferHole).end-i)/j,m=this._findBestLevel(g,h,k,e,b,l,d.abrBandWidthFactor,d.abrBandWidthUpFactor,c);if(m>=0)return m;p.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var o=h?Math.min(h,d.maxStarvationDelay):d.maxStarvationDelay,q=d.abrBandWidthFactor,r=d.abrBandWidthUpFactor;if(0===l){var s=this.bitrateTestDelay;if(s){var t=h?Math.min(h,d.maxLoadingDelay):d.maxLoadingDelay;o=t-s,p.logger.trace("bitrate test took "+Math.round(1e3*s)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*o)+" ms"),q=r=1}}return m=this._findBestLevel(g,h,k,e,b,l+o,q,r,c),Math.max(m,0)}}]),b}(l["default"]);c["default"]=s},{33:33,34:34,35:35,37:37,52:52,54:54}],6:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(48),j=d(i),k=a(37),l=d(k),m=a(25),n=d(m),o=a(35),p=d(o),q=a(34),r=d(q),s=a(38),t=d(s),u=a(55),v=d(u),w=a(33),x=a(54),y=a(51),z={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS"},A=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,p["default"].MEDIA_ATTACHED,p["default"].MEDIA_DETACHING,p["default"].AUDIO_TRACKS_UPDATED,p["default"].AUDIO_TRACK_SWITCHING,p["default"].AUDIO_TRACK_LOADED,p["default"].KEY_LOADED,p["default"].FRAG_LOADED,p["default"].FRAG_PARSING_INIT_SEGMENT,p["default"].FRAG_PARSING_DATA,p["default"].FRAG_PARSED,p["default"].ERROR,p["default"].BUFFER_CREATED,p["default"].BUFFER_APPENDED,p["default"].BUFFER_FLUSHED,p["default"].INIT_PTS_FOUND));return c.config=a.config,c.audioCodecSwap=!1,c.ticks=0,c._state=z.STOPPED,c.ontick=c.tick.bind(c),c.initPTS=[],c.waitingFragment=null,c.videoTrackCC=null,c}return g(b,a),h(b,[{key:"destroy",value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),r["default"].prototype.destroy.call(this),this.state=z.STOPPED}},{key:"onInitPtsFound",value:function(a){var b=a.id,c=a.frag.cc,d=a.initPTS;"main"===b&&(this.initPTS[c]=d,this.videoTrackCC=c,x.logger.log("InitPTS for cc:"+c+" found from video track:"+d),this.state===z.WAITING_INIT_PTS&&this.tick())}},{key:"startLoad",value:function(a){if(this.tracks){var b=this.lastCurrentTime;this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.fragLoadError=0,b>0&&a===-1?(x.logger.log("audio:override startPosition with lastCurrentTime @"+b.toFixed(3)),this.state=z.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:a,this.state=z.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=a,this.state=z.STOPPED}},{key:"stopLoad",value:function(){var a=this.fragCurrent;a&&(a.loader&&a.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=z.STOPPED}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){var a,b,c,d=this.hls,e=d.config;switch(this.state){case z.ERROR:case z.PAUSED:case z.BUFFER_FLUSHING:break;case z.STARTING:this.state=z.WAITING_TRACK,this.loadedmetadata=!1;break;case z.IDLE:var f=this.tracks;if(!f)break;if(!this.media&&(this.startFragRequested||!e.startFragPrefetch))break;if(this.loadedmetadata)a=this.media.currentTime;else if(a=this.nextLoadPosition,void 0===a)break;var g=this.mediaBuffer?this.mediaBuffer:this.media,h=l["default"].bufferInfo(g,a,e.maxBufferHole),i=h.len,k=h.end,m=this.fragPrevious,n=e.maxMaxBufferLength,o=this.audioSwitch,q=this.trackId;if((i<n||o)&&q<f.length){if(c=f[q].details,"undefined"==typeof c){this.state=z.WAITING_TRACK;break}if(!o&&!c.live&&m&&m.sn===c.endSN&&(!this.media.seeking||this.media.duration-k<m.duration/2)){this.hls.trigger(p["default"].BUFFER_EOS,{type:"audio"}),this.state=z.ENDED;break}var r=c.fragments,s=r.length,t=r[0].start,u=r[s-1].start+r[s-1].duration,v=void 0;if(o)if(c.live&&!c.PTSKnown)x.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),k=0;else if(k=a,c.PTSKnown&&a<t){if(!(h.end>t||h.nextStart))return;x.logger.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=t+.05}if(c.initSegment&&!c.initSegment.data)v=c.initSegment;else if(k<=t){if(v=r[0],null!==this.videoTrackCC&&v.cc!==this.videoTrackCC&&(v=(0,y.findFragWithCC)(r,this.videoTrackCC)),c.live&&v.loadIdx&&v.loadIdx===this.fragLoadIdx){var A=h.nextStart?h.nextStart:t;return x.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(A+.05)),void(this.media.currentTime=A+.05)}}else{var B=void 0,C=e.maxFragLookUpTolerance,D=m?r[m.sn-r[0].sn+1]:void 0,E=function(a){var b=Math.min(C,a.duration);return a.start+a.duration-b<=k?1:a.start-b>k&&a.start?-1:0};k<u?(k>u-C&&(C=0),B=D&&!E(D)?D:j["default"].search(r,E)):B=r[s-1],B&&(v=B,t=B.start,m&&v.level===m.level&&v.sn===m.sn&&(v.sn<c.endSN?(v=r[v.sn+1-c.startSN],x.logger.log("SN just loaded, load next one: "+v.sn)):v=null))}if(v)if(v.decryptdata&&null!=v.decryptdata.uri&&null==v.decryptdata.key)x.logger.log("Loading key for "+v.sn+" of ["+c.startSN+" ,"+c.endSN+"],track "+q),this.state=z.KEY_LOADING,d.trigger(p["default"].KEY_LOADING,{frag:v});else{if(x.logger.log("Loading "+v.sn+", cc: "+v.cc+" of ["+c.startSN+" ,"+c.endSN+"],track "+q+", currentTime:"+a+",bufferEnd:"+k.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,v.loadCounter){v.loadCounter++;var F=e.fragLoadingLoopThreshold;if(v.loadCounter>F&&Math.abs(this.fragLoadIdx-v.loadIdx)<F)return void d.trigger(p["default"].ERROR,{type:w.ErrorTypes.MEDIA_ERROR,details:w.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:v})}else v.loadCounter=1;v.loadIdx=this.fragLoadIdx,this.fragCurrent=v,this.startFragRequested=!0,isNaN(v.sn)||(this.nextLoadPosition=v.start+v.duration),d.trigger(p["default"].FRAG_LOADING,{frag:v}),this.state=z.FRAG_LOADING}}break;case z.WAITING_TRACK:b=this.tracks[this.trackId],b&&b.details&&(this.state=z.IDLE);break;case z.FRAG_LOADING_WAITING_RETRY:var G=performance.now(),H=this.retryDate;g=this.media;var I=g&&g.seeking;(!H||G>=H||I)&&(x.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=z.IDLE);break;case z.WAITING_INIT_PTS:if(void 0===this.initPTS[this.videoTrackCC])break;var J=this.waitingFragment;if(J){var K=J.frag.cc;this.videoTrackCC!==K?(x.logger.warn("Waiting fragment CC ("+K+") does not match video track CC ("+this.videoTrackCC+")"),this.waitingFragment=null,this.state=z.IDLE):(this.state=z.FRAG_LOADING,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)}else this.state=z.IDLE;break;case z.STOPPED:case z.FRAG_LOADING:case z.PARSING:case z.PARSED:case z.ENDED:}}},{key:"onMediaAttached",value:function(a){var b=this.media=this.mediaBuffer=a.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),b.addEventListener("seeking",this.onvseeking),b.addEventListener("ended",this.onvended);var c=this.config;this.tracks&&c.autoStartLoad&&this.startLoad(c.startPosition)}},{key:"onMediaDetaching",value:function(){var a=this.media;a&&a.ended&&(x.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var b=this.tracks;b&&b.forEach(function(a){a.details&&a.details.fragments.forEach(function(a){a.loadCounter=void 0})}),a&&(a.removeEventListener("seeking",this.onvseeking),a.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()}},{key:"onMediaSeeking",value:function(){this.state===z.ENDED&&(this.state=z.IDLE),this.media&&(this.lastCurrentTime=this.media.currentTime),void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.tick()}},{key:"onMediaEnded",value:function(){this.startPosition=this.lastCurrentTime=0}},{key:"onAudioTracksUpdated",value:function(a){x.logger.log("audio tracks updated"),this.tracks=a.audioTracks}},{key:"onAudioTrackSwitching",value:function(a){var b=!!a.url;this.trackId=a.id,this.fragCurrent=null,this.state=z.PAUSED,this.waitingFragment=null,b?this.timer||(this.timer=setInterval(this.ontick,100)):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),b&&(this.audioSwitch=!0,this.state=z.IDLE,void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold)),this.tick()}},{key:"onAudioTrackLoaded",value:function(a){var b=a.details,c=a.id,d=this.tracks[c],e=b.totalduration,f=0;if(x.logger.log("track "+c+" loaded ["+b.startSN+","+b.endSN+"],duration:"+e),b.live){var g=d.details;g&&b.fragments.length>0?(t["default"].mergeDetails(g,b),f=b.fragments[0].start,b.PTSKnown?x.logger.log("live audio playlist sliding:"+f.toFixed(3)):x.logger.log("live audio playlist - outdated PTS, unknown sliding")):(b.PTSKnown=!1,x.logger.log("live audio playlist - first load, unknown sliding"))}else b.PTSKnown=!1;if(d.details=b,!this.startFragRequested){if(this.startPosition===-1){var h=b.startTimeOffset;isNaN(h)?this.startPosition=0:(x.logger.log("start time offset found in playlist, adjust startPosition to "+h),
this.startPosition=h)}this.nextLoadPosition=this.startPosition}this.state===z.WAITING_TRACK&&(this.state=z.IDLE),this.tick()}},{key:"onKeyLoaded",value:function(){this.state===z.KEY_LOADING&&(this.state=z.IDLE,this.tick())}},{key:"onFragLoaded",value:function(a){var b=this.fragCurrent,c=a.frag;if(this.state===z.FRAG_LOADING&&b&&"audio"===c.type&&c.level===b.level&&c.sn===b.sn){var d=this.tracks[this.trackId],e=d.details,f=e.totalduration,g=b.level,h=b.sn,i=b.cc,j=this.config.defaultAudioCodec||d.audioCodec||"mp4a.40.2",k=this.stats=a.stats;if("initSegment"===h)this.state=z.IDLE,k.tparsed=k.tbuffered=performance.now(),e.initSegment.data=a.payload,this.hls.trigger(p["default"].FRAG_BUFFERED,{stats:k,frag:b,id:"audio"}),this.tick();else{this.state=z.PARSING,this.appended=!1,this.demuxer||(this.demuxer=new n["default"](this.hls,"audio"));var l=this.initPTS[i],m=e.initSegment?e.initSegment.data:[];if(e.initSegment||void 0!==l){this.pendingBuffering=!0,x.logger.log("Demuxing "+h+" of ["+e.startSN+" ,"+e.endSN+"],track "+g);var o=!1;this.demuxer.push(a.payload,m,j,null,b,f,o,l)}else x.logger.log("unknown video PTS for continuity counter "+i+", waiting for video PTS before demuxing audio frag "+h+" of ["+e.startSN+" ,"+e.endSN+"],track "+g),this.waitingFragment=a,this.state=z.WAITING_INIT_PTS}}this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function(a){var b=this.fragCurrent,c=a.frag;if(b&&"audio"===a.id&&c.sn===b.sn&&c.level===b.level&&this.state===z.PARSING){var d=a.tracks,e=void 0;if(d.video&&delete d.video,e=d.audio){e.levelCodec=e.codec,e.id=a.id,this.hls.trigger(p["default"].BUFFER_CODECS,d),x.logger.log("audio track:audio,container:"+e.container+",codecs[level/parsed]=["+e.levelCodec+"/"+e.codec+"]");var f=e.initSegment;if(f){var g={type:"audio",data:f,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[g]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(p["default"].BUFFER_APPENDING,g))}this.tick()}}}},{key:"onFragParsingData",value:function(a){var b=this,c=this.fragCurrent,d=a.frag;if(c&&"audio"===a.id&&"audio"===a.type&&d.sn===c.sn&&d.level===c.level&&this.state===z.PARSING){var e=this.trackId,f=this.tracks[e],g=this.hls;isNaN(a.endPTS)&&(a.endPTS=a.startPTS+c.duration,a.endDTS=a.startDTS+c.duration),x.logger.log("parsed "+a.type+",PTS:["+a.startPTS.toFixed(3)+","+a.endPTS.toFixed(3)+"],DTS:["+a.startDTS.toFixed(3)+"/"+a.endDTS.toFixed(3)+"],nb:"+a.nb),t["default"].updateFragPTSDTS(f.details,c,a.startPTS,a.endPTS);var h=this.audioSwitch,i=this.media,j=!1;if(h&&i)if(i.readyState){var k=i.currentTime;x.logger.log("switching audio track : currentTime:"+k),k>=a.startPTS&&(x.logger.log("switching audio track : flushing all audio"),this.state=z.BUFFER_FLUSHING,g.trigger(p["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),j=!0,this.audioSwitch=!1,g.trigger(p["default"].AUDIO_TRACK_SWITCHED,{id:e}))}else this.audioSwitch=!1,g.trigger(p["default"].AUDIO_TRACK_SWITCHED,{id:e});var l=this.pendingData;this.audioSwitch||([a.data1,a.data2].forEach(function(b){b&&b.length&&l.push({type:a.type,data:b,parent:"audio",content:"data"})}),!j&&l.length&&(l.forEach(function(a){b.state===z.PARSING&&(b.pendingBuffering=!0,b.hls.trigger(p["default"].BUFFER_APPENDING,a))}),this.pendingData=[],this.appended=!0)),this.tick()}}},{key:"onFragParsed",value:function(a){var b=this.fragCurrent,c=a.frag;b&&"audio"===a.id&&c.sn===b.sn&&c.level===b.level&&this.state===z.PARSING&&(this.stats.tparsed=performance.now(),this.state=z.PARSED,this._checkAppendedParsed())}},{key:"onBufferCreated",value:function(a){var b=a.tracks.audio;b&&(this.mediaBuffer=b.buffer,this.loadedmetadata=!0)}},{key:"onBufferAppended",value:function(a){if("audio"===a.parent){var b=this.state;b!==z.PARSING&&b!==z.PARSED||(this.pendingBuffering=a.pending>0,this._checkAppendedParsed())}}},{key:"_checkAppendedParsed",value:function(){if(!(this.state!==z.PARSED||this.appended&&this.pendingBuffering)){var a=this.fragCurrent,b=this.stats,c=this.hls;if(a){this.fragPrevious=a,b.tbuffered=performance.now(),c.trigger(p["default"].FRAG_BUFFERED,{stats:b,frag:a,id:"audio"});var d=this.mediaBuffer?this.mediaBuffer:this.media;x.logger.log("audio buffered : "+v["default"].toString(d.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,c.trigger(p["default"].AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=z.IDLE}this.tick()}}},{key:"onError",value:function(a){var b=a.frag;if(!b||"audio"===b.type)switch(a.details){case w.ErrorDetails.FRAG_LOAD_ERROR:case w.ErrorDetails.FRAG_LOAD_TIMEOUT:if(!a.fatal){var c=this.fragLoadError;c?c++:c=1;var d=this.config;if(c<=d.fragLoadingMaxRetry){this.fragLoadError=c,b.loadCounter=0;var e=Math.min(Math.pow(2,c-1)*d.fragLoadingRetryDelay,d.fragLoadingMaxRetryTimeout);x.logger.warn("audioStreamController: frag loading failed, retry in "+e+" ms"),this.retryDate=performance.now()+e,this.state=z.FRAG_LOADING_WAITING_RETRY}else x.logger.error("audioStreamController: "+a.details+" reaches max retry, redispatch as fatal ..."),a.fatal=!0,this.state=z.ERROR}break;case w.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case w.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case w.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case w.ErrorDetails.KEY_LOAD_ERROR:case w.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==z.ERROR&&(this.state=a.fatal?z.ERROR:z.IDLE,x.logger.warn("audioStreamController: "+a.details+" while loading frag,switch to "+this.state+" state ..."));break;case w.ErrorDetails.BUFFER_FULL_ERROR:if("audio"===a.parent&&(this.state===z.PARSING||this.state===z.PARSED)){var f=this.mediaBuffer,g=this.media.currentTime,h=f&&l["default"].isBuffered(f,g)&&l["default"].isBuffered(f,g+.5);if(h){var i=this.config;i.maxMaxBufferLength>=i.maxBufferLength&&(i.maxMaxBufferLength/=2,x.logger.warn("audio:reduce max buffer length to "+i.maxMaxBufferLength+"s"),this.fragLoadIdx+=2*i.fragLoadingLoopThreshold),this.state=z.IDLE}else x.logger.warn("buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=z.BUFFER_FLUSHING,this.hls.trigger(p["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}}},{key:"onBufferFlushed",value:function(){var a=this,b=this.pendingData;b&&b.length?(x.logger.log("appending pending audio data on Buffer Flushed"),b.forEach(function(b){a.hls.trigger(p["default"].BUFFER_APPENDING,b)}),this.appended=!0,this.pendingData=[],this.state=z.PARSED):(this.state=z.IDLE,this.fragPrevious=null,this.tick())}},{key:"state",set:function(a){if(this.state!==a){var b=this.state;this._state=a,x.logger.log("audio stream:"+b+"->"+a)}},get:function(){return this._state}}]),b}(r["default"]);c["default"]=A},{25:25,33:33,34:34,35:35,37:37,38:38,48:48,51:51,54:54,55:55}],7:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(35),j=d(i),k=a(34),l=d(k),m=a(54),n=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,j["default"].MANIFEST_LOADING,j["default"].MANIFEST_LOADED,j["default"].AUDIO_TRACK_LOADED));return c.ticks=0,c.ontick=c.tick.bind(c),c}return g(b,a),h(b,[{key:"destroy",value:function(){l["default"].prototype.destroy.call(this)}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){this.updateTrack(this.trackId)}},{key:"onManifestLoading",value:function(){this.tracks=[],this.trackId=-1}},{key:"onManifestLoaded",value:function(a){var b=this,c=a.audioTracks||[],d=!1;this.tracks=c,this.hls.trigger(j["default"].AUDIO_TRACKS_UPDATED,{audioTracks:c});var e=0;c.forEach(function(a){return a["default"]?(b.audioTrack=e,void(d=!0)):void e++}),d===!1&&c.length&&(m.logger.log("no default audio track defined, use first audio track as default"),this.audioTrack=0)}},{key:"onAudioTrackLoaded",value:function(a){a.id<this.tracks.length&&(m.logger.log("audioTrack "+a.id+" loaded"),this.tracks[a.id].details=a.details,a.details.live&&!this.timer&&(this.timer=setInterval(this.ontick,1e3*a.details.targetduration)),!a.details.live&&this.timer&&(clearInterval(this.timer),this.timer=null))}},{key:"setAudioTrackInternal",value:function(a){if(a>=0&&a<this.tracks.length){this.timer&&(clearInterval(this.timer),this.timer=null),this.trackId=a,m.logger.log("switching to audioTrack "+a);var b=this.tracks[a],c=this.hls,d=b.type,e=b.url,f={id:a,type:d,url:e};c.trigger(j["default"].AUDIO_TRACK_SWITCH,f),c.trigger(j["default"].AUDIO_TRACK_SWITCHING,f);var g=b.details;!e||void 0!==g&&g.live!==!0||(m.logger.log("(re)loading playlist for audioTrack "+a),c.trigger(j["default"].AUDIO_TRACK_LOADING,{url:e,id:a}))}}},{key:"updateTrack",value:function(a){if(a>=0&&a<this.tracks.length){this.timer&&(clearInterval(this.timer),this.timer=null),this.trackId=a,m.logger.log("updating audioTrack "+a);var b=this.tracks[a],c=b.url,d=b.details;!c||void 0!==d&&d.live!==!0||(m.logger.log("(re)loading playlist for audioTrack "+a),this.hls.trigger(j["default"].AUDIO_TRACK_LOADING,{url:c,id:a}))}}},{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this.trackId},set:function(a){this.trackId===a&&void 0!==this.tracks[a].details||this.setAudioTrackInternal(a)}}]),b}(l["default"]);c["default"]=n},{34:34,35:35,54:54}],8:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(35),j=d(i),k=a(34),l=d(k),m=a(54),n=a(33),o=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,j["default"].MEDIA_ATTACHING,j["default"].MEDIA_DETACHING,j["default"].MANIFEST_PARSED,j["default"].BUFFER_RESET,j["default"].BUFFER_APPENDING,j["default"].BUFFER_CODECS,j["default"].BUFFER_EOS,j["default"].BUFFER_FLUSHING,j["default"].LEVEL_PTS_UPDATED,j["default"].LEVEL_UPDATED));return c._msDuration=null,c._levelDuration=null,c.onsbue=c.onSBUpdateEnd.bind(c),c.onsbe=c.onSBUpdateError.bind(c),c.pendingTracks={},c.tracks={},c}return g(b,a),h(b,[{key:"destroy",value:function(){l["default"].prototype.destroy.call(this)}},{key:"onLevelPtsUpdated",value:function(a){var b=a.type,c=this.tracks.audio;if("audio"===b&&c&&"audio/mpeg"===c.container){var d=this.sourceBuffer.audio,e=Math.abs(d.timestampOffset-a.start);if(e>.1){var f=d.updating;try{d.abort()}catch(g){f=!0,m.logger.warn("can not abort audio buffer: "+g)}f?this.audioTimestampOffset=a.start:(m.logger.warn("change mpeg audio timestamp offset from "+d.timestampOffset+" to "+a.start),d.timestampOffset=a.start)}}}},{key:"onManifestParsed",value:function(a){var b=a.audio,c=a.video,d=0;a.altAudio&&(b||c)&&(d=(b?1:0)+(c?1:0),m.logger.log(d+" sourceBuffer(s) expected")),this.sourceBufferNb=d}},{key:"onMediaAttaching",value:function(a){var b=this.media=a.media;if(b){var c=this.mediaSource=new MediaSource;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),c.addEventListener("sourceopen",this.onmso),c.addEventListener("sourceended",this.onmse),c.addEventListener("sourceclose",this.onmsc),b.src=URL.createObjectURL(c)}}},{key:"onMediaDetaching",value:function(){m.logger.log("media source detaching");var a=this.mediaSource;if(a){if("open"===a.readyState)try{a.endOfStream()}catch(b){m.logger.warn("onMediaDetaching:"+b.message+" while calling endOfStream")}a.removeEventListener("sourceopen",this.onmso),a.removeEventListener("sourceended",this.onmse),a.removeEventListener("sourceclose",this.onmsc),this.media&&(URL.revokeObjectURL(this.media.src),this.media.removeAttribute("src"),this.media.load()),this.mediaSource=null,this.media=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(j["default"].MEDIA_DETACHED)}},{key:"onMediaSourceOpen",value:function(){m.logger.log("media source opened"),this.hls.trigger(j["default"].MEDIA_ATTACHED,{media:this.media});var a=this.mediaSource;a&&a.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()}},{key:"checkPendingTracks",value:function(){var a=this.pendingTracks,b=Object.keys(a).length;b&&(this.sourceBufferNb<=b||0===this.sourceBufferNb)&&(this.createSourceBuffers(a),this.pendingTracks={},this.doAppending())}},{key:"onMediaSourceClose",value:function(){m.logger.log("media source closed")}},{key:"onMediaSourceEnded",value:function(){m.logger.log("media source ended")}},{key:"onSBUpdateEnd",value:function(){if(this.audioTimestampOffset){var a=this.sourceBuffer.audio;m.logger.warn("change mpeg audio timestamp offset from "+a.timestampOffset+" to "+this.audioTimestampOffset),a.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var b=this.parent,c=this.segments.reduce(function(a,c){return c.parent===b?a+1:a},0);this.hls.trigger(j["default"].BUFFER_APPENDED,{parent:b,pending:c}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration()}},{key:"onSBUpdateError",value:function(a){m.logger.error("sourceBuffer error:",a),this.hls.trigger(j["default"].ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:"onBufferReset",value:function(){var a=this.sourceBuffer;for(var b in a){var c=a[b];try{this.mediaSource.removeSourceBuffer(c),c.removeEventListener("updateend",this.onsbue),c.removeEventListener("error",this.onsbe)}catch(d){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}},{key:"onBufferCodecs",value:function(a){if(0===Object.keys(this.sourceBuffer).length){for(var b in a)this.pendingTracks[b]=a[b];var c=this.mediaSource;c&&"open"===c.readyState&&this.checkPendingTracks()}}},{key:"createSourceBuffers",value:function(a){var b=this.sourceBuffer,c=this.mediaSource;for(var d in a)if(!b[d]){var e=a[d],f=e.levelCodec||e.codec,g=e.container+";codecs="+f;m.logger.log("creating sourceBuffer("+g+")");try{var h=b[d]=c.addSourceBuffer(g);h.addEventListener("updateend",this.onsbue),h.addEventListener("error",this.onsbe),this.tracks[d]={codec:f,container:e.container},e.buffer=h}catch(i){m.logger.error("error while trying to add sourceBuffer:"+i.message),this.hls.trigger(j["default"].ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:i,mimeType:g})}}this.hls.trigger(j["default"].BUFFER_CREATED,{tracks:a})}},{key:"onBufferAppending",value:function(a){this._needsFlush||(this.segments?this.segments.push(a):this.segments=[a],this.doAppending())}},{key:"onBufferAppendFail",value:function(a){m.logger.error("sourceBuffer error:",a.event),this.hls.trigger(j["default"].ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:"onBufferEos",value:function(a){var b=this.sourceBuffer,c=a.type;for(var d in b)c&&d!==c||b[d].ended||(b[d].ended=!0,m.logger.log(d+" sourceBuffer now EOS"));this.checkEos()}},{key:"checkEos",value:function(){var a=this.sourceBuffer,b=this.mediaSource;if(!b||"open"!==b.readyState)return void(this._needsEos=!1);for(var c in a){var d=a[c];if(!d.ended)return;if(d.updating)return void(this._needsEos=!0)}m.logger.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");try{b.endOfStream()}catch(e){m.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}},{key:"onBufferFlushing",value:function(a){this.flushRange.push({start:a.startOffset,end:a.endOffset,type:a.type}),this.flushBufferCounter=0,this.doFlush()}},{key:"onLevelUpdated",value:function(a){var b=a.details;0!==b.fragments.length&&(this._levelDuration=b.totalduration+b.fragments[0].start,this.updateMediaElementDuration())}},{key:"updateMediaElementDuration",value:function(){var a=this.media,b=this.mediaSource,c=this.sourceBuffer,d=this._levelDuration;if(null!==d&&a&&b&&c&&0!==a.readyState&&"open"===b.readyState){for(var e in c)if(c[e].updating)return;null===this._msDuration&&(this._msDuration=b.duration);var f=a.duration;(d>this._msDuration&&d>f||f===1/0||isNaN(f))&&(m.logger.log("Updating mediasource duration to "+d.toFixed(3)),this._msDuration=b.duration=d)}}},{key:"doFlush",value:function(){for(;this.flushRange.length;){var a=this.flushRange[0];if(!this.flushBuffer(a.start,a.end,a.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var b=0,c=this.sourceBuffer;try{for(var d in c)b+=c[d].buffered.length}catch(e){m.logger.error("error while accessing sourceBuffer.buffered")}this.appended=b,this.hls.trigger(j["default"].BUFFER_FLUSHED)}}},{key:"doAppending",value:function(){var a=this.hls,b=this.sourceBuffer,c=this.segments;if(Object.keys(b).length){if(this.media.error)return this.segments=[],void m.logger.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(c&&c.length){var d=c.shift();try{var e=d.type,f=b[e];f?f.updating?c.unshift(d):(f.ended=!1,this.parent=d.parent,f.appendBuffer(d.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(g){m.logger.error("error while trying to append buffer:"+g.message),c.unshift(d);var h={type:n.ErrorTypes.MEDIA_ERROR,parent:d.parent};if(22===g.code)return this.segments=[],h.details=n.ErrorDetails.BUFFER_FULL_ERROR,h.fatal=!1,void a.trigger(j["default"].ERROR,h);if(this.appendError?this.appendError++:this.appendError=1,h.details=n.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>a.config.appendErrorMaxRetry)return m.logger.log("fail "+a.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),c=[],h.fatal=!0,void a.trigger(j["default"].ERROR,h);h.fatal=!1,a.trigger(j["default"].ERROR,h)}}}}},{key:"flushBuffer",value:function(a,b,c){var d,e,f,g,h,i,j=this.sourceBuffer;if(Object.keys(j).length){if(m.logger.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+a+"/"+b),this.flushBufferCounter<this.appended){for(var k in j)if(!c||k===c){if(d=j[k],d.ended=!1,d.updating)return m.logger.warn("cannot flush, sb updating in progress"),!1;try{for(e=0;e<d.buffered.length;e++)if(f=d.buffered.start(e),g=d.buffered.end(e),navigator.userAgent.toLowerCase().indexOf("firefox")!==-1&&b===Number.POSITIVE_INFINITY?(h=a,i=b):(h=Math.max(f,a),i=Math.min(g,b)),Math.min(i,g)-h>.5)return this.flushBufferCounter++,m.logger.log("flush "+k+" ["+h+","+i+"], of ["+f+","+g+"], pos:"+this.media.currentTime),d.remove(h,i),!1}catch(l){m.logger.warn("exception while accessing sourcebuffer, it might have been removed from MediaSource")}}}else m.logger.warn("abort flushing too many retries");m.logger.log("buffer flushed")}return!0}}]),b}(l["default"]);c["default"]=o},{33:33,34:34,35:35,54:54}],9:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(35),j=d(i),k=a(34),l=d(k),m=function(a){function b(a){return e(this,b),f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,j["default"].FPS_DROP_LEVEL_CAPPING,j["default"].MEDIA_ATTACHING,j["default"].MANIFEST_PARSED))}return g(b,a),h(b,[{key:"destroy",value:function(){this.hls.config.capLevelToPlayerSize&&(this.media=this.restrictedLevels=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer)))}},{key:"onFpsDropLevelCapping",value:function(a){b.isLevelAllowed(a.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(a.droppedLevel)}},{key:"onMediaAttaching",value:function(a){this.media=a.media instanceof HTMLVideoElement?a.media:null}},{key:"onManifestParsed",value:function(a){var b=this.hls;this.restrictedLevels=[],b.config.capLevelToPlayerSize&&(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.levels=a.levels,b.firstLevel=this.getMaxLevel(a.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}},{key:"detectPlayerSize",value:function(){if(this.media){var a=this.levels?this.levels.length:0;if(a){var b=this.hls;b.autoLevelCapping=this.getMaxLevel(a-1),b.autoLevelCapping>this.autoLevelCapping&&b.streamController.nextLevelSwitch(),this.autoLevelCapping=b.autoLevelCapping}}}},{key:"getMaxLevel",value:function(a){var c=this;if(!this.levels)return-1;var d=this.levels.filter(function(d,e){return b.isLevelAllowed(e,c.restrictedLevels)&&e<=a});return b.getMaxLevelByMediaSize(d,this.mediaWidth,this.mediaHeight)}},{key:"mediaWidth",get:function(){var a=void 0,c=this.media;return c&&(a=c.width||c.clientWidth||c.offsetWidth,a*=b.contentScaleFactor),a}},{key:"mediaHeight",get:function(){var a=void 0,c=this.media;return c&&(a=c.height||c.clientHeight||c.offsetHeight,a*=b.contentScaleFactor),a}}],[{key:"isLevelAllowed",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return b.indexOf(a)===-1}},{key:"getMaxLevelByMediaSize",value:function(a,b,c){if(!a||a&&!a.length)return-1;for(var d=function(a,b){return!b||(a.width!==b.width||a.height!==b.height)},e=a.length-1,f=0;f<a.length;f+=1){var g=a[f];if((g.width>=b||g.height>=c)&&d(g,a[f+1])){e=f;break}}return e}},{key:"contentScaleFactor",get:function(){var a=1;try{a=window.devicePixelRatio}catch(b){}return a}}]),b}(l["default"]);c["default"]=m},{34:34,35:35}],10:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(35),j=d(i),k=a(34),l=d(k),m=a(54),n=function(a){function b(a){return e(this,b),f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,j["default"].MEDIA_ATTACHING))}return g(b,a),h(b,[{key:"destroy",value:function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1}},{key:"onMediaAttaching",value:function(a){var b=this.hls.config;if(b.capLevelOnFPSDrop){var c=this.video=a.media instanceof HTMLVideoElement?a.media:null;"function"==typeof c.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),b.fpsDroppedMonitoringPeriod)}}},{key:"checkFPS",value:function(a,b,c){var d=performance.now();if(b){if(this.lastTime){var e=d-this.lastTime,f=c-this.lastDroppedFrames,g=b-this.lastDecodedFrames,h=1e3*f/e,i=this.hls;if(i.trigger(j["default"].FPS_DROP,{currentDropped:f,currentDecoded:g,totalDroppedFrames:c}),h>0&&f>i.config.fpsDroppedMonitoringThreshold*g){var k=i.currentLevel;m.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+k),k>0&&(i.autoLevelCapping===-1||i.autoLevelCapping>=k)&&(k-=1,i.trigger(j["default"].FPS_DROP_LEVEL_CAPPING,{level:k,droppedLevel:i.currentLevel}),i.autoLevelCapping=k,i.streamController.nextLevelSwitch())}}this.lastTime=d,this.lastDroppedFrames=c,this.lastDecodedFrames=b}}},{key:"checkFPSInterval",value:function(){var a=this.video;if(a)if(this.isVideoPlaybackQualityAvailable){var b=a.getVideoPlaybackQuality();this.checkFPS(a,b.totalVideoFrames,b.droppedVideoFrames)}else this.checkFPS(a,a.webkitDecodedFrameCount,a.webkitDroppedFrameCount)}}]),b}(l["default"]);c["default"]=n},{34:34,35:35,54:54}],11:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(35),j=d(i),k=a(34),l=d(k),m=a(27),n=d(m),o=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,j["default"].MEDIA_ATTACHED,j["default"].MEDIA_DETACHING,j["default"].FRAG_PARSING_METADATA));return c.id3Track=void 0,c.media=void 0,c}return g(b,a),h(b,[{key:"destroy",value:function(){l["default"].prototype.destroy.call(this)}},{key:"onMediaAttached",value:function(a){this.media=a.media,this.media&&(this.id3Track=this.media.addTextTrack("metadata","id3"),this.id3Track.mode="hidden")}},{key:"onMediaDetaching",value:function(){this.media=void 0}},{key:"onFragParsingMetadata",value:function(a){for(var b=a.frag,c=a.samples,d=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,e=0;e<c.length;e++){var f=n["default"].getID3Frames(c[e].data);if(f){var g=c[e].pts,h=e<c.length-1?c[e+1].pts:b.endPTS;g===h&&(h+=1e-4);for(var i=0;i<f.length;i++){var j=f[i];if(!n["default"].isTimeStampFrame(j)){var k=new d(g,h,"");k.value=j,this.id3Track.addCue(k)}}}}}}]),b}(l["default"]);c["default"]=o},{27:27,34:34,35:35}],12:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(35),j=d(i),k=a(34),l=d(k),m=a(54),n=a(33),o=a(37),p=d(o),q=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,j["default"].MANIFEST_LOADED,j["default"].LEVEL_LOADED,j["default"].FRAG_LOADED,j["default"].ERROR));return c.ontick=c.tick.bind(c),c._manualLevel=-1,c}return g(b,a),h(b,[{key:"destroy",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this._manualLevel=-1}},{key:"startLoad",value:function(){this.canload=!0;var a=this._levels;a&&a.forEach(function(a){a.loadError=0;var b=a.details;b&&b.live&&(a.details=void 0)}),this.timer&&this.tick()}},{key:"stopLoad",value:function(){this.canload=!1}},{key:"onManifestLoaded",value:function(a){var b,c=[],d=[],e={},f=!1,g=!1,h=this.hls,i=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),k=function(a,b){return MediaSource.isTypeSupported(a+"/mp4;codecs="+b)};if(a.levels.forEach(function(a){a.videoCodec&&(f=!0),i&&a.audioCodec&&a.audioCodec.indexOf("mp4a.40.34")!==-1&&(a.audioCodec=void 0),(a.audioCodec||a.attrs&&a.attrs.AUDIO)&&(g=!0);var b=e[a.bitrate];void 0===b?(e[a.bitrate]=c.length,a.url=[a.url],a.urlId=0,c.push(a)):c[b].url.push(a.url)}),f&&g?c.forEach(function(a){a.videoCodec&&d.push(a)}):d=c,d=d.filter(function(a){var b=a.audioCodec,c=a.videoCodec;return(!b||k("audio",b))&&(!c||k("video",c))}),d.length){b=d[0].bitrate,d.sort(function(a,b){return a.bitrate-b.bitrate}),this._levels=d;for(var l=0;l<d.length;l++)if(d[l].bitrate===b){this._firstLevel=l,m.logger.log("manifest loaded,"+d.length+" level(s) found, first bitrate:"+b);break}h.trigger(j["default"].MANIFEST_PARSED,{levels:d,firstLevel:this._firstLevel,stats:a.stats,audio:g,video:f,altAudio:a.audioTracks.length>0})}else h.trigger(j["default"].ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:h.url,reason:"no level with compatible codecs found in manifest"})}},{key:"setLevelInternal",value:function(a){var b=this._levels,c=this.hls;if(a>=0&&a<b.length){if(this.timer&&(clearTimeout(this.timer),this.timer=null),this._level!==a){m.logger.log("switching to level "+a),this._level=a;var d=b[a];d.level=a,c.trigger(j["default"].LEVEL_SWITCH,d),c.trigger(j["default"].LEVEL_SWITCHING,d)}var e=b[a],f=e.details;if(!f||f.live===!0){var g=e.urlId;c.trigger(j["default"].LEVEL_LOADING,{url:e.url[g],level:a,id:g})}}else c.trigger(j["default"].ERROR,{type:n.ErrorTypes.OTHER_ERROR,details:n.ErrorDetails.LEVEL_SWITCH_ERROR,
level:a,fatal:!1,reason:"invalid level idx"})}},{key:"onError",value:function(a){if(!a.fatal){var b=a.details,c=this.hls,d=void 0,e=void 0,f=!1;switch(b){case n.ErrorDetails.FRAG_LOAD_ERROR:case n.ErrorDetails.FRAG_LOAD_TIMEOUT:case n.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case n.ErrorDetails.KEY_LOAD_ERROR:case n.ErrorDetails.KEY_LOAD_TIMEOUT:d=a.frag.level;break;case n.ErrorDetails.LEVEL_LOAD_ERROR:case n.ErrorDetails.LEVEL_LOAD_TIMEOUT:d=a.context.level,f=!0;break;case n.ErrorDetails.REMUX_ALLOC_ERROR:d=a.level}if(void 0!==d){e=this._levels[d],e.loadError?e.loadError++:e.loadError=1;var g=e.url.length;if(g>1&&e.loadError<g)e.urlId=(e.urlId+1)%g,e.details=void 0,m.logger.warn("level controller,"+b+" for level "+d+": switching to redundant stream id "+e.urlId);else{var h=this._manualLevel===-1&&d;if(h)m.logger.warn("level controller,"+b+": switch-down for next fragment"),c.nextAutoLevel=Math.max(0,d-1);else if(e&&e.details&&e.details.live)m.logger.warn("level controller,"+b+" on live stream, discard"),f&&(this._level=void 0);else if(b===n.ErrorDetails.LEVEL_LOAD_ERROR||b===n.ErrorDetails.LEVEL_LOAD_TIMEOUT){var i=c.media,j=i&&p["default"].isBuffered(i,i.currentTime)&&p["default"].isBuffered(i,i.currentTime+.5);if(j){var k=c.config.levelLoadingRetryDelay;m.logger.warn("level controller,"+b+", but media buffered, retry in "+k+"ms"),this.timer=setTimeout(this.ontick,k),a.levelRetry=!0}else m.logger.error("cannot recover "+b+" error"),this._level=void 0,this.timer&&(clearTimeout(this.timer),this.timer=null),a.fatal=!0}}}}}},{key:"onFragLoaded",value:function(a){var b=a.frag;if(b&&"main"===b.type){var c=this._levels[b.level];c&&(c.loadError=0)}}},{key:"onLevelLoaded",value:function(a){var b=a.level;if(b===this._level){var c=this._levels[b];c.loadError=0;var d=a.details;if(d.live){var e=1e3*(d.averagetargetduration?d.averagetargetduration:d.targetduration),f=c.details;f&&d.endSN===f.endSN&&(e/=2,m.logger.log("same live playlist, reload twice faster")),e-=performance.now()-a.stats.trequest,e=Math.max(1e3,Math.round(e)),m.logger.log("live playlist, reload in "+e+" ms"),this.timer=setTimeout(this.ontick,e)}else this.timer=null}}},{key:"tick",value:function(){var a=this._level;if(void 0!==a&&this.canload){var b=this._levels[a];if(b&&b.url){var c=b.urlId;this.hls.trigger(j["default"].LEVEL_LOADING,{url:b.url[c],level:a,id:c})}}}},{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this._level},set:function(a){var b=this._levels;b&&b.length>a&&(this._level===a&&void 0!==b[a].details||this.setLevelInternal(a))}},{key:"manualLevel",get:function(){return this._manualLevel},set:function(a){this._manualLevel=a,void 0===this._startLevel&&(this._startLevel=a),a!==-1&&(this.level=a)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(a){this._firstLevel=a}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var a=this.hls.config.startLevel;return void 0!==a?a:this._firstLevel}return this._startLevel},set:function(a){this._startLevel=a}},{key:"nextLoadLevel",get:function(){return this._manualLevel!==-1?this._manualLevel:this.hls.nextAutoLevel},set:function(a){this.level=a,this._manualLevel===-1&&(this.hls.nextAutoLevel=a)}}]),b}(l["default"]);c["default"]=q},{33:33,34:34,35:35,37:37,54:54}],13:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(48),j=d(i),k=a(37),l=d(k),m=a(25),n=d(m),o=a(35),p=d(o),q=a(34),r=d(q),s=a(38),t=d(s),u=a(55),v=d(u),w=a(33),x=a(54),y={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_LEVEL:"WAITING_LEVEL",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR"},z=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,p["default"].MEDIA_ATTACHED,p["default"].MEDIA_DETACHING,p["default"].MANIFEST_LOADING,p["default"].MANIFEST_PARSED,p["default"].LEVEL_LOADED,p["default"].KEY_LOADED,p["default"].FRAG_LOADED,p["default"].FRAG_LOAD_EMERGENCY_ABORTED,p["default"].FRAG_PARSING_INIT_SEGMENT,p["default"].FRAG_PARSING_DATA,p["default"].FRAG_PARSED,p["default"].ERROR,p["default"].AUDIO_TRACK_SWITCHING,p["default"].AUDIO_TRACK_SWITCHED,p["default"].BUFFER_CREATED,p["default"].BUFFER_APPENDED,p["default"].BUFFER_FLUSHED));return c.config=a.config,c.audioCodecSwap=!1,c.ticks=0,c._state=y.STOPPED,c.ontick=c.tick.bind(c),c}return g(b,a),h(b,[{key:"destroy",value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),r["default"].prototype.destroy.call(this),this.state=y.STOPPED}},{key:"startLoad",value:function(a){if(this.levels){var b=this.lastCurrentTime,c=this.hls;if(this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var d=c.startLevel;d===-1&&(d=0,this.bitrateTest=!0),this.level=c.nextLoadLevel=d,this.loadedmetadata=!1}b>0&&a===-1&&(x.logger.log("override startPosition with lastCurrentTime @"+b.toFixed(3)),a=b),this.state=y.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=a,this.tick()}else this.forceStartLoad=!0,this.state=y.STOPPED}},{key:"stopLoad",value:function(){var a=this.fragCurrent;a&&(a.loader&&a.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=y.STOPPED,this.forceStartLoad=!1}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){switch(this.state){case y.ERROR:break;case y.BUFFER_FLUSHING:this.fragLoadError=0;break;case y.IDLE:this._doTickIdle();break;case y.WAITING_LEVEL:var a=this.levels[this.level];a&&a.details&&(this.state=y.IDLE);break;case y.FRAG_LOADING_WAITING_RETRY:var b=performance.now(),c=this.retryDate;(!c||b>=c||this.media&&this.media.seeking)&&(x.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=y.IDLE);break;case y.ERROR:case y.STOPPED:case y.FRAG_LOADING:case y.PARSING:case y.PARSED:case y.ENDED:}this._checkBuffer(),this._checkFragmentChanged()}},{key:"_doTickIdle",value:function(){var a=this.hls,b=a.config,c=this.media;if(void 0===this.levelLastLoaded||c||!this.startFragRequested&&b.startFragPrefetch){var d=void 0;d=this.loadedmetadata?c.currentTime:this.nextLoadPosition;var e=a.nextLoadLevel,f=this.levels[e];if(f){var g=f.bitrate,h=void 0;h=g?Math.max(8*b.maxBufferSize/g,b.maxBufferLength):b.maxBufferLength,h=Math.min(h,b.maxMaxBufferLength);var i=l["default"].bufferInfo(this.mediaBuffer?this.mediaBuffer:c,d,b.maxBufferHole),j=i.len;if(!(j>=h)){x.logger.trace("buffer length of "+j.toFixed(3)+" is below max of "+h.toFixed(3)+". checking for more payload ..."),this.level=a.nextLoadLevel=e;var k=f.details;if("undefined"==typeof k||k.live&&this.levelLastLoaded!==e)return void(this.state=y.WAITING_LEVEL);var m=this.fragPrevious;if(!k.live&&m&&m.sn===k.endSN&&j&&!i.nextStart){var n=Math.min(c.duration,m.start+m.duration);if(n-Math.max(i.end,m.start)<=Math.max(.2,m.duration)){var o={};return this.altAudio&&(o.type="video"),this.hls.trigger(p["default"].BUFFER_EOS,o),void(this.state=y.ENDED)}}this._fetchPayloadOrEos(d,i,k)}}}}},{key:"_fetchPayloadOrEos",value:function(a,b,c){var d=this.fragPrevious,e=this.level,f=c.fragments,g=f.length;if(0!==g){var h=f[0].start,i=f[g-1].start+f[g-1].duration,j=b.end,k=void 0;if(c.initSegment&&!c.initSegment.data)k=c.initSegment;else if(c.live){var l=this.config.initialLiveManifestSize;if(g<l)return void x.logger.warn("Can not start playback of a level, reason: not enough fragments "+g+" < "+l);if(k=this._ensureFragmentAtLivePoint(c,j,h,i,d,f,g),null===k)return}else j<h&&(k=f[0]);k||(k=this._findFragment(h,d,g,f,j,i,c)),k&&this._loadFragmentOrKey(k,e,c,a,j)}}},{key:"_ensureFragmentAtLivePoint",value:function(a,b,c,d,e,f,g){var h=this.hls.config,i=this.media,j=void 0,k=void 0!==h.liveMaxLatencyDuration?h.liveMaxLatencyDuration:h.liveMaxLatencyDurationCount*a.targetduration;if(b<Math.max(c-h.maxFragLookUpTolerance,d-k)){var l=this.liveSyncPosition=this.computeLivePosition(c,a);x.logger.log("buffer end: "+b.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+l.toFixed(3)),b=l,i&&i.readyState&&i.duration>l&&(i.currentTime=l),this.nextLoadPosition=l}if(a.PTSKnown&&b>d&&i&&i.readyState)return null;if(this.startFragRequested&&!a.PTSKnown){if(e){var m=e.sn+1;m>=a.startSN&&m<=a.endSN&&(j=f[m-a.startSN],x.logger.log("live playlist, switching playlist, load frag with next SN: "+j.sn))}j||(j=f[Math.min(g-1,Math.round(g/2))],x.logger.log("live playlist, switching playlist, unknown, load middle frag : "+j.sn))}return j}},{key:"_findFragment",value:function(a,b,c,d,e,f,g){var h=this.hls.config,i=void 0,k=void 0,l=h.maxFragLookUpTolerance,m=b?d[b.sn-d[0].sn+1]:void 0,n=function(a){var b=Math.min(l,a.duration);return a.start+a.duration-b<=e?1:a.start-b>e&&a.start?-1:0};if(e<f?(e>f-l&&(l=0),k=m&&!n(m)?m:j["default"].search(d,n)):k=d[c-1],k){i=k;var o=i.sn-g.startSN,p=b&&i.level===b.level,q=d[o-1],r=d[o+1];if(b&&i.sn===b.sn)if(p&&!i.backtracked)if(i.sn<g.endSN){var s=b.deltaPTS;s&&s>h.maxBufferHole&&b.dropped&&o?(i=q,x.logger.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this"),b.loadCounter--):(i=r,x.logger.log("SN just loaded, load next one: "+i.sn))}else i=null;else i.backtracked&&(r&&r.backtracked?(x.logger.warn("Already backtracked from fragment "+r.sn+", will not backtrack to fragment "+i.sn+". Loading fragment "+r.sn),i=r):(x.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),i.dropped=0,q?(q.loadCounter&&q.loadCounter--,i=q,i.backtracked=!0):o&&(i=null)))}return i}},{key:"_loadFragmentOrKey",value:function(a,b,c,d,e){var f=this.hls,g=f.config;if(!a.decryptdata||null==a.decryptdata.uri||null!=a.decryptdata.key){if(x.logger.log("Loading "+a.sn+" of ["+c.startSN+" ,"+c.endSN+"],level "+b+", currentTime:"+d.toFixed(3)+",bufferEnd:"+e.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,a.loadCounter){a.loadCounter++;var h=g.fragLoadingLoopThreshold;if(a.loadCounter>h&&Math.abs(this.fragLoadIdx-a.loadIdx)<h)return void f.trigger(p["default"].ERROR,{type:w.ErrorTypes.MEDIA_ERROR,details:w.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:a})}else a.loadCounter=1;return a.loadIdx=this.fragLoadIdx,this.fragCurrent=a,this.startFragRequested=!0,isNaN(a.sn)||(this.nextLoadPosition=a.start+a.duration),a.autoLevel=f.autoLevelEnabled,a.bitrateTest=this.bitrateTest,f.trigger(p["default"].FRAG_LOADING,{frag:a}),this.demuxer||(this.demuxer=new n["default"](f,"main")),void(this.state=y.FRAG_LOADING)}x.logger.log("Loading key for "+a.sn+" of ["+c.startSN+" ,"+c.endSN+"],level "+b),this.state=y.KEY_LOADING,f.trigger(p["default"].KEY_LOADING,{frag:a})}},{key:"getBufferedFrag",value:function(a){return j["default"].search(this._bufferedFrags,function(b){return a<b.startPTS?-1:a>b.endPTS?1:0})}},{key:"followingBufferedFrag",value:function(a){return a?this.getBufferedFrag(a.endPTS+.5):null}},{key:"_checkFragmentChanged",value:function(){var a,b,c=this.media;if(c&&c.readyState&&c.seeking===!1&&(b=c.currentTime,b>1*this.lastCurrentTime&&(this.lastCurrentTime=b),l["default"].isBuffered(c,b)?a=this.getBufferedFrag(b):l["default"].isBuffered(c,b+.1)&&(a=this.getBufferedFrag(b+.1)),a)){var d=a;if(d!==this.fragPlaying){this.hls.trigger(p["default"].FRAG_CHANGED,{frag:d});var e=d.level;this.fragPlaying&&this.fragPlaying.level===e||this.hls.trigger(p["default"].LEVEL_SWITCHED,{level:e}),this.fragPlaying=d}}}},{key:"immediateLevelSwitch",value:function(){if(x.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var a=this.media,b=void 0;a?(b=a.paused,a.pause()):b=!0,this.previouslyPaused=b}var c=this.fragCurrent;c&&c.loader&&c.loader.abort(),this.fragCurrent=null,this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}},{key:"immediateLevelSwitchEnd",value:function(){var a=this.media;a&&a.buffered.length&&(this.immediateSwitch=!1,l["default"].isBuffered(a,a.currentTime)&&(a.currentTime-=1e-4),this.previouslyPaused||a.play())}},{key:"nextLevelSwitch",value:function(){var a=this.media;if(a&&a.readyState){var b=void 0,c=void 0,d=void 0;if(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,c=this.getBufferedFrag(a.currentTime),c&&c.startPTS>1&&this.flushMainBuffer(0,c.startPTS-1),a.paused)b=0;else{var e=this.hls.nextLoadLevel,f=this.levels[e],g=this.fragLastKbps;b=g&&this.fragCurrent?this.fragCurrent.duration*f.bitrate/(1e3*g)+1:0}if(d=this.getBufferedFrag(a.currentTime+b),d&&(d=this.followingBufferedFrag(d))){var h=this.fragCurrent;h&&h.loader&&h.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(d.maxStartPTS,Number.POSITIVE_INFINITY)}}}},{key:"flushMainBuffer",value:function(a,b){this.state=y.BUFFER_FLUSHING;var c={startOffset:a,endOffset:b};this.altAudio&&(c.type="video"),this.hls.trigger(p["default"].BUFFER_FLUSHING,c)}},{key:"onMediaAttached",value:function(a){var b=this.media=this.mediaBuffer=a.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),b.addEventListener("seeking",this.onvseeking),b.addEventListener("seeked",this.onvseeked),b.addEventListener("ended",this.onvended);var c=this.config;this.levels&&c.autoStartLoad&&this.hls.startLoad(c.startPosition)}},{key:"onMediaDetaching",value:function(){var a=this.media;a&&a.ended&&(x.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var b=this.levels;b&&b.forEach(function(a){a.details&&a.details.fragments.forEach(function(a){a.loadCounter=void 0,a.backtracked=void 0})}),a&&(a.removeEventListener("seeking",this.onvseeking),a.removeEventListener("seeked",this.onvseeked),a.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()}},{key:"onMediaSeeking",value:function(){var a=this.media,b=a?a.currentTime:void 0,c=this.config;isNaN(b)||x.logger.log("media seeking to "+b.toFixed(3));var d=this.mediaBuffer?this.mediaBuffer:a,e=l["default"].bufferInfo(d,b,this.config.maxBufferHole);if(this.state===y.FRAG_LOADING){var f=this.fragCurrent;if(0===e.len&&f){var g=c.maxFragLookUpTolerance,h=f.start-g,i=f.start+f.duration+g;b<h||b>i?(f.loader&&(x.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),f.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=y.IDLE):x.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else this.state===y.ENDED&&(0===e.len&&(this.fragPrevious=0),this.state=y.IDLE);a&&(this.lastCurrentTime=b),this.state!==y.FRAG_LOADING&&void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*c.fragLoadingLoopThreshold),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=b),this.tick()}},{key:"onMediaSeeked",value:function(){var a=this.media,b=a?a.currentTime:void 0;isNaN(b)||x.logger.log("media seeked to "+b.toFixed(3)),this.tick()}},{key:"onMediaEnded",value:function(){x.logger.log("media ended"),this.startPosition=this.lastCurrentTime=0}},{key:"onManifestLoading",value:function(){x.logger.log("trigger BUFFER_RESET"),this.hls.trigger(p["default"].BUFFER_RESET),this._bufferedFrags=[],this.stalled=!1,this.startPosition=this.lastCurrentTime=0}},{key:"onManifestParsed",value:function(a){var b,c=!1,d=!1;a.levels.forEach(function(a){b=a.audioCodec,b&&(b.indexOf("mp4a.40.2")!==-1&&(c=!0),b.indexOf("mp4a.40.5")!==-1&&(d=!0))}),this.audioCodecSwitch=c&&d,this.audioCodecSwitch&&x.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=a.levels,this.startLevelLoaded=!1,this.startFragRequested=!1;var e=this.config;(e.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(e.startPosition)}},{key:"onLevelLoaded",value:function(a){var b=a.details,c=a.level,d=this.levels[c],e=b.totalduration,f=0;if(x.logger.log("level "+c+" loaded ["+b.startSN+","+b.endSN+"],duration:"+e),this.levelLastLoaded=c,b.live){var g=d.details;g&&b.fragments.length>0?(t["default"].mergeDetails(g,b),f=b.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(f,g),b.PTSKnown?x.logger.log("live playlist sliding:"+f.toFixed(3)):x.logger.log("live playlist - outdated PTS, unknown sliding")):(b.PTSKnown=!1,x.logger.log("live playlist - first load, unknown sliding"))}else b.PTSKnown=!1;if(d.details=b,this.hls.trigger(p["default"].LEVEL_UPDATED,{details:b,level:c}),this.startFragRequested===!1){if(this.startPosition===-1||this.lastCurrentTime===-1){var h=b.startTimeOffset;isNaN(h)?b.live?(this.startPosition=this.computeLivePosition(f,b),x.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0:(h<0&&(x.logger.log("negative start time offset "+h+", count from end of last fragment"),h=f+e+h),x.logger.log("start time offset found in playlist, adjust startPosition to "+h),this.startPosition=h),this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===y.WAITING_LEVEL&&(this.state=y.IDLE),this.tick()}},{key:"onKeyLoaded",value:function(){this.state===y.KEY_LOADING&&(this.state=y.IDLE,this.tick())}},{key:"onFragLoaded",value:function(a){var b=this.fragCurrent,c=a.frag;if(this.state===y.FRAG_LOADING&&b&&"main"===c.type&&c.level===b.level&&c.sn===b.sn){var d=a.stats,e=this.levels[b.level],f=e.details;if(x.logger.log("Loaded  "+b.sn+" of ["+f.startSN+" ,"+f.endSN+"],level "+b.level),this.bitrateTest=!1,this.stats=d,c.bitrateTest===!0&&this.hls.nextLoadLevel)this.state=y.IDLE,this.startFragRequested=!1,d.tparsed=d.tbuffered=performance.now(),this.hls.trigger(p["default"].FRAG_BUFFERED,{stats:d,frag:b,id:"main"}),this.tick();else if("initSegment"===c.sn)this.state=y.IDLE,d.tparsed=d.tbuffered=performance.now(),f.initSegment.data=a.payload,this.hls.trigger(p["default"].FRAG_BUFFERED,{stats:d,frag:b,id:"main"}),this.tick();else{this.state=y.PARSING;var g=f.totalduration,h=b.level,i=b.sn,j=this.config.defaultAudioCodec||e.audioCodec;this.audioCodecSwap&&(x.logger.log("swapping playlist audio codec"),void 0===j&&(j=this.lastAudioCodec),j&&(j=j.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5")),this.pendingBuffering=!0,this.appended=!1,x.logger.log("Parsing "+i+" of ["+f.startSN+" ,"+f.endSN+"],level "+h+", cc "+b.cc);var k=this.demuxer;k||(k=this.demuxer=new n["default"](this.hls,"main"));var l=this.media,m=l&&l.seeking,o=!m&&(f.PTSKnown||!f.live),q=f.initSegment?f.initSegment.data:[];k.push(a.payload,q,j,e.videoCodec,b,g,o,void 0)}}this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function(a){var b=this.fragCurrent,c=a.frag;if(b&&"main"===a.id&&c.sn===b.sn&&c.level===b.level&&this.state===y.PARSING){var d,e,f=a.tracks;if(f.audio&&this.altAudio&&delete f.audio,e=f.audio){var g=this.levels[this.level].audioCodec,h=navigator.userAgent.toLowerCase();g&&this.audioCodecSwap&&(x.logger.log("swapping playlist audio codec"),g=g.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==e.metadata.channelCount&&h.indexOf("firefox")===-1&&(g="mp4a.40.5"),h.indexOf("android")!==-1&&"audio/mpeg"!==e.container&&(g="mp4a.40.2",x.logger.log("Android: force audio codec to "+g)),e.levelCodec=g,e.id=a.id}e=f.video,e&&(e.levelCodec=this.levels[this.level].videoCodec,e.id=a.id),this.hls.trigger(p["default"].BUFFER_CODECS,f);for(d in f){e=f[d],x.logger.log("main track:"+d+",container:"+e.container+",codecs[level/parsed]=["+e.levelCodec+"/"+e.codec+"]");var i=e.initSegment;i&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(p["default"].BUFFER_APPENDING,{type:d,data:i,parent:"main",content:"initSegment"}))}this.tick()}}},{key:"onFragParsingData",value:function(a){var b=this,c=this.fragCurrent,d=a.frag;if(c&&"main"===a.id&&d.sn===c.sn&&d.level===c.level&&("audio"!==a.type||!this.altAudio)&&this.state===y.PARSING){var e=this.levels[this.level],f=c;if(isNaN(a.endPTS)&&(a.endPTS=a.startPTS+c.duration,a.endDTS=a.startDTS+c.duration),x.logger.log("Parsed "+a.type+",PTS:["+a.startPTS.toFixed(3)+","+a.endPTS.toFixed(3)+"],DTS:["+a.startDTS.toFixed(3)+"/"+a.endDTS.toFixed(3)+"],nb:"+a.nb+",dropped:"+(a.dropped||0)),"video"===a.type)if(f.dropped=a.dropped,f.dropped){if(!f.backtracked)return x.logger.warn("missing video frame(s), backtracking fragment"),f.backtracked=!0,this.nextLoadPosition=a.startPTS,this.state=y.IDLE,this.fragPrevious=f,void this.tick();x.logger.warn("Already backtracked on this fragment, appending with the gap")}else f.backtracked=!1;var g=t["default"].updateFragPTSDTS(e.details,f,a.startPTS,a.endPTS,a.startDTS,a.endDTS),h=this.hls;h.trigger(p["default"].LEVEL_PTS_UPDATED,{details:e.details,level:this.level,drift:g,type:a.type,start:a.startPTS,end:a.endPTS}),[a.data1,a.data2].forEach(function(c){c&&c.length&&b.state===y.PARSING&&(b.appended=!0,b.pendingBuffering=!0,h.trigger(p["default"].BUFFER_APPENDING,{type:a.type,data:c,parent:"main",content:"data"}))}),this.tick()}}},{key:"onFragParsed",value:function(a){var b=this.fragCurrent,c=a.frag;b&&"main"===a.id&&c.sn===b.sn&&c.level===b.level&&this.state===y.PARSING&&(this.stats.tparsed=performance.now(),this.state=y.PARSED,this._checkAppendedParsed())}},{key:"onAudioTrackSwitching",value:function(a){var b=!!a.url,c=a.id;if(!b){if(this.mediaBuffer!==this.media){x.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var d=this.fragCurrent;d.loader&&(x.logger.log("switching to main audio track, cancel main fragment load"),d.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=y.IDLE}var e=this.hls;e.trigger(p["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),e.trigger(p["default"].AUDIO_TRACK_SWITCHED,{id:c}),this.altAudio=!1}}},{key:"onAudioTrackSwitched",value:function(a){var b=a.id,c=!!this.hls.audioTracks[b].url;if(c){var d=this.videoBuffer;d&&this.mediaBuffer!==d&&(x.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=d)}this.altAudio=c,this.tick()}},{key:"onBufferCreated",value:function(a){var b=a.tracks,c=void 0,d=void 0,e=!1;for(var f in b){var g=b[f];"main"===g.id?(d=f,c=g,"video"===f&&(this.videoBuffer=b[f].buffer)):e=!0}e&&c?(x.logger.log("alternate track found, use "+d+".buffered to schedule main fragment loading"),this.mediaBuffer=c.buffer):this.mediaBuffer=this.media}},{key:"onBufferAppended",value:function(a){if("main"===a.parent){var b=this.state;b!==y.PARSING&&b!==y.PARSED||(this.pendingBuffering=a.pending>0,this._checkAppendedParsed())}}},{key:"_checkAppendedParsed",value:function(){if(!(this.state!==y.PARSED||this.appended&&this.pendingBuffering)){var a=this.fragCurrent;if(a){var b=this.mediaBuffer?this.mediaBuffer:this.media;x.logger.log("main buffered : "+v["default"].toString(b.buffered));var c=this._bufferedFrags.filter(function(a){return l["default"].isBuffered(b,(a.startPTS+a.endPTS)/2)});c.push(a),this._bufferedFrags=c.sort(function(a,b){return a.startPTS-b.startPTS}),this.fragPrevious=a;var d=this.stats;d.tbuffered=performance.now(),this.fragLastKbps=Math.round(8*d.total/(d.tbuffered-d.tfirst)),this.hls.trigger(p["default"].FRAG_BUFFERED,{stats:d,frag:a,id:"main"}),this.state=y.IDLE}this.tick()}}},{key:"onError",value:function(a){var b=a.frag||this.fragCurrent;if(!b||"main"===b.type){var c=this.media,d=c&&l["default"].isBuffered(c,c.currentTime)&&l["default"].isBuffered(c,c.currentTime+.5);switch(a.details){case w.ErrorDetails.FRAG_LOAD_ERROR:case w.ErrorDetails.FRAG_LOAD_TIMEOUT:case w.ErrorDetails.KEY_LOAD_ERROR:case w.ErrorDetails.KEY_LOAD_TIMEOUT:if(!a.fatal){var e=this.fragLoadError;e?e++:e=1;var f=this.config;if(e<=f.fragLoadingMaxRetry||d||b.autoLevel&&b.level){this.fragLoadError=e,b.loadCounter=0;var g=Math.min(Math.pow(2,e-1)*f.fragLoadingRetryDelay,f.fragLoadingMaxRetryTimeout);x.logger.warn("mediaController: frag loading failed, retry in "+g+" ms"),this.retryDate=performance.now()+g,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.state=y.FRAG_LOADING_WAITING_RETRY}else x.logger.error("mediaController: "+a.details+" reaches max retry, redispatch as fatal ..."),a.fatal=!0,this.state=y.ERROR}break;case w.ErrorDetails.FRAG_LOOP_LOADING_ERROR:a.fatal||(d?(this._reduceMaxBufferLength(b.duration),this.state=y.IDLE):b.autoLevel&&0!==b.level||(a.fatal=!0,this.state=y.ERROR));break;case w.ErrorDetails.LEVEL_LOAD_ERROR:case w.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==y.ERROR&&(a.fatal?(this.state=y.ERROR,x.logger.warn("streamController: "+a.details+",switch to "+this.state+" state ...")):a.levelRetry||this.state!==y.WAITING_LEVEL||(this.state=y.IDLE));break;case w.ErrorDetails.BUFFER_FULL_ERROR:"main"!==a.parent||this.state!==y.PARSING&&this.state!==y.PARSED||(d?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=y.IDLE):(x.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}}},{key:"_reduceMaxBufferLength",value:function(a){var b=this.config;b.maxMaxBufferLength>=a&&(b.maxMaxBufferLength/=2,x.logger.warn("main:reduce max buffer length to "+b.maxMaxBufferLength+"s"),this.fragLoadIdx+=2*b.fragLoadingLoopThreshold)}},{key:"_checkBuffer",value:function(){var a=this.media,b=this.config;if(a&&a.readyState){var c=a.currentTime,d=this.mediaBuffer?this.mediaBuffer:a,e=d.buffered;if(!this.loadedmetadata&&e.length){this.loadedmetadata=!0;var f=a.seeking?c:this.startPosition,g=l["default"].isBuffered(d,f),h=e.start(0);(c!==f||!g&&Math.abs(f-h)<b.maxSeekHole)&&(x.logger.log("target start position:"+f),g||x.logger.log("target start position not buffered, seek to buffered.start(0) "+f),x.logger.log("adjust currentTime from "+c+" to "+f),a.currentTime=f)}else if(this.immediateSwitch)this.immediateLevelSwitchEnd();else{var i=l["default"].bufferInfo(a,c,0),j=!(a.paused||a.ended||0===a.buffered.length),k=.5,m=c!==this.lastCurrentTime;if(m)this.stallReported&&(x.logger.warn("playback not stuck anymore @"+c+", after "+Math.round(performance.now()-this.stalled)+"ms"),this.stallReported=!1),this.stalled=void 0,this.nudgeRetry=0;else if(j){var n=performance.now(),o=this.hls;if(this.stalled){var q=n-this.stalled,r=i.len,s=this.nudgeRetry||0;if(r<=k&&q>1e3*b.lowBufferWatchdogPeriod){this.stallReported||(this.stallReported=!0,x.logger.warn("playback stalling in low buffer @"+c),o.trigger(p["default"].ERROR,{type:w.ErrorTypes.MEDIA_ERROR,details:w.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:r}));var t=i.nextStart,u=t-c;if(t&&u<b.maxSeekHole&&u>0){this.nudgeRetry=++s;var v=s*b.nudgeOffset;x.logger.log("adjust currentTime from "+a.currentTime+" to next buffered @ "+t+" + nudge "+v),a.currentTime=t+v,this.stalled=void 0,o.trigger(p["default"].ERROR,{type:w.ErrorTypes.MEDIA_ERROR,details:w.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,hole:t+v-c})}}else if(r>k&&q>1e3*b.highBufferWatchdogPeriod)if(this.stallReported||(this.stallReported=!0,x.logger.warn("playback stalling in high buffer @"+c),o.trigger(p["default"].ERROR,{type:w.ErrorTypes.MEDIA_ERROR,details:w.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:r})),this.stalled=void 0,this.nudgeRetry=++s,s<b.nudgeMaxRetry){var y=a.currentTime,z=y+s*b.nudgeOffset;x.logger.log("adjust currentTime from "+y+" to "+z),a.currentTime=z,o.trigger(p["default"].ERROR,{type:w.ErrorTypes.MEDIA_ERROR,details:w.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else x.logger.error("still stuck in high buffer @"+c+" after "+b.nudgeMaxRetry+", raise fatal error"),o.trigger(p["default"].ERROR,{type:w.ErrorTypes.MEDIA_ERROR,details:w.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}else this.stalled=n,this.stallReported=!1}}}}},{key:"onFragLoadEmergencyAborted",value:function(){this.state=y.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()}},{key:"onBufferFlushed",value:function(){var a=this.mediaBuffer?this.mediaBuffer:this.media;this._bufferedFrags=this._bufferedFrags.filter(function(b){return l["default"].isBuffered(a,(b.startPTS+b.endPTS)/2)}),this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.state=y.IDLE,this.fragPrevious=null}},{key:"swapAudioCodec",value:function(){this.audioCodecSwap=!this.audioCodecSwap}},{key:"computeLivePosition",value:function(a,b){var c=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*b.targetduration;return a+Math.max(0,b.totalduration-c)}},{key:"state",set:function(a){if(this.state!==a){var b=this.state;this._state=a,x.logger.log("main stream:"+b+"->"+a),this.hls.trigger(p["default"].STREAM_STATE_TRANSITION,{previousState:b,nextState:a})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var a=this.media;if(a){var b=this.getBufferedFrag(a.currentTime);if(b)return b.level}return-1}},{key:"nextBufferedFrag",get:function(){var a=this.media;return a?this.followingBufferedFrag(this.getBufferedFrag(a.currentTime)):null}},{key:"nextLevel",get:function(){var a=this.nextBufferedFrag;return a?a.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(a){this._liveSyncPosition=a}}]),b}(r["default"]);c["default"]=z},{25:25,33:33,34:34,35:35,37:37,38:38,48:48,54:54,55:55}],14:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(35),j=d(i),k=a(34),l=d(k),m=a(54),n=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,j["default"].ERROR,j["default"].SUBTITLE_TRACKS_UPDATED,j["default"].SUBTITLE_TRACK_SWITCH,j["default"].SUBTITLE_TRACK_LOADED,j["default"].SUBTITLE_FRAG_PROCESSED));return c.config=a.config,c.vttFragSNsProcessed={},c.vttFragQueues=void 0,c.currentlyProcessing=null,c.currentTrackId=-1,c}return g(b,a),h(b,[{key:"destroy",
value:function(){l["default"].prototype.destroy.call(this)}},{key:"clearVttFragQueues",value:function(){var a=this;this.vttFragQueues={},this.tracks.forEach(function(b){a.vttFragQueues[b.id]=[]})}},{key:"nextFrag",value:function(){if(null===this.currentlyProcessing&&this.currentTrackId>-1&&this.vttFragQueues[this.currentTrackId].length){var a=this.currentlyProcessing=this.vttFragQueues[this.currentTrackId].shift();this.hls.trigger(j["default"].FRAG_LOADING,{frag:a})}}},{key:"onSubtitleFragProcessed",value:function(a){a.success&&this.vttFragSNsProcessed[a.frag.trackId].push(a.frag.sn),this.currentlyProcessing=null,this.nextFrag()}},{key:"onError",value:function(a){var b=a.frag;b&&"subtitle"!==b.type||this.currentlyProcessing&&(this.currentlyProcessing=null,this.nextFrag())}},{key:"onSubtitleTracksUpdated",value:function(a){var b=this;m.logger.log("subtitle tracks updated"),this.tracks=a.subtitleTracks,this.clearVttFragQueues(),this.vttFragSNsProcessed={},this.tracks.forEach(function(a){b.vttFragSNsProcessed[a.id]=[]})}},{key:"onSubtitleTrackSwitch",value:function(a){this.currentTrackId=a.id,this.clearVttFragQueues()}},{key:"onSubtitleTrackLoaded",value:function(a){var b=this.vttFragSNsProcessed[a.id],c=this.vttFragQueues[a.id],d=this.currentlyProcessing?this.currentlyProcessing.sn:-1,e=function(a){return b.indexOf(a.sn)>-1},f=function(a){return c.some(function(b){return b.sn===a.sn})};a.details.fragments.forEach(function(b){e(b)||b.sn===d||f(b)||(b.trackId=a.id,c.push(b))}),this.nextFrag()}}]),b}(l["default"]);c["default"]=n},{34:34,35:35,54:54}],15:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function h(a){for(var b=[],c=0;c<a.length;c++)"subtitles"===a[c].kind&&b.push(a[c]);return b}Object.defineProperty(c,"__esModule",{value:!0});var i=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),j=a(35),k=d(j),l=a(34),m=d(l),n=a(54),o=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,k["default"].MEDIA_ATTACHED,k["default"].MEDIA_DETACHING,k["default"].MANIFEST_LOADING,k["default"].MANIFEST_LOADED,k["default"].SUBTITLE_TRACK_LOADED));return c.tracks=[],c.trackId=-1,c.media=void 0,c}return g(b,a),i(b,[{key:"_onTextTracksChanged",value:function(){if(this.media){for(var a=-1,b=h(this.media.textTracks),c=0;c<b.length;c++)"showing"===b[c].mode&&(a=c);this.subtitleTrack=a}}},{key:"destroy",value:function(){m["default"].prototype.destroy.call(this)}},{key:"onMediaAttached",value:function(a){this.media=a.media,this.media&&(this.trackChangeListener=this._onTextTracksChanged.bind(this),this.media.textTracks.addEventListener("change",this.trackChangeListener))}},{key:"onMediaDetaching",value:function(){this.media&&(this.media.textTracks.removeEventListener("change",this.trackChangeListener),this.media=void 0)}},{key:"onManifestLoading",value:function(){this.tracks=[],this.trackId=-1}},{key:"onManifestLoaded",value:function(a){var b=this,c=a.subtitles||[],d=!1;this.tracks=c,this.trackId=-1,this.hls.trigger(k["default"].SUBTITLE_TRACKS_UPDATED,{subtitleTracks:c}),c.forEach(function(a){a["default"]&&(b.subtitleTrack=a.id,d=!0)})}},{key:"onTick",value:function(){var a=this.trackId,b=this.tracks[a];if(b){var c=b.details;void 0!==c&&c.live!==!0||(n.logger.log("(re)loading playlist for subtitle track "+a),this.hls.trigger(k["default"].SUBTITLE_TRACK_LOADING,{url:b.url,id:a}))}}},{key:"onSubtitleTrackLoaded",value:function(a){var b=this;a.id<this.tracks.length&&(n.logger.log("subtitle track "+a.id+" loaded"),this.tracks[a.id].details=a.details,a.details.live&&!this.timer&&(this.timer=setInterval(function(){b.onTick()},1e3*a.details.targetduration,this)),!a.details.live&&this.timer&&(clearInterval(this.timer),this.timer=null))}},{key:"setSubtitleTrackInternal",value:function(a){if(a>=0&&a<this.tracks.length){this.timer&&(clearInterval(this.timer),this.timer=null),this.trackId=a,n.logger.log("switching to subtitle track "+a);var b=this.tracks[a];this.hls.trigger(k["default"].SUBTITLE_TRACK_SWITCH,{id:a});var c=b.details;void 0!==c&&c.live!==!0||(n.logger.log("(re)loading playlist for subtitle track "+a),this.hls.trigger(k["default"].SUBTITLE_TRACK_LOADING,{url:b.url,id:a}))}}},{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(a){this.trackId!==a&&this.setSubtitleTrackInternal(a)}}]),b}(m["default"]);c["default"]=o},{34:34,35:35,54:54}],16:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function h(a){if(a&&a.cues)for(;a.cues.length>0;)a.removeCue(a.cues[0])}function i(a,b){return a&&a.label===b.name&&!(a.textTrack1||a.textTrack2)}function j(a,b,c,d){return Math.min(b,d)-Math.max(a,c)}Object.defineProperty(c,"__esModule",{value:!0});var k=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),l=a(35),m=d(l),n=a(34),o=d(n),p=a(49),q=d(p),r=a(58),s=d(r),t=a(54),u=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,m["default"].MEDIA_ATTACHING,m["default"].MEDIA_DETACHING,m["default"].FRAG_PARSING_USERDATA,m["default"].MANIFEST_LOADING,m["default"].MANIFEST_LOADED,m["default"].FRAG_LOADED,m["default"].LEVEL_SWITCHING,m["default"].INIT_PTS_FOUND));if(c.hls=a,c.config=a.config,c.enabled=!0,c.Cues=a.config.cueHandler,c.textTracks=[],c.tracks=[],c.unparsedVttFrags=[],c.initPTS=void 0,c.cueRanges=[],c.config.enableCEA708Captions){var d=c,g=function(a,b){var c=null;try{c=new window.Event("addtrack")}catch(d){c=document.createEvent("Event"),c.initEvent("addtrack",!1,!1)}c.track=a,b.dispatchEvent(c)},i={newCue:function(a,b,c){if(!d.textTrack1){var e=d.getExistingTrack("1");if(e)d.textTrack1=e,h(d.textTrack1),g(d.textTrack1,d.media);else{var f=d.createTextTrack("captions",d.config.captionsTextTrack1Label,d.config.captionsTextTrack1LanguageCode);f&&(f.textTrack1=!0,d.textTrack1=f)}}d.addCues("textTrack1",a,b,c)}},j={newCue:function(a,b,c){if(!d.textTrack2){var e=d.getExistingTrack("2");if(e)d.textTrack2=e,h(d.textTrack2),g(d.textTrack2,d.media);else{var f=d.createTextTrack("captions",d.config.captionsTextTrack2Label,d.config.captionsTextTrack1LanguageCode);f&&(f.textTrack2=!0,d.textTrack2=f)}}d.addCues("textTrack2",a,b,c)}};c.cea608Parser=new q["default"](0,i,j)}return c}return g(b,a),k(b,[{key:"addCues",value:function(a,b,c,d){for(var e=this.cueRanges,f=!1,g=e.length;g--;){var h=e[g],i=j(h[0],h[1],b,c);if(i>=0&&(h[0]=Math.min(h[0],b),h[1]=Math.max(h[1],c),f=!0,i/(c-b)>.5))return}f||e.push([b,c]),this.Cues.newCue(this[a],b,c,d)}},{key:"onInitPtsFound",value:function(a){var b=this;"undefined"==typeof this.initPTS&&(this.initPTS=a.initPTS),this.unparsedVttFrags.length&&(this.unparsedVttFrags.forEach(function(a){b.onFragLoaded(a)}),this.unparsedVttFrags=[])}},{key:"getExistingTrack",value:function(a){var b=this.media;if(b)for(var c=0;c<b.textTracks.length;c++){var d=b.textTracks[c],e="textTrack"+a;if(d[e]===!0)return d}return null}},{key:"createTextTrack",value:function(a,b,c){var d=this.media;if(d)return d.addTextTrack(a,b,c)}},{key:"destroy",value:function(){o["default"].prototype.destroy.call(this)}},{key:"onMediaAttaching",value:function(a){this.media=a.media}},{key:"onMediaDetaching",value:function(){h(this.textTrack1),h(this.textTrack2)}},{key:"onManifestLoading",value:function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0};var a=this.media;if(a){var b=a.textTracks;if(b)for(var c=0;c<b.length;c++)h(b[c])}}},{key:"onManifestLoaded",value:function(a){var b=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=void 0,this.cueRanges=[],this.config.enableWebVTT){this.tracks=a.subtitles||[];var c=this.media?this.media.textTracks:[];this.tracks.forEach(function(a,d){var e=void 0;if(d<c.length){var f=c[d];i(f,a)&&(e=f)}e||(e=b.createTextTrack("subtitles",a.name,a.lang)),e.mode=a["default"]?"showing":"hidden",b.textTracks.push(e)})}}},{key:"onLevelSwitching",value:function(){this.enabled="NONE"!==this.hls.currentLevel.closedCaptions}},{key:"onFragLoaded",value:function(a){var b=a.frag,c=a.payload;if("main"===b.type){var d=b.sn;if(d!==this.lastSn+1){var e=this.cea608Parser;e&&e.reset()}this.lastSn=d}else if("subtitle"===b.type)if(c.byteLength){if("undefined"==typeof this.initPTS)return void this.unparsedVttFrags.push(a);var f=this.vttCCs;f[b.cc]||(f[b.cc]={start:b.start,prevCC:this.prevCC,"new":!0},this.prevCC=b.cc);var g=this.textTracks,h=this.hls;s["default"].parse(c,this.initPTS,f,b.cc,function(a){var c=g[b.trackId];a.forEach(function(a){c.cues.getCueById(a.id)||c.addCue(a)}),h.trigger(m["default"].SUBTITLE_FRAG_PROCESSED,{success:!0,frag:b})},function(a){t.logger.log("Failed to parse VTT cue: "+a),h.trigger(m["default"].SUBTITLE_FRAG_PROCESSED,{success:!1,frag:b})})}else this.hls.trigger(m["default"].SUBTITLE_FRAG_PROCESSED,{success:!1,frag:b})}},{key:"onFragParsingUserdata",value:function(a){if(this.enabled&&this.config.enableCEA708Captions)for(var b=0;b<a.samples.length;b++){var c=this.extractCea608Data(a.samples[b].bytes);this.cea608Parser.addData(a.samples[b].pts,c)}}},{key:"extractCea608Data",value:function(a){for(var b,c,d,e,f,g=31&a[0],h=2,i=[],j=0;j<g;j++)b=a[h++],c=127&a[h++],d=127&a[h++],e=0!==(4&b),f=3&b,0===c&&0===d||e&&0===f&&(i.push(c),i.push(d));return i}}]),b}(o["default"]);c["default"]=u},{34:34,35:35,49:49,54:54,58:58}],17:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b,c){d(this,a),this.subtle=b,this.aesIV=c}return e(a,[{key:"decrypt",value:function(a,b){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},b,a)}}]),a}();c["default"]=f},{}],18:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){d(this,a),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return e(a,[{key:"uint8ArrayToUint32Array_",value:function(a){for(var b=new DataView(a),c=new Uint32Array(4),d=0;d<4;d++)c[d]=b.getUint32(4*d);return c}},{key:"initTable",value:function(){var a=this.sBox,b=this.invSBox,c=this.subMix,d=c[0],e=c[1],f=c[2],g=c[3],h=this.invSubMix,i=h[0],j=h[1],k=h[2],l=h[3],m=new Uint32Array(256),n=0,o=0,p=0;for(p=0;p<256;p++)p<128?m[p]=p<<1:m[p]=p<<1^283;for(p=0;p<256;p++){var q=o^o<<1^o<<2^o<<3^o<<4;q=q>>>8^255&q^99,a[n]=q,b[q]=n;var r=m[n],s=m[r],t=m[s],u=257*m[q]^16843008*q;d[n]=u<<24|u>>>8,e[n]=u<<16|u>>>16,f[n]=u<<8|u>>>24,g[n]=u,u=16843009*t^65537*s^257*r^16843008*n,i[q]=u<<24|u>>>8,j[q]=u<<16|u>>>16,k[q]=u<<8|u>>>24,l[q]=u,n?(n=r^m[m[m[t^r]]],o^=m[m[o]]):n=o=1}}},{key:"expandKey",value:function(a){for(var b=this.uint8ArrayToUint32Array_(a),c=!0,d=0;d<b.length&&c;)c=b[d]===this.key[d],d++;if(!c){this.key=b;var e=this.keySize=b.length;if(4!==e&&6!==e&&8!==e)throw new Error("Invalid aes key size="+e);var f=this.ksRows=4*(e+6+1),g=void 0,h=void 0,i=this.keySchedule=new Uint32Array(f),j=this.invKeySchedule=new Uint32Array(f),k=this.sBox,l=this.rcon,m=this.invSubMix,n=m[0],o=m[1],p=m[2],q=m[3],r=void 0,s=void 0;for(g=0;g<f;g++)g<e?r=i[g]=b[g]:(s=r,g%e===0?(s=s<<8|s>>>24,s=k[s>>>24]<<24|k[s>>>16&255]<<16|k[s>>>8&255]<<8|k[255&s],s^=l[g/e|0]<<24):e>6&&g%e===4&&(s=k[s>>>24]<<24|k[s>>>16&255]<<16|k[s>>>8&255]<<8|k[255&s]),i[g]=r=(i[g-e]^s)>>>0);for(h=0;h<f;h++)g=f-h,s=3&h?i[g]:i[g-4],h<4||g<=4?j[h]=s:j[h]=n[k[s>>>24]]^o[k[s>>>16&255]]^p[k[s>>>8&255]]^q[k[255&s]],j[h]=j[h]>>>0}}},{key:"networkToHostOrderSwap",value:function(a){return a<<24|(65280&a)<<8|(16711680&a)>>8|a>>>24}},{key:"decrypt",value:function(a,b,c){for(var d,e,f=this.keySize+6,g=this.invKeySchedule,h=this.invSBox,i=this.invSubMix,j=i[0],k=i[1],l=i[2],m=i[3],n=this.uint8ArrayToUint32Array_(c),o=n[0],p=n[1],q=n[2],r=n[3],s=new Int32Array(a),t=new Int32Array(s.length),u=void 0,v=void 0,w=void 0,x=void 0,y=void 0,z=void 0,A=void 0,B=void 0,C=void 0,D=void 0,E=void 0,F=void 0,G=this.networkToHostOrderSwap;b<s.length;){for(C=G(s[b]),D=G(s[b+1]),E=G(s[b+2]),F=G(s[b+3]),y=C^g[0],z=F^g[1],A=E^g[2],B=D^g[3],d=4,e=1;e<f;e++)u=j[y>>>24]^k[z>>16&255]^l[A>>8&255]^m[255&B]^g[d],v=j[z>>>24]^k[A>>16&255]^l[B>>8&255]^m[255&y]^g[d+1],w=j[A>>>24]^k[B>>16&255]^l[y>>8&255]^m[255&z]^g[d+2],x=j[B>>>24]^k[y>>16&255]^l[z>>8&255]^m[255&A]^g[d+3],y=u,z=v,A=w,B=x,d+=4;u=h[y>>>24]<<24^h[z>>16&255]<<16^h[A>>8&255]<<8^h[255&B]^g[d],v=h[z>>>24]<<24^h[A>>16&255]<<16^h[B>>8&255]<<8^h[255&y]^g[d+1],w=h[A>>>24]<<24^h[B>>16&255]<<16^h[y>>8&255]<<8^h[255&z]^g[d+2],x=h[B>>>24]<<24^h[y>>16&255]<<16^h[z>>8&255]<<8^h[255&A]^g[d+3],d+=3,t[b]=G(u^o),t[b+1]=G(x^p),t[b+2]=G(w^q),t[b+3]=G(v^r),o=C,p=D,q=E,r=F,b+=4}return t.buffer}},{key:"destroy",value:function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0}}]),a}();c["default"]=f},{}],19:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(17),h=d(g),i=a(20),j=d(i),k=a(18),l=d(k),m=a(33),n=a(54),o=function(){function a(b,c){e(this,a),this.observer=b,this.config=c,this.logEnabled=!0;try{var d=crypto?crypto:self.crypto;this.subtle=d.subtle||d.webkitSubtle}catch(f){}this.disableWebCrypto=!this.subtle}return f(a,[{key:"isSync",value:function(){return this.disableWebCrypto&&this.config.enableSoftwareAES}},{key:"decrypt",value:function(a,b,c,d){var e=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(n.logger.log("JS AES decrypt"),this.logEnabled=!1);var f=this.decryptor;f||(this.decryptor=f=new l["default"]),f.expandKey(b),d(f.decrypt(a,0,c))}else{this.logEnabled&&(n.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1);var g=this.subtle;this.key!==b&&(this.key=b,this.fastAesKey=new j["default"](g,b)),this.fastAesKey.expandKey().then(function(f){var i=new h["default"](g,c);i.decrypt(a,f)["catch"](function(f){e.onWebCryptoError(f,a,b,c,d)}).then(function(a){d(a)})})["catch"](function(f){e.onWebCryptoError(f,a,b,c,d)})}}},{key:"onWebCryptoError",value:function(a,b,c,d,e){this.config.enableSoftwareAES?(n.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(b,c,d,e)):(n.logger.error("decrypting error : "+a.message),this.observer.trigger(Event.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:a.message}))}},{key:"destroy",value:function(){var a=this.decryptor;a&&(a.destroy(),this.decryptor=void 0)}}]),a}();c["default"]=o},{17:17,18:18,20:20,33:33,54:54}],20:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b,c){d(this,a),this.subtle=b,this.key=c}return e(a,[{key:"expandKey",value:function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}]),a}();c["default"]=f},{}],21:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(22),h=d(g),i=a(54),j=a(27),k=d(j),l=function(){function a(b,c,d){e(this,a),this.observer=b,this.config=d,this.remuxer=c}return f(a,[{key:"resetInitSegment",value:function(a,b,c,d){this._audioTrack={container:"audio/adts",type:"audio",id:-1,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:b,duration:d,inputTimeScale:9e4}}},{key:"resetTimeStamp",value:function(){}},{key:"append",value:function(a,b,c,d){for(var e=this._audioTrack,f=k["default"].getID3Data(a,0),g=90*k["default"].getTimeStamp(f),j=0,l=g,m=a.length,n=f.length,o=[{pts:l,dts:l,data:f}];n<m-1;)if(h["default"].isHeader(a,n)&&n+5<m){h["default"].initTrackConfig(e,this.observer,a,n,e.manifestCodec);var p=h["default"].appendFrame(e,a,n,g,j);if(!p){i.logger.log("Unable to parse AAC frame");break}n+=p.length,l=p.sample.pts,j++}else k["default"].isHeader(a,n)?(f=k["default"].getID3Data(a,n),o.push({pts:l,dts:l,data:f}),n+=f.length):n++;this.remuxer.remux(e,{samples:[]},{samples:o,inputTimeScale:9e4},{samples:[]},b,c,d)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(a){var b,c,d=k["default"].getID3Data(a,0);if(d&&void 0!==k["default"].getTimeStamp(d))for(b=d.length,c=Math.min(a.length-1,b+100);b<c;b++)if(h["default"].probe(a,b))return i.logger.log("ADTS sync word found !"),!0;return!1}}]),a}();c["default"]=l},{22:22,27:27,54:54}],22:[function(a,b,c){"use strict";var d=a(54),e=a(33),f={getAudioConfig:function(a,b,c,f){var g,h,i,j,k,l=navigator.userAgent.toLowerCase(),m=f,n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];return g=((192&b[c+2])>>>6)+1,h=(60&b[c+2])>>>2,h>n.length-1?void a.trigger(Event.ERROR,{type:e.ErrorTypes.MEDIA_ERROR,details:e.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+h}):(j=(1&b[c+2])<<2,j|=(192&b[c+3])>>>6,d.logger.log("manifest codec:"+f+",ADTS data:type:"+g+",sampleingIndex:"+h+"["+n[h]+"Hz],channelConfig:"+j),/firefox/i.test(l)?h>=6?(g=5,k=new Array(4),i=h-3):(g=2,k=new Array(2),i=h):l.indexOf("android")!==-1?(g=2,k=new Array(2),i=h):(g=5,k=new Array(4),f&&(f.indexOf("mp4a.40.29")!==-1||f.indexOf("mp4a.40.5")!==-1)||!f&&h>=6?i=h-3:((f&&f.indexOf("mp4a.40.2")!==-1&&h>=6&&1===j||!f&&1===j)&&(g=2,k=new Array(2)),i=h)),k[0]=g<<3,k[0]|=(14&h)>>1,k[1]|=(1&h)<<7,k[1]|=j<<3,5===g&&(k[1]|=(14&i)>>1,k[2]=(1&i)<<7,k[2]|=8,k[3]=0),{config:k,samplerate:n[h],channelCount:j,codec:"mp4a.40."+g,manifestCodec:m})},isHeaderPattern:function(a,b){return 255===a[b]&&240===(246&a[b+1])},getHeaderLength:function(a,b){return 1&a[b+1]?7:9},getFullFrameLength:function(a,b){return(3&a[b+3])<<11|a[b+4]<<3|(224&a[b+5])>>>5},isHeader:function(a,b){return!!(b+1<a.length&&this.isHeaderPattern(a,b))},probe:function(a,b){if(b+1<a.length&&this.isHeaderPattern(a,b)){var c=this.getHeaderLength(a,b),d=c;b+5<a.length&&(d=this.getFullFrameLength(a,b));var e=b+d;if(e===a.length||e+1<a.length&&this.isHeaderPattern(a,e))return!0}return!1},initTrackConfig:function(a,b,c,e,f){if(!a.samplerate){var g=this.getAudioConfig(b,c,e,f);a.config=g.config,a.samplerate=g.samplerate,a.channelCount=g.channelCount,a.codec=g.codec,a.manifestCodec=g.manifestCodec,d.logger.log("parsed codec:"+a.codec+",rate:"+g.samplerate+",nb channel:"+g.channelCount)}},getFrameDuration:function(a){return 9216e4/a},appendFrame:function(a,b,c,d,e){var f=this.getFrameDuration(a.samplerate),g=this.parseFrameHeader(b,c,d,e,f);if(g){var h=g.stamp,i=g.headerLength,j=g.frameLength,k={unit:b.subarray(c+i,c+i+j),pts:h,dts:h};return a.samples.push(k),a.len+=j,{sample:k,length:j+i}}},parseFrameHeader:function(a,b,c,d,e){var f,g,h,i=a.length;if(f=this.getHeaderLength(a,b),g=this.getFullFrameLength(a,b),g-=f,g>0&&b+f+g<=i)return h=c+d*e,{headerLength:f,frameLength:g,stamp:h}}};b.exports=f},{33:33,54:54}],23:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(35),h=d(g),i=a(33),j=a(19),k=d(j),l=a(21),m=d(l),n=a(29),o=d(n),p=a(32),q=d(p),r=a(28),s=d(r),t=a(45),u=d(t),v=a(46),w=d(v),x=function(){function a(b,c,d,f){e(this,a),this.observer=b,this.typeSupported=c,this.config=d,this.vendor=f}return f(a,[{key:"destroy",value:function(){var a=this.demuxer;a&&a.destroy()}},{key:"push",value:function(a,b,c,d,e,f,g,i,j,l,m,n){if(a.byteLength>0&&null!=b&&null!=b.key&&"AES-128"===b.method){var o=this.decrypter;null==o&&(o=this.decrypter=new k["default"](this.observer,this.config));var p,q=this;try{p=performance.now()}catch(r){p=Date.now()}o.decrypt(a,b.key.buffer,b.iv.buffer,function(a){var k;try{k=performance.now()}catch(o){k=Date.now()}q.observer.trigger(h["default"].FRAG_DECRYPTED,{stats:{tstart:p,tdecrypt:k}}),q.pushDecrypted(new Uint8Array(a),b,new Uint8Array(c),d,e,f,g,i,j,l,m,n)})}else this.pushDecrypted(new Uint8Array(a),b,new Uint8Array(c),d,e,f,g,i,j,l,m,n)}},{key:"pushDecrypted",value:function(a,b,c,d,e,f,g,j,k,l,n,p){var r=this.demuxer;if(!r||g&&!this.probe(a)){for(var t=this.observer,v=this.typeSupported,x=this.config,y=[{demux:m["default"],remux:u["default"]},{demux:s["default"],remux:u["default"]},{demux:q["default"],remux:u["default"]},{demux:o["default"],remux:w["default"]}],z=0,A=y.length;z<A;z++){var B=y[z],C=B.demux.probe;if(C(a)){var D=this.remuxer=new B.remux(t,x,v,this.vendor);r=new B.demux(t,D,x,v),this.probe=C;break}}if(!r)return void t.trigger(h["default"].ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=r}var E=this.remuxer;(g||j)&&(r.resetInitSegment(c,d,e,l),E.resetInitSegment()),g&&(r.resetTimeStamp(p),E.resetTimeStamp(p)),"function"==typeof r.setDecryptData&&r.setDecryptData(b),r.append(a,f,k,n)}}]),a}();c["default"]=x},{19:19,21:21,28:28,29:29,32:32,33:33,35:35,45:45,46:46}],24:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a(23),f=d(e),g=a(35),h=d(g),i=a(54),j=a(1),k=d(j),l=function(a){var b=new k["default"];b.trigger=function(a){for(var c=arguments.length,d=Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];b.emit.apply(b,[a,a].concat(d))},b.off=function(a){for(var c=arguments.length,d=Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];b.removeListener.apply(b,[a].concat(d))};var c=function(b,c){a.postMessage({event:b,data:c})};a.addEventListener("message",function(d){var e=d.data;switch(e.cmd){case"init":var g=JSON.parse(e.config);a.demuxer=new f["default"](b,e.typeSupported,g,e.vendor);try{(0,i.enableLogs)(g.debug===!0)}catch(h){}c("init",null);break;case"demux":a.demuxer.push(e.data,e.decryptdata,e.initSegment,e.audioCodec,e.videoCodec,e.timeOffset,e.discontinuity,e.trackSwitch,e.contiguous,e.duration,e.accurateTimeOffset,e.defaultInitPTS)}}),b.on(h["default"].FRAG_DECRYPTED,c),b.on(h["default"].FRAG_PARSING_INIT_SEGMENT,c),b.on(h["default"].FRAG_PARSED,c),b.on(h["default"].ERROR,c),b.on(h["default"].FRAG_PARSING_METADATA,c),b.on(h["default"].FRAG_PARSING_USERDATA,c),b.on(h["default"].INIT_PTS_FOUND,c),b.on(h["default"].FRAG_PARSING_DATA,function(b,c){var d=[],e={event:b,data:c};c.data1&&(e.data1=c.data1.buffer,d.push(c.data1.buffer),delete c.data1),c.data2&&(e.data2=c.data2.buffer,d.push(c.data2.buffer),delete c.data2),a.postMessage(e,d)})};c["default"]=l},{1:1,23:23,35:35,54:54}],25:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(35),h=d(g),i=a(23),j=d(i),k=a(24),l=d(k),m=a(54),n=a(33),o=a(1),p=d(o),q=function(){function b(c,d){e(this,b),this.hls=c,this.id=d;var f=this.observer=new p["default"],g=c.config;f.trigger=function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];f.emit.apply(f,[a,a].concat(c))},f.off=function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];f.removeListener.apply(f,[a].concat(c))};var i=function(a,b){b=b||{},b.frag=this.frag,b.id=this.id,c.trigger(a,b)}.bind(this);f.on(h["default"].FRAG_DECRYPTED,i),f.on(h["default"].FRAG_PARSING_INIT_SEGMENT,i),f.on(h["default"].FRAG_PARSING_DATA,i),f.on(h["default"].FRAG_PARSED,i),f.on(h["default"].ERROR,i),f.on(h["default"].FRAG_PARSING_METADATA,i),f.on(h["default"].FRAG_PARSING_USERDATA,i),f.on(h["default"].INIT_PTS_FOUND,i);var k={mp4:MediaSource.isTypeSupported("video/mp4"),mpeg:MediaSource.isTypeSupported("audio/mpeg"),mp3:MediaSource.isTypeSupported('audio/mp4; codecs="mp3"')},o=navigator.vendor;if(g.enableWorker&&"undefined"!=typeof Worker){m.logger.log("demuxing in webworker");var q=void 0;try{var r=a(3);q=this.w=r(l["default"]),this.onwmsg=this.onWorkerMessage.bind(this),q.addEventListener("message",this.onwmsg),q.onerror=function(a){c.trigger(h["default"].ERROR,{type:n.ErrorTypes.OTHER_ERROR,details:n.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:a.message+" ("+a.filename+":"+a.lineno+")"}})},q.postMessage({cmd:"init",typeSupported:k,vendor:o,id:d,config:JSON.stringify(g)})}catch(s){m.logger.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),q&&URL.revokeObjectURL(q.objectURL),this.demuxer=new j["default"](f,k,g,o),this.w=void 0}}else this.demuxer=new j["default"](f,k,g,o)}return f(b,[{key:"destroy",value:function(){var a=this.w;if(a)a.removeEventListener("message",this.onwmsg),a.terminate(),this.w=null;else{var b=this.demuxer;b&&(b.destroy(),this.demuxer=null)}var c=this.observer;c&&(c.removeAllListeners(),this.observer=null)}},{key:"push",value:function(a,b,c,d,e,f,g,h){var i=this.w,j=isNaN(e.startDTS)?e.start:e.startDTS,k=e.decryptdata,l=this.frag,n=!(l&&e.cc===l.cc),o=!(l&&e.level===l.level),p=l&&e.sn===l.sn+1,q=!o&&p;if(n&&m.logger.log(this.id+":discontinuity detected"),o&&m.logger.log(this.id+":switch detected"),this.frag=e,i)i.postMessage({cmd:"demux",data:a,decryptdata:k,initSegment:b,audioCodec:c,videoCodec:d,timeOffset:j,discontinuity:n,trackSwitch:o,contiguous:q,duration:f,accurateTimeOffset:g,defaultInitPTS:h},[a]);else{var r=this.demuxer;r&&r.push(a,k,b,c,d,j,n,o,q,f,g,h)}}},{key:"onWorkerMessage",value:function(a){var b=a.data,c=this.hls;switch(b.event){case"init":URL.revokeObjectURL(this.w.objectURL);break;case h["default"].FRAG_PARSING_DATA:b.data.data1=new Uint8Array(b.data1),b.data2&&(b.data.data2=new Uint8Array(b.data2));default:b.data=b.data||{},b.data.frag=this.frag,b.data.id=this.id,c.trigger(b.event,b.data)}}}]),b}();c["default"]=q},{1:1,23:23,24:24,3:3,33:33,35:35,54:54}],26:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a(54),g=function(){function a(b){d(this,a),this.data=b,this.bytesAvailable=b.byteLength,this.word=0,this.bitsAvailable=0}return e(a,[{key:"loadWord",value:function(){var a=this.data,b=this.bytesAvailable,c=a.byteLength-b,d=new Uint8Array(4),e=Math.min(4,b);if(0===e)throw new Error("no bytes available");d.set(a.subarray(c,c+e)),this.word=new DataView(d.buffer).getUint32(0),this.bitsAvailable=8*e,this.bytesAvailable-=e}},{key:"skipBits",value:function(a){var b;this.bitsAvailable>a?(this.word<<=a,this.bitsAvailable-=a):(a-=this.bitsAvailable,b=a>>3,a-=b>>3,this.bytesAvailable-=b,this.loadWord(),this.word<<=a,this.bitsAvailable-=a)}},{key:"readBits",value:function(a){var b=Math.min(this.bitsAvailable,a),c=this.word>>>32-b;return a>32&&f.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=b,this.bitsAvailable>0?this.word<<=b:this.bytesAvailable>0&&this.loadWord(),b=a-b,b>0&&this.bitsAvailable?c<<b|this.readBits(b):c}},{key:"skipLZ",value:function(){var a;for(a=0;a<this.bitsAvailable;++a)if(0!==(this.word&2147483648>>>a))return this.word<<=a,this.bitsAvailable-=a,a;return this.loadWord(),a+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var a=this.skipLZ();return this.readBits(a+1)-1}},{key:"readEG",value:function(){var a=this.readUEG();return 1&a?1+a>>>1:-1*(a>>>1)}},{key:"readBoolean",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}},{key:"skipScalingList",value:function(a){var b,c,d=8,e=8;for(b=0;b<a;b++)0!==e&&(c=this.readEG(),e=(d+c+256)%256),d=0===e?d:e}},{key:"readSPS",value:function(){var a,b,c,d,e,f,g,h,i,j=0,k=0,l=0,m=0,n=this.readUByte.bind(this),o=this.readBits.bind(this),p=this.readUEG.bind(this),q=this.readBoolean.bind(this),r=this.skipBits.bind(this),s=this.skipEG.bind(this),t=this.skipUEG.bind(this),u=this.skipScalingList.bind(this);
if(n(),a=n(),b=o(5),r(3),c=n(),t(),100===a||110===a||122===a||244===a||44===a||83===a||86===a||118===a||128===a){var v=p();if(3===v&&r(1),t(),t(),r(1),q())for(h=3!==v?8:12,i=0;i<h;i++)q()&&u(i<6?16:64)}t();var w=p();if(0===w)p();else if(1===w)for(r(1),s(),s(),d=p(),i=0;i<d;i++)s();t(),r(1),e=p(),f=p(),g=o(1),0===g&&r(1),r(1),q()&&(j=p(),k=p(),l=p(),m=p());var x=[1,1];if(q()&&q()){var y=n();switch(y){case 1:x=[1,1];break;case 2:x=[12,11];break;case 3:x=[10,11];break;case 4:x=[16,11];break;case 5:x=[40,33];break;case 6:x=[24,11];break;case 7:x=[20,11];break;case 8:x=[32,11];break;case 9:x=[80,33];break;case 10:x=[18,11];break;case 11:x=[15,11];break;case 12:x=[64,33];break;case 13:x=[160,99];break;case 14:x=[4,3];break;case 15:x=[3,2];break;case 16:x=[2,1];break;case 255:x=[n()<<8|n(),n()<<8|n()]}}return{width:Math.ceil(16*(e+1)-2*j-2*k),height:(2-g)*(f+1)*16-(g?2:4)*(l+m),pixelRatio:x}}},{key:"readSliceType",value:function(){return this.readUByte(),this.readUEG(),this.readUEG()}}]),a}();c["default"]=g},{54:54}],27:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){d(this,a)}return e(a,null,[{key:"isHeader",value:function(a,b){return b+10<=a.length&&73===a[b]&&68===a[b+1]&&51===a[b+2]&&a[b+3]<255&&a[b+4]<255&&a[b+6]<128&&a[b+7]<128&&a[b+8]<128&&a[b+9]<128}},{key:"isFooter",value:function(a,b){return b+10<=a.length&&51===a[b]&&68===a[b+1]&&73===a[b+2]&&a[b+3]<255&&a[b+4]<255&&a[b+6]<128&&a[b+7]<128&&a[b+8]<128&&a[b+9]<128}},{key:"getID3Data",value:function(b,c){for(var d=c,e=0;a.isHeader(b,c);){e+=10;var f=a._readSize(b,c+6);e+=f,a.isFooter(b,c+10)&&(e+=10),c+=e}if(e>0)return b.subarray(d,d+e)}},{key:"_readSize",value:function(a,b){var c=0;return c=(127&a[b])<<21,c|=(127&a[b+1])<<14,c|=(127&a[b+2])<<7,c|=127&a[b+3]}},{key:"getTimeStamp",value:function(b){for(var c=a.getID3Frames(b),d=0;d<c.length;d++){var e=c[d];if(a.isTimeStampFrame(e))return a._readTimeStamp(e)}}},{key:"isTimeStampFrame",value:function(a){return a&&"PRIV"===a.key&&"com.apple.streaming.transportStreamTimestamp"===a.info}},{key:"_getFrameData",value:function(b){var c=String.fromCharCode(b[0],b[1],b[2],b[3]),d=a._readSize(b,4),e=10;return{type:c,size:d,data:b.subarray(e,e+d)}}},{key:"getID3Frames",value:function(b){for(var c=0,d=[];a.isHeader(b,c);){var e=a._readSize(b,c+6);c+=10;for(var f=c+e;c+8<f;){var g=a._getFrameData(b.subarray(c)),h=a._decodeFrame(g);h&&d.push(h),c+=g.size+10}a.isFooter(b,c)&&(c+=10)}return d}},{key:"_decodeFrame",value:function(b){return"PRIV"===b.type?a._decodePrivFrame(b):"T"===b.type[0]?a._decodeTextFrame(b):"W"===b.type[0]?a._decodeURLFrame(b):void 0}},{key:"_readTimeStamp",value:function(a){if(8===a.data.byteLength){var b=new Uint8Array(a.data),c=1&b[3],d=(b[4]<<23)+(b[5]<<15)+(b[6]<<7)+b[7];return d/=45,c&&(d+=47721858.84),Math.round(d)}}},{key:"_decodePrivFrame",value:function(b){if(!(b.size<2)){var c=a._utf8ArrayToStr(b.data),d=new Uint8Array(b.data.subarray(c.length+1));return{key:b.type,info:c,data:d.buffer}}}},{key:"_decodeTextFrame",value:function(b){if(!(b.size<2)){if("TXXX"===b.type){var c=1,d=a._utf8ArrayToStr(b.data.subarray(c));c+=d.length+1;var e=a._utf8ArrayToStr(b.data.subarray(c));return{key:b.type,info:d,data:e}}var f=a._utf8ArrayToStr(b.data.subarray(1));return{key:b.type,data:f}}}},{key:"_decodeURLFrame",value:function(b){if("WXXX"===b.type){if(b.size<2)return;var c=1,d=a._utf8ArrayToStr(b.data.subarray(c));c+=d.length+1;var e=a._utf8ArrayToStr(b.data.subarray(c));return{key:b.type,info:d,data:e}}var f=a._utf8ArrayToStr(b.data);return{key:b.type,data:f}}},{key:"_utf8ArrayToStr",value:function(a){for(var b=void 0,c=void 0,d="",e=0,f=a.length;e<f;){var g=a[e++];switch(g>>4){case 0:return d;case 1:case 2:case 3:case 4:case 5:case 6:case 7:d+=String.fromCharCode(g);break;case 12:case 13:b=a[e++],d+=String.fromCharCode((31&g)<<6|63&b);break;case 14:b=a[e++],c=a[e++],d+=String.fromCharCode((15&g)<<12|(63&b)<<6|(63&c)<<0)}}return d}}]),a}();c["default"]=f},{}],28:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(27),h=d(g),i=a(54),j=a(30),k=d(j),l=function(){function a(b,c,d){e(this,a),this.observer=b,this.config=d,this.remuxer=c}return f(a,[{key:"resetInitSegment",value:function(a,b,c,d){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:b,duration:d,inputTimeScale:9e4}}},{key:"resetTimeStamp",value:function(){}},{key:"append",value:function(a,b,c,d){for(var e=h["default"].getID3Data(a,0),f=90*h["default"].getTimeStamp(e),g=e.length,i=a.length,j=0,l=0,m=this._audioTrack,n=[{pts:f,dts:f,data:e}];g<i;)if(k["default"].isHeader(a,g)){var o=k["default"].appendFrame(m,a,g,f,j);if(!o)break;g+=o.length,l=o.sample.pts,j++}else h["default"].isHeader(a,g)?(e=h["default"].getID3Data(a,g),n.push({pts:l,dts:l,data:e}),g+=e.length):g++;this.remuxer.remux(m,{samples:[]},{samples:n,inputTimeScale:9e4},{samples:[]},b,c,d)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(a){var b,c,d=h["default"].getID3Data(a,0);if(d&&void 0!==h["default"].getTimeStamp(d))for(b=d.length,c=Math.min(a.length-1,b+100);b<c;b++)if(k["default"].probe(a,b))return i.logger.log("MPEG Audio sync word found !"),!0;return!1}}]),a}();c["default"]=l},{27:27,30:30,54:54}],29:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(35),h=d(g),i=Math.pow(2,32)-1,j=function(){function a(b,c){e(this,a),this.observer=b,this.remuxer=c}return f(a,[{key:"resetTimeStamp",value:function(a){this.initPTS=a}},{key:"resetInitSegment",value:function(b,c,d,e){if(b&&b.byteLength){var f=this.initData=a.parseInitSegment(b),g={};f.audio&&(g.audio={container:"audio/mp4",codec:c,initSegment:e?b:null}),f.video&&(g.video={container:"video/mp4",codec:d,initSegment:e?b:null}),this.observer.trigger(h["default"].FRAG_PARSING_INIT_SEGMENT,{tracks:g})}else c&&(this.audioCodec=c),d&&(this.videoCodec=d)}},{key:"append",value:function(b,c,d,e){var f=this.initData;f||(this.resetInitSegment(b,this.audioCodec,this.videoCodec),f=this.initData);var g=void 0,i=this.initPTS;if(void 0===i){var j=a.getStartDTS(f,b);this.initPTS=i=j-c,this.observer.trigger(h["default"].INIT_PTS_FOUND,{initPTS:i})}a.offsetStartDTS(f,b,i),g=a.getStartDTS(f,b),this.remuxer.remux(f.audio,f.video,null,null,g,d,e,b)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(b){if(b.length>=8){var c=a.bin2str(b.subarray(4,8));return["moof","ftyp","styp"].indexOf(c)>=0}return!1}},{key:"bin2str",value:function(a){return String.fromCharCode.apply(null,a)}},{key:"readUint32",value:function(a,b){a.data&&(b+=a.start,a=a.data);var c=a[b]<<24|a[b+1]<<16|a[b+2]<<8|a[b+3];return c<0?4294967296+c:c}},{key:"writeUint32",value:function(a,b,c){a.data&&(b+=a.start,a=a.data),a[b]=c>>24,a[b+1]=c>>16&255,a[b+2]=c>>8&255,a[b+3]=255&c}},{key:"findBox",value:function(b,c){var d,e,f,g,h,i,j,k=[];if(b.data?(i=b.start,g=b.end,b=b.data):(i=0,g=b.byteLength),!c.length)return null;for(d=i;d<g;)e=a.readUint32(b,d),f=a.bin2str(b.subarray(d+4,d+8)),j=e>1?d+e:g,f===c[0]&&(1===c.length?k.push({data:b,start:d+8,end:j}):(h=a.findBox({data:b,start:d+8,end:j},c.slice(1)),h.length&&(k=k.concat(h)))),d=j;return k}},{key:"parseInitSegment",value:function(b){var c=[],d=a.findBox(b,["moov","trak"]);return d.forEach(function(b){var d=a.findBox(b,["tkhd"])[0];if(d){var e=d.data[d.start],f=0===e?12:20,g=a.readUint32(d,f),h=a.findBox(b,["mdia","mdhd"])[0];if(h){e=h.data[h.start],f=0===e?12:20;var i=a.readUint32(h,f),j=a.findBox(b,["mdia","hdlr"])[0];if(j){var k=a.bin2str(j.data.subarray(j.start+8,j.start+12)),l={soun:"audio",vide:"video"}[k];l&&(c[g]={timescale:i,type:l},c[l]={timescale:i,id:g})}}}}),c}},{key:"getStartDTS",value:function(b,c){var d,e,f;return d=a.findBox(c,["moof","traf"]),e=[].concat.apply([],d.map(function(c){return a.findBox(c,["tfhd"]).map(function(d){var e,f,g;return e=a.readUint32(d,4),f=b[e].timescale||9e4,g=a.findBox(c,["tfdt"]).map(function(b){var c,d;return c=b.data[b.start],d=a.readUint32(b,4),1===c&&(d*=Math.pow(2,32),d+=a.readUint32(b,8)),d})[0],g=g||1/0,g/f})})),f=Math.min.apply(null,e),isFinite(f)?f:0}},{key:"offsetStartDTS",value:function(b,c,d){a.findBox(c,["moof","traf"]).map(function(c){return a.findBox(c,["tfhd"]).map(function(e){var f=a.readUint32(e,4),g=b[f].timescale||9e4;a.findBox(c,["tfdt"]).map(function(b){var c=b.data[b.start],e=a.readUint32(b,4);if(0===c)a.writeUint32(b,4,e-d*g);else{e*=Math.pow(2,32),e+=a.readUint32(b,8),e-=d*g;var f=Math.floor(e/(i+1)),h=Math.floor(e%(i+1));a.writeUint32(b,4,f),a.writeUint32(b,8,h)}})})})}}]),a}();c["default"]=j},{35:35}],30:[function(a,b,c){"use strict";var d={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],appendFrame:function(a,b,c,d,e){if(!(c+24>b.length)){var f=this.parseHeader(b,c);if(f&&c+f.frameLength<=b.length){var g=10368e4/f.sampleRate,h=d+e*g,i={unit:b.subarray(c,c+f.frameLength),pts:h,dts:h};return a.config=[],a.channelCount=f.channelCount,a.samplerate=f.sampleRate,a.samples.push(i),a.len+=f.frameLength,{sample:i,length:f.frameLength}}}},parseHeader:function(a,b){var c=a[b+1]>>3&3,e=a[b+1]>>1&3,f=a[b+2]>>4&15,g=a[b+2]>>2&3,h=!!(2&a[b+2]);if(1!==c&&0!==f&&15!==f&&3!==g){var i=3===c?3-e:3===e?3:4,j=1e3*d.BitratesMap[14*i+f-1],k=3===c?0:2===c?1:2,l=d.SamplingRateMap[3*k+g],m=h?1:0,n=a[b+3]>>6===3?1:2,o=3===e?(3===c?12:6)*j/l+m<<2:(3===c?144:72)*j/l+m|0;return{sampleRate:l,channelCount:n,frameLength:o}}},isHeaderPattern:function(a,b){return 255===a[b]&&224===(224&a[b+1])&&0!==(6&a[b+1])},isHeader:function(a,b){return!!(b+1<a.length&&this.isHeaderPattern(a,b))},probe:function(a,b){if(b+1<a.length&&this.isHeaderPattern(a,b)){var c=4,d=this.parseHeader(a,b),e=c;d&&d.frameLength&&(e=d.frameLength);var f=b+e;if(f===a.length||f+1<a.length&&this.isHeaderPattern(a,f))return!0}return!1}};b.exports=d},{}],31:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(19),h=d(g),i=function(){function a(b,c,d,f){e(this,a),this.decryptdata=d,this.discardEPB=f,this.decrypter=new h["default"](b,c)}return f(a,[{key:"decryptBuffer",value:function(a,b){this.decrypter.decrypt(a,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,b)}},{key:"decryptAacSample",value:function(a,b,c,d){var e=a[b].unit,f=e.subarray(16,e.length-e.length%16),g=f.buffer.slice(f.byteOffset,f.byteOffset+f.length),h=this;this.decryptBuffer(g,function(f){f=new Uint8Array(f),e.set(f,16),d||h.decryptAacSamples(a,b+1,c)})}},{key:"decryptAacSamples",value:function(a,b,c){for(;;b++){if(b>=a.length)return void c();if(!(a[b].unit.length<32)){var d=this.decrypter.isSync();if(this.decryptAacSample(a,b,c,d),!d)return}}}},{key:"getAvcEncryptedData",value:function(a){for(var b=16*Math.floor((a.length-48)/160)+16,c=new Int8Array(b),d=0,e=32;e<=a.length-16;e+=160,d+=16)c.set(a.subarray(e,e+16),d);return c}},{key:"getAvcDecryptedUnit",value:function(a,b){b=new Uint8Array(b);for(var c=0,d=32;d<=a.length-16;d+=160,c+=16)a.set(b.subarray(c,c+16),d);return a}},{key:"decryptAvcSample",value:function(a,b,c,d,e,f){var g=this.discardEPB(e.data),h=this.getAvcEncryptedData(g),i=this;this.decryptBuffer(h.buffer,function(h){e.data=i.getAvcDecryptedUnit(g,h),f||i.decryptAvcSamples(a,b,c+1,d)})}},{key:"decryptAvcSamples",value:function(a,b,c,d){for(;;b++,c=0){if(b>=a.length)return void d();for(var e=a[b].units;!(c>=e.length);c++){var f=e[c];if(!(f.length<=48||1!==f.type&&5!==f.type)){var g=this.decrypter.isSync();if(this.decryptAvcSample(a,b,c,d,f,g),!g)return}}}}}]),a}();c["default"]=i},{19:19}],32:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(22),h=d(g),i=a(30),j=d(i),k=a(35),l=d(k),m=a(26),n=d(m),o=a(31),p=d(o),q=a(54),r=a(33),s=function(){function a(b,c,d,f){e(this,a),this.observer=b,this.config=d,this.typeSupported=f,this.remuxer=c,this.sampleAes=null}return f(a,[{key:"setDecryptData",value:function(a){null!=a&&null!=a.key&&"SAMPLE-AES"===a.method?this.sampleAes=new p["default"](this.observer,this.config,a,this.discardEPB):this.sampleAes=null}},{key:"resetInitSegment",value:function(a,b,c,d){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack={container:"video/mp2t",type:"video",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:0},this._audioTrack={container:"video/mp2t",type:"audio",id:-1,inputTimeScale:9e4,duration:d,sequenceNumber:0,samples:[],len:0,isAAC:!0},this._id3Track={type:"id3",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0},this._txtTrack={type:"text",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0},this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=b,this.videoCodec=c,this._duration=d}},{key:"resetTimeStamp",value:function(){}},{key:"append",value:function(a,b,c,d){var e,f,g,h,i,j,k=a.length,m=!1;this.contiguous=c;var n=this.pmtParsed,o=this._avcTrack,p=this._audioTrack,s=this._id3Track,t=o.id,u=p.id,v=s.id,w=this._pmtId,x=o.pesData,y=p.pesData,z=s.pesData,A=this._parsePAT,B=this._parsePMT,C=this._parsePES,D=this._parseAVCPES.bind(this),E=this._parseAACPES.bind(this),F=this._parseMPEGPES.bind(this),G=this._parseID3PES.bind(this);for(k-=k%188,e=0;e<k;e+=188)if(71===a[e]){if(f=!!(64&a[e+1]),g=((31&a[e+1])<<8)+a[e+2],h=(48&a[e+3])>>4,h>1){if(i=e+5+a[e+4],i===e+188)continue}else i=e+4;switch(g){case t:f&&(x&&(j=C(x))&&D(j,!1),x={data:[],size:0}),x&&(x.data.push(a.subarray(i,e+188)),x.size+=e+188-i);break;case u:f&&(y&&(j=C(y))&&(p.isAAC?E(j):F(j)),y={data:[],size:0}),y&&(y.data.push(a.subarray(i,e+188)),y.size+=e+188-i);break;case v:f&&(z&&(j=C(z))&&G(j),z={data:[],size:0}),z&&(z.data.push(a.subarray(i,e+188)),z.size+=e+188-i);break;case 0:f&&(i+=a[i]+1),w=this._pmtId=A(a,i);break;case w:f&&(i+=a[i]+1);var H=B(a,i,this.typeSupported.mpeg===!0||this.typeSupported.mp3===!0,null!=this.sampleAes);t=H.avc,t>0&&(o.id=t),u=H.audio,u>0&&(p.id=u,p.isAAC=H.isAAC),v=H.id3,v>0&&(s.id=v),m&&!n&&(q.logger.log("reparse from beginning"),m=!1,e=-188),n=this.pmtParsed=!0;break;case 17:case 8191:break;default:m=!0}}else this.observer.trigger(l["default"].ERROR,{type:r.ErrorTypes.MEDIA_ERROR,details:r.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});x&&(j=C(x))?(D(j,!0),o.pesData=null):o.pesData=x,y&&(j=C(y))?(p.isAAC?E(j):F(j),p.pesData=null):(y&&y.size&&q.logger.log("last AAC PES packet truncated,might overlap between fragments"),p.pesData=y),z&&(j=C(z))?(G(j),s.pesData=null):s.pesData=z,null==this.sampleAes?this.remuxer.remux(p,o,s,this._txtTrack,b,c,d):this.decryptAndRemux(p,o,s,this._txtTrack,b,c,d)}},{key:"decryptAndRemux",value:function(a,b,c,d,e,f,g){if(a.samples&&a.isAAC){var h=this;this.sampleAes.decryptAacSamples(a.samples,0,function(){h.decryptAndRemuxAvc(a,b,c,d,e,f,g)})}else this.decryptAndRemuxAvc(a,b,c,d,e,f,g)}},{key:"decryptAndRemuxAvc",value:function(a,b,c,d,e,f,g){if(b.samples){var h=this;this.sampleAes.decryptAvcSamples(b.samples,0,0,function(){h.remuxer.remux(a,b,c,d,e,f,g)})}else this.remuxer.remux(a,b,c,d,e,f,g)}},{key:"destroy",value:function(){this._initPTS=this._initDTS=void 0,this._duration=0}},{key:"_parsePAT",value:function(a,b){return(31&a[b+10])<<8|a[b+11]}},{key:"_parsePMT",value:function(a,b,c,d){var e,f,g,h,i={audio:-1,avc:-1,id3:-1,isAAC:!0};for(e=(15&a[b+1])<<8|a[b+2],f=b+3+e-4,g=(15&a[b+10])<<8|a[b+11],b+=12+g;b<f;){switch(h=(31&a[b+1])<<8|a[b+2],a[b]){case 207:if(!d){q.logger.log("unkown stream type:"+a[b]);break}case 15:i.audio===-1&&(i.audio=h);break;case 21:i.id3===-1&&(i.id3=h);break;case 219:if(!d){q.logger.log("unkown stream type:"+a[b]);break}case 27:i.avc===-1&&(i.avc=h);break;case 3:case 4:c?i.audio===-1&&(i.audio=h,i.isAAC=!1):q.logger.log("MPEG audio found, not supported in this browser for now");break;case 36:q.logger.warn("HEVC stream type found, not supported for now");break;default:q.logger.log("unkown stream type:"+a[b])}b+=((15&a[b+3])<<8|a[b+4])+5}return i}},{key:"_parsePES",value:function(a){var b,c,d,e,f,g,h,i,j,k=0,l=a.data;if(!a||0===a.size)return null;for(;l[0].length<19&&l.length>1;){var m=new Uint8Array(l[0].length+l[1].length);m.set(l[0]),m.set(l[1],l[0].length),l[0]=m,l.splice(1,1)}if(b=l[0],d=(b[0]<<16)+(b[1]<<8)+b[2],1===d){if(e=(b[4]<<8)+b[5],e&&e>a.size-6)return null;c=b[7],192&c&&(h=536870912*(14&b[9])+4194304*(255&b[10])+16384*(254&b[11])+128*(255&b[12])+(254&b[13])/2,h>4294967295&&(h-=8589934592),64&c?(i=536870912*(14&b[14])+4194304*(255&b[15])+16384*(254&b[16])+128*(255&b[17])+(254&b[18])/2,i>4294967295&&(i-=8589934592),h-i>54e5&&(q.logger.warn(Math.round((h-i)/9e4)+"s delta between PTS and DTS, align them"),h=i)):i=h),f=b[8],j=f+9,a.size-=j,g=new Uint8Array(a.size);for(var n=0,o=l.length;n<o;n++){b=l[n];var p=b.byteLength;if(j){if(j>p){j-=p;continue}b=b.subarray(j),p-=j,j=0}g.set(b,k),k+=p}return e&&(e-=f+3),{data:g,pts:h,dts:i,len:e}}return null}},{key:"pushAccesUnit",value:function(a,b){if(a.units.length&&a.frame){var c=b.samples,d=c.length;!this.config.forceKeyFrameOnDiscontinuity||a.key===!0||b.sps&&(d||this.contiguous)?(a.id=d,c.push(a)):b.dropped++}a.debug.length&&q.logger.log(a.pts+"/"+a.dts+":"+a.debug)}},{key:"_parseAVCPES",value:function(a,b){var c,d,e,f=this,g=this._avcTrack,h=this._parseAVCNALu(a.data),i=!1,j=this.avcSample,k=!1;a.data=null,h.forEach(function(b){switch(b.type){case 1:d=!0,i&&j&&(j.debug+="NDR "),j.frame=!0;var h=b.data;if(k&&h.length>4){var l=new n["default"](h).readSliceType();2!==l&&4!==l&&7!==l&&9!==l||(j.key=!0)}break;case 5:d=!0,j||(j=f.avcSample=f._createAVCSample(!0,a.pts,a.dts,"")),i&&(j.debug+="IDR "),j.key=!0,j.frame=!0;break;case 6:d=!0,i&&j&&(j.debug+="SEI "),c=new n["default"](f.discardEPB(b.data)),c.readUByte();for(var m=0,o=0,p=!1,q=0;!p&&c.bytesAvailable>1;){m=0;do q=c.readUByte(),m+=q;while(255===q);o=0;do q=c.readUByte(),o+=q;while(255===q);if(4===m&&0!==c.bytesAvailable){p=!0;var r=c.readUByte();if(181===r){var s=c.readUShort();if(49===s){var t=c.readUInt();if(1195456820===t){var u=c.readUByte();if(3===u){var v=c.readUByte(),w=c.readUByte(),x=31&v,y=[v,w];for(e=0;e<x;e++)y.push(c.readUByte()),y.push(c.readUByte()),y.push(c.readUByte());f._insertSampleInOrder(f._txtTrack.samples,{type:3,pts:a.pts,bytes:y})}}}}}else if(o<c.bytesAvailable)for(e=0;e<o;e++)c.readUByte()}break;case 7:if(d=!0,k=!0,i&&j&&(j.debug+="SPS "),!g.sps){c=new n["default"](b.data);var z=c.readSPS();g.width=z.width,g.height=z.height,g.pixelRatio=z.pixelRatio,g.sps=[b.data],g.duration=f._duration;var A=b.data.subarray(1,4),B="avc1.";for(e=0;e<3;e++){var C=A[e].toString(16);C.length<2&&(C="0"+C),B+=C}g.codec=B}break;case 8:d=!0,i&&j&&(j.debug+="PPS "),g.pps||(g.pps=[b.data]);break;case 9:d=!1,j&&f.pushAccesUnit(j,g),j=f.avcSample=f._createAVCSample(!1,a.pts,a.dts,i?"AUD ":"");break;case 12:d=!1;break;default:d=!1,j&&(j.debug+="unknown NAL "+b.type+" ")}if(j&&d){var D=j.units;D.push(b)}}),b&&j&&(this.pushAccesUnit(j,g),this.avcSample=null)}},{key:"_createAVCSample",value:function(a,b,c,d){return{key:a,pts:b,dts:c,units:[],debug:d}}},{key:"_insertSampleInOrder",value:function(a,b){var c=a.length;if(c>0){if(b.pts>=a[c-1].pts)a.push(b);else for(var d=c-1;d>=0;d--)if(b.pts<a[d].pts){a.splice(d,0,b);break}}else a.push(b)}},{key:"_getLastNalUnit",value:function(){var a=this.avcSample,b=void 0;if(!a||0===a.units.length){var c=this._avcTrack,d=c.samples;a=d[d.length-1]}if(a){var e=a.units;b=e[e.length-1]}return b}},{key:"_parseAVCNALu",value:function(a){var b,c,d,e,f,g=0,h=a.byteLength,i=this._avcTrack,j=i.naluState||0,k=j,l=[],m=-1;for(j===-1&&(m=0,f=31&a[0],j=0,g=1);g<h;)if(b=a[g++],j)if(1!==j)if(b)if(1===b){if(m>=0)d={data:a.subarray(m,g-j-1),type:f},l.push(d);else{var n=this._getLastNalUnit();if(n&&(k&&g<=4-k&&n.state&&(n.data=n.data.subarray(0,n.data.byteLength-k)),c=g-j-1,c>0)){var o=new Uint8Array(n.data.byteLength+c);o.set(n.data,0),o.set(a.subarray(0,c),n.data.byteLength),n.data=o}}g<h?(e=31&a[g],m=g,f=e,j=0):j=-1}else j=0;else j=3;else j=b?0:2;else j=b?0:1;if(m>=0&&j>=0&&(d={data:a.subarray(m,h),type:f,state:j},l.push(d)),0===l.length){var p=this._getLastNalUnit();if(p){var q=new Uint8Array(p.data.byteLength+a.byteLength);q.set(p.data,0),q.set(a,p.data.byteLength),p.data=q}}return i.naluState=j,l}},{key:"discardEPB",value:function(a){for(var b,c,d=a.byteLength,e=[],f=1;f<d-2;)0===a[f]&&0===a[f+1]&&3===a[f+2]?(e.push(f+2),f+=2):f++;if(0===e.length)return a;b=d-e.length,c=new Uint8Array(b);var g=0;for(f=0;f<b;g++,f++)g===e[0]&&(g++,e.shift()),c[f]=a[g];return c}},{key:"_parseAACPES",value:function(a){var b,c,d,e,f,g=this._audioTrack,i=a.data,j=a.pts,k=0,m=this.aacOverFlow,n=this.aacLastPTS;if(m){var o=new Uint8Array(m.byteLength+i.byteLength);o.set(m,0),o.set(i,m.byteLength),i=o}for(d=k,f=i.length;d<f-1&&!h["default"].isHeader(i,d);d++);if(d){var p,s;if(d<f-1?(p="AAC PES did not start with ADTS header,offset:"+d,s=!1):(p="no ADTS header found in AAC PES",s=!0),q.logger.warn("parsing error:"+p),this.observer.trigger(l["default"].ERROR,{type:r.ErrorTypes.MEDIA_ERROR,details:r.ErrorDetails.FRAG_PARSING_ERROR,fatal:s,reason:p}),s)return}if(h["default"].initTrackConfig(g,this.observer,i,d,this.audioCodec),c=0,b=h["default"].getFrameDuration(g.samplerate),m&&n){var t=n+b;Math.abs(t-j)>1&&(q.logger.log("AAC: align PTS for overlapping frames by "+Math.round((t-j)/90)),j=t)}for(;d<f;)if(h["default"].isHeader(i,d)&&d+5<f){var u=h["default"].appendFrame(g,i,d,j,c);if(!u)break;d+=u.length,e=u.sample.pts,c++}else d++;m=d<f?i.subarray(d,f):null,this.aacOverFlow=m,this.aacLastPTS=e}},{key:"_parseMPEGPES",value:function(a){for(var b=a.data,c=b.length,d=0,e=0,f=a.pts;e<c;)if(j["default"].isHeader(b,e)){var g=j["default"].appendFrame(this._audioTrack,b,e,f,d);if(!g)break;e+=g.length,d++}else e++}},{key:"_parseID3PES",value:function(a){this._id3Track.samples.push(a)}}],[{key:"probe",value:function(a){return a.length>=564&&71===a[0]&&71===a[188]&&71===a[376]}}]),a}();c["default"]=s},{22:22,26:26,30:30,31:31,33:33,35:35,54:54}],33:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});c.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},c.ErrorDetails={MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOOP_LOADING_ERROR:"fragLoopLoadingError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException",WEBVTT_EXCEPTION:"webVTTException"}},{}],34:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a(54),i=a(33),j=a(35),k=d(j),l=function(){function a(b){e(this,a),this.hls=b,this.onEvent=this.onEvent.bind(this);for(var c=arguments.length,d=Array(c>1?c-1:0),f=1;f<c;f++)d[f-1]=arguments[f];this.handledEvents=d,this.useGenericHandler=!0,this.registerListeners()}return g(a,[{key:"destroy",value:function(){this.unregisterListeners()}},{key:"isEventHandler",value:function(){return"object"===f(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent}},{key:"registerListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(a){if("hlsEventGeneric"===a)throw new Error("Forbidden event name: "+a);this.hls.on(a,this.onEvent)},this)}},{key:"unregisterListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(a){this.hls.off(a,this.onEvent)},this)}},{key:"onEvent",value:function(a,b){this.onEventGeneric(a,b)}},{key:"onEventGeneric",value:function(a,b){var c=function(a,b){var c="on"+a.replace("hls","");if("function"!=typeof this[c])throw new Error("Event "+a+" has no generic handler in this "+this.constructor.name+" class (tried "+c+")");return this[c].bind(this,b)};try{c.call(this,a,b).call()}catch(d){h.logger.error("internal error happened while processing "+a+":"+d.message),this.hls.trigger(k["default"].ERROR,{type:i.ErrorTypes.OTHER_ERROR,details:i.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:a,err:d})}}}]),a}();c["default"]=l},{33:33,35:35,54:54}],35:[function(a,b,c){"use strict";b.exports={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCH:"hlsLevelSwitch",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCH:"hlsAudioTrackSwitch",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},{}],36:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){d(this,a)}return e(a,null,[{key:"getSilentFrame",value:function(a,b){switch(a){case"mp4a.40.2":if(1===b)return new Uint8Array([0,200,0,128,35,128]);if(2===b)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===b)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===b)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===b)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===b)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===b)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===b)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===b)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}}]),a}();c["default"]=f},{}],37:[function(a,b,c){"use strict";var d={isBuffered:function(a,b){if(a)for(var c=a.buffered,d=0;d<c.length;d++)if(b>=c.start(d)&&b<=c.end(d))return!0;return!1},bufferInfo:function(a,b,c){if(!a)return{len:0,start:b,end:b,nextStart:void 0};try{var d,e=a.buffered,f=[];for(d=0;d<e.length;d++)f.push({start:e.start(d),end:e.end(d)});return this.bufferedInfo(f,b,c)}catch(g){}},bufferedInfo:function(a,b,c){var d,e,f,g,h,i=[];for(a.sort(function(a,b){var c=a.start-b.start;return c?c:b.end-a.end}),h=0;h<a.length;h++){var j=i.length;if(j){var k=i[j-1].end;a[h].start-k<c?a[h].end>k&&(i[j-1].end=a[h].end):i.push(a[h])}else i.push(a[h])}for(h=0,d=0,e=f=b;h<i.length;h++){var l=i[h].start,m=i[h].end;if(b+c>=l&&b<m)e=l,f=m,d=f-b;else if(b+c<l){g=l;break}}return{len:d,start:e,end:f,nextStart:g}}};b.exports=d},{}],38:[function(a,b,c){
"use strict";var d=a(54),e={mergeDetails:function(a,b){var c,f=Math.max(a.startSN,b.startSN)-b.startSN,g=Math.min(a.endSN,b.endSN)-b.startSN,h=b.startSN-a.startSN,i=a.fragments,j=b.fragments,k=0;if(g<f)return void(b.PTSKnown=!1);for(var l=f;l<=g;l++){var m=i[h+l],n=j[l];n&&m&&(k=m.cc-n.cc,isNaN(m.startPTS)||(n.start=n.startPTS=m.startPTS,n.endPTS=m.endPTS,n.duration=m.duration,n.backtracked=m.backtracked,n.dropped=m.dropped,c=n))}if(k)for(d.logger.log("discontinuity sliding from playlist, take drift into account"),l=0;l<j.length;l++)j[l].cc+=k;if(c)e.updateFragPTSDTS(b,c,c.startPTS,c.endPTS,c.startDTS,c.endDTS);else if(h>=0&&h<i.length){var o=i[h].start;for(l=0;l<j.length;l++)j[l].start+=o}b.PTSKnown=a.PTSKnown},updateFragPTSDTS:function(a,b,c,d,f,g){var h=c;if(!isNaN(b.startPTS)){var i=Math.abs(b.startPTS-c);isNaN(b.deltaPTS)?b.deltaPTS=i:b.deltaPTS=Math.max(i,b.deltaPTS),h=Math.max(c,b.startPTS),c=Math.min(c,b.startPTS),d=Math.max(d,b.endPTS),f=Math.min(f,b.startDTS),g=Math.max(g,b.endDTS)}var j=c-b.start;b.start=b.startPTS=c,b.maxStartPTS=h,b.endPTS=d,b.startDTS=f,b.endDTS=g,b.duration=d-c;var k=b.sn;if(!a||k<a.startSN||k>a.endSN)return 0;var l,m,n;for(l=k-a.startSN,m=a.fragments,b=m[l],n=l;n>0;n--)e.updatePTS(m,n,n-1);for(n=l;n<m.length-1;n++)e.updatePTS(m,n,n+1);return a.PTSKnown=!0,j},updatePTS:function(a,b,c){var e=a[b],f=a[c],g=f.startPTS;isNaN(g)?c>b?f.start=e.start+e.duration:f.start=Math.max(e.start-f.duration,0):c>b?(e.duration=g-e.start,e.duration<0&&d.logger.warn("negative duration computed for frag "+e.sn+",level "+e.level+", there should be some duration drift between playlist and fragment!")):(f.duration=e.start-g,f.duration<0&&d.logger.warn("negative duration computed for frag "+f.sn+",level "+f.level+", there should be some duration drift between playlist and fragment!"))}};b.exports=e},{54:54}],39:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(2),h=d(g),i=a(35),j=d(i),k=a(33),l=a(43),m=d(l),n=a(41),o=d(n),p=a(42),q=d(p),r=a(13),s=d(r),t=a(12),u=d(t),v=a(11),w=d(v),x=a(54),y=a(1),z=d(y),A=a(4),B=function(){function a(){var b=this,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e(this,a);var d=a.DefaultConfig;if((c.liveSyncDurationCount||c.liveMaxLatencyDurationCount)&&(c.liveSyncDuration||c.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var f in d)f in c||(c[f]=d[f]);if(void 0!==c.liveMaxLatencyDurationCount&&c.liveMaxLatencyDurationCount<=c.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==c.liveMaxLatencyDuration&&(c.liveMaxLatencyDuration<=c.liveSyncDuration||void 0===c.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');(0,x.enableLogs)(c.debug),this.config=c,this._autoLevelCapping=-1;var g=this.observer=new z["default"];g.trigger=function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];g.emit.apply(g,[a,a].concat(c))},g.off=function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];g.removeListener.apply(g,[a].concat(c))},this.on=g.on.bind(g),this.off=g.off.bind(g),this.trigger=g.trigger.bind(g);var h=this.abrController=new c.abrController(this),i=new c.bufferController(this),j=new c.capLevelController(this),k=new c.fpsController(this),l=new m["default"](this),n=new o["default"](this),p=new q["default"](this),r=new w["default"](this),t=this.levelController=new u["default"](this),v=this.streamController=new s["default"](this),y=[t,v],A=c.audioStreamController;A&&y.push(new A(this)),this.networkControllers=y;var B=[l,n,p,h,i,j,k,r];if(A=c.audioTrackController){var C=new A(this);this.audioTrackController=C,B.push(C)}if(A=c.subtitleTrackController){var D=new A(this);this.subtitleTrackController=D,B.push(D)}[c.subtitleStreamController,c.timelineController].forEach(function(a){a&&B.push(new a(b))}),this.coreComponents=B}return f(a,null,[{key:"isSupported",value:function(){var a=window.MediaSource=window.MediaSource||window.WebKitMediaSource,b=window.SourceBuffer=window.SourceBuffer||window.WebKitSourceBuffer,c=a&&"function"==typeof a.isTypeSupported&&a.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),d=!b||b.prototype&&"function"==typeof b.prototype.appendBuffer&&"function"==typeof b.prototype.remove;return c&&d}},{key:"version",get:function(){return"0.7.10"}},{key:"Events",get:function(){return j["default"]}},{key:"ErrorTypes",get:function(){return k.ErrorTypes}},{key:"ErrorDetails",get:function(){return k.ErrorDetails}},{key:"DefaultConfig",get:function(){return a.defaultConfig?a.defaultConfig:A.hlsDefaultConfig},set:function(b){a.defaultConfig=b}}]),f(a,[{key:"destroy",value:function(){x.logger.log("destroy"),this.trigger(j["default"].DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(a){a.destroy()}),this.url=null,this.observer.removeAllListeners(),this._autoLevelCapping=-1}},{key:"attachMedia",value:function(a){x.logger.log("attachMedia"),this.media=a,this.trigger(j["default"].MEDIA_ATTACHING,{media:a})}},{key:"detachMedia",value:function(){x.logger.log("detachMedia"),this.trigger(j["default"].MEDIA_DETACHING),this.media=null}},{key:"loadSource",value:function(a){a.m3u8?(x.logger.log("loadSource:"+a.url),this.url=a.url,this.trigger(j["default"].MANIFEST_LOADING,{url:a.url,m3u8:a.m3u8})):(a=a.url,a=h["default"].buildAbsoluteURL(window.location.href,a,{alwaysNormalize:!0}),x.logger.log("loadSource:"+a),this.url=a,this.trigger(j["default"].MANIFEST_LOADING,{url:a}))}},{key:"startLoad",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;x.logger.log("startLoad("+a+")"),this.networkControllers.forEach(function(b){b.startLoad(a)})}},{key:"stopLoad",value:function(){x.logger.log("stopLoad"),this.networkControllers.forEach(function(a){a.stopLoad()})}},{key:"swapAudioCodec",value:function(){x.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}},{key:"recoverMediaError",value:function(){x.logger.log("recoverMediaError");var a=this.media;this.detachMedia(),this.attachMedia(a)}},{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(a){x.logger.log("set currentLevel:"+a),this.loadLevel=a,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(a){x.logger.log("set nextLevel:"+a),this.levelController.manualLevel=a,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(a){x.logger.log("set loadLevel:"+a),this.levelController.manualLevel=a}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(a){this.levelController.nextLoadLevel=a}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(a){x.logger.log("set firstLevel:"+a),this.levelController.firstLevel=a}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(a){x.logger.log("set startLevel:"+a);var b=this;a!==-1&&(a=Math.max(a,b.minAutoLevel)),b.levelController.startLevel=a}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(a){x.logger.log("set autoLevelCapping:"+a),this._autoLevelCapping=a}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var a=this,b=a.levels,c=a.config.minAutoBitrate,d=b?b.length:0,e=0;e<d;e++){var f=b[e].realBitrate?Math.max(b[e].realBitrate,b[e].bitrate):b[e].bitrate;if(f>c)return e}return 0}},{key:"maxAutoLevel",get:function(){var a=this,b=a.levels,c=a.autoLevelCapping,d=void 0;return d=c===-1&&b&&b.length?b.length-1:c}},{key:"nextAutoLevel",get:function(){var a=this;return Math.min(Math.max(a.abrController.nextAutoLevel,a.minAutoLevel),a.maxAutoLevel)},set:function(a){var b=this;b.abrController.nextAutoLevel=Math.max(b.minAutoLevel,a)}},{key:"audioTracks",get:function(){var a=this.audioTrackController;return a?a.audioTracks:[]}},{key:"audioTrack",get:function(){var a=this.audioTrackController;return a?a.audioTrack:-1},set:function(a){var b=this.audioTrackController;b&&(b.audioTrack=a)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var a=this.subtitleTrackController;return a?a.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var a=this.subtitleTrackController;return a?a.subtitleTrack:-1},set:function(a){var b=this.subtitleTrackController;b&&(b.subtitleTrack=a)}}]),a}();c["default"]=B},{1:1,11:11,12:12,13:13,2:2,33:33,35:35,4:4,41:41,42:42,43:43,54:54}],40:[function(a,b,c){"use strict";b.exports=a(39)["default"]},{39:39}],41:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(35),j=d(i),k=a(34),l=d(k),m=a(33),n=a(54),o=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,j["default"].FRAG_LOADING));return c.loaders={},c}return g(b,a),h(b,[{key:"destroy",value:function(){var a=this.loaders;for(var b in a){var c=a[b];c&&c.destroy()}this.loaders={},l["default"].prototype.destroy.call(this)}},{key:"onFragLoading",value:function(a){var b=a.frag,c=b.type,d=this.loaders[c],e=this.hls.config;b.loaded=0,d&&(n.logger.warn("abort previous fragment loader for type:"+c),d.abort()),d=this.loaders[c]=b.loader="undefined"!=typeof e.fLoader?new e.fLoader(e):new e.loader(e);var f=void 0,g=void 0,h=void 0;f={url:b.url,frag:b,responseType:"arraybuffer",progressData:!1};var i=b.byteRangeStartOffset,j=b.byteRangeEndOffset;isNaN(i)||isNaN(j)||(f.rangeStart=i,f.rangeEnd=j),g={timeout:e.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:e.fragLoadingMaxRetryTimeout},h={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},d.load(f,g,h)}},{key:"loadsuccess",value:function(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,e=a.data,f=c.frag;f.loader=void 0,this.loaders[f.type]=void 0,this.hls.trigger(j["default"].FRAG_LOADED,{payload:e,frag:f,stats:b,networkDetails:d})}},{key:"loaderror",value:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,d=b.loader;d&&d.abort(),this.loaders[b.type]=void 0,this.hls.trigger(j["default"].ERROR,{type:m.ErrorTypes.NETWORK_ERROR,details:m.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:b.frag,response:a,networkDetails:c})}},{key:"loadtimeout",value:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,d=b.loader;d&&d.abort(),this.loaders[b.type]=void 0,this.hls.trigger(j["default"].ERROR,{type:m.ErrorTypes.NETWORK_ERROR,details:m.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:b.frag,networkDetails:c})}},{key:"loadprogress",value:function(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,e=b.frag;e.loaded=a.loaded,this.hls.trigger(j["default"].FRAG_LOAD_PROGRESS,{frag:e,stats:a,networkDetails:d})}}]),b}(l["default"]);c["default"]=o},{33:33,34:34,35:35,54:54}],42:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(35),j=d(i),k=a(34),l=d(k),m=a(33),n=a(54),o=function(a){function b(a){e(this,b);var c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,j["default"].KEY_LOADING));return c.loaders={},c.decryptkey=null,c.decrypturl=null,c}return g(b,a),h(b,[{key:"destroy",value:function(){for(var a in this.loaders){var b=this.loaders[a];b&&b.destroy()}this.loaders={},l["default"].prototype.destroy.call(this)}},{key:"onKeyLoading",value:function(a){var b=a.frag,c=b.type,d=this.loaders[c],e=b.decryptdata,f=e.uri;if(f!==this.decrypturl||null===this.decryptkey){var g=this.hls.config;d&&(n.logger.warn("abort previous key loader for type:"+c),d.abort()),b.loader=this.loaders[c]=new g.loader(g),this.decrypturl=f,this.decryptkey=null;var h=void 0,i=void 0,k=void 0;h={url:f,frag:b,responseType:"arraybuffer"},i={timeout:g.fragLoadingTimeOut,maxRetry:g.fragLoadingMaxRetry,retryDelay:g.fragLoadingRetryDelay,maxRetryDelay:g.fragLoadingMaxRetryTimeout},k={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},b.loader.load(h,i,k)}else this.decryptkey&&(e.key=this.decryptkey,this.hls.trigger(j["default"].KEY_LOADED,{frag:b}))}},{key:"loadsuccess",value:function(a,b,c){var d=c.frag;this.decryptkey=d.decryptdata.key=new Uint8Array(a.data),d.loader=void 0,this.loaders[d.type]=void 0,this.hls.trigger(j["default"].KEY_LOADED,{frag:d})}},{key:"loaderror",value:function(a,b){var c=b.frag,d=c.loader;d&&d.abort(),this.loaders[b.type]=void 0,this.hls.trigger(j["default"].ERROR,{type:m.ErrorTypes.NETWORK_ERROR,details:m.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:c,response:a})}},{key:"loadtimeout",value:function(a,b){var c=b.frag,d=c.loader;d&&d.abort(),this.loaders[b.type]=void 0,this.hls.trigger(j["default"].ERROR,{type:m.ErrorTypes.NETWORK_ERROR,details:m.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:c})}}]),b}(l["default"]);c["default"]=o},{33:33,34:34,35:35,54:54}],43:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function g(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a(2),j=d(i),k=a(35),l=d(k),m=a(34),n=d(m),o=a(33),p=a(47),q=d(p),r=a(54),s=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,t=/#EXT-X-MEDIA:(.*)/g,u=new RegExp([/#EXTINF:(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)(\S+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),v=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,w=function(){function a(){g(this,a),this.method=null,this.key=null,this.iv=null,this._uri=null}return h(a,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=j["default"].buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}]),a}(),x=function(){function a(){g(this,a),this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[]}return h(a,[{key:"createInitializationVector",value:function(a){for(var b=new Uint8Array(16),c=12;c<16;c++)b[c]=a>>8*(15-c)&255;return b}},{key:"fragmentDecryptdataFromLevelkey",value:function(a,b){var c=a;return a&&a.method&&a.uri&&!a.iv&&(c=new w,c.method=a.method,c.baseuri=a.baseuri,c.reluri=a.reluri,c.iv=this.createInitializationVector(b)),c}},{key:"cloneObj",value:function(a){return JSON.parse(JSON.stringify(a))}},{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=j["default"].buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(a){this._url=a}},{key:"programDateTime",get:function(){return!this._programDateTime&&this.rawProgramDateTime&&(this._programDateTime=new Date(Date.parse(this.rawProgramDateTime))),this._programDateTime}},{key:"byteRange",get:function(){if(!this._byteRange){var a=this._byteRange=[];if(this.rawByteRange){var b=this.rawByteRange.split("@",2);if(1===b.length){var c=this.lastByteRangeEndOffset;a[0]=c?c:0}else a[0]=parseInt(b[1]);a[1]=parseInt(b[0])+a[0]}}return this._byteRange}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata}}]),a}(),y=function(a){function b(a){g(this,b);var c=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,l["default"].MANIFEST_LOADING,l["default"].LEVEL_LOADING,l["default"].AUDIO_TRACK_LOADING,l["default"].SUBTITLE_TRACK_LOADING));return c.loaders={},c}return f(b,a),h(b,[{key:"destroy",value:function(){for(var a in this.loaders){var b=this.loaders[a];b&&b.destroy()}this.loaders={},n["default"].prototype.destroy.call(this)}},{key:"onManifestLoading",value:function(a){a.m3u8?this.loadsuccess({data:a.m3u8,url:a.url},{loaded:1,retry:1,tfirst:1,tload:1,total:1,trequest:1},{type:"manifest",url:a.url}):this.load(a.url,{type:"manifest"})}},{key:"onLevelLoading",value:function(a){this.load(a.url,{type:"level",level:a.level,id:a.id})}},{key:"onAudioTrackLoading",value:function(a){this.load(a.url,{type:"audioTrack",id:a.id})}},{key:"onSubtitleTrackLoading",value:function(a){this.load(a.url,{type:"subtitleTrack",id:a.id})}},{key:"load",value:function(a,b){var c=this.loaders[b.type];if(c){var d=c.context;if(d&&d.url===a)return void r.logger.trace("playlist request ongoing");r.logger.warn("abort previous loader for type:"+b.type),c.abort()}var e=this.hls.config,f=void 0,g=void 0,h=void 0,i=void 0;"manifest"===b.type?(f=e.manifestLoadingMaxRetry,g=e.manifestLoadingTimeOut,h=e.manifestLoadingRetryDelay,i=e.manifestLoadingMaxRetryTimeout):(f=e.levelLoadingMaxRetry,g=e.levelLoadingTimeOut,h=e.levelLoadingRetryDelay,i=e.levelLoadingMaxRetryTimeout,r.logger.log("loading playlist for "+b.type+" "+(b.level||b.id))),c=this.loaders[b.type]=b.loader="undefined"!=typeof e.pLoader?new e.pLoader(e):new e.loader(e),b.url=a,b.responseType="";var j=void 0,k=void 0;j={timeout:g,maxRetry:f,retryDelay:h,maxRetryDelay:i},k={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},c.load(b,j,k)}},{key:"resolve",value:function(a,b){return j["default"].buildAbsoluteURL(b,a,{alwaysNormalize:!0})}},{key:"parseMasterPlaylist",value:function(a,b){var c=[],d=void 0;for(s.lastIndex=0;null!=(d=s.exec(a));){var e={},f=e.attrs=new q["default"](d[1]);e.url=this.resolve(d[2],b);var g=f.decimalResolution("RESOLUTION");g&&(e.width=g.width,e.height=g.height),e.bitrate=f.decimalInteger("AVERAGE-BANDWIDTH")||f.decimalInteger("BANDWIDTH"),e.name=f.NAME;var h=f.CODECS;if(h){h=h.split(/[ ,]+/);for(var i=0;i<h.length;i++){var j=h[i];j.indexOf("avc1")!==-1?e.videoCodec=this.avc1toavcoti(j):j.indexOf("hvc1")!==-1?e.videoCodec=j:e.audioCodec=j}}c.push(e)}return c}},{key:"parseMasterPlaylistMedia",value:function(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,e=void 0,f=[],g=0;for(t.lastIndex=0;null!=(e=t.exec(a));){var h={},i=new q["default"](e[1]);i.TYPE===c&&(h.groupId=i["GROUP-ID"],h.name=i.NAME,h.type=c,h["default"]="YES"===i.DEFAULT,h.autoselect="YES"===i.AUTOSELECT,h.forced="YES"===i.FORCED,i.URI&&(h.url=this.resolve(i.URI,b)),h.lang=i.LANGUAGE,h.name||(h.name=h.lang),d&&(h.audioCodec=d),h.id=g++,f.push(h))}return f}},{key:"avc1toavcoti",value:function(a){var b,c=a.split(".");return c.length>2?(b=c.shift()+".",b+=parseInt(c.shift()).toString(16),b+=("000"+parseInt(c.shift()).toString(16)).substr(-4)):b=a,b}},{key:"parseLevelPlaylist",value:function(a,b,c,d){var e,f,g=0,h=0,i={type:null,version:null,url:b,fragments:[],live:!0,startSN:0},j=new w,k=0,l=null,m=new x;for(u.lastIndex=0;null!==(e=u.exec(a));){var n=e[1];if(n){m.duration=parseFloat(n);var o=(" "+e[2]).slice(1);m.title=o?o:null,m.tagList.push(o?["INF",n,o]:["INF",n])}else if(e[3]){if(!isNaN(m.duration)){var p=g++;m.type=d,m.start=h,m.levelkey=j,m.sn=p,m.level=c,m.cc=k,m.baseurl=b,m.relurl=(" "+e[3]).slice(1),i.fragments.push(m),l=m,h+=m.duration,m=new x}}else if(e[4]){if(m.rawByteRange=(" "+e[4]).slice(1),l){var s=l.byteRangeEndOffset;s&&(m.lastByteRangeEndOffset=s)}}else if(e[5])m.rawProgramDateTime=(" "+e[5]).slice(1),m.tagList.push(["PROGRAM-DATE-TIME",m.rawProgramDateTime]);else{for(e=e[0].match(v),f=1;f<e.length&&void 0===e[f];f++);var t=(" "+e[f+1]).slice(1),y=(" "+e[f+2]).slice(1);switch(e[f]){case"#":m.tagList.push(y?[t,y]:[t]);break;case"PLAYLIST-TYPE":i.type=t.toUpperCase();break;case"MEDIA-SEQUENCE":g=i.startSN=parseInt(t);break;case"TARGETDURATION":i.targetduration=parseFloat(t);break;case"VERSION":i.version=parseInt(t);break;case"EXTM3U":break;case"ENDLIST":i.live=!1;break;case"DIS":k++,m.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":k=parseInt(t);break;case"KEY":var z=t,A=new q["default"](z),B=A.enumeratedString("METHOD"),C=A.URI,D=A.hexadecimalInteger("IV");B&&(j=new w,C&&["AES-128","SAMPLE-AES"].indexOf(B)>=0&&(j.method=B,j.baseuri=b,j.reluri=C,j.key=null,j.iv=D));break;case"START":var E=t,F=new q["default"](E),G=F.decimalFloatingPoint("TIME-OFFSET");isNaN(G)||(i.startTimeOffset=G);break;case"MAP":var H=new q["default"](t);m.relurl=H.URI,m.rawByteRange=H.BYTERANGE,m.baseurl=b,m.level=c,m.type=d,m.sn="initSegment",i.initSegment=m,m=new x;break;default:r.logger.warn("line parsed but not handled: "+e)}}}return m=l,m&&!m.relurl&&(i.fragments.pop(),h-=m.duration),i.totalduration=h,i.averagetargetduration=h/i.fragments.length,i.endSN=g-1,i}},{key:"loadsuccess",value:function(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,e=a.data,f=a.url,g=c.type,h=c.id,i=c.level,j=this.hls;if(this.loaders[g]=void 0,void 0!==f&&0!==f.indexOf("data:")||(f=c.url),b.tload=performance.now(),0===e.indexOf("#EXTM3U"))if(e.indexOf("#EXTINF:")>0){var k="audioTrack"!==g&&"subtitleTrack"!==g,m=isNaN(i)?isNaN(h)?0:h:i,n=this.parseLevelPlaylist(e,f,m,"audioTrack"===g?"audio":"subtitleTrack"===g?"subtitle":"main");n.tload=b.tload,"manifest"===g&&j.trigger(l["default"].MANIFEST_LOADED,{levels:[{url:f,details:n}],audioTracks:[],url:f,stats:b,networkDetails:d}),b.tparsed=performance.now(),n.targetduration?k?j.trigger(l["default"].LEVEL_LOADED,{details:n,level:i||0,id:h||0,stats:b,networkDetails:d}):"audioTrack"===g?j.trigger(l["default"].AUDIO_TRACK_LOADED,{details:n,id:h,stats:b,networkDetails:d}):"subtitleTrack"===g&&j.trigger(l["default"].SUBTITLE_TRACK_LOADED,{details:n,id:h,stats:b,networkDetails:d}):j.trigger(l["default"].ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:f,reason:"invalid targetduration",networkDetails:d})}else{var p=this.parseMasterPlaylist(e,f);if(p.length){var q=this.parseMasterPlaylistMedia(e,f,"AUDIO",p[0].audioCodec),s=this.parseMasterPlaylistMedia(e,f,"SUBTITLES");if(q.length){var t=!1;q.forEach(function(a){a.url||(t=!0)}),t===!1&&p[0].audioCodec&&!p[0].attrs.AUDIO&&(r.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),q.unshift({type:"main",name:"main"}))}j.trigger(l["default"].MANIFEST_LOADED,{levels:p,audioTracks:q,subtitles:s,url:f,stats:b,networkDetails:d})}else j.trigger(l["default"].ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:f,reason:"no level found in manifest",networkDetails:d})}else j.trigger(l["default"].ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:f,reason:"no EXTM3U delimiter",networkDetails:d})}},{key:"loaderror",value:function(a,b){var c,d,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,f=b.loader;switch(b.type){case"manifest":c=o.ErrorDetails.MANIFEST_LOAD_ERROR,d=!0;break;case"level":c=o.ErrorDetails.LEVEL_LOAD_ERROR,d=!1;break;case"audioTrack":c=o.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,d=!1}f&&(f.abort(),this.loaders[b.type]=void 0),this.hls.trigger(l["default"].ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:c,fatal:d,url:f.url,loader:f,response:a,context:b,networkDetails:e})}},{key:"loadtimeout",value:function(a,b){var c,d,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,f=b.loader;switch(b.type){case"manifest":c=o.ErrorDetails.MANIFEST_LOAD_TIMEOUT,d=!0;break;case"level":c=o.ErrorDetails.LEVEL_LOAD_TIMEOUT,d=!1;break;case"audioTrack":c=o.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT,d=!1}f&&(f.abort(),this.loaders[b.type]=void 0),this.hls.trigger(l["default"].ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:c,fatal:d,url:f.url,loader:f,context:b,networkDetails:e})}}]),b}(n["default"]);c["default"]=y},{2:2,33:33,34:34,35:35,47:47,54:54}],44:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=Math.pow(2,32)-1,g=function(){function a(){d(this,a)}return e(a,null,[{key:"init",value:function(){a.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var b;for(b in a.types)a.types.hasOwnProperty(b)&&(a.types[b]=[b.charCodeAt(0),b.charCodeAt(1),b.charCodeAt(2),b.charCodeAt(3)]);var c=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),d=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);a.HDLR_TYPES={video:c,audio:d};var e=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),f=new Uint8Array([0,0,0,0,0,0,0,0]);a.STTS=a.STSC=a.STCO=f,a.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),a.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),a.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),a.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var g=new Uint8Array([105,115,111,109]),h=new Uint8Array([97,118,99,49]),i=new Uint8Array([0,0,0,1]);a.FTYP=a.box(a.types.ftyp,g,i,g,h),a.DINF=a.box(a.types.dinf,a.box(a.types.dref,e))}},{key:"box",value:function(a){for(var b,c=Array.prototype.slice.call(arguments,1),d=8,e=c.length,f=e;e--;)d+=c[e].byteLength;for(b=new Uint8Array(d),b[0]=d>>24&255,b[1]=d>>16&255,b[2]=d>>8&255,b[3]=255&d,b.set(a,4),e=0,d=8;e<f;e++)b.set(c[e],d),d+=c[e].byteLength;return b}},{key:"hdlr",value:function(b){return a.box(a.types.hdlr,a.HDLR_TYPES[b])}},{key:"mdat",value:function(b){return a.box(a.types.mdat,b)}},{key:"mdhd",value:function(b,c){c*=b;var d=Math.floor(c/(f+1)),e=Math.floor(c%(f+1));return a.box(a.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,b>>24&255,b>>16&255,b>>8&255,255&b,d>>24,d>>16&255,d>>8&255,255&d,e>>24,e>>16&255,e>>8&255,255&e,85,196,0,0]))}},{key:"mdia",value:function(b){return a.box(a.types.mdia,a.mdhd(b.timescale,b.duration),a.hdlr(b.type),a.minf(b))}},{key:"mfhd",value:function(b){return a.box(a.types.mfhd,new Uint8Array([0,0,0,0,b>>24,b>>16&255,b>>8&255,255&b]))}},{key:"minf",value:function(b){return"audio"===b.type?a.box(a.types.minf,a.box(a.types.smhd,a.SMHD),a.DINF,a.stbl(b)):a.box(a.types.minf,a.box(a.types.vmhd,a.VMHD),a.DINF,a.stbl(b))}},{key:"moof",value:function(b,c,d){return a.box(a.types.moof,a.mfhd(b),a.traf(d,c))}},{key:"moov",value:function(b){for(var c=b.length,d=[];c--;)d[c]=a.trak(b[c]);return a.box.apply(null,[a.types.moov,a.mvhd(b[0].timescale,b[0].duration)].concat(d).concat(a.mvex(b)))}},{key:"mvex",value:function(b){for(var c=b.length,d=[];c--;)d[c]=a.trex(b[c]);return a.box.apply(null,[a.types.mvex].concat(d))}},{key:"mvhd",value:function(b,c){c*=b;var d=Math.floor(c/(f+1)),e=Math.floor(c%(f+1)),g=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,b>>24&255,b>>16&255,b>>8&255,255&b,d>>24,d>>16&255,d>>8&255,255&d,e>>24,e>>16&255,e>>8&255,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return a.box(a.types.mvhd,g)}},{key:"sdtp",value:function(b){var c,d,e=b.samples||[],f=new Uint8Array(4+e.length);for(d=0;d<e.length;d++)c=e[d].flags,f[d+4]=c.dependsOn<<4|c.isDependedOn<<2|c.hasRedundancy;return a.box(a.types.sdtp,f)}},{key:"stbl",value:function(b){return a.box(a.types.stbl,a.stsd(b),a.box(a.types.stts,a.STTS),a.box(a.types.stsc,a.STSC),a.box(a.types.stsz,a.STSZ),a.box(a.types.stco,a.STCO))}},{key:"avc1",value:function(b){var c,d,e,f=[],g=[];for(c=0;c<b.sps.length;c++)d=b.sps[c],e=d.byteLength,f.push(e>>>8&255),f.push(255&e),f=f.concat(Array.prototype.slice.call(d));for(c=0;c<b.pps.length;c++)d=b.pps[c],e=d.byteLength,g.push(e>>>8&255),g.push(255&e),g=g.concat(Array.prototype.slice.call(d));var h=a.box(a.types.avcC,new Uint8Array([1,f[3],f[4],f[5],255,224|b.sps.length].concat(f).concat([b.pps.length]).concat(g))),i=b.width,j=b.height,k=b.pixelRatio[0],l=b.pixelRatio[1];return a.box(a.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,i>>8&255,255&i,j>>8&255,255&j,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),h,a.box(a.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),a.box(a.types.pasp,new Uint8Array([k>>24,k>>16&255,k>>8&255,255&k,l>>24,l>>16&255,l>>8&255,255&l])));
}},{key:"esds",value:function(a){var b=a.config.length;return new Uint8Array([0,0,0,0,3,23+b,0,1,0,4,15+b,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([b]).concat(a.config).concat([6,1,2]))}},{key:"mp4a",value:function(b){var c=b.samplerate;return a.box(a.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,b.channelCount,0,16,0,0,0,0,c>>8&255,255&c,0,0]),a.box(a.types.esds,a.esds(b)))}},{key:"mp3",value:function(b){var c=b.samplerate;return a.box(a.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,b.channelCount,0,16,0,0,0,0,c>>8&255,255&c,0,0]))}},{key:"stsd",value:function(b){return"audio"===b.type?b.isAAC||"mp3"!==b.codec?a.box(a.types.stsd,a.STSD,a.mp4a(b)):a.box(a.types.stsd,a.STSD,a.mp3(b)):a.box(a.types.stsd,a.STSD,a.avc1(b))}},{key:"tkhd",value:function(b){var c=b.id,d=b.duration*b.timescale,e=b.width,g=b.height,h=Math.floor(d/(f+1)),i=Math.floor(d%(f+1));return a.box(a.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,c>>24&255,c>>16&255,c>>8&255,255&c,0,0,0,0,h>>24,h>>16&255,h>>8&255,255&h,i>>24,i>>16&255,i>>8&255,255&i,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,e>>8&255,255&e,0,0,g>>8&255,255&g,0,0]))}},{key:"traf",value:function(b,c){var d=a.sdtp(b),e=b.id,g=Math.floor(c/(f+1)),h=Math.floor(c%(f+1));return a.box(a.types.traf,a.box(a.types.tfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e])),a.box(a.types.tfdt,new Uint8Array([1,0,0,0,g>>24,g>>16&255,g>>8&255,255&g,h>>24,h>>16&255,h>>8&255,255&h])),a.trun(b,d.length+16+20+8+16+8+8),d)}},{key:"trak",value:function(b){return b.duration=b.duration||4294967295,a.box(a.types.trak,a.tkhd(b),a.mdia(b))}},{key:"trex",value:function(b){var c=b.id;return a.box(a.types.trex,new Uint8Array([0,0,0,0,c>>24,c>>16&255,c>>8&255,255&c,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(b,c){var d,e,f,g,h,i,j=b.samples||[],k=j.length,l=12+16*k,m=new Uint8Array(l);for(c+=8+l,m.set([0,0,15,1,k>>>24&255,k>>>16&255,k>>>8&255,255&k,c>>>24&255,c>>>16&255,c>>>8&255,255&c],0),d=0;d<k;d++)e=j[d],f=e.duration,g=e.size,h=e.flags,i=e.cts,m.set([f>>>24&255,f>>>16&255,f>>>8&255,255&f,g>>>24&255,g>>>16&255,g>>>8&255,255&g,h.isLeading<<2|h.dependsOn,h.isDependedOn<<6|h.hasRedundancy<<4|h.paddingValue<<1|h.isNonSync,61440&h.degradPrio,15&h.degradPrio,i>>>24&255,i>>>16&255,i>>>8&255,255&i],12+16*d);return a.box(a.types.trun,m)}},{key:"initSegment",value:function(b){a.types||a.init();var c,d=a.moov(b);return c=new Uint8Array(a.FTYP.byteLength+d.byteLength),c.set(a.FTYP),c.set(d,a.FTYP.byteLength),c}}]),a}();c["default"]=g},{}],45:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(36),h=d(g),i=a(35),j=d(i),k=a(54),l=a(44),m=d(l),n=a(33),o=1e4,p=function(){function a(b,c,d,f){e(this,a),this.observer=b,this.config=c,this.typeSupported=d;var g=navigator.userAgent;this.isSafari=f&&f.indexOf("Apple")>-1&&g&&!g.match("CriOS"),this.ISGenerated=!1}return f(a,[{key:"destroy",value:function(){}},{key:"resetTimeStamp",value:function(a){this._initPTS=this._initDTS=a}},{key:"resetInitSegment",value:function(){this.ISGenerated=!1}},{key:"remux",value:function(a,b,c,d,e,f,g){if(this.ISGenerated){if(g){var h=this._initPTS,i=this._PTSNormalize,l=a.inputTimeScale||b.inputTimeScale,m=1/0,n=1/0,o=a.samples;if(o.length&&(m=n=i(o[0].pts-l*e,h)),o=b.samples,o.length){var p=o[0];m=Math.min(m,i(p.pts-l*e,h)),n=Math.min(n,i(p.dts-l*e,h))}if(m!==1/0){var q=h-m;Math.abs(q)>10*l&&(k.logger.warn("timestamp inconsistency, "+(q/l).toFixed(3)+"s delta against expected value: missing discontinuity ? reset initPTS/initDTS"),this._initPTS=m,this._initDTS=n,this.observer.trigger(j["default"].INIT_PTS_FOUND,{initPTS:m}))}}}else this.generateIS(a,b,e);if(this.ISGenerated)if(a.samples.length){a.timescale||(k.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(a,b,e));var r=this.remuxAudio(a,e,f,g);if(b.samples.length){var s=void 0;r&&(s=r.endPTS-r.startPTS),b.timescale||(k.logger.warn("regenerate InitSegment as video detected"),this.generateIS(a,b,e)),this.remuxVideo(b,e,f,s,g)}}else{var t=void 0;b.samples.length&&(t=this.remuxVideo(b,e,f,g)),t&&a.codec&&this.remuxEmptyAudio(a,e,f,t)}c.samples.length&&this.remuxID3(c,e),d.samples.length&&this.remuxText(d,e),this.observer.trigger(j["default"].FRAG_PARSED)}},{key:"generateIS",value:function(a,b,c){var d,e,f=this.observer,g=a.samples,h=b.samples,i=this.typeSupported,l="audio/mp4",o={},p={tracks:o},q=void 0===this._initPTS;if(q&&(d=e=1/0),a.config&&g.length&&(a.timescale=a.samplerate,k.logger.log("audio sampling rate : "+a.samplerate),a.isAAC||(i.mpeg?(l="audio/mpeg",a.codec=""):i.mp3&&(a.codec="mp3")),o.audio={container:l,codec:a.codec,initSegment:!a.isAAC&&i.mpeg?new Uint8Array:m["default"].initSegment([a]),metadata:{channelCount:a.channelCount}},q&&(d=e=g[0].pts-a.inputTimeScale*c)),b.sps&&b.pps&&h.length){var r=b.inputTimeScale;b.timescale=r,o.video={container:"video/mp4",codec:b.codec,initSegment:m["default"].initSegment([b]),metadata:{width:b.width,height:b.height}},q&&(d=Math.min(d,h[0].pts-r*c),e=Math.min(e,h[0].dts-r*c),this.observer.trigger(j["default"].INIT_PTS_FOUND,{initPTS:d}))}Object.keys(o).length?(f.trigger(j["default"].FRAG_PARSING_INIT_SEGMENT,p),this.ISGenerated=!0,q&&(this._initPTS=d,this._initDTS=e)):f.trigger(j["default"].ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})}},{key:"remuxVideo",value:function(a,b,c,d,e){var f,g,h,i,l,o,p,q,r=8,s=a.timescale,t=a.samples,u=[],v=t.length,w=this._PTSNormalize,x=this._initDTS,y=this.nextAvcDts,z=this.isSafari;z&&(c|=t.length&&y&&(e&&Math.abs(b-y/s)<.1||Math.abs(t[0].pts-y-x)<s/5)),c||(y=b*s),t.forEach(function(a){a.pts=w(a.pts-x,y),a.dts=w(a.dts-x,y)}),t.sort(function(a,b){var c=a.dts-b.dts,d=a.pts-b.pts;return c?c:d?d:a.id-b.id});var A=t.reduce(function(a,b){return Math.max(Math.min(a,b.pts-b.dts),-18e3)},0);if(A<0){k.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(A/90)+" ms to overcome this issue");for(var B=0;B<t.length;B++)t[B].dts+=A}var C=t[0];l=Math.max(C.dts,0),i=Math.max(C.pts,0);var D=Math.round((l-y)/90);c&&D&&(D>1?k.logger.log("AVC:"+D+" ms hole between fragments detected,filling it"):D<-1&&k.logger.log("AVC:"+-D+" ms overlapping between fragments detected"),l=y,t[0].dts=l,i=Math.max(i-D,y),t[0].pts=i,k.logger.log("Video/PTS/DTS adjusted: "+Math.round(i/90)+"/"+Math.round(l/90)+",delta:"+D+" ms")),o=l,C=t[t.length-1],q=Math.max(C.dts,0),p=Math.max(C.pts,0,q),z&&(f=Math.round((q-l)/(t.length-1)));for(var E=0,F=0,G=0;G<v;G++){for(var H=t[G],I=H.units,J=I.length,K=0,L=0;L<J;L++)K+=I[L].data.length;F+=K,E+=J,H.length=K,z?H.dts=l+G*f:H.dts=Math.max(H.dts,l),H.pts=Math.max(H.pts,H.dts)}var M=F+4*E+8;try{g=new Uint8Array(M)}catch(N){return void this.observer.trigger(j["default"].ERROR,{type:n.ErrorTypes.MUX_ERROR,details:n.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:M,reason:"fail allocating video mdat "+M})}var O=new DataView(g.buffer);O.setUint32(0,M),g.set(m["default"].types.mdat,4);for(var P=0;P<v;P++){for(var Q=t[P],R=Q.units,S=0,T=void 0,U=0,V=R.length;U<V;U++){var W=R[U],X=W.data,Y=W.data.byteLength;O.setUint32(r,Y),r+=4,g.set(X,r),r+=Y,S+=4+Y}if(z)T=Math.max(0,f*Math.round((Q.pts-Q.dts)/f));else{if(P<v-1)f=t[P+1].dts-Q.dts;else{var Z=this.config,$=Q.dts-t[P>0?P-1:P].dts;if(Z.stretchShortVideoTrack){var _=Z.maxBufferHole,aa=Z.maxSeekHole,ba=Math.floor(Math.min(_,aa)*s),ca=(d?i+d*s:this.nextAudioPts)-Q.pts;ca>ba?(f=ca-$,f<0&&(f=$),k.logger.log("It is approximately "+ca/90+" ms to the next segment; using duration "+f/90+" ms for the last video frame.")):f=$}else f=$}T=Math.round(Q.pts-Q.dts)}u.push({size:S,duration:f,cts:T,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:Q.key?2:1,isNonSync:Q.key?0:1}})}this.nextAvcDts=q+f;var da=a.dropped;if(a.len=0,a.nbNalu=0,a.dropped=0,u.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var ea=u[0].flags;ea.dependsOn=2,ea.isNonSync=0}a.samples=u,h=m["default"].moof(a.sequenceNumber++,l,a),a.samples=[];var fa={data1:h,data2:g,startPTS:i/s,endPTS:(p+f)/s,startDTS:l/s,endDTS:this.nextAvcDts/s,type:"video",nb:u.length,dropped:da};return this.observer.trigger(j["default"].FRAG_PARSING_DATA,fa),fa}},{key:"remuxAudio",value:function(a,b,c,d){var e,f,g,h,i,l,p,q=a.inputTimeScale,r=a.timescale,s=q/r,t=a.isAAC?1024:1152,u=t*s,v=this._PTSNormalize,w=this._initDTS,x=!a.isAAC&&this.typeSupported.mpeg,y=a.samples,z=[],A=this.nextAudioPts;if(c|=y.length&&A&&(d&&Math.abs(b-A/q)<.1||Math.abs(y[0].pts-A-w)<20*u),c||(A=b*q),y.forEach(function(a){a.pts=a.dts=v(a.pts-w,A)}),y.sort(function(a,b){return a.pts-b.pts}),d&&a.isAAC)for(var B=0,C=A;B<y.length;){var D,E=y[B],F=E.pts;D=F-C;var G=Math.abs(1e3*D/q);if(D<=-u)k.logger.warn("Dropping 1 audio frame @ "+(C/q).toFixed(3)+"s due to "+G+" ms overlap."),y.splice(B,1),a.len-=E.unit.length;else if(D>=u&&G<o&&C){var H=Math.round(D/u);k.logger.warn("Injecting "+H+" audio frame @ "+(C/q).toFixed(3)+"s due to "+Math.round(1e3*D/q)+" ms gap.");for(var I=0;I<H;I++){var J=Math.max(C,0);g||(k.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),g=E.unit.subarray()),y.splice(B,0,{unit:g,pts:J,dts:J}),a.len+=g.length,C+=u,B++}E.pts=E.dts=C,C+=u,B++}else Math.abs(D)>.1*u,E.pts=E.dts=C,C+=u,B++}for(var K=0,L=y.length;K<L;K++){var M=y[K],N=M.unit,O=M.pts;if(void 0!==p)f.duration=Math.round((O-p)/s);else{var P=Math.round(1e3*(O-A)/q),Q=0;if(c&&a.isAAC&&P){if(P>0&&P<o)Q=Math.round((O-A)/u),k.logger.log(P+" ms hole between AAC samples detected,filling it"),Q>0&&(g||(g=N.subarray()),a.len+=Q*g.length);else if(P<-12){k.logger.log("drop overlapping AAC sample, expected/parsed/delta:"+(A/q).toFixed(3)+"s/"+(O/q).toFixed(3)+"s/"+-P+"ms"),a.len-=N.byteLength;continue}O=A}if(l=Math.max(0,O),!(a.len>0))return;var R=x?a.len:a.len+8;e=x?0:8;try{h=new Uint8Array(R)}catch(S){return void this.observer.trigger(j["default"].ERROR,{type:n.ErrorTypes.MUX_ERROR,details:n.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:R,reason:"fail allocating audio mdat "+R})}if(!x){var T=new DataView(h.buffer);T.setUint32(0,R),h.set(m["default"].types.mdat,4)}for(var U=0;U<Q;U++)g||(k.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),g=N.subarray()),h.set(g,e),e+=g.byteLength,f={size:g.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},z.push(f)}h.set(N,e);var V=N.byteLength;e+=V,f={size:V,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},z.push(f),p=O}var W=0,X=z.length;if(X>=2&&(W=z[X-2].duration,f.duration=W),X){this.nextAudioPts=A=p+s*W,a.len=0,a.samples=z,i=x?new Uint8Array:m["default"].moof(a.sequenceNumber++,l/s,a),a.samples=[];var Y=l/q,Z=A/q,$={data1:i,data2:h,startPTS:Y,endPTS:Z,startDTS:Y,endDTS:Z,type:"audio",nb:X};return this.observer.trigger(j["default"].FRAG_PARSING_DATA,$),$}return null}},{key:"remuxEmptyAudio",value:function(a,b,c,d){var e=a.inputTimeScale,f=a.samplerate?a.samplerate:e,g=e/f,i=this.nextAudioPts,j=(void 0!==i?i:d.startDTS*e)+this._initDTS,l=d.endDTS*e+this._initDTS,m=1024,n=g*m,o=Math.ceil((l-j)/n),p=h["default"].getSilentFrame(a.manifestCodec||a.codec,a.channelCount);if(k.logger.warn("remux empty Audio"),!p)return void k.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!");for(var q=[],r=0;r<o;r++){var s=j+r*n;q.push({unit:p,pts:s,dts:s}),a.len+=p.length}a.samples=q,this.remuxAudio(a,b,c)}},{key:"remuxID3",value:function(a,b){var c,d=a.samples.length,e=a.inputTimeScale,f=this._initPTS,g=this._initDTS;if(d){for(var h=0;h<d;h++)c=a.samples[h],c.pts=(c.pts-f)/e,c.dts=(c.dts-g)/e;this.observer.trigger(j["default"].FRAG_PARSING_METADATA,{samples:a.samples})}a.samples=[],b=b}},{key:"remuxText",value:function(a,b){a.samples.sort(function(a,b){return a.pts-b.pts});var c,d=a.samples.length,e=a.inputTimeScale,f=this._initPTS;if(d){for(var g=0;g<d;g++)c=a.samples[g],c.pts=(c.pts-f)/e;this.observer.trigger(j["default"].FRAG_PARSING_USERDATA,{samples:a.samples})}a.samples=[],b=b}},{key:"_PTSNormalize",value:function(a,b){var c;if(void 0===b)return a;for(c=b<a?-8589934592:8589934592;Math.abs(a-b)>4294967296;)a+=c;return a}}]),a}();c["default"]=p},{33:33,35:35,36:36,44:44,54:54}],46:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(35),h=d(g),i=function(){function a(b){e(this,a),this.observer=b}return f(a,[{key:"destroy",value:function(){}},{key:"resetTimeStamp",value:function(){}},{key:"resetInitSegment",value:function(){}},{key:"remux",value:function(a,b,c,d,e,f,g,i){var j=this.observer,k="";a&&(k+="audio"),b&&(k+="video"),j.trigger(h["default"].FRAG_PARSING_DATA,{data1:i,startPTS:e,startDTS:e,type:k,nb:1,dropped:0}),j.trigger(h["default"].FRAG_PARSED)}}]),a}();c["default"]=i},{35:35}],47:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=/^(\d+)x(\d+)$/,g=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,h=function(){function a(b){d(this,a),"string"==typeof b&&(b=a.parseAttrList(b));for(var c in b)b.hasOwnProperty(c)&&(this[c]=b[c])}return e(a,[{key:"decimalInteger",value:function(a){var b=parseInt(this[a],10);return b>Number.MAX_SAFE_INTEGER?1/0:b}},{key:"hexadecimalInteger",value:function(a){if(this[a]){var b=(this[a]||"0x").slice(2);b=(1&b.length?"0":"")+b;for(var c=new Uint8Array(b.length/2),d=0;d<b.length/2;d++)c[d]=parseInt(b.slice(2*d,2*d+2),16);return c}return null}},{key:"hexadecimalIntegerAsNumber",value:function(a){var b=parseInt(this[a],16);return b>Number.MAX_SAFE_INTEGER?1/0:b}},{key:"decimalFloatingPoint",value:function(a){return parseFloat(this[a])}},{key:"enumeratedString",value:function(a){return this[a]}},{key:"decimalResolution",value:function(a){var b=f.exec(this[a]);if(null!==b)return{width:parseInt(b[1],10),height:parseInt(b[2],10)}}}],[{key:"parseAttrList",value:function(a){var b,c={};for(g.lastIndex=0;null!==(b=g.exec(a));){var d=b[2],e='"';0===d.indexOf(e)&&d.lastIndexOf(e)===d.length-1&&(d=d.slice(1,-1)),c[b[1]]=d}return c}}]),a}();c["default"]=h},{}],48:[function(a,b,c){"use strict";var d={search:function(a,b){for(var c=0,d=a.length-1,e=null,f=null;c<=d;){e=(c+d)/2|0,f=a[e];var g=b(f);if(g>0)c=e+1;else{if(!(g<0))return f;d=e-1}}return null}};b.exports=d},{}],49:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},g=function(a){var b=a;return f.hasOwnProperty(a)&&(b=f[a]),String.fromCharCode(b)},h=15,i=100,j={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},k={17:2,18:4,21:6,22:8,23:10,19:13,20:15},l={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},m={25:2,26:4,29:6,30:8,31:10,27:13,28:15},n=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],o={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(a){this.time=a},log:function(a,b){var c=this.verboseFilter[a];this.verboseLevel>=c}},p=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c].toString(16));return b},q=function(){function a(b,c,e,f,g){d(this,a),this.foreground=b||"white",this.underline=c||!1,this.italics=e||!1,this.background=f||"black",this.flash=g||!1}return e(a,[{key:"reset",value:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}},{key:"setStyles",value:function(a){for(var b=["foreground","underline","italics","background","flash"],c=0;c<b.length;c++){var d=b[c];a.hasOwnProperty(d)&&(this[d]=a[d])}}},{key:"isDefault",value:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}},{key:"equals",value:function(a){return this.foreground===a.foreground&&this.underline===a.underline&&this.italics===a.italics&&this.background===a.background&&this.flash===a.flash}},{key:"copy",value:function(a){this.foreground=a.foreground,this.underline=a.underline,this.italics=a.italics,this.background=a.background,this.flash=a.flash}},{key:"toString",value:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}]),a}(),r=function(){function a(b,c,e,f,g,h){d(this,a),this.uchar=b||" ",this.penState=new q(c,e,f,g,h)}return e(a,[{key:"reset",value:function(){this.uchar=" ",this.penState.reset()}},{key:"setChar",value:function(a,b){this.uchar=a,this.penState.copy(b)}},{key:"setPenState",value:function(a){this.penState.copy(a)}},{key:"equals",value:function(a){return this.uchar===a.uchar&&this.penState.equals(a.penState)}},{key:"copy",value:function(a){this.uchar=a.uchar,this.penState.copy(a.penState)}},{key:"isEmpty",value:function(){return" "===this.uchar&&this.penState.isDefault()}}]),a}(),s=function(){function a(){d(this,a),this.chars=[];for(var b=0;b<i;b++)this.chars.push(new r);this.pos=0,this.currPenState=new q}return e(a,[{key:"equals",value:function(a){for(var b=!0,c=0;c<i;c++)if(!this.chars[c].equals(a.chars[c])){b=!1;break}return b}},{key:"copy",value:function(a){for(var b=0;b<i;b++)this.chars[b].copy(a.chars[b])}},{key:"isEmpty",value:function(){for(var a=!0,b=0;b<i;b++)if(!this.chars[b].isEmpty()){a=!1;break}return a}},{key:"setCursor",value:function(a){this.pos!==a&&(this.pos=a),this.pos<0?(o.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>i&&(o.log("ERROR","Too large cursor position "+this.pos),this.pos=i)}},{key:"moveCursor",value:function(a){var b=this.pos+a;if(a>1)for(var c=this.pos+1;c<b+1;c++)this.chars[c].setPenState(this.currPenState);this.setCursor(b)}},{key:"backSpace",value:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}},{key:"insertChar",value:function(a){a>=144&&this.backSpace();var b=g(a);return this.pos>=i?void o.log("ERROR","Cannot insert "+a.toString(16)+" ("+b+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(b,this.currPenState),void this.moveCursor(1))}},{key:"clearFromPos",value:function(a){var b;for(b=a;b<i;b++)this.chars[b].reset()}},{key:"clear",value:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}},{key:"clearToEndOfRow",value:function(){this.clearFromPos(this.pos)}},{key:"getTextString",value:function(){for(var a=[],b=!0,c=0;c<i;c++){var d=this.chars[c].uchar;" "!==d&&(b=!1),a.push(d)}return b?"":a.join("")}},{key:"setPenStyles",value:function(a){this.currPenState.setStyles(a);var b=this.chars[this.pos];b.setPenState(this.currPenState)}}]),a}(),t=function(){function a(){d(this,a),this.rows=[];for(var b=0;b<h;b++)this.rows.push(new s);this.currRow=h-1,this.nrRollUpRows=null,this.reset()}return e(a,[{key:"reset",value:function(){for(var a=0;a<h;a++)this.rows[a].clear();this.currRow=h-1}},{key:"equals",value:function(a){for(var b=!0,c=0;c<h;c++)if(!this.rows[c].equals(a.rows[c])){b=!1;break}return b}},{key:"copy",value:function(a){for(var b=0;b<h;b++)this.rows[b].copy(a.rows[b])}},{key:"isEmpty",value:function(){for(var a=!0,b=0;b<h;b++)if(!this.rows[b].isEmpty()){a=!1;break}return a}},{key:"backSpace",value:function(){var a=this.rows[this.currRow];a.backSpace()}},{key:"clearToEndOfRow",value:function(){var a=this.rows[this.currRow];a.clearToEndOfRow()}},{key:"insertChar",value:function(a){var b=this.rows[this.currRow];b.insertChar(a)}},{key:"setPen",value:function(a){var b=this.rows[this.currRow];b.setPenStyles(a)}},{key:"moveCursor",value:function(a){var b=this.rows[this.currRow];b.moveCursor(a)}},{key:"setCursor",value:function(a){o.log("INFO","setCursor: "+a);var b=this.rows[this.currRow];b.setCursor(a)}},{key:"setPAC",value:function(a){o.log("INFO","pacData = "+JSON.stringify(a));var b=a.row-1;if(this.nrRollUpRows&&b<this.nrRollUpRows-1&&(b=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==b){for(var c=0;c<h;c++)this.rows[c].clear();var d=this.currRow+1-this.nrRollUpRows,e=this.lastOutputScreen;if(e){var f=e.rows[d].cueStartTime;if(f&&f<o.time)for(var g=0;g<this.nrRollUpRows;g++)this.rows[b-this.nrRollUpRows+g+1].copy(e.rows[d+g])}}this.currRow=b;var i=this.rows[this.currRow];if(null!==a.indent){var j=a.indent,k=Math.max(j-1,0);i.setCursor(a.indent),a.color=i.chars[k].penState.foreground}var l={foreground:a.color,underline:a.underline,italics:a.italics,background:"black",flash:!1};this.setPen(l)}},{key:"setBkgData",value:function(a){o.log("INFO","bkgData = "+JSON.stringify(a)),this.backSpace(),this.setPen(a),this.insertChar(32)}},{key:"setRollUpRows",value:function(a){this.nrRollUpRows=a}},{key:"rollUp",value:function(){if(null===this.nrRollUpRows)return void o.log("DEBUG","roll_up but nrRollUpRows not set yet");o.log("TEXT",this.getDisplayText());var a=this.currRow+1-this.nrRollUpRows,b=this.rows.splice(a,1)[0];b.clear(),this.rows.splice(this.currRow,0,b),o.log("INFO","Rolling up")}},{key:"getDisplayText",value:function(a){a=a||!1;for(var b=[],c="",d=-1,e=0;e<h;e++){var f=this.rows[e].getTextString();f&&(d=e+1,a?b.push("Row "+d+": '"+f+"'"):b.push(f.trim()))}return b.length>0&&(c=a?"["+b.join(" | ")+"]":b.join("\n")),c}},{key:"getTextAndFormat",value:function(){return this.rows}}]),a}(),u=function(){function a(b,c){d(this,a),this.chNr=b,this.outputFilter=c,this.mode=null,this.verbose=0,this.displayedMemory=new t,this.nonDisplayedMemory=new t,this.lastOutputScreen=new t,this.currRollUpRow=this.displayedMemory.rows[h-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}return e(a,[{key:"reset",value:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[h-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null}},{key:"getHandler",value:function(){return this.outputFilter}},{key:"setHandler",value:function(a){this.outputFilter=a}},{key:"setPAC",value:function(a){this.writeScreen.setPAC(a)}},{key:"setBkgData",value:function(a){this.writeScreen.setBkgData(a)}},{key:"setMode",value:function(a){a!==this.mode&&(this.mode=a,o.log("INFO","MODE="+a),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=a)}},{key:"insertChars",value:function(a){for(var b=0;b<a.length;b++)this.writeScreen.insertChar(a[b]);var c=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";o.log("INFO",c+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(o.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}},{key:"ccRCL",value:function(){o.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}},{key:"ccBS",value:function(){o.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}},{key:"ccAOF",value:function(){}},{key:"ccAON",value:function(){}},{key:"ccDER",value:function(){o.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}},{key:"ccRU",value:function(a){o.log("INFO","RU("+a+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(a)}},{key:"ccFON",value:function(){o.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})}},{key:"ccRDC",value:function(){o.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}},{key:"ccTR",value:function(){o.log("INFO","TR"),this.setMode("MODE_TEXT")}},{key:"ccRTD",value:function(){o.log("INFO","RTD"),this.setMode("MODE_TEXT")}},{key:"ccEDM",value:function(){o.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()}},{key:"ccCR",value:function(){o.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()}},{key:"ccENM",value:function(){o.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}},{key:"ccEOC",value:function(){if(o.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var a=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=a,this.writeScreen=this.nonDisplayedMemory,o.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()}},{key:"ccTO",value:function(a){o.log("INFO","TO("+a+") - Tab Offset"),this.writeScreen.moveCursor(a)}},{key:"ccMIDROW",value:function(a){var b={flash:!1};if(b.underline=a%2===1,b.italics=a>=46,b.italics)b.foreground="white";else{var c=Math.floor(a/2)-16,d=["white","green","blue","cyan","red","yellow","magenta"];b.foreground=d[c]}o.log("INFO","MIDROW: "+JSON.stringify(b)),this.writeScreen.setPen(b)}},{key:"outputDataUpdate",value:function(){var a=o.time;null!==a&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(a,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,a,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:a):this.cueStartTime=a,this.lastOutputScreen.copy(this.displayedMemory))}},{key:"cueSplitAtTime",value:function(a){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,a,this.displayedMemory),this.cueStartTime=a))}}]),a}(),v=function(){function a(b,c,e){d(this,a),this.field=b||1,this.outputs=[c,e],this.channels=[new u(1,c),new u(2,e)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,"char":0,cmd:0,other:0}}return e(a,[{key:"getHandler",value:function(a){return this.channels[a].getHandler()}},{key:"setHandler",value:function(a,b){this.channels[a].setHandler(b)}},{key:"addData",value:function(a,b){var c,d,e,f=!1;this.lastTime=a,o.setTime(a);for(var g=0;g<b.length;g+=2)if(d=127&b[g],e=127&b[g+1],0!==d||0!==e){if(o.log("DATA","["+p([b[g],b[g+1]])+"] -> ("+p([d,e])+")"),c=this.parseCmd(d,e),c||(c=this.parseMidrow(d,e)),c||(c=this.parsePAC(d,e)),c||(c=this.parseBackgroundAttributes(d,e)),!c&&(f=this.parseChars(d,e)))if(this.currChNr&&this.currChNr>=0){var h=this.channels[this.currChNr-1];h.insertChars(f)}else o.log("WARNING","No channel found yet. TEXT-MODE?");c?this.dataCounters.cmd+=2:f?this.dataCounters["char"]+=2:(this.dataCounters.other+=2,o.log("WARNING","Couldn't parse cleaned data "+p([d,e])+" orig: "+p([b[g],b[g+1]])))}else this.dataCounters.padding+=2}},{key:"parseCmd",value:function(a,b){var c=null,d=(20===a||28===a)&&32<=b&&b<=47,e=(23===a||31===a)&&33<=b&&b<=35;if(!d&&!e)return!1;if(a===this.lastCmdA&&b===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,o.log("DEBUG","Repeated command ("+p([a,b])+") is dropped"),!0;c=20===a||23===a?1:2;var f=this.channels[c-1];return 20===a||28===a?32===b?f.ccRCL():33===b?f.ccBS():34===b?f.ccAOF():35===b?f.ccAON():36===b?f.ccDER():37===b?f.ccRU(2):38===b?f.ccRU(3):39===b?f.ccRU(4):40===b?f.ccFON():41===b?f.ccRDC():42===b?f.ccTR():43===b?f.ccRTD():44===b?f.ccEDM():45===b?f.ccCR():46===b?f.ccENM():47===b&&f.ccEOC():f.ccTO(b-32),this.lastCmdA=a,this.lastCmdB=b,this.currChNr=c,!0}},{key:"parseMidrow",value:function(a,b){var c=null;if((17===a||25===a)&&32<=b&&b<=47){if(c=17===a?1:2,c!==this.currChNr)return o.log("ERROR","Mismatch channel in midrow parsing"),!1;var d=this.channels[c-1];return d.ccMIDROW(b),o.log("DEBUG","MIDROW ("+p([a,b])+")"),!0}return!1}},{key:"parsePAC",value:function(a,b){var c=null,d=null,e=(17<=a&&a<=23||25<=a&&a<=31)&&64<=b&&b<=127,f=(16===a||24===a)&&64<=b&&b<=95;if(!e&&!f)return!1;if(a===this.lastCmdA&&b===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;c=a<=23?1:2,d=64<=b&&b<=95?1===c?j[a]:l[a]:1===c?k[a]:m[a];var g=this.interpretPAC(d,b),h=this.channels[c-1];return h.setPAC(g),this.lastCmdA=a,this.lastCmdB=b,this.currChNr=c,!0}},{key:"interpretPAC",value:function(a,b){var c=b,d={color:null,italics:!1,indent:null,underline:!1,row:a};return c=b>95?b-96:b-64,d.underline=1===(1&c),c<=13?d.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(c/2)]:c<=15?(d.italics=!0,d.color="white"):d.indent=4*Math.floor((c-16)/2),d}},{key:"parseChars",value:function(a,b){var c=null,d=null,e=null;if(a>=25?(c=2,e=a-8):(c=1,e=a),17<=e&&e<=19){var f=b;f=17===e?b+80:18===e?b+112:b+144,o.log("INFO","Special char '"+g(f)+"' in channel "+c),d=[f]}else 32<=a&&a<=127&&(d=0===b?[a]:[a,b]);if(d){var h=p(d);o.log("DEBUG","Char codes =  "+h.join(",")),this.lastCmdA=null,this.lastCmdB=null}return d}},{key:"parseBackgroundAttributes",value:function(a,b){var c,d,e,f,g=(16===a||24===a)&&32<=b&&b<=47,h=(23===a||31===a)&&45<=b&&b<=47;return!(!g&&!h)&&(c={},16===a||24===a?(d=Math.floor((b-32)/2),c.background=n[d],b%2===1&&(c.background=c.background+"_semi")):45===b?c.background="transparent":(c.foreground="black",47===b&&(c.underline=!0)),e=a<24?1:2,f=this.channels[e-1],f.setBkgData(c),this.lastCmdA=null,this.lastCmdB=null,!0)}},{key:"reset",value:function(){for(var a=0;a<this.channels.length;a++)this.channels[a]&&this.channels[a].reset();this.lastCmdA=null,this.lastCmdB=null}},{key:"cueSplitAtTime",value:function(a){for(var b=0;b<this.channels.length;b++)this.channels[b]&&this.channels[b].cueSplitAtTime(a)}}]),a}();c["default"]=v},{}],50:[function(a,b,c){"use strict";var d=a(57),e={newCue:function(a,b,c,e){for(var f,g,h,i,j,k=window.VTTCue||window.TextTrackCue,l=0;l<e.rows.length;l++)if(f=e.rows[l],h=!0,i=0,j="",!f.isEmpty()){for(var m=0;m<f.chars.length;m++)f.chars[m].uchar.match(/\s/)&&h?i++:(j+=f.chars[m].uchar,h=!1);
f.cueStartTime=b,b===c&&(c+=1e-4),g=new k(b,c,(0,d.fixLineBreaks)(j.trim())),i>=16?i--:i++,navigator.userAgent.match(/Firefox\//)?g.line=l+1:g.line=l>7?l-2:l+1,g.align="left",g.position=Math.max(0,Math.min(100,100*(i/32)+(navigator.userAgent.match(/Firefox\//)?50:0))),a.addCue(g)}}};b.exports=e},{57:57}],51:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){return g["default"].search(a,function(a){return a.cc<b?1:a.cc>b?-1:0})}Object.defineProperty(c,"__esModule",{value:!0}),c.findFragWithCC=e;var f=a(48),g=d(f)},{48:48}],52:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a(53),h=d(g),i=function(){function a(b,c,d,f){e(this,a),this.hls=b,this.defaultEstimate_=f,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new h["default"](c),this.fast_=new h["default"](d)}return f(a,[{key:"sample",value:function(a,b){a=Math.max(a,this.minDelayMs_);var c=8e3*b/a,d=a/1e3;this.fast_.sample(d,c),this.slow_.sample(d,c)}},{key:"canEstimate",value:function(){var a=this.fast_;return a&&a.getTotalWeight()>=this.minWeight_}},{key:"getEstimate",value:function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}},{key:"destroy",value:function(){}}]),a}();c["default"]=i},{53:53}],53:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b){d(this,a),this.alpha_=b?Math.exp(Math.log(.5)/b):0,this.estimate_=0,this.totalWeight_=0}return e(a,[{key:"sample",value:function(a,b){var c=Math.pow(this.alpha_,a);this.estimate_=b*(1-c)+c*this.estimate_,this.totalWeight_+=a}},{key:"getTotalWeight",value:function(){return this.totalWeight_}},{key:"getEstimate",value:function(){if(this.alpha_){var a=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/a}return this.estimate_}}]),a}();c["default"]=f},{}],54:[function(a,b,c){"use strict";function d(){}function e(a,b){return b="["+a+"] > "+b}function f(a){var b=self.console[a];return b?function(){for(var c=arguments.length,d=Array(c),f=0;f<c;f++)d[f]=arguments[f];d[0]&&(d[0]=e(a,d[0])),b.apply(self.console,d)}:d}function g(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];c.forEach(function(b){j[b]=a[b]?a[b].bind(a):f(b)})}Object.defineProperty(c,"__esModule",{value:!0});var h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},i={trace:d,debug:d,log:d,warn:d,info:d,error:d},j=i;c.enableLogs=function(a){if(a===!0||"object"===("undefined"==typeof a?"undefined":h(a))){g(a,"debug","log","info","warn","error");try{j.log()}catch(b){j=i}}else j=i},c.logger=j},{}],55:[function(a,b,c){"use strict";var d={toString:function(a){for(var b="",c=a.length,d=0;d<c;d++)b+="["+a.start(d).toFixed(3)+","+a.end(d).toFixed(3)+"]";return b}};b.exports=d},{}],56:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c["default"]=function(){function a(a){if("string"!=typeof a)return!1;var b=f[a.toLowerCase()];return!!b&&a.toLowerCase()}function b(a){if("string"!=typeof a)return!1;var b=g[a.toLowerCase()];return!!b&&a.toLowerCase()}function c(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)a[d]=c[d]}return a}function d(d,f,g){var h=this,i=function(){if("undefined"!=typeof navigator)return/MSIE\s8\.0/.test(navigator.userAgent)}(),j={};i?h=document.createElement("custom"):j.enumerable=!0,h.hasBeenReset=!1;var k="",l=!1,m=d,n=f,o=g,p=null,q="",r=!0,s="auto",t="start",u=50,v="middle",w=50,x="middle";if(Object.defineProperty(h,"id",c({},j,{get:function(){return k},set:function(a){k=""+a}})),Object.defineProperty(h,"pauseOnExit",c({},j,{get:function(){return l},set:function(a){l=!!a}})),Object.defineProperty(h,"startTime",c({},j,{get:function(){return m},set:function(a){if("number"!=typeof a)throw new TypeError("Start time must be set to a number.");m=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"endTime",c({},j,{get:function(){return n},set:function(a){if("number"!=typeof a)throw new TypeError("End time must be set to a number.");n=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"text",c({},j,{get:function(){return o},set:function(a){o=""+a,this.hasBeenReset=!0}})),Object.defineProperty(h,"region",c({},j,{get:function(){return p},set:function(a){p=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"vertical",c({},j,{get:function(){return q},set:function(b){var c=a(b);if(c===!1)throw new SyntaxError("An invalid or illegal string was specified.");q=c,this.hasBeenReset=!0}})),Object.defineProperty(h,"snapToLines",c({},j,{get:function(){return r},set:function(a){r=!!a,this.hasBeenReset=!0}})),Object.defineProperty(h,"line",c({},j,{get:function(){return s},set:function(a){if("number"!=typeof a&&a!==e)throw new SyntaxError("An invalid number or illegal string was specified.");s=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"lineAlign",c({},j,{get:function(){return t},set:function(a){var c=b(a);if(!c)throw new SyntaxError("An invalid or illegal string was specified.");t=c,this.hasBeenReset=!0}})),Object.defineProperty(h,"position",c({},j,{get:function(){return u},set:function(a){if(a<0||a>100)throw new Error("Position must be between 0 and 100.");u=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"positionAlign",c({},j,{get:function(){return v},set:function(a){var c=b(a);if(!c)throw new SyntaxError("An invalid or illegal string was specified.");v=c,this.hasBeenReset=!0}})),Object.defineProperty(h,"size",c({},j,{get:function(){return w},set:function(a){if(a<0||a>100)throw new Error("Size must be between 0 and 100.");w=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"align",c({},j,{get:function(){return x},set:function(a){var c=b(a);if(!c)throw new SyntaxError("An invalid or illegal string was specified.");x=c,this.hasBeenReset=!0}})),h.displayState=void 0,i)return h}if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var e="auto",f={"":!0,lr:!0,rl:!0},g={start:!0,middle:!0,end:!0,left:!0,right:!0};return d.prototype.getCueAsHTML=function(){var a=window.WebVTT;return a.convertCueToDOMTree(window,this.text)},d}()},{}],57:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new m,this.regionList=[]}function f(a){function b(a,b,c,d){return 3600*(0|a)+60*(0|b)+(0|c)+(0|d)/1e3}var c=a.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return c?c[3]?b(c[1],c[2],c[3].replace(":",""),c[4]):c[1]>59?b(c[1],c[2],0,c[4]):b(0,c[1],c[2],c[4]):null}function g(){this.values=Object.create(null)}function h(a,b,c,d){var e=d?a.split(d):[a];for(var f in e)if("string"==typeof e[f]){var g=e[f].split(c);if(2===g.length){var h=g[0],i=g[1];b(h,i)}}}function i(a,b,c){function d(){var b=f(a);if(null===b)throw new Error("Malformed timestamp: "+j);return a=a.replace(/^[^\sa-zA-Z-]+/,""),b}function e(a,b){var d=new g;h(a,function(a,b){switch(a){case"region":for(var e=c.length-1;e>=0;e--)if(c[e].id===b){d.set(a,c[e].region);break}break;case"vertical":d.alt(a,b,["rl","lr"]);break;case"line":var f=b.split(","),g=f[0];d.integer(a,g),d.percent(a,g)&&d.set("snapToLines",!1),d.alt(a,g,["auto"]),2===f.length&&d.alt("lineAlign",f[1],["start",o,"end"]);break;case"position":f=b.split(","),d.percent(a,f[0]),2===f.length&&d.alt("positionAlign",f[1],["start",o,"end","line-left","line-right","auto"]);break;case"size":d.percent(a,b);break;case"align":d.alt(a,b,["start",o,"end","left","right"])}},/:/,/\s/),b.region=d.get("region",null),b.vertical=d.get("vertical","");var e=d.get("line","auto");"auto"===e&&n.line===-1&&(e=-1),b.line=e,b.lineAlign=d.get("lineAlign","start"),b.snapToLines=d.get("snapToLines",!0),b.size=d.get("size",100),b.align=d.get("align",o);var f=d.get("position","auto");"auto"===f&&50===n.position&&(f="start"===b.align||"left"===b.align?0:"end"===b.align||"right"===b.align?100:50),b.position=f}function i(){a=a.replace(/^\s+/,"")}var j=a;if(i(),b.startTime=d(),i(),"-->"!==a.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+j);a=a.substr(3),i(),b.endTime=d(),i(),e(a,b)}function j(a){return a.replace(/<br(?: \/)?>/gi,"\n")}Object.defineProperty(c,"__esModule",{value:!0}),c.fixLineBreaks=void 0;var k=a(56),l=d(k),m=function(){return{decode:function(a){if(!a)return"";if("string"!=typeof a)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(a))}}};g.prototype={set:function(a,b){this.get(a)||""===b||(this.values[a]=b)},get:function(a,b,c){return c?this.has(a)?this.values[a]:b[c]:this.has(a)?this.values[a]:b},has:function(a){return a in this.values},alt:function(a,b,c){for(var d=0;d<c.length;++d)if(b===c[d]){this.set(a,b);break}},integer:function(a,b){/^-?\d+$/.test(b)&&this.set(a,parseInt(b,10))},percent:function(a,b){var c;return!!((c=b.match(/^([\d]{1,3})(\.[\d]*)?%$/))&&(b=parseFloat(b),b>=0&&b<=100))&&(this.set(a,b),!0)}};var n=new l["default"](0,0,0),o="middle"===n.align?"middle":"center";e.prototype={parse:function(a){function b(){var a=d.buffer,b=0;for(a=j(a);b<a.length&&"\r"!==a[b]&&"\n"!==a[b];)++b;var c=a.substr(0,b);return"\r"===a[b]&&++b,"\n"===a[b]&&++b,d.buffer=a.substr(b),c}function c(a){h(a,function(a,b){switch(a){case"Region":}},/:/)}var d=this;a&&(d.buffer+=d.decoder.decode(a,{stream:!0}));try{var e;if("INITIAL"===d.state){if(!/\r\n|\n/.test(d.buffer))return this;e=b();var f=e.match(/^WEBVTT([ \t].*)?$/);if(!f||!f[0])throw new Error("Malformed WebVTT signature.");d.state="HEADER"}for(var g=!1;d.buffer;){if(!/\r\n|\n/.test(d.buffer))return this;switch(g?g=!1:e=b(),d.state){case"HEADER":/:/.test(e)?c(e):e||(d.state="ID");continue;case"NOTE":e||(d.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(e)){d.state="NOTE";break}if(!e)continue;if(d.cue=new l["default"](0,0,""),d.state="CUE",e.indexOf("-->")===-1){d.cue.id=e;continue}case"CUE":try{i(e,d.cue,d.regionList)}catch(k){d.cue=null,d.state="BADCUE";continue}d.state="CUETEXT";continue;case"CUETEXT":var m=e.indexOf("-->")!==-1;if(!e||m&&(g=!0)){d.oncue&&d.oncue(d.cue),d.cue=null,d.state="ID";continue}d.cue.text&&(d.cue.text+="\n"),d.cue.text+=e;continue;case"BADCUE":e||(d.state="ID");continue}}}catch(k){"CUETEXT"===d.state&&d.cue&&d.oncue&&d.oncue(d.cue),d.cue=null,d.state="INITIAL"===d.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var a=this;try{if(a.buffer+=a.decoder.decode(),(a.cue||"HEADER"===a.state)&&(a.buffer+="\n\n",a.parse()),"INITIAL"===a.state)throw new Error("Malformed WebVTT signature.")}catch(b){throw b}return a.onflush&&a.onflush(),this}},c.fixLineBreaks=j,c["default"]=e},{56:56}],58:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}var e=a(57),f=d(e),g=function(a,b,c){return a.substr(c||0,b.length)===b},h=function(a){var b=parseInt(a.substr(-3)),c=parseInt(a.substr(-6,2)),d=parseInt(a.substr(-9,2)),e=a.length>9?parseInt(a.substr(0,a.indexOf(":"))):0;return isNaN(b)||isNaN(c)||isNaN(d)||isNaN(e)?-1:(b+=1e3*c,b+=6e4*d,b+=36e5*e)},i=function l(a){for(var l=5381,b=a.length;b;)l=33*l^a.charCodeAt(--b);return(l>>>0).toString()},j=function(a,b,c){var d=a[b],e=a[d.prevCC];if(!e||!e["new"]&&d["new"])return a.ccOffset=a.presentationOffset=d.start,void(d["new"]=!1);for(;e&&e["new"];)a.ccOffset+=d.start-e.start,d["new"]=!1,d=e,e=a[d.prevCC];a.presentationOffset=c},k={parse:function(a,b,c,d,e,k){var l=/\r\n|\n\r|\n|\r/g,m=String.fromCharCode.apply(null,new Uint8Array(a)).trim().replace(l,"\n").split("\n"),n="00:00.000",o=0,p=0,q=0,r=[],s=void 0,t=!0,u=new f["default"];u.oncue=function(a){var b=c[d],e=c.ccOffset;b&&b["new"]&&(void 0!==p?e=c.ccOffset=b.start:j(c,d,q)),q&&(e=q+c.ccOffset-c.presentationOffset),a.startTime+=e-p,a.endTime+=e-p,a.id=i(a.startTime)+i(a.endTime)+i(a.text),a.text=decodeURIComponent(escape(a.text)),a.endTime>0&&r.push(a)},u.onparsingerror=function(a){s=a},u.onflush=function(){return s&&k?void k(s):void e(r)},m.forEach(function(a){if(t){if(g(a,"X-TIMESTAMP-MAP=")){t=!1,a.substr(16).split(",").forEach(function(a){g(a,"LOCAL:")?n=a.substr(6):g(a,"MPEGTS:")&&(o=parseInt(a.substr(7)))});try{b=b<0?b+8589934592:b,o-=b,p=h(n)/1e3,q=o/9e4,p===-1&&(s=new Error("Malformed X-TIMESTAMP-MAP: "+a))}catch(c){s=new Error("Malformed X-TIMESTAMP-MAP: "+a)}return}""===a&&(t=!1)}u.parse(a+"\n")}),u.flush()}};b.exports=k},{57:57}],59:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a(54),g=function(){function a(b){d(this,a),b&&b.xhrSetup&&(this.xhrSetup=b.xhrSetup)}return e(a,[{key:"destroy",value:function(){this.abort(),this.loader=null}},{key:"abort",value:function(){var a=this.loader;a&&4!==a.readyState&&(this.stats.aborted=!0,a.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null}},{key:"load",value:function(a,b,c){this.context=a,this.config=b,this.callbacks=c,this.stats={trequest:performance.now(),retry:0},this.retryDelay=b.retryDelay,this.loadInternal()}},{key:"loadInternal",value:function(){var a,b=this.context;a="undefined"!=typeof XDomainRequest?this.loader=new XDomainRequest:this.loader=new XMLHttpRequest;var c=this.stats;c.tfirst=0,c.loaded=0;var d=this.xhrSetup;try{if(d)try{d(a,b.url)}catch(e){a.open("GET",b.url,!0),d(a,b.url)}a.readyState||a.open("GET",b.url,!0)}catch(e){return void this.callbacks.onError({code:a.status,text:e.message},b,a)}b.rangeEnd&&a.setRequestHeader("Range","bytes="+b.rangeStart+"-"+(b.rangeEnd-1)),a.onreadystatechange=this.readystatechange.bind(this),a.onprogress=this.loadprogress.bind(this),a.responseType=b.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),a.send()}},{key:"readystatechange",value:function(a){var b=a.currentTarget,c=b.readyState,d=this.stats,e=this.context,g=this.config;if(!d.aborted&&c>=2)if(window.clearTimeout(this.requestTimeout),0===d.tfirst&&(d.tfirst=Math.max(performance.now(),d.trequest)),4===c){var h=b.status;if(h>=200&&h<300){d.tload=Math.max(d.tfirst,performance.now());var i=void 0,j=void 0;"arraybuffer"===e.responseType?(i=b.response,j=i.byteLength):(i=b.responseText,j=i.length),d.loaded=d.total=j;var k={url:b.responseURL,data:i};this.callbacks.onSuccess(k,d,e,b)}else d.retry>=g.maxRetry||h>=400&&h<499?(f.logger.error(h+" while loading "+e.url),this.callbacks.onError({code:h,text:b.statusText},e,b)):(f.logger.warn(h+" while loading "+e.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,g.maxRetryDelay),d.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),g.timeout)}},{key:"loadtimeout",value:function(){f.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)}},{key:"loadprogress",value:function(a){var b=a.currentTarget,c=this.stats;c.loaded=a.loaded,a.lengthComputable&&(c.total=a.total);var d=this.callbacks.onProgress;d&&d(c,this.context,null,b)}}]),a}();c["default"]=g},{54:54}]},{},[40])(40)})}});
/*! Txplayer - v3.0.0 - 2018-11-23 12:20:35
 * Copyright (c) 2018
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(290)},65:function(a,b){!function(a){function b(){}function c(a){g=[a]}function d(a,b,c){return a&&a.apply(b.context||b,c)}function e(a){return/\?/.test(a)?"&":"?"}function f(f){function n(a){X++||(Y(),S&&(A[U]={s:[a]}),O&&(a=O.apply(f,[a])),d(L,f,[a,v,f]),d(N,f,[f,v]))}function F(a){X++||(Y(),S&&a!=w&&(A[U]=a),d(M,f,[f,a]),d(N,f,[f,a]))}f=a.extend({},C,f);var G,H,I,J,K,L=f.success,M=f.error,N=f.complete,O=f.dataFilter,P=f.callbackParameter,Q=f.callback,R=f.cache,S=f.pageCache,T=f.charset,U=f.url,V=f.data,W=f.timeout,X=0,Y=b;return y&&y(function(a){a.done(L).fail(M),L=a.resolve,M=a.reject}).promise(f),f.abort=function(){!X++&&Y()},d(f.beforeSend,f,[f])===!1||X?f:(U=U||j,V=V?"string"==typeof V?V:a.param(V,f.traditional):j,U+=V?e(U)+V:j,P&&(U+=e(U)+encodeURIComponent(P)+"=?"),!R&&!S&&(U+=e(U)+"_"+(new Date).getTime()+"="),U=U.replace(/=\?(&|$)/,"="+Q+"$1"),S&&(G=A[U])?G.s?n(G.s[0]):F(G):(x[Q]=c,I=a(u)[0],I.id=m+B++,T&&(I[i]=T),D&&D.version()<11.6?(J=a(u)[0]).text="document.getElementById('"+I.id+"')."+p+"()":I[h]=h,E&&(I.htmlFor=I.id,I.event=o),I[q]=I[p]=I[r]=function(a){if(!I[s]||!/i/.test(I[s])){try{I[o]&&I[o]()}catch(b){}a=g,g=0,a?n(a[0]):F(k)}},I.src=U,Y=function(a){K&&clearTimeout(K),I[r]=I[q]=I[p]=null,z[t](I),J&&z[t](J)},z[l](I,H=z.firstChild),J&&z[l](J,H),K=W>0&&setTimeout(function(){F(w)},W)),f)}var g,h="async",i="charset",j="",k="error",l="insertBefore",m="_jqjsp",n="on",o=n+"click",p=n+k,q=n+"load",r=n+"readystatechange",s="readyState",t="removeChild",u="<script>",v="success",w="timeout",x=window,y=a.Deferred,z=a("head")[0]||document.documentElement,A={},B=0,C={callback:m,url:location.href},D=x.opera,E=!!a("<div>").html("<!--[if IE]><i><![endif]-->").find("i").length;f.setup=function(b){a.extend(C,b)},a.jsonp=f}(Txplayer.$)},78:function(a,b){var c={unstarted:-1,ended:0,playing:1,paused:2,buffering:3,cued:4,stop:5},d={msd:"流畅180P",sd:"标清270P",hd:"高清480P",shd:"超清720P",fhd:"蓝光1080P"};a.exports={playerstate:c,definitionMap:d}},79:function(a,b){function c(a){var b={getinfo:["http://h5vv.video.qq.com/getinfo?callback=?","https://h5vv.video.qq.com/getinfo?callback=?"],edugetvinfo:["http://sv.video.qq.com/edugetvinfo?callback=?","https://sv.video.qq.com/edugetvinfo?callback=?"],mvgetinfo:["http://sv.video.qq.com/mvgetinfo?callback=?","https://sv.video.qq.com/mvgetinfo?callback=?"],getinfoInews:["http://h5wx.video.qq.com/getinfo?callback=?","https://h5wx.video.qq.com/getinfo?callback=?"],getvinfo:["http://h5vv.video.qq.com/getvinfo?callback=?","https://h5vv.video.qq.com/getvinfo?callback=?"],getkey:["http://h5vv.video.qq.com/getkey?callback=?","https://h5vv.video.qq.com/getkey?callback=?"],mvgetkey:["http://sv.video.qq.com/mvgetkey?callback=?","https://sv.video.qq.com/mvgetkey?callback=?"],getkeyInews:["http://h5wx.video.qq.com/getkey?callback=?","https://h5wx.video.qq.com/getkey?callback=?"],zb:["http://info.zb.video.qq.com/?callback=?","https://info.zb.video.qq.com/?callback=?"],rmd_mobile:["http://like.video.qq.com/fcgi-bin/rmd_mobile?callback=?","https://like.video.qq.com/fcgi-bin/rmd_mobile?callback=?"],like:["http://like.video.qq.com/fcgi-bin/like?","https://like.video.qq.com/fcgi-bin/like?"],dataout_ex:["http://sns.video.qq.com/fcgi-bin/dlib/dataout_ex?","https://sns.video.qq.com/fcgi-bin/dlib/dataout_ex?"],get_dtype:["http://h5vv.video.qq.com/getdtype?","https://h5vv.video.qq.com/getdtype?"]};return"https:"===window.location.protocol?b[a][1]:b[a][0]}function d(a){return e=Txplayer.$,this.context=a.context,this.init()}var e=Txplayer.$,f=Txplayer.util,g=f.AppHelper,h=[{reg:function(){return!!this.cfg.noAuth},request:function(a){var b=this;a.resolve({param:{vids:b.cfg.vid,defaultfmt:b.cfg.fmt}})}},{reg:function(){return!(!this.cfg.eduext&&!this.cfg.authext)},request:function(a){var b=this;a.resolve({cgi:c("edugetvinfo"),param:{eduext:b.cfg.eduext,platform:f.mobile?"261001":"260201",vid:b.cfg.vid,defn:b.cfg.fmt}})}},{reg:function(){return"kuaibao.qq.com"===location.hostname},request:function(a){var b=this;a.resolve({cgi:c("getinfo"),param:{platform:"570701",vid:b.cfg.vid,sdtfrom:"v7152"}})}},{reg:function(){return 1===this.cfg.classType},request:function(a){var b=this;a.resolve({cgi:c("edugetvinfo"),param:{platform:221001,vid:b.cfg.vid,defn:b.cfg.fmt}})}},{reg:function(){if(window!==top&&"v.qq.com"===location.hostname&&"/iframe/player.html"===location.pathname){var a=f.getParams(location.href);if(a&&a.cKey&&a.encryptVer&&a.platform)return this.params=a,!0}return!1},request:function(a){var b,d=this,e={cgi:c("getinfo"),param:{encryptVer:d.params.encryptVer,platform:d.params.platform,cKey:d.params.cKey,vids:d.cfg.vid,defaultfmt:d.cfg.fmt}};try{b=window.parent.location.href}catch(f){}b&&(e.param.wxrefer=b),a.resolve(e)}},{reg:function(){return!(!f.browser.mqq||"xiaoqu.qq.com"!==window.location.hostname&&"buluo.qq.com"!==window.location.hostname)},request:function(a){if(!window.getBrowserSignature)return void a.reject();var b=this;window.getBrowserSignature(b.cfg.vid,function(c){var d;if(c&&c.data)try{var e=JSON.parse(c.data);e&&e.result&&e.result.token&&(d=e.result.token)}catch(g){}d?a.resolve({param:{cKey:d,encryptVer:"6.4",platform:f.os.ios?"170408":"170308",vids:b.cfg.vid,defaultfmt:b.cfg.fmt}}):a.reject()})}},{reg:function(){return!(!f.browser.mqqbrowser||f.browser.mqq||f.browser.wechat||f.browser.qqdownloader||window!==top)},request:function(a){var b,d,h=this,i="undefined"!=typeof h.cfg.svr_time?h.cfg.svr_time+"":parseInt(+new Date/1e3)+"",j=function(){var b,d,e={vid:h.cfg.vid};e.timestamp=i,f.os.ios?(b=window.x5.ios.getBrowserSignature,d=f.os.ipad?e:"vid:"+e.vid+"["+e.timestamp+"]"):(b=window.x5.android.getBrowserSignature,d="vid:"+e.vid+"["+e.timestamp+"]"),b(d,function(b){var d;"object"==typeof b&&b.key&&b.ver&&b.platform?(d={cgi:c("getvinfo"),param:{cKey:b.key,encryptVer:b.ver,platform:b.platform,vid:h.cfg.vid,defn:h.cfg.fmt}},a.resolve(d)):"object"==typeof b&&b.data?(d={cgi:c("getvinfo"),param:{cKey:b.data,encryptVer:"4.0",platform:"161001",vid:h.cfg.vid,defn:h.cfg.fmt}},a.resolve(d)):"string"==typeof b?(d={cgi:c("getvinfo"),param:{cKey:b,encryptVer:"4.0",platform:"161001",vid:h.cfg.vid,defn:h.cfg.fmt}},a.resolve(d)):a.reject()},function(){a.reject()})};b=window.x5&&window.x5.ios&&"function"===e.type(window.x5.ios.getBrowserSignature),d=window.x5&&"function"===e.type(window.x5.getBrowserSignature),b||d?j():g.loadMqqBrowserAPI().done(function(){b=window.x5&&window.x5.ios&&"function"===e.type(window.x5.ios.getBrowserSignature),d=window.x5&&"function"===e.type(window.x5.getBrowserSignature),b||d?j():a.reject()}).fail(function(){a.reject()})}},{reg:function(){return!!(f.browser.qqnews&&!f.browser.qqnewsAd||f.browser.kuaibao)},request:function(a){var b,c,d,e=this,g=e.cfg.vid,h="undefined"!=typeof e.cfg.svr_time?e.cfg.svr_time+"":parseInt(+new Date/1e3)+"",i="TVP_KUAIBAO_CB_"+h.substr(-4,4);if(window.top!==window){try{var j=window.top.location.href;j&&(b=window.top,c=b.document)}catch(k){d=!0}if(d)return void a.reject()}else b=window,c=b.document;b[i]=function(b){var c;try{c=JSON.parse(b)}catch(d){}if(c&&c.key&&c.ver&&c.platform&&c.sdtfrom){var f={param:{cKey:c.key,encryptVer:c.ver,platform:c.platform,sdtfrom:c.sdtfrom,vid:e.cfg.vid,defaultfmt:"mp4",clip:4}};a.resolve(f)}else a.reject()};var l=function(){var a={method:"getCKey",types:["string","string","string"],args:[g,h,i],instanceName:"TencentNewsScriptControllerJsInterface"},b="jsbridge://get_with_json_data?json="+encodeURIComponent(JSON.stringify(a))+"&_t="+h,c=new Image;c.src=b},m=function(){var a=function(){b.getBrowserSignature(g,h,i)};"function"==typeof b.getBrowserSignature?(a(),c.addEventListener("TencentNewsJSInjectionComplete",function(){a()})):c.addEventListener("TencentNewsJSInjectionComplete",function(){a()})};f.os.ios?m():f.os.android?l():a.reject()}},{reg:function(){return!(!f.browser.douban&&!f.browser.liebao)},request:function(a){var b,c=this,d="undefined"!=typeof c.cfg.svr_time?c.cfg.svr_time+"":parseInt(+new Date/1e3)+"",e=function(){if(!window.getBrowserSignature)return void a.reject();try{b=window.getBrowserSignature(c.cfg.vid,d)}catch(e){}if(b&&b.key&&b.ver&&b.platform){var f={param:{cKey:b.key,encryptVer:b.ver,platform:b.platform,vid:c.cfg.vid,defaultfmt:c.cfg.fmt}};a.resolve(f)}else a.reject()};e()}},{reg:function(){return!(!f.browser.mqq||"mqqcartoon"!==f.getUrlParam("openS"))},request:function(a){var b=this,d="undefined"!=typeof b.cfg.svr_time?b.cfg.svr_time+"":parseInt(+new Date/1e3)+"";e.getScript("http://imgcache.qq.com/club/client/comic/release/js/util/qqComicVideoAuth.js?t="+d,function(){"function"===e.type(window.getBrowserSignature)?window.getBrowserSignature(b.cfg.vid,function(d){if(d&&d!==-1){var e={cgi:c("getvinfo"),param:{cKey:d,encryptVer:"6.4",platform:"170101",vid:b.cfg.vid,defn:b.cfg.fmt}};a.resolve(e)}}):a.reject()})}},{reg:function(){return f.isNewsPlugin()},request:function(a){a.resolve({param:{platform:"20701"}})}},{reg:function(){return"yoo.qq.com"===window.location.hostname},request:function(a){a.resolve({param:{platform:"4450701",sdtfrom:"v7158"}})}},{reg:function(){var a=location.hostname;return/(\.)?maobing\.qq\.com$/.test(a)},request:function(a){a.resolve({param:{platform:"5020701",sdtfrom:"v7161"}})}},{reg:function(){return"qc.vip.qq.com"==window.location.hostname||"cdn.vip.qq.com"==window.location.hostname},request:function(a){a.resolve({param:{platform:"4860701",sdtfrom:"v7159"}})}},{reg:function(){return"h5.maobing.qq.com"==window.location.hostname||"h5test.maobing.qq.com"==window.location.hostname},request:function(a){a.resolve({param:{platform:"5020701",sdtfrom:"v7161"}})}},{reg:function(){return"m.v.qq.com"!=window.location.hostname&&"v.qq.com"!=window.location.hostname},request:function(a){a.resolve({param:{platform:"4810701",sdtfrom:"v7157"}})}}];d.prototype={init:function(){return this.exportsModuleApis(),this.reg_request},reg_request:function(a,b){var c=this;c.cfg=a,c.cfg2=b;var d=e.Deferred(),f=!1;return e(h).each(function(a,b){return"function"!==e.type(b.reg)||("function"!==e.type(b.request)||(!b.reg.call(c)||(f=!0,b.request.call(c,d),!1)))}),f||d.reject(),setTimeout(function(){d.reject()},6e3),d},exportsModuleApis:function(){var a=this;this.context.msg.setData("isInAuthRuleList",function(b,c){var d=!1;a.cfg={},a.cfg2={},e(h).each(function(b,c){return"function"!==e.type(c.reg)||(!c.reg.call(a)||(d=!0,!1))}),c.data=d})}},a.exports=d},120:function(a,b,c){function d(a){e=Txplayer.util,f=Txplayer.$,this.context=a,this.dataset={_cache:{}},this.dataset.url="//ncgi.video.qq.com/fcgi-bin/livemark/get_video_mark",this.init(),f.jsonp||c(65)}var e,f,g=d.prototype;g.init=function(){this.addEventListeners()},g.addEventListeners=function(){var a=this;this.dataset.eventList={},this.dataset.eventList[e.getUniqueMsgKey("vidChange")]=function(){a.dataset.request&&"function"===f.type(a.dataset.request.abort)&&a.dataset.request.abort(),a.dataset._cache={}},f.each(this.dataset.eventList,function(b,c){a.context.msg.on(b,c)})},g.requestVideoMark=function(){var a=this.context.dataset.vid;if("v.qq.com"===location.hostname&&this.context.config.official&&!this.dataset._cache[a]){var b=e.getJsonpCallbackName("dd"),c={idlist:a,otype:"json",pr:1,callback:b},d=this;this.context.dataset.cid&&(c.cid=this.context.dataset.cid),this.context.dataset.columnId&&(c.lid=this.context.dataset.columnId),this.dataset.request=f.jsonp({url:this.dataset.url,data:c,callback:b}).done(function(b){d._handleData(b),d.dataset._cache[a]=!0}).fail(function(a){Txplayer.util.localLog("GET_VIDEO_MARK_DATA_ERROR",a)})}},g._handleData=function(a){var b=[],c={},d=this;try{a&&a.results[0]&&a.results[0].fields[0]&&a.results[0].fields[0].videotag[0]&&a.results[0].fields[0].videotag[0].ts&&a.results[0].fields[0].videotag[0].ts.t[0]&&(b=a.results[0].fields[0].videotag[0].ts.t[0])}catch(g){Txplayer.util.localLog("PARSE_VIDEO_MARK_DATA_ERROR",g)}f.each(b,function(a,b){b=b||{};var d=b.cate;"undefined"!==f.type(b.cate)&&(c[d]||(c[d]=[]),c[d].push(b))}),f.each(c,function(a,b){try{d.context.msg.broadcast("getVideoMarkDataReady."+a,b)}catch(c){e.showError("getVideoMark.handleData.Error."+a,c)}})},a.exports=d},290:function(a,b,c){function d(a){f=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=c(291),f=Txplayer.$,g=Txplayer.util,h=(Txplayer.v4errcode,c(79)),i=c(120);d.prototype={init:function(){var a=this;return this.auth=new h({context:this.context}),this.getVideoMark=new i(this.context),this.dataset.hasVideoPlayed=!1,this.context.dataset.urlIndex=0,["vid","cid","columnId","title","nextVid","tpid","authext","eduext","authfrom","isNeedPay","autoplay","skipPrelude","connectionPlayTime","playStartTime"].forEach(function(b){a.context.dataset[b]=a.context.config[b]}),"string"===f.type(this.context.config.volume)&&/^\d+$/.test(this.context.config.volume)&&(this.context.config.volume=parseInt(this.context.config.volume)),"number"!==f.type(this.context.config.volume)||this.context.config.volume>100||this.context.config.volume<0?void g.showError("context.config.volume必须为 0~100 "):(this.context.dataset.volume=this.context.config.volume,this.context.config.duration&&this.context.config.playEndTime&&(this.context.dataset.playEndTime=parseInt(this.context.config.duration)-this.context.config.playEndTime,this.context.dataset.playEndTime<0&&(this.context.dataset.playEndTime=null)),this.context.msg.broadcast("setVolume",{volume:this.context.dataset.volume,showTips:!1}),g.isSupportSafariHls(this.context.dataset.platform)&&(this.context.dataset.useHls=!0),a.context.dataset.hasChromeHlsPlugin&&(this.context.dataset.useChromeHls=!0,this.context.dataset.useHls=!0),this.context.getinfo=new e(this.context),this.addEventListener(),this.exportsModuleApis(),g.v4log("v4HdPlayerControl-init"),void(this.context.dataset.autoplay&&this.playControl({nextVid:this.context.dataset.nextVid,vid:this.context.dataset.vid,connectionPlayTime:this.context.dataset.connectionPlayTime,playStartTime:this.context.dataset.playStartTime})))},addEventListener:function(){this.dealAdMsgMoudle(),this.dealFilmMsgMoudle()},exportsModuleApis:function(){this.initUserApis(),this.initPrivateMsg(),this.initDataApis()}},g.extend(d.prototype,c(295)),g.extend(d.prototype,c(296)),g.extend(d.prototype,c(297)),g.extend(d.prototype,c(298)),g.extend(d.prototype,c(299)),g.extend(d.prototype,c(300)),g.extend(d.prototype,c(301)),g.extend(d.prototype,c(303)),Txplayer.register("v4HdPlayerControl",d)},291:function(a,b,c){function d(a){var b=function(){};return b.prototype=a,new b}function e(a){f=Txplayer.$,g.call(this,a)}var f=Txplayer.$,g=c(292),h="POST";e.prototype=d(g.prototype),e.prototype.constructor=e,e.prototype.requestGetinfo=function(a){return this.context.dataset.requestNewGetinfoError?this.requestOldGetinfo(a):this.requestNewGetinfo(a)},e.prototype.requestGetkey=function(a){return this.context.dataset.requestNewGetinfoError?this.requestOldGetVkey(a):this.requestNewGetVkey(a)},e.prototype.requestInsertAd=function(a){return a&&(a.method=h),this.requestPostCgi("insertAd",a).defer},e.prototype.requestPauseAd=function(a){return a&&(a.method=h),this.requestPostCgi("pauseAd",a).defer},e.prototype.requestEndingAd=function(a){return a&&(a.method=h),this.requestPostCgi("endingAd",a).defer},e.prototype.requestPpbAd=function(a){return a&&(a.method=h),this.requestPostCgi("ppbAd",a).defer},e.prototype.requestPdfAd=function(a){return a&&(a.method=h),this.requestPostCgi("pdfAd",a).defer},e.prototype.requestIvbAd=function(a){return a&&(a.method=h),this.requestPostCgi("ivbAd",a).defer},e.prototype.requestYaliuAd=function(a){return a&&(a.method=h),this.requestPostCgi("yaliuAd",a).defer},e.prototype.requestPostCgi=function(a,b){var c={};c="vinfoad"==a?this.dataset.svDomain?{buid:"vinfoad_sv",adparam:f.param(b.adparam),vinfoparam_sv:f.param(b.vinfoparam)}:{buid:"vinfoad",adparam:f.param(b.adparam),vinfoparam:f.param(b.vinfoparam)}:"vinfo"==a?this.dataset.svDomain?{buid:"onlyvinfo_sv",vinfoparam_sv:f.param(b.vinfoparam)}:{buid:"onlyvinfo",vinfoparam:f.param(b.vinfoparam)}:"getkey"==a?this.dataset.svDomain?{buid:"onlyvkey_sv",vkeyparam_sv:f.param(b.vkeyparam)}:{buid:"onlyvkey",vkeyparam:f.param(b.vkeyparam)}:{buid:"onlyad",adparam:f.param(b)};var d=b.domain?b.domain:"vd.l.qq.com",e=f.Deferred(),g=+new Date,i=b.method||"POST";"GET"===i&&(h=i);var j=f.ajax({method:i,type:i,url:"//"+d+"/proxyhttp",crossDomain:!0,xhrFields:{withCredentials:!0},timeout:8e3,dataType:"POST"===i?"json":"jsonp",contentType:"POST"===i?"text/plain":"application/javascript",data:"POST"===i?JSON.stringify(c):c}).done(function(a){var b=+new Date;if(0==a.errCode)try{if("onlyad"==c.buid){var d=JSON.parse(a.ad);d.adcost=b-g,e.resolve(d)}else"vinfoad"==c.buid?("{}"==a.vinfo&&e.reject(a,"dataerr"),e.resolve(JSON.parse(a.vinfo),a.ad)):"vinfoad_sv"==c.buid?("{}"==a.vinfo&&e.reject(a,"dataerr"),e.resolve(JSON.parse(a.vinfo),a.ad)):"onlyvinfo"==c.buid?("{}"==a.vinfo&&e.reject(a,"dataerr"),e.resolve(JSON.parse(a.vinfo))):"onlyvinfo_sv"==c.buid?("{}"==a.vinfo&&e.reject(a,"dataerr"),e.resolve(JSON.parse(a.vinfo))):"onlyvkey"==c.buid?("{}"==a.vkey&&e.reject(a,"dataerr"),e.resolve(JSON.parse(a.vkey))):"onlyvkey_sv"==c.buid&&("{}"==a.vkey&&e.reject(a,"dataerr"),e.resolve(JSON.parse(a.vkey)))}catch(f){e.reject(a,"dataerr")}else e.reject(a)}).fail(function(a,b){e.reject(a,b)});return{request:j,defer:e}},a.exports=e},292:function(a,b,c){function d(a){f=Txplayer.$,this.context=a,this.dataset={},this.context&&this.context.dataset&&this.context.dataset.businessId&&(this.context.dataset.authext||this.context.dataset.authfrom)&&("11"==this.context.dataset.businessId||this.context.dataset.businessId>=200)&&(this.dataset.svDomain=!0)}var e=c(293),f=Txplayer.$,g=c(294),h=Txplayer.util,i=["30","40","41","42","50","64","85","445"],j=["vd.l.qq.com","vi.l.qq.com"],k="pxy.video.qq.com",l=!1;d.prototype={checkGetInfoData:function(a){return a&&"o"==a.s?1:0},checkGetinfoRetCode:function(a){var b,c,d=0;return a&&a.s?"o"!==a.s?(d=a.em||50,c=a.exem):a.vl&&a.vl.vi&&f.isArray(a.vl.vi)&&0!==a.vl.cnt?b=a.vl.vi[0]:d=68:d=50,0!==d||5===b.fst&&f.isPlainObject(b.ul)&&f.isArray(b.ul.ui)&&0!==b.ul.ui.length?0===d&&2!==b.st&&(8!=b.st?d=62:(d=83,c=b.ch)):d=62,{exVal:c,iRetCode:d,vi:b}},getRequestUrl:function(a){a=a||{};var b,c={},d=["vv.video.qq.com","av.video.qq.com","bkvv.video.qq.com","h5vv.video.qq.com"];return c.domain=d[a.retryTimes],"vv.video.qq.com"==c.domain&&this.dataset.svDomain&&(c.domain="sv.video.qq.com"),"http:"===location.protocol?c.protocol="http:":c.protocol="https:","geth5info"===a.type?c.path="/geth5info?":"getkey"===a.type&&(c.path="/geth5key?"),b=c.protocol+"//"+c.domain+c.path,a.disableCallback||(b+="callback=?&"),b},getInfoConfig:function(a,b){var c="";try{c=location.href.replace(location.search,""),h.isInIframe()&&(c=h.removeUrlParams(top.location.href||""))}catch(d){}var g=window!=top?h.removeUrlParams(document.referrer||""):document.location.host,i={charge:0,defaultfmt:"auto",otype:"vinfoad"==a?"ojson":"json",guid:this.context.dataset.guid,flowid:this.context.dataset.flowid,platform:this.context.dataset.platform,sdtfrom:this.context.dataset.sdtfrom,defnpayver:1,appVer:Txplayer.dataset.ver,host:location.host,ehost:c,refer:g,sphttps:"https:"===location.protocol?1:0,tm:b.tm?b.tm:h.getTimeStampStr(),spwm:4};i.logintoken=this.context.dataset.txplayerAuth.getInfo(!0),this.context.dataset.unid&&(i.unid=this.context.dataset.unid),this.context.dataset.authfrom&&(i.auth_from=this.context.dataset.authfrom),this.context.dataset.authext&&(i.auth_ext=this.context.dataset.authext);var j=f.extend(i,b);b.show1080p||(j.defnpayver=0),"auto"!=j.defn&&j.defn?j.defsrc=2:j.defsrc=1;var k=(new Date).getDay();j.encryptVer="7."+(0==k?7:k);var l=e.$xx(j.platform,j.vids||j.vid,j.sdtfrom,1,i.tm,j.encryptVer);return j.cKey=l||"",this.context.dataset.useP2P&&(j.fp2p=1),j},getinfoOnError:function(a,b){a=a||{},"444"==a.code?a.timeout?a.errCode=Txplayer.v4errcode.getPlatformErrorCode("getinfo","neterror","03"):a.dataerr?a.errCode=Txplayer.v4errcode.getPlatformErrorCode("getinfo","neterror","04"):a.errCode=Txplayer.v4errcode.getPlatformErrorCode("getinfo","neterror","01"):a.code?a.errCode=Txplayer.v4errcode.getPlatformErrorCode("getinfo","cgiInnerError",a.code):(a.code="444",a.errCode=Txplayer.v4errcode.getPlatformErrorCode("getinfo","neterror","04")),a.errCode&&a.exem&&(a.errCode+="."+a.exem),b.reject(a)},getinfoReport:function(a,b,c,d){var e=+new Date,g={endTime:e,startTime:c,getinfoURL:b,costTime:e-c};a&&"object"===f.type(a)?(g.err="error",g=f.extend(g,a)):a&&"string"===f.type(a)&&(g.err=a,"timeout"==a&&(g.code=600)),"string"===f.type(a)?"timeout"==a?g.errCode=Txplayer.v4errcode.getPlatformErrorCode("getinfo","neterror","03"):g.errCode=Txplayer.v4errcode.getPlatformErrorCode("getinfo","neterror","01"):a&&a.code&&(g.errCode=Txplayer.v4errcode.getPlatformErrorCode("getinfo","cgiInnerError",a.code)),d&&(g.isLastRetry=1),g.errCode&&g.exem&&(g.errCode+="."+g.exem),this.context.msg.broadcast("getinfoFinish",g)},dealGetinfoData:function(a,b,c){var d,e,h,i=this,j=i.checkGetInfoData(a);if(1===j){if(d=i.checkGetinfoRetCode(a),83!=d.iRetCode&&0!==d.iRetCode)return Txplayer.util.v4log("getinfo返回错误码错误 ",{iRetCode:d.iRetCode}),void i.getinfoOnError(a,b);a.iRetCode=d.iRetCode,i.dataset.getinfoData=a;try{i.context.dataset.reportClip=d.vi.fc||d.vi.cl.fc,i.context.dataset.reportStatus=d.vi.vst,i.context.dataset.reportType=d.vi.type,i.context.dataset.reportTestId=a.tstid,i.context.dataset.reportUsrIP=a.ip,i.context.dataset.cdnID=d.vi.ul.ui[0].vt}catch(k){}return e=g.getPcVideoMp4Url(a,i.context),"array"===f.type(e)&&e.length&&(h=1==a.dltype?e[0].urlArray[0].url+"&vkey="+d.vi.fvkey:e[0].urlArray&&e[0].urlArray[0]&&e[0].urlArray[0].url),i.context.dataset.dltype=a.dltype,8===i.context.dataset.dltype&&e&&e[0]&&!e[0].m3u8&&(i.context.dataset.dltype=3),b.resolve(h,e,g.getDefinitionListFromData(a),a,c?c:{}),i.context.msg.broadcast("reportGetinfo",{filename:d.vi.fn,cdnIp:Txplayer.util.getHostNameByUrl(d.vi.ul.ui[0].url),cdnId:d.vi.ul.ui[0].vt,vkey:1==a.dltype?d.vi.fvkey:""}),null}return{exem:a.exem,code:a.em,curTime:a.curTime}},requestNewGetinfo:function(a){function b(s){s&&s.tm&&(a.tm=s.tm,h=e.getInfoConfig("vinfoad",a),3==p&&(p+=1)),s&&s.ckeyRetry&&(delete a.tm,h=e.getInfoConfig("vinfoad",a)),s&&s.domainRetry&&m++;var t=s&&s.domain||j[m%2],u=s&&s.method||"POST";l&&(u="GET");var v=+new Date,w="//"+t+"/proxyhttp/"+c+"&"+f.param(h),x=o>=p;(o>0||a.onlyGetinfo)&&(h.sphls=1,h.spgzip="",h.dlver=""),o++,e.context.msg.broadcast("getinfoStart",{getinfoURL:w,time:+new Date}),t===k&&(d.finaltry=1);var y=+new Date,z=e.requestPostCgi(c,{vinfoparam:h,adparam:d,domain:t,method:u});n=z.request;var A=z.defer;A.done(function(a,c){var d=+new Date,h={};try{h=JSON.parse(c)}catch(j){}h.adcost=d-y,h.retryTimes=o,h.domain=t;var k=e.dealGetinfoData(a,g,h);e.getinfoReport(k,w,v,x),k&&(k.code?x||f.inArray(k.code+"",i)==-1?e.getinfoOnError(k,g):85==k.code?b(k.exem==-3&&k.curTime?{tm:k.curTime}:{ckeyRetry:!0}):b():x?e.getinfoOnError({},g):b({domainRetry:!0}))}).fail(function(a,c){r.push(+new Date-y),c&&"abort"===c||(e.getinfoReport(c,w,v,x),x?!q&&o>=p&&r.every(function(a){return a<=500})?(b({domain:k}),q=!0):l?e.getinfoOnError({code:444,timeout:"timeout"===c,dataerr:"dataerr"===c,costTime:+new Date-v},g):(b({domain:"vd.l.qq.com",method:"GET"}),l=!0):b({domainRetry:!0}))})}var c,d,e=this,g=f.Deferred(),h=this.getInfoConfig("vinfoad",a),m=0;a.onlyGetinfo?(c="vinfo",d=""):(c="vinfoad",d=e.context.adApi&&e.context.adApi.getAdRequestParam()||{});var n,o=0,p=3,q=!1,r=[];return b(),this.context.msg.off("vidChange.requestGetinfo").on("vidChange.requestGetinfo",function(){n&&n.abort&&n.abort()}),this.context.msg.off("seekStart.requestGetinfo").on("seekStart.requestGetinfo",function(){n&&n.abort&&n.abort()}),this.context.msg.off("userStopVideo.requestGetinfo").on("userStopVideo.requestGetinfo",function(){n&&n.abort&&n.abort()}),g},requestOldGetinfo:function(a){function b(j){var k=j&&j.cgi?j.cgi:e.getRequestUrl({type:"geth5info",retryTimes:h}),l=+new Date;j&&j.tm&&(a.tm=j.tm,d=e.getInfoConfig("getinfo",a));var m=k+"&"+f.param(d),n=h>=3;h++,e.context.msg.broadcast("getinfoStart",{getinfoURL:m,time:l}),c=f.jsonp({url:k,data:d,timeout:6e3,callback:Txplayer.util.getJsonpCallbackName("getinfo")}).done(function(a){var c=e.dealGetinfoData(a,g);e.getinfoReport(c,m,l,n),c&&(c.code?n||f.inArray(c.code+"",i)==-1?e.getinfoOnError(c,g):b(85==c.code&&c.exem==-3&&c.curTime?{tm:c.curTime,cgi:k}:{cgi:k}):n?e.getinfoOnError({},g):b())}).fail(function(a,c){c&&"abort"===c||(e.getinfoReport(c,m,l,n),n?e.getinfoOnError({code:444,timeout:"timeout"===c,costTime:+new Date-l},g):b())})}var c,d=this.getInfoConfig("getinfo",a),e=this,g=f.Deferred(),h=0;return b(),this.context.msg.off("vidChange.requestGetinfo").on("vidChange.requestGetinfo",function(){c&&c.abort&&c.abort()}),this.context.msg.off("seekStart.requestGetinfo").on("seekStart.requestGetinfo",function(){c&&c.abort&&c.abort()}),this.context.msg.off("userStopVideo.requestGetinfo").on("userStopVideo.requestGetinfo",function(){c&&c.abort&&c.abort()}),g},getKeyConfig:function(a,b,c){function d(a){for(var b=0,c=a.length;b<c;b++)if(1==a[b].sl)return a[b].id;return-1}var f="";try{f=location.href.replace(location.search,""),h.isInIframe()&&(f=top.location.href.replace(top.location.search,""))}catch(g){}var i=h.removeUrlParams(f),j={otype:b?"ojson":"json",vid:a.vid,format:d(this.dataset.getinfoData.fl.fi),filename:a.newFileName,platform:this.context.dataset.platform,appVer:Txplayer.dataset.ver,vt:a.vt,sdtfrom:this.context.dataset.sdtfrom,guid:this.context.dataset.guid,flowid:this.context.dataset.flowid,charge:a.isNeedPay?1:0,linkver:2,lnk:this.context.dataset.getinfoJSON.vl.vi[0].lnk,tm:c?c:h.getTimeStampStr(),refer:f,ehost:i};j.logintoken=this.context.dataset.txplayerAuth.getInfo(!0),this.context.dataset.unid&&(j.unid=this.context.dataset.unid),this.context.dataset.authfrom&&(j.auth_from=this.context.dataset.authfrom),this.context.dataset.authext&&(j.auth_ext=this.context.dataset.authext);var k=(new Date).getDay();j.encryptVer="7."+(0==k?7:k);var l=e.$xx(j.platform,j.vids||j.vid,j.sdtfrom,1,j.tm,j.encryptVer);return j.cKey=l||"",j},getKeyErrorCode:function(a){a=a||{},!a.err&&a.em&&(a.err="error"),!a.code&&a.em&&(a.code=a.em);var b="";return"error"===a?b=Txplayer.v4errcode.getPlatformErrorCode("getkey","neterror","01"):"timeout"===a?b=Txplayer.v4errcode.getPlatformErrorCode("getkey","neterror","03"):"dataerr"===a?b=Txplayer.v4errcode.getPlatformErrorCode("getkey","neterror","04"):a.errCode?b=a.errCode:"timeout"===a.err?b=Txplayer.v4errcode.getPlatformErrorCode("getkey","neterror","03"):"no key"!==a.err||a.hasOwnProperty("code")?a.err&&!a.hasOwnProperty("code")?b=Txplayer.v4errcode.getPlatformErrorCode("getkey","neterror","01"):a.err&&a.hasOwnProperty("code")&&(b=Txplayer.v4errcode.getPlatformErrorCode("getkey","cgiInnerError",a.code+"")):b=Txplayer.v4errcode.getPlatformErrorCode("getkey","neterror","04"),b&&a.exem&&(b+="."+a.exem),b},getkeyReport:function(a,b,c,d){var e=this,g=+new Date,h={endTime:g,startTime:b,getkeyURL:c,costTime:g-b,isLastRetry:d};a&&"object"===f.type(a)?(h.err="error",h=f.extend(h,a),a.em&&(h.code=a.em)):a&&"string"===f.type(a)&&(h.err=a,"timeout"==a&&(h.code=600)),h.errCode=e.getKeyErrorCode(a),e.context.msg.broadcast("getkeyFinish",h)},requestOldGetVkey:function(a){var b,c=f.Deferred(),d=this,e=0,g=this.getRequestUrl({type:"getkey",retryTimes:e}),h=this.getKeyConfig(a,!1),j=function(a){if(a=a||{},a.code&&f.inArray(a.code+"",i)==-1)return void c.reject(a);var k=e>d.context.config.keyRetryTimes;if(k)return a.code||(a.code=445),void c.reject(a);e++;var l=+new Date;d.context.msg.broadcast("getkeyStart"),b=f.jsonp({url:a.url||g,data:h,timeout:6e3,callback:Txplayer.util.getJsonpCallbackName("getkey")}).done(function(b){b&&b.key?(c.resolve(b.key),d.getkeyReport(null,l,g+"&"+f.param(h),k)):(!b.code&&a.em&&(b.code=a.em),b.key||(b.err="no key"),d.getkeyReport(b,l,g+"&"+f.param(h),k),b.errCode=d.getKeyErrorCode(b),j(b))}).fail(function(a,b){b&&"abort"===b||(d.getkeyReport(b,l,g+"&"+f.param(h),k),j({code:445,errCode:d.getKeyErrorCode(b),url:d.getRequestUrl({type:"getkey",retryTimes:e}),timeout:"timeout"===b}))})};return j(),this.context.msg.off("vidChange.requestOldGetVkey").on("vidChange.requestOldGetVkey",function(){b&&b.abort&&b.abort()}),this.context.msg.off("userStopVideo.requestOldGetVkey").on("userStopVideo.requestOldGetVkey",function(){b&&b.abort&&b.abort()}),c},requestNewGetVkey:function(a){var b,c=f.Deferred(),d=this,e=0,g=this.getKeyConfig(a,!0),h=0,m=d.context.config.keyRetryTimes,n=!1,o=[],p=function(q){if(q=q||{},q.code&&f.inArray(q.code+"",i)==-1)return void c.reject(q);var r=e>m;if(r&&!q.lastDomain)return q.code||(q.code=445),void c.reject(q);q&&q.domainRetry&&h++,q.ckeyRetry&&(g=d.getKeyConfig(a,!0,q.curTime));var s=q&&q.domain||j[h%2],t=q&&q.method||"POST";l&&(t="GET"),e++;var u=+new Date,v="//"+s+"/proxyhttp/getkey&"+f.param(g);d.context.msg.broadcast("getkeyStart");var w=+new Date,x=d.requestPostCgi("getkey",{vkeyparam:g,domain:s,method:t});b=x.request;var y=x.defer;y.done(function(a){a&&a.key?(c.resolve(a.key),d.getkeyReport(null,u,v,r)):(!a.code&&a.em&&(a.code=a.em),85==a.code&&(a.hasOwnProperty("exem")&&(a.exem=a.exem),a.exem==-3&&(m=3==m?4:m),a.curTime&&(a.curTime=a.curTime),a.ckeyRetry=!0),a.err||(a.err="no key"),d.getkeyReport(a,u,v,r),a.errCode=d.getKeyErrorCode(a),a.code||"no key"!=a.err||(a.domainRetry=!0),Txplayer.util.v4log("重试getkey，后台有返回数据："+JSON.stringify(a)),p(a))}).fail(function(a,b){return o.push(+new Date-w),b&&"abort"===b?void Txplayer.util.v4log("重试getkey，所有请求都失败了，abort，err: "+b):void(!n&&e>m&&o.every(function(a){return a<=500})?(Txplayer.util.v4log("重试getkey，所有的请求都失败了,500ms以内, err: "+b),p({domain:k}),n=!0):l?(Txplayer.util.v4log("重试getkey，其他场景, err: "+b),d.getkeyReport(b,u,v,r),p({code:445,errCode:d.getKeyErrorCode(b||"error"),timeout:"timeout"===b,domainRetry:!0})):(Txplayer.util.v4log("重试getkey，没有用过GET请求，切换到GET请求, err: "+b),p({domain:"vd.l.qq.com",lastDomain:!0,method:"GET"}),l=!0))})};return p(),this.context.msg.off("vidChange.requestOldGetVkey").on("vidChange.requestOldGetVkey",function(){b&&b.abort&&b.abort()}),this.context.msg.off("userStopVideo.requestOldGetVkey").on("userStopVideo.requestOldGetVkey",function(){b&&b.abort&&b.abort()}),c}},a.exports=d},293:function(a,b){var c={};c.ha=function(a){function b(a,b){return((a>>1)+(b>>1)<<1)+(1&a)+(1&b)}for(var c=[],d=0;d<64;)c[d]=0|4294967296*Math.abs(Math.sin(++d));var e=function(d){for(var e,f,g,h,i=[],j=unescape(encodeURI(d)),k=j.length,l=[e=1732584193,f=-271733879,~e,~f],m=0;m<=k;)i[m>>2]|=(j.charCodeAt(m)||128)<<8*(m++%4);for(i[d=(k+8>>6)*a+14]=8*k,m=0;m<d;m+=a){for(k=l,h=0;h<64;)k=[g=k[3],b(e=k[1],(g=b(b(k[0],[e&(f=k[2])|~e&g,g&e|~g&f,e^f^g,f^(e|~g)][k=h>>4]),b(c[h],i[[h,5*h+1,3*h+5,7*h][k]%a+m])))<<(k=[7,12,17,22,5,9,14,20,4,11,a,23,6,10,15,21][4*k+h++%4])|g>>>32-k),e,f];for(h=4;h;)l[--h]=b(l[h],k[h])}for(d="";h<32;)d+=(l[h>>3]>>4*(1^7&h++)&15).toString(a);return d};return e}(16),c.stringToHex=function(a){for(var b="",c=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"),d=0;d<a.length;d++)b+=c[a.charCodeAt(d)>>4]+c[15&a.charCodeAt(d)];return b},c.hexToString=function(a){for(var b="",c="0x"==a.substr(0,2)?2:0;c<a.length;c+=2)b+=String.fromCharCode(parseInt(a.substr(c,2),16));return b},c._Seed="#$#@#*ad",c.tempcalc=function(a,b){for(var c="",d=0;d<a.length;d++)c+=String.fromCharCode(a.charCodeAt(d)^b.charCodeAt(d%4));return c},c.u1=function(a,b){for(var c="",d=b;d<a.length;d+=2)c+=a.charAt(d);return c},c._urlStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c.urlenc=function(a,b,d){for(var e,f,g,h,i,j,k,l="",m=0;m<a.length;)e=a.charCodeAt(m++),f=a.charCodeAt(m++),g=a.charCodeAt(m++),15==m&&(l+="A",l+=b,l+=d),h=e>>2,i=(3&e)<<4|f>>4,j=(15&f)<<2|g>>6,k=63&g,
isNaN(f)?j=k=64:isNaN(g)&&(k=64),l=l+c._urlStr.charAt(h)+c._urlStr.charAt(i)+c._urlStr.charAt(j)+c._urlStr.charAt(k);return l},c.$xx=function(a,b,d,e,f,g){if(magic="123456",g.length<3)return"err";if("7."!=g.substr(0,2))return"err";subver=g.substr(2),"1"==subver&&(magic="06fc1464"),"2"==subver&&(magic="4244ce1b"),"3"==subver&&(magic="77de31c5"),"4"==subver&&(magic="e0149fa2"),"5"==subver&&(magic="60394ced"),"6"==subver&&(magic="2da639f0"),"7"==subver&&(magic="c2f0cf9f");var f=f||parseInt(+new Date/1e3),e=(""+e).charAt(0),h=c.ha(magic+b+f+"*#06#"+a);return h},a.exports=c},294:function(a,b,c){var d=c(78).definitionMap;a.exports={getDefinitionListFromData:function(a){var b=Txplayer.$,c=[],e=location.hostname;if(top!==window)try{e=top.location.hostname}catch(f){}if("o"===a.s&&a.fl&&a.fl.fi&&"array"===b.type(a.fl.fi)&&a.fl.fi.length&&a.fl.fi[0])for(var g=0,h=a.fl.fi.length;g<h;g++)a.fl.fi[g].name in d&&("fhd"==a.fl.fi[g].name&&"fhd"!=a.fl.fi[g].name||c.push({name:a.fl.fi[g].name,cname:a.fl.fi[g].cname,sl:a.fl.fi[g].sl,format:a.fl.fi[g].id,lmt:a.fl.fi[g].lmt,fs:a.fl.fi[g].fs,br:a.fl.fi[g].br}));return c},getPcVideoMp4Url:function(a,b){function c(a){var b=[];return 8===a.dltype&&"o"===a.s&&a.vl&&a.vl.vi&&a.vl.vi.length&&a.vl.vi[0]&&a.vl.vi[0].ul&&(b.m3u8=a.vl.vi[0].ul.m3u8),(3===a.dltype||8===a.dltype)&&"o"===a.s&&a.vl&&a.vl.vi&&a.vl.vi.length&&a.vl.vi[0]&&a.vl.vi[0].ul&&a.vl.vi[0].ul.ui&&a.vl.vi[0].ul.ui.length&&k.each(a.vl.vi[0].ul.ui,function(c,d){d.url&&d.hls&&d.hls.pt?b.push(d.url+d.hls.pt):8===a.dltype&&b.push(d.url)}),b}function d(a,b){if(0===b)return a;var c=a.lastIndexOf("."),d=a.substr(0,c)+"."+b+a.substring(c);return d}function e(a){var b=a.indexOf("."),c=a.substr(b);return c}function f(a,c,d,e){for(var f=[],g={},h={},i=a.ui.length,j=0;j<i;j++)g=a.ui[j],h={},g.url&&(g.url&&g.url.indexOf(c+".flv")===-1&&g.url.indexOf(c+".mp4")===-1?h.url=g.url+d:h.url=g.url,g.vt&&(h.vt=parseInt(g.vt)),h.url.indexOf("sdtfrom")===-1&&(h.url.indexOf("?")>-1?h.url+="&sdtfrom="+b.dataset.sdtfrom:h.url+="?sdtfrom="+b.dataset.sdtfrom,h.url+="&guid="+b.dataset.guid),f.push(h));return f}var g,h,i,j,k=Txplayer.$,l=a.vl,m=l.vi,n=m[0],o=[],p=n.fn;if(3==a.dltype||8===a.dltype){g={},g.vid=n.lnk,g.width=parseInt(n.vw),g.height=parseInt(n.vh),g.bytesTotal=parseInt(n.fs),g.byteRate=n.br,g.filename=n.fn,h=n.fn,g.newFileName=h,g.fileNameSuffix=e(h);var q=c(a);g.urlArray=[],j=q.length;for(var r=0;r<j;r++)g.urlArray.push({url:q[r]});return g.vt=n.ul.ui[0].vt,g.duration=parseInt(n.td,10),g.m3u8=q.m3u8,o.push(g),o}if(j=n.cl.fc,!n.cl.ci&&n.fvkey&&n.fn&&n.ul&&n.ul.ui&&n.ul.ui.length)return g={},g.vid=n.lnk,g.width=parseInt(n.vw),g.height=parseInt(n.vh),g.bytesTotal=parseInt(n.fs),g.byteRate=n.br,g.filename=n.fn,h=n.fn,g.newFileName=h,g.fileNameSuffix=e(h),g.urlArray=f(n.ul,n.lnk,h,g.fileNameSuffix),g.vt=n.ul.ui[0].vt,g.duration=parseInt(n.td,10),o.push(g),o;if(n.cl.ci&&j===n.cl.ci.length){for(var s=0;s<j;s++)i=n.cl.ci[s],g={},g.vid=n.lnk,g.width=parseInt(n.vw),g.height=parseInt(n.vh),g.bytesTotal=parseInt(i.cs),g.duration=parseFloat(i.cd),g.byteRate=n.br,g.filename=n.fn,h=d(p,s+1),g.newFileName=h,g.fileNameSuffix=e(h),g.urlArray=f(n.ul,n.lnk,h,g.fileNameSuffix),g.vt=n.ul.ui[0].vt,o.push(g);return o}}}},295:function(a,b){var c=Txplayer.util;a.exports={playControl:function(a){var b=Txplayer.$,d=this;if(d.context.dataset.playerWidth=d.context.dataset.$playermod.width(),d.context.dataset.playerHeight=d.context.dataset.$playermod.height(),"string"===b.type(a)?a={vid:a}:"undefined"===b.type(a)&&(a={}),a.vid||(a.vid=this.context.dataset.vid),!a.vid||11!==a.vid.length)throw new Error("vid is illegal");if(this.context.dataset.canPlayTime&&this.context.dataset.currentTime>=this.context.dataset.canPlayTime&&a.vid===this.context.dataset.vid)return void(this.context.dataset.getinfoJSON&&4==this.context.dataset.getinfoJSON.exem?this.showDujiaDialog():this.showUIVipGuide("trial"));if(1!==this.context.dataset.playState&&!this.context.dataset.isPlayingAd||a.vid!==this.context.dataset.vid){if(a.vid==this.context.dataset.vid){if(this.dataset.hasVideoPlayed)return void this.context.msg.broadcast("play");if(this.context.dataset.playList&&this.context.dataset.playList.length)return void this.context.msg.broadcast("setFocusVideoUrl",b.extend({},this.context.dataset.playList[0],{autoplay:!0}))}a.autoplay=!0,this.checkLanguageSwitch(a),a.hasOwnProperty("cid")&&(this.context.dataset.cid=a.cid),a.hasOwnProperty("columnId")&&(this.context.dataset.columnId=a.columnId),a.hasOwnProperty("autoplay")&&(this.context.dataset.autoplay=a.autoplay),a.hasOwnProperty("isNeedPay")&&(this.context.dataset.isNeedPay=a.isNeedPay),a.hasOwnProperty("nextVid")&&(this.context.dataset.nextVid=a.nextVid),a.hasOwnProperty("showBullet")&&(this.context.config.showBullet=a.showBullet||this.context.config.showBullet||!1),a.hasOwnProperty("playEndTime")&&a.playEndTime&&a.hasOwnProperty("duration")?(this.context.dataset.playEndTime=parseInt(a.duration)-parseInt(a.playEndTime),this.context.dataset.playEndTime<0&&(this.context.dataset.playEndTime=null)):a.hasOwnProperty("vid")&&a.vid!==this.context.dataset.vid&&(this.context.dataset.playEndTime=null),a.hasOwnProperty("trailerMode")&&a.trailerMode?this.context.dataset.trailerMode=!0:this.context.dataset.trailerMode=!1,this.context.dataset.connectionPlayTime=a.connectionPlayTime?a.connectionPlayTime:0,a.connectionPlayTime&&this.context.config.duration&&Math.abs(+a.connectionPlayTime-+this.context.config.duration)<1&&(this.context.dataset.connectionPlayTime=a.connectionPlayTime=0),this.context.dataset.playStartTime=a.playStartTime?a.playStartTime:0,this.context.dataset.connectionPlayType=a.hasOwnProperty("connectionPlayType")?a.connectionPlayType:0,a.hasOwnProperty("connectionPlayType")||a.vid===this.context.dataset.vid||(this.context.dataset.connectionPlayType=3),a.hasOwnProperty("title")&&(this.context.dataset.title=c.xss(a.title)),a.authext&&(this.context.dataset.authext=a.authext),a.eduext&&(this.context.dataset.eduext=a.eduext),this.context.dataset.isAnNewPlayAction=!!a.isAnNewPlayAction,this.dataset.hasVideoPlayed=!1,this.dataset.hasLoadVideoUrl=!1;var e=this.context.dataset.vid;a.hasOwnProperty("vid")&&this.setVid(a.vid),this.context.msg.broadcast("beforeVideoPlay",this.context.dataset.vid,e),this.initNextVid();var f={};f.playStartTime=d.getSkipPreludeTime(),f.connectionPlayTime=d.context.dataset.connectionPlayTime,c.v4log("main-playcontrol:loadVideoUrls",f),this.loadVideoUrls(f)}},initNextVid:function(){var a=this;"array"==Txplayer.$.type(Txplayer.dataset.isReadyPlugins)&&Txplayer.dataset.isReadyPlugins.indexOf("UiPlayNext")!=-1?this.context.msg.broadcast("setNextVid",{nextVid:this.context.dataset.nextVid}):this.context.msg.on("pluginReady",function(b){"UiPlayNext"==b.name&&a.context.msg.broadcast("setNextVid",{nextVid:a.context.dataset.nextVid})})},setVid:function(a){if(a&&a!==this.context.dataset.vid){c.showInfo("HdPlayerControl.onVidChange",{currentVid:this.context.dataset.vid,nextVid:a});var b=this.context.dataset.vid;this.context.dataset.vid=a,this.context.msg.broadcast("vidChange",a,b),this.context.dataset.hasCallSetVid=!0;try{this.context.userMsg.broadcast("vidChange",a,b)}catch(d){}this.context.dataset.playerId=c.createGUID(),this.context.dataset.flowid=this.context.dataset.playerId+"_"+this.context.dataset.platform}},pauseControl:function(){this.context.dataset.disableHotKey||this.context.dataset.isPlayingAd||this.context.msg.broadcast("pause")}}},296:function(a,b){var c=Txplayer.util;a.exports={seekTo:function(a){function b(){i===j.index?e.context.msg.broadcast("setFocusVideoCurrentTime",{time:f-j.prevDurtion,autoplay:!0}):e.context.dataset.playList[j.index]&&(g=e.context.dataset.playList[j.index],g.autoplay=!0,g.currentTime=f-j.prevDurtion,g.updateIndex=j.index,e.context.msg.broadcast("setFocusVideoUrl",g))}var d=Txplayer.$,e=this;if("object"===d.type(a)&&a.showTips&&(this.dataset.seekToSyncFlag=!0),!this.context.dataset.isPlayingAd){if(0===this.context.dataset.playState)return void c.showError("播放已结束，不能seek");if(this.context.dataset.playState===-1)return void c.showError("播放状态未初始化，不能seek","seekTo");if(!this.context.dataset.disableHotKey){var f,g,h,i,j,k,l,m,n=this.context.dataset.currentTime,o="object"!==d.type(a)||!a.hasOwnProperty("connectionPlayTime")&&!a.hasOwnProperty("playStartTime")&&!a.hasOwnProperty("historyTime")&&!a.hasOwnProperty("showTips")&&!a.hasOwnProperty("doNotReport");if(a&&"object"===d.type(a)&&(a.time&&"string"==typeof a.time&&/^\d+$/.test(a.time)&&(a.time=Number(a.time)),a.connectionPlayTime&&"string"==typeof a.connectionPlayTime&&/^\d+$/.test(a.connectionPlayTime)&&(a.connectionPlayTime=Number(a.connectionPlayTime)),a.playStartTime&&"string"==typeof a.playStartTime&&/^\d+$/.test(a.playStartTime)&&(a.playStartTime=Number(a.playStartTime))),"object"===d.type(a)?f="number"===d.type(a.time)?a.time:"number"===d.type(a.connectionPlayTime)?a.connectionPlayTime:"number"===d.type(a.playStartTime)?a.playStartTime:null:"number"===d.type(a)&&(f=a,a={}),"number"!==d.type(f))return void c.error("seekTo参数错: 参数必须为number("+f+")");if(f<0&&(f=0),"number"===d.type(f)&&f<=this.context.dataset.duration&&("number"!==d.type(this.context.dataset.canPlayTime)||f<=this.context.dataset.canPlayTime)&&this.updateCurrentTime(f,"seekTo"),h=this.context.dataset.duration,f>h)return void c.showError("seekTo参数错误: seekTime["+f+"]不能超过视频的时长["+h+"]","");"number"==d.type(this.context.dataset.canPlayTime)&&f>this.context.dataset.canPlayTime&&(f=this.context.dataset.canPlayTime-1),j=this.getVideoSeekToInfo(f),i=this.context.dataset.playListIndex,k=+new Date,this.context.dataset.isVideoSeeking=!0,c.v4log("seekStart ",{isVideoSeeking:this.context.dataset.isVideoSeeking}),this.context.msg.broadcast("seekStart",{type:"film",seekTime:f,seekIndex:j.index,seekStartTime:k,currentTimeWhenSeekStart:n,isUserAction:o});try{this.context.userMsg.broadcast("seekStart",{type:"film",seekTime:f,seekIndex:j.index,seekStartTime:k,currentTimeWhenSeekStart:n,isUserAction:o})}catch(p){}this.context.msg.off("videoSeeked.seekTo"),this.context.msg.once("videoSeeked.seekTo",function(){l=+new Date,m=e.context.dataset.currentTime,e.context.msg.broadcast("seekEnd",{seekStartTime:k,seekEndTime:l,seekTime:f,currentTimeWhenSeekStart:n,currentTimeWhenSeekEnd:m,isUserAction:o});try{e.context.userMsg.broadcast("seekEnd",{type:"film",seekStartTime:k,seekEndTime:l,seekTime:f,currentTimeWhenSeekStart:n,currentTimeWhenSeekEnd:m,isUserAction:o})}catch(a){}Math.abs(f-m)>5&&(e.context.dataset.retrySeekTo=!0,b())}),e.context.msg.broadcast("pause"),b(),a.seekTime=f,e.context.msg.broadcast("showUiSeekTip",a),a.bulletid&&e.context.msg.broadcast("barrageSeekTime",{bulletid:a.bulletid,time:f})}}}}},297:function(a,b){function c(){var a=this,b=Txplayer.util;this.context.msg.on("onAdOrderDataReady",function(a){}),this.context.msg.on("loadingAdStart",function(c){if(b.v4log("loadingAdStart 前帖开始播放"),!a.context.dataset.hasLoadingAdStart){a.context.dataset.hasLoadingAdStart=!0,a.context.msg.broadcast("adVideoShow"),a.context.msg.broadcast("filmVideoHide","loadingad");try{a.context.userMsg.broadcast("adStart",{type:"loadingad"}),a.context.msg.broadcast("adStart",{type:"loadingad"})}catch(d){}}}),this.context.msg.on("loadingAdLoadComplete",function(c){b.v4log("loadingAdLoadComplete 前帖全部下载完成, p2pLoadingAdLoadComplete : ",a.context.dataset.p2pLoadingAdLoadComplete),a.context.dataset.p2pLoadingAdLoadComplete||a.context.msg.broadcast("setPreloadVideoUrl",{isPreloadFirstFilm:!0})}),this.context.msg.on("p2pLoadingAdLoadComplete",function(c){b.v4log("p2pLoadingAdLoadComplete p2p加载前贴"),a.context.msg.broadcast("setPreloadVideoUrl",{isPreloadFirstFilm:!0})}),this.context.msg.on("loadingAdEnd",function(c){b.v4log("loadingAdEnd 前帖播放结束"),a.context.msg.broadcast("adVideoHide"),a.context.msg.broadcast("filmVideoShow","loadingad");try{a.context.userMsg.broadcast("adEnd",{type:"loadingad"}),a.context.msg.broadcast("adEnd",{type:"loadingad"})}catch(d){}}),this.context.msg.on("insertAdStart",function(c){b.v4log("insertAdStart"),a.context.msg.broadcast("adVideoShow"),a.context.msg.broadcast("filmVideoHide","insertad");try{a.context.userMsg.broadcast("adStart",{type:"insertad"}),a.context.msg.broadcast("adStart",{type:"insertad"})}catch(d){}}),this.context.msg.on("insertAdEnd",function(c){b.v4log("insertAdEnd"),a.context.msg.broadcast("adVideoHide"),a.context.msg.broadcast("filmVideoShow","insertad");try{a.context.userMsg.broadcast("adEnd",{type:"insertad"}),a.context.msg.broadcast("adEnd",{type:"insertad"})}catch(d){}}),this.context.msg.on("endingAdStart",function(c){b.v4log("endingAdStart"),a.context.msg.broadcast("adVideoShow"),a.context.msg.broadcast("filmVideoHide","endingad");try{a.context.userMsg.broadcast("adStart",{type:"endingad"}),a.context.msg.broadcast("adStart",{type:"endingad"})}catch(d){}}),this.context.msg.on("endingAdEnd",function(c){if(!a.context.dataset.isFilmEnded)return b.v4log("isEndingAdEnded"),void(a.context.dataset.isEndingAdEnded=!0);b.v4log("endingAdEnd"),a.context.msg.broadcast("adVideoHide"),a.context.msg.broadcast("filmVideoShow","endingad"),setTimeout(function(){a.context.msg.broadcast("videoEnd",{index:a.context.dataset.playListIndex,playListType:"endingad",isTheLastFilm:!0,isAllEnd:!0,from:"endingAdEnd"});try{a.context.userMsg.broadcast("videoEnd",{isTheLastFilm:!0,isAllEnd:!0})}catch(b){}},0);try{a.context.userMsg.broadcast("adEnd",{type:"endingad"}),a.context.msg.broadcast("adEnd",{type:"endingad"})}catch(d){}}),this.context.msg.on("pauseAdStart",function(b){a.context.msg.broadcast("adVideoShow")}),this.context.msg.on("pauseAdEnd",function(b){a.context.msg.broadcast("adVideoHide")}),this.context.msg.on("pvlAdStart",function(b){a.context.msg.broadcast("loadingImageAdUrlReady",{url:b})})}a.exports={dealAdMsgMoudle:c}},298:function(a,b){function c(){var a=this;a.context.msg.on(d.getUniqueMsgKey("beforeVideoPlay"),function(b,c){a.context.dataset.urlIndex=0,a.context.dataset.getinfoJSON=null,a.context.dataset.requestNewGetinfoError=!1,a.context.dataset.filmVideoData=[],a.context.dataset.duration=null,a.context.dataset.disableHotKey=!1,a.context.dataset.hasLoadingAdStart=!1,a.updateCurrentTime(0,"beforeVideoPlay"),a.dataset.seekToSyncFlag=!1,a.context.msg.off("videoPlaying.loadAndSeekSync"),a.context.msg.off("getVideoUrlSuccess.loadVideoUrls"),a.context.msg.off("videoPlaying.showUiSeekTip")}),a.context.msg.on(d.getUniqueMsgKey("beforeVideoRePlay"),function(b,c){a.dataset.hasVideoPlayed=!1,a.context.dataset.hasLoadingAdStart=!1,a.updateCurrentTime(0,"beforeVideoRePlay")}),this.context.msg.on(d.getUniqueMsgKey("videoPlaying"),function(b){"film"===a.context.dataset.currentPlayListType&&(a.dataset.hasVideoPlayed=!0)}),this.context.msg.on(d.getUniqueMsgKey("videoEnd"),function(b){b.isTheLastFilm&&"film"===b.playListType&&(a.context.msg.off("videoSeeked.seekTo"),a.dataset.hasVideoPlayed=!1,a.context.dataset.getinfoJSON=null)}),this.context.msg.on("userStopVideo",function(b){a.dataset.hasVideoPlayed=!1}),a.context.msg.on(d.getUniqueMsgKey("videoTimeUpdate"),function(b){if(b&&"film"===b.playListType){var c=a.calcCurrentTime();if(c&&b&&b.videoTag&&b.videoTag.currentTime&&a.updateCurrentTime(c,"onSectionTimeupdate"),a.context.dataset.canPlayTime){if(c&&c>=a.context.dataset.canPlayTime&&(a.context.dataset.getinfoJSON&&4==a.context.dataset.getinfoJSON.exem?a.showDujiaDialog():a.showUIVipGuide("trial")),b&&b.videoTag&&Math.floor(b.videoTag.duration)!==a.context.dataset.canPlayTime){var d=a.context.dataset.canPlayTime-b.videoTag.duration;d>0&&d<=3&&(a.context.dataset.canPlayTime=Math.floor(b.videoTag.duration))}a.showUnOfficialLimitTips()}}}),a.context.msg.on(d.getUniqueMsgKey("videoPlaying"),function(b){if(b&&"film"===b.playListType&&a.context.dataset.canPlayTime){var c=a.calcCurrentTime();c&&a.updateCurrentTime(c,"onSectionPlaying"),c&&c>=a.context.dataset.canPlayTime&&(a.context.dataset.getinfoJSON&&4==a.context.dataset.getinfoJSON.exem?a.showDujiaDialog():a.showUIVipGuide("trial"))}}),a.context.msg.on(d.getUniqueMsgKey("seekStart"),function(b){b&&"film"===b.type&&a.context.dataset.canPlayTime&&b&&b.seekTime&&b.seekTime>=a.dataset.canPlayTime&&(a.context.dataset.getinfoJSON&&4==a.context.dataset.getinfoJSON.exem?a.showDujiaDialog():a.showUIVipGuide("trial"))}),a.context.msg.on(d.getUniqueMsgKey("videoEnd"),function(b){b&&"film"===b.playListType&&a.context.dataset.canPlayTime&&a.context.dataset.currentTime>a.context.dataset.canPlayTime&&(a.updateCurrentTime(a.context.dataset.canPlayTime,"videoEnd"),a.context.dataset.getinfoJSON&&4==a.context.dataset.getinfoJSON.exem?a.showDujiaDialog():a.showUIVipGuide("trial"))}),a.context.msg.on(d.getUniqueMsgKey("beforeVideoPlay"),function(b,c){if(a.context.dataset.hasChromeHlsPlugin){a.context.dataset.useChromeHls=!0,a.context.dataset.useHls=!0;var e=["html5hd","safarihls","chromehls"],f=a.context.config.playerType;e.indexOf(f)>-1&&(a.context.config.playerType="chromehls")}d.isSupportSafariHls(a.context.dataset.platform)&&(a.context.dataset.useHls=!0),a.context.dataset.hasCallShowUIVipGuide=!1}),this.context.msg.on(d.getUniqueMsgKey("videoInterruptByError"),function(){a.dataset.getVkeyErrorData&&83===a.dataset.getVkeyErrorData.code?a.context.dataset.getinfoJSON&&4==a.context.dataset.getinfoJSON.exem?a.showDujiaDialog():a.showUIVipGuide("trial"):a.dataset.getVideoInfoErrorData&&91===a.dataset.getVideoInfoErrorData.code&&(a.showUIVipGuide("switchDef"),a.context.dataset.isDefinitionSwitching=!1)}),a.context.msg.on(d.getUniqueMsgKey("chromehlsErrorSwitchToHtml5hd"),function(b,c){a.context.msg.broadcast("reportChromeHlsError",b.code),a.context.dataset.useHls=!1,a.context.dataset.useChromeHls=!1,delete a.context.dataset.hlsLoadStartTime;var d=["html5hd","safarihls","chromehls"],e=a.context.config.playerType;d.indexOf(e)>-1&&(a.context.config.playerType="html5hd");var f={autoplay:!0};f.playStartTime=a.getSkipPreludeTime(),f.connectionPlayTime=a.context.dataset.connectionPlayTime,f.onlyGetinfo=!0,a.context.dataset.isDefinitionSwitching&&a.context.dataset.definition&&(f.defn=a.context.dataset.definition),a.context.dataset.isPlayingAd?a.context.msg.once("loadingAdEnd",function(){a.loadVideoUrls(f)}):a.loadVideoUrls(f)}),a.context.msg.on(d.getUniqueMsgKey("chromehlsErrorSwitchToChromehls"),function(b,c){a.context.msg.broadcast("reportChromeHlsError",b.code);var d={autoplay:!0};d.playStartTime=a.getSkipPreludeTime(),d.connectionPlayTime=a.context.dataset.connectionPlayTime,d.onlyGetinfo=!0,a.context.dataset.isDefinitionSwitching&&a.context.dataset.definition&&(d.defn=a.context.dataset.definition),a.loadVideoUrls(d)}),a.context.msg.on(d.getUniqueMsgKey("chromehlsCkeyTimeout"),function(){var b={onlyGetinfo:!0};a.updateVideoUrls(b)}),a.context.msg.on(d.getUniqueMsgKey("getVideoUrlSuccess"),function(){var b={width:a.context.dataset.videoWidth,height:a.context.dataset.videoHeight};if(b.width&&b.height){var c=a.context.dataset.$playermod.width(),d=a.context.dataset.$playermod.height(),e=b.width*(d/b.height),f=b.height*(c/b.width);e<c&&e>=c-20?a.context.dataset.$videomod.addClass("txp_video_fit_cover"):f<d&&f>=d-20?a.context.dataset.$videomod.addClass("txp_video_fit_cover"):a.context.dataset.$videomod.removeClass("txp_video_fit_cover")}});var b=function(){var b={otype:"json",market_id:1,platform:2,unix_time:+new Date,ip:a.context.dataset.reportUsrIP,user_agent:navigator.userAgent,qq:d.getQQFromCookie(),wx_openid:d.cookie.get("vuserid"),refer:document.referrer,url:location.href};Txplayer.$.jsonp({url:"//ncgi.video.qq.com/fcgi-bin/get_guid_http_to_jce?callback=?",data:b,callback:Txplayer.util.getJsonpCallbackName("get_guid")}).done(function(b){b&&0==b.err_code&&b.guid?(a.context.dataset.unid=b.guid,d.setData(Txplayer.dataset.localStorageKey.unid,b.guid)):a.dataset.hasRequestUnid=!1}).fail(function(){a.dataset.hasRequestUnid=!1})};a.context.msg.on(d.getUniqueMsgKey("videoPlaying"),function(c){if(c&&"film"===c.playListType){if(a.context.dataset.unid)return;var e=d.getData(Txplayer.dataset.localStorageKey.unid);if(e)return void(a.context.dataset.unid||(a.context.dataset.unid=e));if(a.dataset.hasRequestUnid)return;a.dataset.hasRequestUnid=!0,b()}}),a.context.msg.on(d.getUniqueMsgKey("videoPlaying"),function(b){b&&"film"===b.playListType&&a.getVideoMark&&a.getVideoMark.requestVideoMark()}),a.context.msg.on(d.getUniqueMsgKey("showLoginGuide"),function(b){a.context.dataset.disableHotKey=!0,a.context.msg.broadcast("pause"),a.context.msg.broadcast("hideUiTips"),Txplayer.util.v4log("showLoginGuide",{connectionPlayTime:a.context.dataset.currentTime});try{a.context.userMsg.broadcast("showLoginGuide",{connectionPlayTime:a.context.dataset.currentTime})}catch(c){}a.context.dataset.isBrowserFullscreen&&a.context.msg.broadcast("exitBrowserFullscreen"),a.context.dataset.isWindowFullscreen&&a.context.msg.broadcast("exitWindowFullscreen")})}var d=Txplayer.util;a.exports={dealFilmMsgMoudle:c}},299:function(a,b){a.exports={initUserApis:function(){this.dataset.moduleApis={},this.dataset.moduleApis.seekTo=this.seekTo.bind(this),this.dataset.moduleApis.play=this.playControl.bind(this),this.dataset.moduleApis.pause=this.pauseControl.bind(this),this.dataset.moduleApis.getVid=this.getVid.bind(this),this.dataset.moduleApis.getCid=this.getCid.bind(this),this.dataset.moduleApis.getColumnId=this.getColumnId.bind(this),this.dataset.moduleApis.isSmallWindowMode=this.isSmallWindowMode.bind(this),this.dataset.moduleApis.setPlayerVipStatus=this.setPlayerVipStatus.bind(this),this.dataset.moduleApis.getDuration=this.getDuration.bind(this),this.dataset.moduleApis.getFileSize=this.getFileSize.bind(this),this.dataset.moduleApis.getVideoSize=this.getVideoSize.bind(this),this.dataset.moduleApis.getCurrentTime=this.getCurrentTime.bind(this),this.dataset.moduleApis.seekRight=this.seekRight.bind(this),this.dataset.moduleApis.seekLeft=this.seekLeft.bind(this),this.dataset.moduleApis.togglePlayPause=this.togglePlayPause.bind(this),this.dataset.moduleApis.getUserPayStatus=this.getUserPayStatus.bind(this),this.dataset.moduleApis.getVideoType=this.getVideoType.bind(this),this.dataset.moduleApis.getPlayerType=this.getPlayerType.bind(this),this.dataset.moduleApis.setSmallWindowMode=this.setSmallWindowMode.bind(this),this.dataset.moduleApis.getDefinitionList=this.getDefinitionList.bind(this),this.dataset.moduleApis.callPlayerExtendMethod=this.callPlayerExtendMethod.bind(this),this.dataset.moduleApis.closeLoginGuide=this.closeLoginGuide.bind(this),Txplayer.$.extend(this.context.userApi,this.dataset.moduleApis)},initPrivateMsg:function(){var a=this;this.dataset.privateApis={},this.dataset.privateApis.playControl=this.playControl.bind(this),this.dataset.privateApis.pauseControl=this.pauseControl.bind(this),this.dataset.privateApis.seekTo=this.seekTo.bind(this),this.dataset.privateApis.retryUrlsWhenErr=this.retryUrlsWhenErr.bind(this),this.dataset.privateApis.loadVideoUrls=this.loadVideoUrls.bind(this),Txplayer.$.each(this.dataset.privateApis,function(b,c){a.context.msg.on(b,c)})},initDataApis:function(){var a=this;this.dataset.dataApis={},this.dataset.dataApis.getVideoSeekToInfo=function(b,c){c.data=a.getVideoSeekToInfo(b)},Txplayer.$.each(this.dataset.dataApis,function(b,c){a.context.msg.setData(b,c)})}}},300:function(a,b){var c=Txplayer.util,d=Txplayer.v4errcode;a.exports={requestVideoUrlsByVid:function(a){a=a||{};var b={vid:this.context.dataset.vid,defn:this.context.dataset.historyDefinition||"",charge:this.context.dataset.isNeedPay?1:0,fhdswitch:a.fhdswitch?1:0,show1080p:this.context.config.show1080p?1:0,isHLS:0},e=this,f={};if(Txplayer.$.extend(b,a),this.context.dataset.useHls===!0&&"false"!=c.getUrlParam("ishls")){var g={isHLS:1,dtype:3,sphls:1,spgzip:"",dlver:""},h=!c.inNewIframe()&&("v.qq.com"===location.hostname||"film.qq.com"===location.hostname),i=h&&"0"===c.getUrlParam("useNewHls");h&&!i&&(g.sphls=2,g.spgzip=1,g.dlver=2),Txplayer.$.extend(b,g)}c.v4log("requestGetinfo",b);var j=+new Date;this.context.getinfo.requestGetinfo(b).done(function(d,g,h,i,j){if(c.v4log("requestGetinfo-done",d),g&&(e.context.dataset.filmVideoData=g,e.context.dataset.definitionList=h,Txplayer.$(e.context.dataset.definitionList).each(function(a,b){1===b.sl&&(e.context.dataset.currentDefinitionRate=b.br,e.context.dataset.definition=b.name)})),e.context.dataset.getinfoJSON=i,e.context.dataset.duration=e.getDuration(),e.dataset.getVideoInfoErrorData=null,e.context.dataset.userPayStatus=e.getUserPayStatus(),e.context.dataset.filesize=e.getFileSize(),e.context.dataset.canPlayTime=null,i&&i.preview&&(1==i.exem||2==i.exem||4==i.exem||83==i.iRetCode)&&(e.context.dataset.canPlayTime=i.preview,f={code:83,trailTime:i.preview}),i&&i.vl&&i.vl.vi&&"object"===Txplayer.$.type(i.vl.vi[0])&&(e.context.dataset.videoWidth=i.vl.vi[0].vw,e.context.dataset.videoHeight=i.vl.vi[0].vh,e.context.dataset.tpid=i.vl.vi[0].videotype,e.context.dataset.ckey=i.vl.vi[0].fvkey),i.preview||1!==i.exem&&83!==i.iRetCode){if(1==i.dltype){e.context.msg.broadcast("destroyHlsPlayer",{msg:"backend does not suppoert hls, dltype=1"}),e.context.dataset.useHls=!1,e.context.dataset.useChromeHls=!1;var k=["html5hd","safarihls","chromehls"],l=e.context.config.playerType;k.indexOf(l)>-1&&(e.context.config.playerType="html5hd")}c.v4log("broadcast-getVideoUrlSuccess",a),e.context.msg.broadcast("getVideoUrlSuccess",d,g[0]),b.onlyGetinfo&&!a.requestNewGetinfoError||(c.v4log("broadcast-onAdOrderDataReady",""),e.context.msg.broadcast("onAdOrderDataReady",j))}else f={code:83,trailTime:0};f&&f.hasOwnProperty("trailTime")&&!f.trailTime?e.showUIVipGuide("trial"):(f&&f.hasOwnProperty("code")&&83===f.code||e.context.dataset.trailerMode)&&(c.v4log("该片支持试看",f),4==i.exem?e.context.msg.broadcast("showUIDujiaTip",f):e.context.msg.broadcast("showUIVipTip",f))}).fail(function(f){var g=+new Date;c.v4log("requestGetinfo-Fail",f);var h=window.performance&&window.performance.now()||0,i=g-j;if(i>32e3&&(i=32e3),f&&1001==f.code)return c.v4log("合并接口失败 单独请求接口",f),a.onlyGetinfo=!0,a.requestNewGetinfoError=!0,e.context.dataset.requestNewGetinfoError=!0,e.requestVideoUrlsByVid(a),void e.context.msg.broadcast("reportAdInfo",{adtype:"LD",step:1,step_duration:i,step_code:f.code,step_index:1,firstview_duration:parseInt(h,10)});if(b.onlyGetinfo&&!a.requestNewGetinfoError||e.context.msg.broadcast("reportAdInfo",{adtype:"LD",step:1,step_duration:i,step_code:444===f.code?2103:2100,step_index:1,firstview_duration:parseInt(h,10)}),f&&91===f.code)e.dataset.getVideoInfoErrorData=f,e.context.msg.broadcast("videoInterruptByError");else if(f&&96==f.code)e.context.msg.broadcast("showLoginGuide");else if(f&&"76"===f.code&&"hls"===f.type)e.context.dataset.useHls=!1,e.requestVideoUrlsByVid(a);else{var k=d[f.code]||d.defaultMsg;"80"==f.code&&c.inArray(["1","2","3","7","9","10","11","14"],""+f.exem)>-1&&(k=d["80."+f.exem]),e.context.msg.broadcast("error",{errCode:f.errCode,code:f.code,msg:k,type:"cgi",exem:f.exem});try{e.context.userMsg.broadcast("error",{flowId:e.context.dataset.flowid,errCode:f.errCode,code:f.code,msg:k,type:"cgi",exem:f.exem})}catch(l){}}})},requestVideoNextPartKey:function(a,b,c){if(b=b||0,!this.context.dataset.filmVideoData)return!1;var e=this;return c=c?c:Txplayer.$.Deferred(),a.isNeedPay=this.context.dataset.isNeedPay,this.context.getinfo.requestGetkey(a).done(function(d){return e.dataset.getVkeyErrorData=null,d?void c.resolve(a.urlArray[b].url+"&vkey="+d):void c.reject()}).fail(function(f){if(f&&"1001"==f.code)return e.context.dataset.requestNewGetinfoError=!0,void e.requestVideoNextPartKey(a,b,c);if(!e.context.dataset.canPlayTime||83!==f.code){e.dataset.getVkeyErrorData=f,e.context.msg.broadcast("error",{code:f.code,errCode:f.errCode,msg:d[f.code]||d.defaultMsg,type:"cgi"});try{e.context.userMsg.broadcast("error",{flowId:e.context.dataset.flowid,code:f.code,errCode:f.errCode,msg:d[f.code]||d.defaultMsg,type:"cgi"})}catch(g){}c.reject(f)}}),c},updateVideoUrls:function(a){a=a||{};var b=this;this.context.msg.once("getVideoUrlSuccess.updateVideoUrls",function(a,c){c=c||{};var d=[];c.urlArray&&c.urlArray.length>0&&(d=c.urlArray.map(function(a){return a.url})),b.context.msg.broadcast("setChromeHlsData",{k:"keytimeout",v:{keyid:"hls."+b.context.dataset.getinfoJSON.vl.vi[0].lnk+"."+b.context.dataset.currentDefinitionFormat,m3u8url:d}})});var c=Txplayer.$.extend({},{vid:a.vid,charge:a.charge,defn:a.defn,fhdswitch:a.fhdswitch,onlyGetinfo:a.onlyGetinfo});this.requestVideoUrlsByVid(c)},loadVideoUrls:function(a){a=a||{},this.dataset.hasLoadVideoUrl=!0;var b,d=this;c.v4log("loadVideoUrls",a);var e=function(a){if(c.v4log("seekToSync",{playState:d.context.dataset.playState,seekToSyncFlag:d.dataset.seekToSyncFlag}),d.context.dataset.playState===-1)d.context.msg.on("videoPlaying.loadAndSeekSync",function(b){"film"==b.playListType&&(d.dataset.seekToSyncFlag||(a(),d.context.msg.off("videoPlaying.loadAndSeekSync")))});else{if(d.dataset.seekToSyncFlag)return;a()}};this.context.msg.once("getVideoUrlSuccess.loadVideoUrls",function(b,f){if(f=f||{},!d.context.dataset.filmVideoData)return void c.showError("onGetVideoUrlSuccess失败","找不到播放url列表");var g=[];d.context.dataset.useHls===!0?g.push({url:b,filesize:d.context.dataset.filmVideoData[0].bytesTotal,vid:d.context.dataset.vid,m3u8:f&&f.m3u8}):Txplayer.$(d.context.dataset.filmVideoData).each(function(a,e){return 0===a&&b?void g.push({url:b,filesize:e.bytesTotal,vid:d.context.dataset.vid,data:e}):void g.push({_url:e.urlArray,data:e,filesize:e.bytesTotal,vid:d.context.dataset.vid,getUrlSync:function(){var a=Txplayer.$.Deferred();return d.requestVideoNextPartKey(this.data,d.context.dataset.urlIndex).done(function(b){c.showInfo("getUrlSync.done",b),a.resolve(b)}).fail(function(b){c.showError("getUrlSync.fail",b),a.reject(b)}),a}})});var h={data:g};return c.v4log("videoListChange",""),d.context.msg.broadcast("videoListChange",b,g),a.repalcePlayList&&(h.repalcePlayList=!0),a.clear&&(h.clear=!0),c.v4log("addUrls2Player",""),d.context.msg.broadcast("addUrls2Player",h),d.context.dataset.useChromeHls&&(d.context.dataset.hlsLoadStartTime=a.connectionPlayTime?a.connectionPlayTime:a.playStartTime,d.context.dataset.hlsLoadStartTime=+d.context.dataset.hlsLoadStartTime),c.v4log("options.autoplay",{autoplay:a.autoplay||"",noHdAdPlugin:d.context.dataset.noHdAdPlugin||""}),a.autoplay?(d.context.dataset.autoplay=!0,d.context.msg.broadcast("play")):d.context.dataset.noHdAdPlugin&&!a.fhdswitch&&(c.v4log("noHdAdPlugin-play",a),d.context.dataset.autoplay=!0,d.context.msg.broadcast("play")),d.context.dataset.autoplay&&d.context.dataset.requestNewGetinfoError&&!a.fhdswitch&&(c.v4log("requestNewGetinfoError",{}),d.context.msg.broadcast("play")),d.context.dataset.useChromeHls?(d.context.msg.off("videoPlaying.showUiSeekTip"),void d.context.msg.on("videoPlaying.showUiSeekTip",function(b){b&&"film"==b.playListType&&(delete d.context.dataset.hlsLoadStartTime,d.context.msg.off("videoPlaying.showUiSeekTip"),a.type="chromehls",d.context.msg.broadcast("showUiSeekTip",a))})):void(a.connectionPlayTime?e(function(){d.context.dataset.isSkippingTime=!0,d.seekTo({connectionPlayTime:a.connectionPlayTime})}):a.playStartTime&&e(function(){d.context.dataset.isSkippingTime=!0,d.seekTo({playStartTime:a.playStartTime})}))}),b=Txplayer.$.extend({},{vid:a.vid,charge:a.charge,defn:a.defn,fhdswitch:a.fhdswitch,onlyGetinfo:a.onlyGetinfo}),d.requestVideoUrlsByVid(b)}}},301:function(a,b,c){var d=Txplayer.util,e=Txplayer.$,f=c(302);a.exports={calcCurrentTime:function(){if("film"!=this.context.dataset.currentPlayListType)return 0;var a=this.context.dataset.playListIndex;this.context.dataset.filmVideoData&&a>=this.context.dataset.filmVideoData.length&&(a=0);var b=0;return Txplayer.$(this.context.dataset.filmVideoData).each(function(c,d){return!(c>=a)&&void(b+=d.duration)}),b+=parseInt(this.context.dataset.videoCurrentTime),parseInt(b)},updateCurrentTime:function(a,b){"number"===Txplayer.$.type(a)&&(this.context.dataset.currentTime=a)},getVideoSeekToInfo:function(a){var b=0,c=0;this.context.dataset.useHls||Txplayer.$(this.context.dataset.filmVideoData).each(function(d,e){
if(c=d,b+=e.duration,b>a)return b-=e.duration,!1});var d={index:c,prevDurtion:b};return d},showUIVipGuide:function(a){if(!this.context.dataset.hasCallShowUIVipGuide){this.context.dataset.hasCallShowUIVipGuide=!0;var b=this;setTimeout(function(){b.context.dataset.hasCallShowUIVipGuide=!1},3e3);var c={trial:{trialFinish:!0},switchDef:{switchDefinitionFail:!0}};this.pauseControl(),d.v4log("showUIVipGuide",c[a]),this.context.msg.broadcast("showUIVipGuide",c[a]);try{this.context.userMsg.broadcast("showUIVipGuide",c[a])}catch(e){}this.context.dataset.isBrowserFullscreen&&this.context.msg.broadcast("exitBrowserFullscreen"),this.context.dataset.isWindowFullscreen&&this.context.msg.broadcast("exitWindowFullscreen")}},showDujiaDialog:function(){var a=this;window.console.info("限时1分钟播放"),this.pauseControl();var b=f({context:this.context,target:e("#txplayer_"+this.context.dataset.playerId),content:'<txp class="txp_title">试看结束<span class="brspace">，</span>扫码<txp class="txp_text_em">下载速看APP</txp>看完整版</txp><img src="https://puui.qpic.cn/vupload/0/20180511_1526020568574.jpeg/0">',open:function(){a.context.dataset.disableHotKey=!0},close:function(){a.context.dataset.disableHotKey=!1}});b.open()},showUnOfficialLimitTips:function(){if(!this.context.config.official&&this.context.dataset.canPlayTime&&4!=this.context.dataset.getinfoJSON.exem){var a=Txplayer.util.getTxVideoPageURLByVid(this.context.dataset.vid,0),b=this.context.dataset.canPlayTime||0,c=Math.floor(b/60),d=b-60*c;this.context.msg.broadcast("showUnOfficialLimitTips",{min:c,sec:d,href:a})}},getSkipPreludeTime:function(){var a;return a=this.context.dataset.skipPrelude?parseInt(this.context.dataset.playStartTime):0},checkLanguageSwitch:function(a){var b=d.getSessionData(Txplayer.dataset.sessionStorageKey.languageSwitch),c="";try{if(b&&(b=b.split("|")||[],b.length>0)){var e=b[0],f=(b[1],b[2]),g=(new Date).getTime();g-f<3e4?e===a.vid&&(c="page_langSwitch"):d.delSessionData(Txplayer.dataset.sessionStorageKey.languageSwitch)}var h=this.context.dataset.adext||"";c?0===h.length?h=c:h.indexOf("page_langSwitch")===-1&&(h=h+"|"+c):h=h.replace(/\|?page\_langSwitch/g,""),this.context.dataset.adext=h}catch(i){}},getDuration:function(){var a=0;return this.context.dataset.getinfoJSON&&this.context.dataset.getinfoJSON.vl&&this.context.dataset.getinfoJSON.vl.vi&&this.context.dataset.getinfoJSON.vl.vi[0]&&this.context.dataset.getinfoJSON.vl.vi[0].td&&(a=parseFloat(this.context.dataset.getinfoJSON.vl.vi[0].td)),parseFloat(a)},getFileSize:function(){if(!this.context.dataset.filmVideoData||"array"!==Txplayer.$.type(this.context.dataset.filmVideoData))return 0;var a=0;return Txplayer.$(this.context.dataset.filmVideoData).each(function(b,c){a+=parseInt(c.bytesTotal)}),parseInt(a/1024)},getVideoSize:function(){return{width:this.context.dataset.videoWidth,height:this.context.dataset.videoHeight}},getVideoType:function(){return this.context.config.videoType},getPlayerType:function(){return this.context.config.playerType},getCurrentTime:function(){return this.context.dataset.currentTime||0},getVid:function(){return this.context.dataset.vid},getCid:function(){return this.context.dataset.cid},getColumnId:function(){return this.context.dataset.columnId},isSmallWindowMode:function(){return!!this.context.dataset.isSmallWindowMode},callPlayerExtendMethod:function(){var a=Array.prototype.slice.call(arguments,0),b=a.shift();if(b)switch(a.length){case 1:try{this.context.msg.broadcast(b,a[0])}catch(c){}break;case 2:try{this.context.msg.broadcast(b,a[0],a[1])}catch(c){}break;default:try{this.context.msg.broadcast(b,a)}catch(c){}}},setPlayerVipStatus:function(a){this.context.config.show1080p=!!a},getDefinitionList:function(){return[]},seekRight:function(a){var b=5;"number"===Txplayer.$.type(a)&&(b=a);var c=this.context.dataset.duration;if(c){var d=this.getCurrentTime();d+=b,d>c||this.seekTo(d)}},seekLeft:function(a){var b=5;"number"===Txplayer.$.type(a)&&(b=a);var c=this.context.dataset.duration;if(c){var d=this.getCurrentTime();d-=b,d<0||this.seekTo(d)}},togglePlayPause:function(){this.context.dataset.disableHotKey||(1===this.context.dataset.playState?(this.pauseControl(),this.context.msg.broadcast("userPausePlayer")):(this.playControl(),this.context.msg.broadcast("userPlayPlayer")))},getUserPayStatus:function(){var a=null;return this.context.dataset.getinfoJSON&&this.context.dataset.getinfoJSON.vl&&this.context.dataset.getinfoJSON.vl.vi&&this.context.dataset.getinfoJSON.vl.vi.length&&this.context.dataset.getinfoJSON.vl.vi[0]&&(a=this.context.dataset.getinfoJSON.vl.vi[0].ch),a},setSmallWindowMode:function(a){this.context.dataset.isSmallWindowMode=!!a,this.context.msg.broadcast("smallWindowModeChange",{isSmallWindow:!!a})},closeLoginGuide:function(a){if(Txplayer.util.v4log("closeLoginGuide",a),this.context.dataset.disableHotKey=!1,a)if(a.success)if(a.isVip){this.context.msg.broadcast("definitionChange","shd");try{this.context.userMsg.broadcast("definitionChange",{definition:"shd"})}catch(b){}}else this.context.msg.broadcast("definitionChange","shd"),this.context.msg.broadcast("set720pWhenLogin");else this.context.msg.broadcast("closeLoginGuide"),this.context.msg.broadcast("play")}}},302:function(a,b){function c(a){this.options=e(a),this.resizeListened=!1,this.initDom()}function d(a){return d.dialog?(d.dialog.initDom(a),d.dialog):(d.dialog=new c(a),d.dialog)}function e(a){"[object Object]"!=Object.prototype.toString.call(a)&&(a={});var b={};for(var c in h)h.hasOwnProperty(c)&&(b[c]=h[c]);for(var d in a)a.hasOwnProperty(d)&&(b[d]=a[d]);return b}var f=Txplayer.util,g=Txplayer.$,h={context:null,showClose:!0,content:"",open:function(){},close:function(){}},i='<txp class="txp_overlay_trial_watch " display-id="14"><txp class="txp_overlay_content"><txp class="txp_close ${closeClass}"><svg class="txp_icon txp_icon_close" version="1.1" viewBox="0 0 16 16" width="16" height="16"><use class="txp_svg_symbol txp_svg_close" xlink:href="#txp_svg_close"></use></svg></txp>${content}</txp></txp>';c.prototype.initDom=function(a){a&&(this.options=e(a));var b=this.options;this.$dom&&(this.delEvent(),this.$dom.remove()),this.$target=b.target;var c={content:b.content||"",closeClass:b.showClose?" ":"txp_none"};this.domStr=f.tpl(i,c),this.$dom=g(this.domStr),this.$dom.attr("id","txp-trial-dialog");var d=this.$target.width();d<700?(this.$dom.addClass("txp_overlay_trial_watch_s"),this.$dom.find(".brspace").html("<br>")):(this.$dom.removeClass("txp_overlay_trial_watch_s"),this.$dom.find(".brspace").text("，")),this.$target.append(this.$dom),this.$closeBtn=this.$dom.find(".txp_close"),this.initEvent()},c.prototype.initEvent=function(){var a=this;this.options.showClose&&this.$closeBtn.on("click",function(){a.close()}),this.options.context&&!this.resizeListened&&this.options.context.msg.on("resize",function(b){a.resizeListened=!0;var c=b.width;b.height;c<700?(a.$dom.addClass("txp_overlay_trial_watch_s"),a.$dom.find(".brspace").html("<br>")):(a.$dom.removeClass("txp_overlay_trial_watch_s"),a.$dom.find(".brspace").text("，"))})},c.prototype.delEvent=function(){this.options.showClose&&this.$closeBtn.off("click")},c.prototype.open=function(){this.$dom.removeClass("txp_none"),this.options.open()},c.prototype.close=function(){this.$dom.addClass("txp_none"),this.options.close()},c.prototype.destroy=function(){this.delEvent(),this.close();var a=this,b=setTimeout(function(){a.$dom.remove(),clearTimeout(b),b=null},1e3)},d.dialog=null,a.exports=d},303:function(a,b){var c=Txplayer.util;a.exports={retryUrlsWhenErr:function(a){c.v4log("retryUrlsWhenErr",a);var b=this,d=a.currentTime,e=a.index;if(b.context.dataset.urlIndex++,b.context.dataset.filmVideoData&&!(e>=b.context.dataset.filmVideoData.length))if(b.context.dataset.urlIndex>=b.context.dataset.filmVideoData[e].urlArray.length&&(b.context.dataset.urlIndex=0),b.context.dataset.useHls===!0)a.isFocus?b.context.msg.broadcast("setFocusVideoUrl",{url:b.context.dataset.filmVideoData[e].urlArray[b.context.dataset.urlIndex].url,currentTime:d,autoplay:!0}):b.context.msg.broadcast("setPreloadVideoUrl",{url:b.context.dataset.filmVideoData[e].urlArray[b.context.dataset.urlIndex].url,currentTime:d,autoplay:!1});else{if(c.browser.ie&&0==b.context.dataset.playState)return;a.isFocus&&b.requestVideoNextPartKey(b.context.dataset.filmVideoData[e],b.context.dataset.urlIndex).done(function(a){b.context.msg.broadcast("setFocusVideoUrl",{url:a,currentTime:d,autoplay:!0})})}}}}});
/*! Txplayer - v3.0.0 - 2018-11-23 12:20:35
 * Copyright (c) 2018
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(37)},37:function(a,b){function c(a){d=Txplayer.$,this.dataset={},this.context=a,this.init()}var d=Txplayer.$;Txplayer.util;c.prototype={init:function(){this.addEventListeners()},reset:function(){delete this.dataset.fileData,delete this.dataset.fileSize,delete this.dataset.prevBuffer,delete this.dataset.buffer},updateSpeed:function(a){this.dataset.hasOwnProperty("speeds")||(this.dataset.speeds=[]),"number"==typeof a&&(a>12288&&(a=12e3),this.context.dataset.videoDownloadSpeed=a,this.dataset.speeds.push(a));var b=10;this.dataset.speeds.length>b&&this.dataset.speeds.splice(0,this.dataset.speeds.length-b);var c={speed:this.dataset.speed,average:this.getAverSpeed()};this.context.msg.broadcast("downloadSpeedUpdate",c)},getAverSpeed:function(){if(!this.dataset.hasOwnProperty("speeds"))return 0;var a=0,b=0;return this.dataset.speeds&&this.dataset.speeds.length&&(d.each(this.dataset.speeds,function(b,c){a+=parseInt(c)}),b=parseInt(a/this.dataset.speeds.length)),b},calcMp4:function(){if(!this.context.dataset.disableCalcDownloadSpeed&&!this.dataset.isStop&&this.dataset.video&&this.dataset.fileData&&this.dataset.fileData.filesize){this.dataset.fileData.filesize=parseInt(this.dataset.fileData.filesize);var a=this;if(a.dataset.video.buffered.length&&(a.dataset.buffer=a.dataset.video.buffered.end(a.dataset.video.buffered.length-1),a.dataset.fileSize=a.dataset.fileData.filesize/1024,a.dataset.duration=a.dataset.fileData.data&&a.dataset.fileData.data.duration||a.dataset.video.duration,a.dataset.duration=parseFloat(a.dataset.duration),a.dataset.duration)){if(parseInt(a.dataset.buffer)>=parseInt(a.dataset.duration))return a.dataset.speed=0,void a.stop();if(a.dataset.hasOwnProperty("prevBuffer")||(a.dataset.prevBuffer=0),a.dataset.bufferUpdateTime=+new Date,a.dataset.bufferIncrease=a.dataset.buffer-a.dataset.prevBuffer,a.dataset.bufferIncrease<=0)return a.dataset.speed=0,void a.updateSpeed(a.dataset.speed);a.dataset.bufferUpdateCostTime=a.dataset.bufferUpdateTime-a.dataset.prevBufferUpdateTime,a.dataset.updateFileSize=a.dataset.fileSize*(a.dataset.bufferIncrease/a.dataset.duration),a.dataset.speed=a.dataset.updateFileSize/(a.dataset.bufferUpdateCostTime/1e3),a.dataset.speed=parseInt(a.dataset.speed),isNaN(a.dataset.speed)||a.updateSpeed(a.dataset.speed),a.dataset.prevBufferUpdateTime=a.dataset.bufferUpdateTime,a.dataset.prevBuffer=a.dataset.buffer}}},calcHLS:function(a){if(!this.context.dataset.disableCalcDownloadSpeed&&!this.dataset.isStop&&a&&a.loaded){if(this.dataset.prevBuffer||(this.dataset.prevBuffer=0),this.dataset.bufferIncrease=a.loaded-this.dataset.prevBuffer,this.dataset.bufferUpdateTime=+new Date,this.dataset.bufferIncrease<=0)return this.dataset.prevBufferUpdateTime=this.dataset.bufferUpdateTime,this.dataset.prevBuffer=a.loaded,void(this.context.dataset.videoDownloadSpeed=0);this.dataset.bufferUpdateCostTime=this.dataset.bufferUpdateTime-this.dataset.prevBufferUpdateTime,this.dataset.bufferUpdateCostTime<0||(this.dataset.speed=this.dataset.bufferIncrease/1024/(this.dataset.bufferUpdateCostTime/1e3),this.dataset.speed=parseInt(this.dataset.speed),isNaN(this.dataset.speed)||this.updateSpeed(this.dataset.speed),this.dataset.prevBufferUpdateTime=this.dataset.bufferUpdateTime,this.dataset.prevBuffer=a.loaded)}},getRealDownloadSpeedWhenNetFree:function(){var a={},b=this;setInterval(function(){var c=b.context.dataset.videoDownloadSpeed;a.hasOwnProperty(c)?"number"!=typeof a[c]?a[c]=1:(a[c]++,4===a[c]&&(b.context.dataset.videoDownloadSpeed=0,a={})):(a={},a[c]=1)},500)},addEventListeners:function(){var a=this;this.context.msg.on("adLoadProgress",function(b){b&&b.speed&&(a.context.dataset.videoDownloadSpeed=+b.speed)}),this.context.msg.on("videoPlay",function(b){b&&b.videoTag&&(0==b.videoTag.buffered.length&&(a.reset(),a.dataset.prevBufferUpdateTime=+new Date),a.dataset.video=b.videoTag,a.dataset.fileData=a.context.dataset.playList[a.context.dataset.playListIndex])}),this.context.msg.on("error.download-monitor",function(b){b&&b.type&&a.stop()}),"chromehls"===this.context.config.playerType&&this.context.msg.on("hlsProgress",function(b){a.dataset.isStop||a.calcHLS(b)}),this.context.msg.on("videoPlay.download-monitor",function(){"chromehls"!=a.context.config.playerType&&a.startTimer()}),a.getRealDownloadSpeedWhenNetFree()},startTimer:function(){if(!this.dataset.calcTimer){var a=this;this.dataset.calcTimer=setInterval(function(){a.calcMp4()},100)}},stop:function(){this.dataset.isStop=!0,this.dataset.startTimer&&clearInterval(this.dataset.startTimer)}},Txplayer.register("DownloadMonitor",c)}});
/*! Txplayer - v3.0.0 - 2018-11-23 12:20:35
 * Copyright (c) 2018
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(309)},212:function(a,b,c){function d(a){var b="qqlivechannel=channel1."+a;if(Txplayer.util.browser.ie){var c=new Date;c.setTime(c.getTime()+864e5),document.cookie=b+";path=/;expires="+c.toGMTString()}else{var d=Txplayer.$("<input>");Txplayer.$("body").append(d),d.css({position:"absolute",left:"-9999px"}),d.val(b),d.css({top:Txplayer.$(window).scrollTop()+"px"}),d.get(0).focus(),d.get(0).setSelectionRange(0,b.length),document.queryCommandSupported&&document.queryCommandSupported("copy")&&document.execCommand("copy",!0),d.remove()}}var e=c(213);a.exports=function(a){if(a.support&&a.sso){try{d(a.atag)}catch(b){}e(function(b){b&&b.exist().done(function(){b.open(a.sso),a.success&&a.success()}).fail(function(){a.error&&a.error()})})}}},213:function(a,b){var c=[],d=!1,e=0;a.exports=function(a){if(e)return void a(e);if(c.push(a),!d){if(d=!0,"qq.com"!=document.domain)throw new Error("document.domain is not qq.com");var b=document.createElement("iframe");b.src="javascript:'<script>window.onload=function(){document.write(\\'<script>document.domain=\\\"qq.com\\\";<\\\\/script>\\');document.close();};</script>'",b.style.cssText="display:none;",document.body.appendChild(b),b.getClient=function(a){e=a;for(var b=c.shift();b;)b&&b(a),b=c.shift()},b.src="//v.qq.com/iframe/client.html"}}},309:function(a,b,c){function d(a){e=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=Txplayer.$,f=Txplayer.util,g=(Txplayer.apiList,c(310)),h=c(212),i=c(213);d.prototype={init:function(){this.write(),this.addEventListerner(),this.exportsModuleApis()},write:function(){var a={error:"txp-ui-error",errorMsg:"txp-ui-error-msg",errorRefresh:"txp-ui-error-refresh",changePlayer:"txp-ui-error-changeplayer",openNewPage:"txp-ui-error-newpage",errorCode:"txp-ui-error-code",errorTip:"txp-ui-error-tip",clientTitle:"txp-ui-error-client-title",clientSpan:"txp-ui-error-client-span",clientBtn:"txp-ui-error-client-btn",whenCoolOpen:"txp-ui-error-when-coolopen"},b=e.tmpl(g,a);this.context.dataset.$playermod.append(b),this.dataset.$error=this.context.dataset.$playermod.find('[data-role="'+a.error+'"]'),this.dataset.$errorMsg=this.context.dataset.$playermod.find('[data-role="'+a.errorMsg+'"]'),this.dataset.$errorRefresh=this.context.dataset.$playermod.find('[data-role="'+a.errorRefresh+'"]'),this.dataset.$changePlayer=this.context.dataset.$playermod.find('[data-role="'+a.changePlayer+'"]'),this.dataset.$openNewPage=this.context.dataset.$playermod.find('[data-role="'+a.openNewPage+'"]'),this.dataset.$errorCode=this.context.dataset.$playermod.find('[data-role="'+a.errorCode+'"]'),this.dataset.$errorTip=this.context.dataset.$playermod.find('[data-role="'+a.errorTip+'"]'),this.dataset.$clientTitle=this.context.dataset.$playermod.find('[data-role="'+a.clientTitle+'"]'),this.dataset.$clientSpan=this.context.dataset.$playermod.find('[data-role="'+a.clientSpan+'"]'),this.dataset.$clientBtn=this.context.dataset.$playermod.find('[data-role="'+a.clientBtn+'"]'),this.dataset.$coolOpenSpan=this.context.dataset.$playermod.find('[data-role="'+a.whenCoolOpen+'"]'),this.dataset.errorTipSrc={offline:{src:"//i.gtimg.cn/qqlive/images/20170712/error_tip2.png",srcset:"//i.gtimg.cn/qqlive/images/20170712/error_tip2@2x.png 2x"},ufo:{src:"//i.gtimg.cn/qqlive/images/20170712/error_tip1.png",srcset:"//i.gtimg.cn/qqlive/images/20170712/error_tip1@2x.png 2x"}},this.dataset.isCoolOpen="coolOpen"===this.context.config.playerType},remove:function(){this.dataset.$error.remove()},hide:function(){this.dataset.$error.addClass(Txplayer.dataset.hideClass)},getData:function(){var a=f.getData(Txplayer.dataset.localStorageKey.userSetting);try{a=JSON.parse(a)}catch(b){a={}}return a},setData:function(a,b){var c=this.getData(Txplayer.dataset.localStorageKey.userSetting);c[a]=b,f.setData(Txplayer.dataset.localStorageKey.userSetting,JSON.stringify(c))},report:function(a,b){this.context.msg.broadcast("reportUsrAction",{usr_action:a,usr_action_detail:b||""})},showErrorUiTips:function(a){var b=this;f.v4log("showErrorUiTips",a),a&&"object"===e.type(a.msg)&&(a.msg=a.msg.defaultMsg);var c=a.code+"",d=this.context.dataset.flowid;if(c&&c.indexOf("_")>-1&&(c=c.split("_")[0]),a&&e.inArray(c,["83"])>-1&&"function"===e.type(this.context.config.showOpenVIPGuide))return this.context.config.showOpenVIPGuide(),void(this.context.dataset.isBrowserFullscreen&&this.context.msg.broadcast("exitBrowserFullscreen"));if(this.dataset.$error.removeClass(Txplayer.dataset.hideClass),this.context.dataset.$playermod.width()<560?this.dataset.$errorCode.text("[ 错误码:"+(a.errCode||"")+" ]"):this.dataset.$errorCode.text("[ 错误码:"+(a.errCode||"")+", "+d+" ]"),e.inArray(a.code+"",["1","2","3","4","5","444","445","10001","30","40","41","42","50","68"])>-1){var g=a.msg;4!=a.code||f.isSupportMP4()||(g="当前浏览器不支持H5播放器"),this.dataset.$errorMsg.html(g);var h;h=e.inArray(a.code+"",["444","445"])>-1?this.dataset.errorTipSrc.offline:this.dataset.errorTipSrc.ufo;var j=!1;try{j=parent.window._TxpIframeInQzoneIfrme}catch(k){}f.inNewIframe()&&j?this.dataset.$changePlayer.addClass(Txplayer.dataset.hideClass):this.dataset.$changePlayer.removeClass(Txplayer.dataset.hideClass)}else this.dataset.$changePlayer.addClass(Txplayer.dataset.hideClass),this.dataset.$errorRefresh.addClass(Txplayer.dataset.hideClass),this.dataset.$errorMsg.html(a.msg||Txplayer.v4errcode.defaultMsg),h=this.dataset.errorTipSrc.ufo;var l=this.context.dataset.$playermod||Txplayer.$&&Txplayer.$("#"+this.context.config.containerId),m=l.find(".txp_player");(this.dataset.isCoolOpen||this.context.config.useMiniSkin||m.hasClass("txp_player_mini")||!this.context.config.showHTML5Switch)&&(this.dataset.$changePlayer.addClass(Txplayer.dataset.hideClass),this.dataset.$coolOpenSpan.removeClass(Txplayer.dataset.hideClass));var n=["ke.qq.com","fudao.qq.com"];(f.os.mac||n.indexOf(location.host)>-1)&&this.dataset.$clientTitle.addClass(Txplayer.dataset.hideClass),this.dataset.$errorTip.attr({src:h.src,srcset:h.srcset});var o=this.dataset.errorcodeStr=a.code+"."+a.exem;"80.14"===o&&(f.os.mac?(this.dataset.$clientTitle.removeClass(Txplayer.dataset.hideClass),this.dataset.$clientSpan.text("请使用Mac客户端观看 ")):this.dataset.$clientSpan.text("请使用PC客户端观看 ")),this.dataset.$clientTitle.hasClass(Txplayer.dataset.hideClass)||i(function(a){a&&a.exist().done(function(){var a="立即打开";"80.14"===o&&(a="继续观看"),b.dataset.$clientBtn.text(a)}).fail(function(){var a="立即下载";b.dataset.$clientBtn.text(a)})})},addEventListerner:function(){var a=this;this.dataset.eventsList={},this.dataset.eventsList[f.getUniqueMsgKey("videoPlaying")]=function(){a.hide()},this.dataset.eventsList[f.getUniqueMsgKey("vidChange")]=function(){a.hide()},e.each(this.dataset.eventsList,function(b,c){a.context.msg.on(b,c)}),this.dataset.$errorRefresh.off("click").on("click",function(){window.location.reload()}),this.dataset.$changePlayer.off("click").on("click",function(){a.setData("isUseFlash",1),window.location.reload()}),this.dataset.$openNewPage.off("click").on("click",function(){var b=a.context.config.otherVideoLink;b&&window.open(b)}),this.dataset.$clientBtn.off("click").on("click",function(){a.report("playererror-clientbtn-clicked");var b=a.context.dataset.vid||"",c=a.context.dataset.cid||"",d=Math.max(a.context.dataset.currentTime-5,0),e="web.playererror";h({support:!0,atag:"playererror",sso:"qqlive://sso/vbarid="+c+"&videoid="+b+"&start="+d+"&atag="+e,success:function(){a.report("playererror-clientbtn-play")},error:function(){"80.14"===a.dataset.errorcodeStr&&f.os.mac?window.open("https://v.qq.com/download.html#mac","_blank"):location.href="//node.video.qq.com/x/api/download_pc",a.report("playererror-clientbtn-download")}})}),this.context.msg.on("error",function(b){b&&e.inArray(b.type,["film","cgi","init"])===-1||(a.context.dataset.disableHotKey=!0,b&&94==b.code||a.showErrorUiTips(b))})},exportsModuleApis:function(){var a=this;this.dataset.privateApis={},this.dataset.privateApis.showErrorUiTips=this.showErrorUiTips.bind(this),e.each(this.dataset.privateApis,function(b,c){a.context.msg.on(b,c)})}},Txplayer.register("v4UiError",d)},310:function(a,b){a.exports='<txpdiv  data-role="<%=error%>" class="txp_video_error txp_none">\n  <img data-role="<%=errorTip%>" class="txp_error_pic" alt=""/>\n  <txpdiv class="txp_error_title">\n    <span data-role="<%=errorMsg%>">网络链接似乎出现问题，</span>\n    <span data-role="<%=errorRefresh%>">\n      你可以 <button class="txp_btn">刷新</button>\n      <span data-role="<%=changePlayer%>"> 或 <button class="txp_btn">使用兼容模式播放</button></span>\n      <span class="txp_none" data-role="<%=whenCoolOpen%>">试试</span>\n    </span>\n  </txpdiv >\n  <txpdiv class="txp_error_title2" data-role="<%=clientTitle%>">\n    <span data-role="<%=clientSpan%>">使用客户端播放更稳定 </span><a class="txp_link_btn" data-role="<%=clientBtn%>">立即下载</a>\n  </txpdiv>\n\n  <!-- <txpdiv class="txp_error_swtich">\n    <a class="txp_error_btn" href="javascript:;" data-role="<%=changePlayer%>" style="width: auto;">\n      使用兼容模式播放\n    </a>\n    <a class="txp_error_btn_text" data-role="<%=errorRefresh%>" href="javascript:;">\n      <i class="icon icon_refresh">\n        <svg class="txp_icon txp_icon_refresh" viewBox="0 0 20 20" width="20" height="20">\n          <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="<%=svgPrefix%>#svg_icon_refresh"></use>\n        </svg>\n      </i>刷新\n    </a>\n  </txpdiv> -->\n  <txpdiv class="txp_error_code" ><span data-role="<%=errorCode%>">[ 错误码: xx, xxx ]</span> <a href="//support.qq.com/products/2208" target="_blank">我要反馈</a></txpdiv >\n</txpdiv >\n'}});
/*! Txplayer - v3.0.0 - 2018-11-23 12:20:35
 * Copyright (c) 2018
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(247)},78:function(a,b){var c={unstarted:-1,ended:0,playing:1,paused:2,buffering:3,cued:4,stop:5},d={msd:"流畅180P",sd:"标清270P",hd:"高清480P",shd:"超清720P",fhd:"蓝光1080P"};a.exports={playerstate:c,definitionMap:d}},247:function(a,b,c){function d(a){f=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=c(248),f=Txplayer.$,g=Txplayer.util,h=(Txplayer.apiList,c(78).definitionMap);d.prototype={init:function(){this.write(),this.addEventListener(),this.exportsModuleApis()},write:function(){var a={hide:Txplayer.dataset.hideClass,tips:"txp-ui-tips",text:"txp-ui-tips-text",close:"txp-ui-tips-close"},b=f.tmpl(e,a);this.context.dataset.$loading?this.context.dataset.$loading.before(b):this.context.dataset.$playermod.append(b),this.dataset.$tips=this.context.dataset.$playermod.find('[data-role="'+a.tips+'"]'),this.dataset.$text=this.context.dataset.$playermod.find('[data-role="'+a.text+'"]'),this.dataset.$close=this.context.dataset.$playermod.find('[data-role="'+a.close+'"]')},remove:function(){this.dataset.$tips.remove()},stopTips:function(){this.context.msg.broadcast("hideUiTips"),this.dataset.trialMovie_TIMER&&(clearInterval(this.dataset.trialMovie_TIMER),this.dataset.trialMovie_TIMER=null)},dealVipTip:function(a){var b,c=this,d=5,e=0,f=function(){if(e>d)return void clearInterval(c.dataset.trialMovie_TIMER);e++;try{b=c.context.config.flashCallFn({type:c.context.dataset.trailerMode?"trailerMode":"getPayTip"})}catch(a){g.showInfo("[updateTrialData.getTips.error]",a)}if(b){c.dataset.getTip_TIMER&&(clearTimeout(c.dataset.getTip_TIMER),c.dataset.getTip_TIMER=null);var h=b.match(/\[.*?\]/);if(h){h=h[0];var i='<a href="javascript:;" data-action="openVIP" data-role="txp-ui-tips-openVIP">'+h.slice(1,-1)+"</a>";b=b.replace(h,i)}}else c.dataset.getTip_TIMER&&clearTimeout(c.dataset.getTip_TIMER),c.dataset.getTip_TIMER=setTimeout(function(){b=f()},1e3)},h=function(){c.context.dataset.isUiTipsShowing||c.context.dataset.isPlayingAd||(b||f(),b&&c.context.msg.broadcast("showUiTips",{text:b,time:300}))};h(),this.dataset.trialMovie_TIMER&&clearInterval(c.dataset.trialMovie_TIMER),this.dataset.trialMovie_TIMER=setInterval(function(){h()},5e3)},dealDujiaTip:function(){var a=this;this.context.msg.once(g.getUniqueMsgKey("videoPlaying"),function(){a.hasShownDujia||(a.hasShownDujia=!0,a.context.msg.broadcast("showUiTips",{text:"可试看1分钟速看独家内容",time:5,hideClose:!0}))}),this.context.msg.on(g.getUniqueMsgKey("vidChange"),function(){a.hasShownDujia=!1}),this.context.msg.on(g.getUniqueMsgKey("beforeVideoRePlay"),function(){a.hasShownDujia=!1})},dealSeekTip:function(a){var b,c=this;a&&a.showTips?"undefined"==typeof Txplayer.plugins["txp-history-plugin"]&&(b="<a>"+g.formatPlayTime(a.seekTime)+"</a>",c.context.msg.broadcast("showUiTips",{text:"您上次观看至 "+b+" 处，正在为您续播",time:3,hideClose:!0})):a.connectionPlayTime?"undefined"==typeof Txplayer.plugins["txp-history-plugin"]&&(b="<a>"+g.formatPlayTime(a.connectionPlayTime)+"</a>",c.context.msg.broadcast("showUiTips",{text:"您上次观看至 "+b+" 处，正在为您续播",time:3,hideClose:!0})):a.playStartTime?c.dataset.hasShowTips||(b="<a>"+g.formatPlayTime(a.playStartTime)+"</a>",c.context.msg.broadcast("showUiTips",{text:"腾讯视频已为您跳过片头",time:3,hideClose:!0})):a.historyTime?"undefined"==typeof Txplayer.plugins["txp-history-plugin"]&&c.context.msg.broadcast("showUiTips",{text:"您上次观看至 "+a.historyTime+" 处，正在为您续播",time:5}):a.uiText&&(c.context.msg.broadcast("showUiTips",{text:a.uiText,time:a.time,hideClose:a.hideClose}),c.dataset.hasShowTips=!0)},dealDenitionTip:function(){var a=this;this.dataset.eventsList[g.getUniqueMsgKey("setDefinitionStart")]=function(b,c){if(c)return void a.context.msg.broadcast("showUiTips",{text:"正在缓冲...",time:3,hideClose:!0});var d=h[b];d&&(d="<a>["+d+"]</a>",a.context.msg.broadcast("showUiTips",{text:"正在为您切换清晰度"+d,time:10}))},this.dataset.eventsList[g.getUniqueMsgKey("setDefinitionDone")]=function(b){a.context.msg.broadcast("hideUiTips")},this.dataset.eventsList[g.getUniqueMsgKey("setDefinitionFail")]=function(b){a.context.msg.broadcast("showUiTips",{text:"sorry, 切换清晰度失败, 请稍后重试",time:5})}},dealPlaybackRateTip:function(a){if(!this.context.dataset.isPlayingAd){if(a>=4)return void this.context.msg.broadcast("showUiTips",{text:"播放速度已经达到最高值",time:3,hideClose:!0});if(a<=.4)return void this.context.msg.broadcast("showUiTips",{text:"播放速度已经达到最低值",time:3,hideClose:!0});a=1.25==a?a:a.toFixed(1),this.context.msg.broadcast("showUiTips",{text:"正在<a>"+a+"</a>倍速度播放",time:3,hideClose:!0})}},dealVolumeTip:function(a){a.mute===!0?this.context.msg.broadcast("showUiTips",{text:"视频静音",time:2,hideClose:!0}):a.mute===!1?this.context.msg.broadcast("showUiTips",{text:"取消视频静音",time:2,hideClose:!0}):a.volume>=0&&this.context.msg.broadcast("showUiTips",{text:"当前音量: <a>"+a.volume+"</a>",time:3,hideClose:!0})},dealConsoleReportTip:function(a){this.context.msg.broadcast("showUiTips",{text:"您的反馈我们已收到，感谢您的支持~",time:5,hideClose:!0})},showVIPShareTips:function(){var a="//vip.video.qq.com/fcgi-bin/comm_cgi?callback=?",b=f.jsonp||f.ajax,c=this,d=function(a){var b="该账号多地登录存在安全隐患，已暂停会员服务，请修改密码并等待一段时间后重试。";a=a||{},a.tips=a.tips||b;var d=0;c.context.dataset.openAccountData=[],a.buttonlist&&"array"===f.type(a.buttonlist)&&f.each(a.buttonlist,function(b,e){e&&(e.title&&e.url&&(a.tips+='&nbsp;<a href="javascript:;" data-action="shareVIP" data-click="'+d+'">'+e.title+"</a>&nbsp;",c.context.dataset.openAccountData.push(e)),d++)}),c.context.msg.broadcast("showUiTips",{text:a.tips,time:3e4})};b({url:a,data:{name:"attack_account",cmd:1},timeout:6e3,callback:Txplayer.util.getJsonpCallbackName("getshareviptips")}).done(function(a){d(a)}).fail(function(a,b){d()})},showUnOfficialLimitTips:function(a){if(!this.context.dataset.isUiTipsShowing){var b='可试看${min}分钟，去腾讯视频观看完整版 <a target="_blank;" href="${href}">立即前往</a>';a.sec>0&&(b='可试看${min}分钟${sec}秒，去腾讯视频观看完整版 <a target="_blank;" href="${href}">立即前往</a>'),a.min<=0&&a.sec>0&&(b='可试看${sec}秒，去腾讯视频观看完整版 <a target="_blank;" href="${href}">立即前往</a>'),this.context.msg.broadcast("showUiTips",{text:g.tpl(b,a),time:9999,hideClose:!0})}},addEventListener:function(){var a=this;this.dataset.$close.on("click",function(){a.context.msg.broadcast("hideUiTips",{userAction:!0,tips:a.dataset.$text.html()})}),this.dataset.eventsList={},this.dealDenitionTip(),this.dataset.eventsList[g.getUniqueMsgKey("vidChange")]=function(){a.stopTips(),a.dataset.hasShowTips=!1},this.dataset.eventsList[g.getUniqueMsgKey("error")]=function(b){a.stopTips(),b&&94==b.code&&a.showVIPShareTips()},f.each(this.dataset.eventsList,function(b,c){a.context.msg.on(b,c)}),a.context.msg.on("showUIVipGuide",function(b){a.stopTips()}),a.context.msg.on("showDujiaDialog",function(){a.stopTips()})},exportsModuleApis:function(){var a=this;this.dataset.moduleApis={},this.dataset.moduleApis.showUiTips=function(b){b&&b.text&&(a.context.dataset.isSmallWindowMode||(b.time=b.time||4,"undefined"===f.type(b.hideClose)&&(b.hideClose=!1),b.hideClose?a.dataset.$close.addClass(Txplayer.dataset.hideClass):a.dataset.$close.removeClass(Txplayer.dataset.hideClass),a.dataset.$tips.removeClass(Txplayer.dataset.hideClass),a.dataset.$text.html(b.text),a.context.dataset.isUiTipsShowing=!a.dataset.$tips.hasClass(Txplayer.dataset.hideClass),a.dataset.hide_TIMER&&clearTimeout(a.dataset.hide_TIMER),a.dataset.hide_TIMER=setTimeout(function(){a.context.msg.broadcast("hideUiTips")},1e3*b.time)))},this.dataset.moduleApis.hideUiTips=function(b){a.dataset.$tips.addClass(Txplayer.dataset.hideClass),a.context.dataset.isUiTipsShowing=!a.dataset.$tips.hasClass(Txplayer.dataset.hideClass)},this.dataset.moduleApis.showUIVipTip=function(b){a.dealVipTip(b)},this.dataset.moduleApis.showUIDujiaTip=function(b){a.dealDujiaTip(b)},this.dataset.moduleApis.showUiSeekTip=function(b){a.dealSeekTip(b)},this.dataset.moduleApis.showUiRateTip=function(b){a.dealPlaybackRateTip(b)},this.dataset.moduleApis.showUiPlaybackRateTip=function(b){a.dealPlaybackRateTip(b)},this.dataset.moduleApis.showUiVolumeTip=function(b){a.dealVolumeTip(b)},this.dataset.moduleApis.showConsoleReportTips=function(b){a.dealConsoleReportTip(b)},this.dataset.moduleApis.showUnOfficialLimitTips=function(b){a.showUnOfficialLimitTips(b)},f.each(this.dataset.moduleApis,function(b,c){a.context.msg.on(b,c)})}},Txplayer.register("UiTips",d)},248:function(a,b){a.exports='<txpdiv data-role="<%=tips%>" class="txp_alert_info <%=hide%>">\n  <txpdiv class="txp_alert_content">\n    <txpdiv data-role="<%=text%>" class="txp_alert_text"></txpdiv>\n    <button data-role="<%=close%>" class="txp_btn txp_btn_close" title="关闭"></button>\n  </txpdiv>\n</txpdiv>'}});
/*! Txplayer - v3.0.0 - 2018-11-23 12:20:35
 * Copyright (c) 2018
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(173)},173:function(a,b,c){function d(a){f=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=c(174),f=Txplayer.$,g=Txplayer.util;d.prototype={init:function(){this.dataset.controlHideClass="txp_autohide",this.context.dataset.isControlShow=!0,this.write(),this.addEventListener(),this.loadSubPlugins()},write:function(){var a={controlWrap:"txp-control-wrap",buttonsLeftRole:"txp-control-left",buttonsRightRole:"txp-control-right",buttonsCenterRole:"txp-control-center",hide:Txplayer.dataset.hideClass,autoHide:this.dataset.controlHideClass},b=f.tmpl(e,a);this.context.dataset.$playermod.append(b),this.dataset.$playermod=this.context.dataset.$playermod,this.dataset.$controlWrap=this.context.dataset.$playermod.find('[data-role="'+a.controlWrap+'"]'),this.dataset.$buttonsleftmod=this.context.dataset.$playermod.find('[data-role="'+a.buttonsLeftRole+'"]'),this.dataset.$buttonsrightmod=this.context.dataset.$playermod.find('[data-role="'+a.buttonsRightRole+'"]'),this.dataset.$buttonscentermod=this.context.dataset.$playermod.find('[data-role="'+a.buttonsCenterRole+'"]'),(this.context.config.autoplay||g.mobile)&&(this.context.dataset.$playermod.addClass(this.dataset.controlHideClass),this.uiControlVisibilityChange(!1),this.context.dataset.isControlShow=!1)},remove:function(){this.dataset.$controlWrap.remove()},loadSubPlugins:function(){var a=[];if(this.context.pluginConfig&&"array"===f.type(this.context.pluginConfig.subPlugins)&&(a=this.context.pluginConfig.subPlugins.slice(0)),!g.mobile&&"v4"==this.context.config.version)for(var b=0;b<a.length;b++)if(["UiControlPlay","UiVolume","UiDefinition"].indexOf(a[b])!=-1){if(g.inArray(this.context.config.removePluginsList,a[b])!=-1)continue;a[b]="v4"+a[b]}var c={msg:this.context.msg,adApi:this.context.adApi,userMsg:this.context.userMsg,userApi:this.context.userApi,privateApi:this.context.privateApi,dataset:this.context.dataset,config:this.context.config,$mod:{$playermod:this.dataset.$playermod,$progressmod:this.dataset.$buttonscentermod,$buttonsleftmod:this.dataset.$buttonsleftmod,$buttonsrightmod:this.dataset.$buttonsrightmod}};g.loadPlugins.call(this,a,c,this.context.config.settings)},handlerUiControlShowHide:function(){function a(a){if(a=a||{},a&&!a.force){if(1!==e.context.dataset.playState&&!e.context.dataset.isPlayingAd)return;if(e.context.dataset.isSmallWindowMode)return;if(e.context.dataset.isFocusVideoBufferIng)return;if(e.context.dataset.isVideoSeeking)return;if(e.dataset.isMouseHoverControl)return;if(e.context.dataset.isRightClickMenu)return;if(e.context.dataset.disableHideControl)return}e.context.dataset.$playermod.addClass(e.dataset.controlHideClass),e.uiControlVisibilityChange(!1),e.context.msg.broadcast("hideUiControl"),e.context.dataset.isControlShow=!1,e.dataset.hideControl_TIMER&&(clearTimeout(e.dataset.hideControl_TIMER),e.dataset.hideControl_TIMER=null)}function b(){return!e.context.dataset.$playermod.hasClass(e.dataset.controlHideClass)}function c(a){if(a=a||{},a&&!a.force){if(e.context.dataset.isSmallWindowMode)return;if(e.dataset.errorcode)return}e.context.msg.broadcast("beforeUiControlShow"),e.context.dataset.$playermod.removeClass(e.dataset.controlHideClass),e.uiControlVisibilityChange(!0),e.context.dataset.isControlShow=!0,d()}function d(){e.dataset.hideControl_TIMER&&(clearTimeout(e.dataset.hideControl_TIMER),e.dataset.hideControl_TIMER=null),e.dataset.hideControl_TIMER=setTimeout(function(){a()},3e3)}var e=this;this.dataset.hideControl_TIMER=null,g.mobile?this.context.msg.on("ready",function(){e.context.dataset.$shadow.on("touchend",function(){b()?a():c()})}):(this.dataset.$playermod.on("click mouseenter",function(a){c(a)}),this.dataset.$playermod.on("mouseleave",function(b){a(b)}),this.dataset.$playermod.on("mousemove",function(a){e.dataset.screenX==a.screenX&&e.dataset.screenY==a.screenY||(e.dataset.screenX=a.screenX,e.dataset.screenY=a.screenY,c(a))})),this.dataset.eventsList[g.getUniqueMsgKey("videoPause")]=function(a){a&&a.end||e.context.dataset.isPlayingAd||c()},this.dataset.eventsList[g.getUniqueMsgKey("videoEnd")]=function(a){a&&a.isAllEnd&&c()},this.dataset.eventsList[g.getUniqueMsgKey("error")]=function(b){b&&94==b.code||(a({force:!0}),e.dataset.errorcode=b.code)},this.dataset.eventsList[g.getUniqueMsgKey("videoPlaying")]=function(){delete e.dataset.errorcode,d()},this.dataset.eventsList[g.getUniqueMsgKey("smallWindowModeChange")]=function(b){b&&b.isSmallWindow&&a({force:!0})},this.dataset.eventsList[g.getUniqueMsgKey("hideUicontrol")]=function(b){a()},f.each(this.dataset.eventsList,function(a,b){e.context.msg.on(a,b)}),this.show=c,this.hide=a},uiControlVisibilityChange:function(a){try{a!==this.dataset.uiControlVisibilityChangeState&&(this.dataset.uiControlVisibilityChangeState=a,this.context.msg.broadcast("uiControlVisibilityChange",a),this.context.userMsg.broadcast("uiControlVisibilityChange",a))}catch(b){}},addEventListener:function(){var a=this;this.dataset.eventsList={},this.handlerUiControlShowHide(),this.dataset.eventsList[g.getUniqueMsgKey("userStopVideo")]=function(b){a.show()},this.dataset.eventsList[g.getUniqueMsgKey("showUicontrol")]=function(b){a.context.dataset.isSmallWindowMode||(a.context.dataset.$playermod.removeClass(a.dataset.controlHideClass),a.uiControlVisibilityChange(!0),a.context.dataset.isControlShow=!0)},this.dataset.eventsList[g.getUniqueMsgKey("videoEnd")]=function(b){if(b&&b.isAllEnd){if(a.context.dataset.isSmallWindowMode)return;a.context.dataset.$playermod.removeClass(a.dataset.controlHideClass),a.uiControlVisibilityChange(!0),a.context.dataset.isControlShow=!0}},f.each(this.dataset.eventsList,function(b,c){a.context.msg.on(b,c)}),this.dataset.$controlWrap.on("mouseenter",function(){a.dataset.isMouseHoverControl=!0}).on("mouseleave",function(){a.dataset.isMouseHoverControl=!1}),this.dataset.eventsList[g.getUniqueMsgKey("windowFullscreenChange")]=function(b){a.dataset.isMouseHoverControl=!1,setTimeout(function(){a.dataset.isMouseHoverControl=!1,a.hide({force:!0})},1e3)},this.dataset.eventsList[g.getUniqueMsgKey("browserFullscreenChange")]=function(b){a.dataset.isMouseHoverControl=!1,setTimeout(function(){a.dataset.isMouseHoverControl=!1,a.hide({force:!0})},200)}}},Txplayer.register("UiControl",d)},174:function(a,b){a.exports='<txpdiv data-role="<%=controlWrap%>" class="txp_bottom">\n  <txpdiv class="txp_controls">\n    <txpdiv class="txp_left_controls" data-role="<%=buttonsLeftRole%>"></txpdiv>\n    <txpdiv class="txp_progress_bar_container" data-role="<%=buttonsCenterRole%>"></txpdiv>\n    <txpdiv class="txp_right_controls" data-role="<%=buttonsRightRole%>"></txpdiv>\n  </txpdiv>\n</txpdiv>'}});
/*! Txplayer - v3.0.0 - 2018-11-23 12:20:35
 * Copyright (c) 2018
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(232)},232:function(a,b,c){function d(a){e=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=Txplayer.$,f=Txplayer.util,g=(Txplayer.apiList,c(233));d.prototype={init:function(){this.write(),this.addEventListerner()},write:function(){var a={loadedProgress:"txp-control-load-progress",playedProgress:"txp-control-play-progress",playStartTimePoint:"txp-control-play-start-time-point",playEndTimePoint:"txp-control-play-end-time-point",playedPoint:"txp-control-play-point",progressList:"txp-control-progress-list",progressIndicator:"txp-control-progress-indicator",tabindex:Txplayer.dataset.tabindex++,hideClass:Txplayer.dataset.hideClass};this.dataset.renderData=a;var b=e.tmpl(g,a);this.context.$mod.$progressmod.append(b),this.dataset.$loadedProgress=this.context.$mod.$progressmod.find('[data-role="'+a.loadedProgress+'"]'),this.dataset.$playprogress=this.context.$mod.$progressmod.find('[data-role="'+a.playedProgress+'"]'),this.dataset.$playStartTimePoint=this.context.$mod.$progressmod.find('[data-role="'+a.playStartTimePoint+'"]'),this.dataset.$playEndTimePoint=this.context.$mod.$progressmod.find('[data-role="'+a.playEndTimePoint+'"]'),this.dataset.$playpoint=this.context.$mod.$progressmod.find('[data-role="'+a.playedPoint+'"]'),this.dataset.$progressIndicator=this.context.$mod.$progressmod.find('[data-role="'+a.progressIndicator+'"]'),this.dataset.$progressList=this.context.$mod.$progressmod.find('[data-role="'+a.progressList+'"]')},remove:function(){this.dataset.$loadedProgress.remove(),this.dataset.$playprogress.remove(),this.dataset.$playpoint.remove(),this.dataset.$playStartTimePoint.remove(),this.dataset.$playEndTimePoint.remove(),this.dataset.$progressIndicator.remove(),this.dataset.$progressList.remove()},isInProgressArea:function(a){var b=this;if(1!=a.which)return!1;var c=e(a.target),d=c.data("role");return f.inArray([b.dataset.renderData.progressList,b.dataset.renderData.progressIndicator,b.dataset.renderData.playedPoint,b.dataset.renderData.playedProgress,b.dataset.renderData.loadedProgress,"txp-control-progress","txp-control-center"],d)>-1||c.hasClass("txp_interact_dot")||c.hasClass("txp_progress_role")},progressOnMouseMove:function(){var a,b,c,d=!1,f=this,g=-1,h=!1,i=function(b){var d=f.dataset.$progressList.parent(),e=d&&d[0]&&d[0].offsetLeft||0;g=b.pageX-f.context.$mod.$playermod.offset().left-e,g!==-1&&(g>a?g=a:g<0&&(g=0),c=parseInt(g/a*1e4)/100)},j=function(b){var c=parseInt(g/a*1e4)/100;0===g?0:parseInt(g/a*1e4)/100;f.updateProgressWidth(c+"%"),"mousedown"==b&&f.context.msg.broadcast("userSeekStart",{time:parseInt(f.context.dataset.duration*c/100)}),"mouseup"==b&&f.context.msg.broadcast("userSeekEnd",{time:parseInt(f.context.dataset.duration*c/100)})};this.context.$mod.$progressmod.on("mouseenter",function(){a=f.dataset.$progressList.width(),b=f.dataset.$progressIndicator.width();var c=f.dataset.$playStartTimePoint,d=f.dataset.$playEndTimePoint;f.context.dataset.skipPrelude?(f.context.dataset.playStartTime&&c.show(),f.context.dataset.playEndTime&&d.show()):(c.hide(),d.hide())}).on("mouseleave",function(){f.dataset.$playStartTimePoint.hide(),f.dataset.$playEndTimePoint.hide()});var k=f.context.dataset.$playermod&&f.context.dataset.$playermod.attr("id"),l="";e("body").on("mousedown",function(a){f.context.dataset.isPlayingAd||f.isVideoCanNotPlay()||f.context.dataset.isImgAdLoadingShowing||f.isInProgressArea(a)&&(f.context.dataset.isDisableProgress||(Object.keys&&Object.keys(Txplayer.dataset._instance).length>1&&(l=e(a.target).parents(".txp_player").attr("id")),k&&l&&l!==k||(h=!0,d=!0,f.context.dataset.isVideoSeeking=!0,f.context.msg.broadcast("pause"),i(a),j("mousedown"))))}).on("mousemove",function(a){f.context.dataset.isPlayingAd||f.context.dataset.isImgAdLoadingShowing||f.isVideoCanNotPlay()||k&&l&&l!==k||(i(a),h&&d&&j())}).on("mouseup",function(b){if(!f.context.dataset.duration)return void(h=!1);if(!f.context.dataset.isPlayingAd&&!f.context.dataset.isImgAdLoadingShowing&&h&&(!k||!l||l===k)){l="";f.context.dataset.playState;i(b);var c=parseInt(f.context.dataset.duration*(g/a));j("mouseup"),f.context.msg.broadcast("seekTo",c),d=!1,h=!1}})},isVideoCanNotPlay:function(){var a=this.context.dataset.playState;return 0===a||a===-1},progressOnTouch:function(){var a,b,c,d,e=this,f=function(a){var f=parseInt(b/c*1e4)/100,g=parseInt((b-d/2)/c*1e4)/100;e.updateProgressWidth(g+"%"),e.context.msg.broadcast("progressUpdate",f),"touchstart"==a&&e.context.msg.broadcast("userSeekStart",{time:parseInt(e.context.dataset.duration*f/100)}),"touchend"==a&&e.context.msg.broadcast("userSeekEnd",{time:parseInt(e.context.dataset.duration*f/100)})};this.context.$mod.$progressmod.on("touchstart",function(g){e.context.dataset.isPlayingAd||(g=g.originalEvent?g.originalEvent:g,g&&g.touches&&g.touches.length&&(g=g.touches[0],a=e.dataset.$progressList.offset().left,b=g.pageX-a,c=e.dataset.$progressList.width(),d=e.dataset.$progressIndicator.width(),f("touchstart"),e.context.dataset.isControlTouch=!0,e.context.msg.broadcast("pause")))}).on("touchmove",function(c){e.context.dataset.isPlayingAd||(c=c.originalEvent?c.originalEvent:c,c&&c.touches&&c.touches.length&&(c.preventDefault(),c=c.touches[0],b=c.pageX-a,b>e.dataset.$progressList.width()?b=e.dataset.$progressList.width():b<0&&(b=0),f(),e.context.dataset.isControlTouch=!0))}).on("touchend",function(a){if(!e.context.dataset.isPlayingAd){var d=parseInt(e.context.dataset.duration*(b/c));d>=e.context.dataset.duration&&(d=e.context.dataset.duration-1),f("touchend"),e.context.dataset.isControlTouch=!1,e.context.msg.broadcast("seekTo",d)}})},getCanplayTimeLimit:function(){var a;return"number"==e.type(this.context.dataset.canPlayTime)&&this.context.dataset.duration&&(a=this.context.dataset.canPlayTime/this.context.dataset.duration,a=100*a),a},updateBufferedBar:function(a){if(this.context.dataset.duration&&"number"===e.type(a)){var b=parseInt(100*a/this.context.dataset.duration);b>=99&&(b=100),this.dataset.$loadedProgress.css({width:b+"%"})}},updateProgressWidth:function(a){var b=this.getCanplayTimeLimit();b&&(a=parseFloat((a+"").replace("%","")),a>b&&(a=b),a+="%"),this.dataset.$playprogress.css("width",a),this.dataset.$playpoint.css("left",a)},updateSkipPrelude:function(){var a=this.context.dataset,b=this.dataset.$playStartTimePoint,c=this.dataset.$playEndTimePoint,d=a.playStartTime?+a.playStartTime:0,e=a.playEndTime?+a.playEndTime:0,f=this.context.dataset.duration||0;d?b.css("left",d/f*100+"%").removeClass(Txplayer.dataset.hideClass):b.addClass(Txplayer.dataset.hideClass),e?c.css("left",e/f*100+"%").removeClass(Txplayer.dataset.hideClass):c.addClass(Txplayer.dataset.hideClass)},addEventListerner:function(){var a=this;this.dataset.eventsList={},a.context.dataset.duration?a.updateSkipPrelude():this.dataset.eventsList[f.getUniqueMsgKey("getVideoUrlSuccess")]=function(){a.updateSkipPrelude()},this.dataset.eventsList[f.getUniqueMsgKey("seekStart")]=function(b){if(a.context.dataset.isControlShow&&!a.context.dataset.isPlayingAd&&a.context.dataset.duration){var c=b.seekTime/a.context.dataset.duration;c=100*c+"%",a.updateProgressWidth(c),b.currentTimeWhenSeekStart&&b.currentTimeWhenSeekStart>b.seekTime&&a.updateBufferedBar(b.seekTime)}},this.dataset.eventsList[f.getUniqueMsgKey("videoTimeUpdate")]=function(){if(!a.context.dataset.isPlayingAd&&a.context.dataset.duration&&!a.context.dataset.isVideoSeeking){var b=a.context.dataset.currentTime;if(a.context.dataset.isControlShow||b%5===0){var c=b/a.context.dataset.duration;c=100*c+"%",a.updateProgressWidth(c),a.updateBufferedBar(a.context.dataset.bufferedTime)}}},this.context.dataset.$playermod.on("mouseenter",function(){if(!a.context.dataset.isPlayingAd&&a.context.dataset.duration&&!a.context.dataset.isVideoSeeking&&0!=a.context.dataset.playState){var b=a.context.dataset.currentTime,c=b/a.context.dataset.duration;c=100*c+"%",a.updateProgressWidth(c),a.updateBufferedBar(a.context.dataset.bufferedTime)}}),this.dataset.eventsList[f.getUniqueMsgKey("videoProgress")]=function(){a.context.dataset.isControlShow&&1===a.context.dataset.playState&&a.updateBufferedBar(a.context.dataset.bufferedTime)},this.dataset.eventsList[f.getUniqueMsgKey("vidChange")]=function(){a.updateBufferedBar(0),a.updateProgressWidth(0)},this.dataset.eventsList[f.getUniqueMsgKey("videoPlaying")]=function(b){b&&"endingad"===b.playListType&&(a.context.dataset.bufferedTime=0,a.updateBufferedBar(0),a.updateProgressWidth(0))},this.dataset.eventsList[f.getUniqueMsgKey("videoEnd")]=function(b){b&&b.isAllEnd&&(a.updateBufferedBar(0),a.updateProgressWidth(0))},this.dataset.eventsList[f.getUniqueMsgKey("videoEnd")]=function(b){b&&b.isTheLastFilm&&(a.updateBufferedBar(0),a.updateProgressWidth(0))},this.dataset.eventsList[f.getUniqueMsgKey("beforeVideoPlay")]=function(b){a.updateBufferedBar(0),a.updateProgressWidth(0)},this.dataset.eventsList[f.getUniqueMsgKey("speedyTouchmove")]=function(b){100*b/a.context.dataset.duration+"%";a.updateProgressWidth()},this.dataset.eventsList[f.getUniqueMsgKey("userStopVideo")]=function(b){a.updateBufferedBar(0),a.updateProgressWidth(0)},this.dataset.eventsList[f.getUniqueMsgKey("disableProgress")]=function(b){a.context.dataset.isDisableProgress=!0},this.dataset.eventsList[f.getUniqueMsgKey("videoPlaying")]=function(b){b&&"film"===b.playListType&&(a.context.dataset.isDisableProgress=!1)},e.each(this.dataset.eventsList,function(b,c){a.context.msg.on(b,c)}),f.mobile?this.progressOnTouch():this.progressOnMouseMove()}},Txplayer.register("UiProgress",d)},233:function(a,b){a.exports='<txpdiv class="txp_progress_list" data-role="<%=progressList%>">\n  <txpdiv class="txp_progress_load" style="width:0%" data-role="<%=loadedProgress%>"></txpdiv>\n  <txpdiv class="txp_progress_play" style="width:0%" data-role="<%=playedProgress%>"></txpdiv>\n  <txpdiv class="txp_interact_progress_list">\n    <txpdiv class="txp_interact_dot <%= hideClass %>" data-role="<%=playStartTimePoint%>"></txpdiv>\n    <txpdiv class="txp_interact_dot <%= hideClass %>" data-role="<%=playEndTimePoint%>"></txpdiv>\n  </txpdiv>\n</txpdiv>\n\n<txpdiv class="txp_btn_scrubber" style="left:0%" data-role="<%=playedPoint%>">\n  <txpdiv class="txp_scrubber_indicator" data-role="<%=progressIndicator%>"></txpdiv>\n</txpdiv>'}});
/*! Txplayer - v3.0.0 - 2018-11-23 12:20:35
 * Copyright (c) 2018
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(305)},176:function(a,b){a.exports='<txpdiv data-role="<%=playBtn%>" class="txp_btn txp_btn_play" data-status="play" aria-label="播放/暂停">\n  <% if(isUseH5Type){ %>\n  <svg class="txp_icon txp_icon_play" viewBox="0 0 60 60" >\n\t<use class="txp_svg_play" xlink:href="<%=svgPrefix%>#txp_svg_play" />\n\t<use class="txp_svg_pause" xlink:href="<%=svgPrefix%>#txp_svg_pause" />\n\t<use class="txp_svg_stop" xlink:href="<%=svgPrefix%>#txp_svg_stop" />\n\t<use class="txp_svg_replay" xlink:href="<%=svgPrefix%>#txp_svg_replay" />\n  </svg>\n  <% }else{%>\n  <svg class="txp_icon txp_icon_play" version="1.1" viewBox="0 0 36 36">\n    <use class="txp_svg_symbol txp_svg_play" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="<%=svgPrefix%>#txp_svg_play"></use>\n    <use class="txp_svg_symbol txp_svg_pause" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="<%=svgPrefix%>#txp_svg_pause"></use>\n    <use class="txp_svg_symbol txp_svg_stop" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="<%=svgPrefix%>#txp_svg_stop"></use>\n    <use class="txp_svg_symbol txp_svg_replay" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="<%=svgPrefix%>#txp_svg_replay"></use>\n  </svg>\n  <txpdiv data-role="<%=tips%>" class="txp_tooltip">播放</txpdiv>\n  <% } %>\n</txpdiv>'},305:function(a,b,c){function d(a){e=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=Txplayer.$,f=Txplayer.util,g=c(176),h=c(306);d.prototype={init:function(){this.write(),this.addEventListener()},write:function(){var a={playBtn:"txp-ui-control-playbtn",tips:"txp-ui-control-playbtn-tips",isUseH5Type:f.isUseH5Type(),tabindex:Txplayer.dataset.tabindex++},b=e.tmpl(g,a);if(this.context.config.enableStopButton){var c={stopBtn:"txp-ui-control-stopbtn",tips:"txp-ui-control-stopbtn-tips"},d=e.tmpl(h,c);this.context.$mod.$buttonsleftmod.append(d),this.dataset.$stopbtn=this.context.$mod.$buttonsleftmod.find('[data-role="'+c.stopBtn+'"]')}this.context.$mod.$buttonsleftmod.append(b),this.dataset.$playbtn=this.context.$mod.$buttonsleftmod.find('[data-role="'+a.playBtn+'"]'),this.dataset.$tips=this.context.$mod.$buttonsleftmod.find('[data-role="'+a.tips+'"]')},remove:function(){this.dataset.$playbtn.remove()},initPlayState:function(){var a=this.context.dataset.playState;1===a||3===a?(this.dataset.$playbtn.attr("data-status","pause"),this.dataset.$tips.html("暂停")):0===a?(this.dataset.$playbtn.attr("data-status","replay"),this.dataset.$tips.html("重新播放")):(this.dataset.$playbtn.attr("data-status","play"),this.dataset.$tips.html("播放"))},bindMouseEvent:function(){var a=this;this.dataset.$playbtn.on("mouseenter",function(){a.dataset.$playbtn.addClass(Txplayer.dataset.btnHoverClass)}).on("mouseleave",function(){a.dataset.$playbtn.removeClass(Txplayer.dataset.btnHoverClass)})},stopPauseTimer:function(){this.dataset.pauseTimer&&(clearTimeout(this.dataset.pauseTimer),this.dataset.pauseTimer=null)},addEventListener:function(){var a=this;this.initPlayState(),this.dataset.$stopbtn&&this.dataset.$stopbtn.on(Txplayer.dataset.clickEventName,function(){"function"==typeof a.context.userApi.stop&&(a.context.userApi.stop(),a.context.userMsg.broadcast("userClickStopBtn"))}),this.dataset.$playbtn.on(Txplayer.dataset.clickEventName,function(){var b=(e(this),a.context.dataset.isPlayingAd);if(!b){a.context.msg.broadcast("reportUsrAction",{usr_action:a.dataset.$playbtn.attr("data-status")});try{a.context.userMsg.broadcast("userClickPlayBtn")}catch(c){}"pause"===a.dataset.$playbtn.attr("data-status")?(a.context.msg.broadcast("pauseControl"),a.context.msg.broadcast("userPausePlayer"),a.context.userMsg.broadcast("pause")):"replay"===a.dataset.$playbtn.attr("data-status")?(a.context.dataset.connectionPlayTime=0,a.context.msg.broadcast("beforeVideoRePlay"),a.context.msg.broadcast("playControl",{vid:a.context.dataset.vid,connectionPlayType:1,playStartTime:a.context.dataset.playStartTime,playEndTime:a.context.dataset.playEndTime}),a.context.msg.broadcast("userPlayPlayer")):(a.context.msg.broadcast("playControl",{connectionPlayType:1}),a.context.msg.broadcast("userPlayPlayer"))}}),this.dataset.eventsList={},this.dataset.eventsList[f.getUniqueMsgKey("getVideoUrlSuccess")]=function(){a.dataset.isAllEnd=!1},this.dataset.eventsList[f.getUniqueMsgKey("videoPlay")]=function(){a.dataset.isAllEnd=!1,a.dataset.$playbtn.attr("data-status","pause"),a.dataset.$tips.html("暂停")},this.dataset.eventsList[f.getUniqueMsgKey("videoPause")]=function(b){b&&"film"!=b.playListType||a.context.dataset.isDefinitionSwitching&&!a.context.dataset.useChromeHls||(a.stopPauseTimer(),a.dataset.pauseTimer=setTimeout(function(){if(!a.context.dataset.isDefinitionSwitching||a.context.dataset.useChromeHls){if(a.dataset.isAllEnd)return a.dataset.$playbtn.attr("data-status","replay"),a.dataset.$tips.html("重新播放"),void a.context.msg.broadcast("hideLoading");if(2===a.context.dataset.playState){if(a.context.dataset.canPlayTime&&a.context.dataset.currentTime>=a.context.dataset.canPlayTime)return a.dataset.isAllEnd=!0,a.dataset.$playbtn.attr("data-status","replay"),a.dataset.$playbtn.removeClass("txp_disabled"),void a.dataset.$tips.html("重新播放");a.dataset.$playbtn.attr("data-status","play"),a.dataset.$tips.html("播放"),a.context.msg.broadcast("hideLoading")}}},200))},this.dataset.eventsList[f.getUniqueMsgKey("seekEnd")]=function(b){"h5"!=a.context.config.playerType&&2===a.context.dataset.playState&&(!a.context.dataset.canPlayTime||a.context.dataset.currentTime<a.context.dataset.canPlayTime)&&(a.dataset.$playbtn.attr("data-status","play"),a.dataset.$tips.html("播放"))},this.dataset.eventsList[f.getUniqueMsgKey("showUIVipGuide")]=function(b){b&&b.trialFinish&&(f.v4log("v4UiControlPlay-重新播放按钮"),a.dataset.$playbtn.attr("data-status","replay"),a.dataset.$playbtn.removeClass("txp_disabled"),a.dataset.$tips.html("重新播放"))},this.dataset.eventsList[f.getUniqueMsgKey("showDujiaDialog")]=function(){f.v4log("v4UiControlPlay-重新播放按钮"),a.dataset.$playbtn.attr("data-status","replay"),a.dataset.$playbtn.removeClass("txp_disabled"),a.dataset.$tips.html("重新播放")},this.dataset.eventsList[f.getUniqueMsgKey("showLoginGuide")]=function(b){a.dataset.$playbtn.attr("data-status","play"),a.dataset.$tips.html("播放")},this.dataset.eventsList[f.getUniqueMsgKey("videoEnd")]=function(b){b&&b.isAllEnd&&(a.dataset.isAllEnd=!0,a.context.msg.broadcast("pause"),a.dataset.$playbtn.attr("data-status","replay"),a.dataset.$playbtn.removeClass("txp_disabled"),a.dataset.$tips.html("重新播放"))},this.dataset.eventsList[f.getUniqueMsgKey("vidChange")]=function(b){a.dataset.$playbtn.attr("data-status","play"),a.dataset.$tips.html("播放")},this.dataset.eventsList[f.getUniqueMsgKey("beforeVideoPlay")]=function(b){a.dataset.isAllEnd=!1,a.dataset.$playbtn.attr("data-status","play"),a.dataset.$playbtn.addClass("txp_disabled")},this.dataset.eventsList[f.getUniqueMsgKey("videoPlaying")]=function(b){setTimeout(function(){if("film"!=a.context.dataset.currentPlayListType){if(a.dataset.$playbtn.hasClass("txp_disabled"))return;a.dataset.$playbtn.addClass("txp_disabled")}else a.dataset.$playbtn.removeClass("txp_disabled")},100)},this.dataset.eventsList[f.getUniqueMsgKey("isPlayingAdStatusChange")]=function(b){if(f.v4log("isPlayingAdStatusChange-disablePlayBtn",{isPlayingAd:b}),b){if(a.dataset.$playbtn.attr("data-status","pause"),a.dataset.$tips.html("暂停"),a.dataset.$playbtn.hasClass("txp_disabled"))return;a.dataset.$playbtn.addClass("txp_disabled")}else a.dataset.$playbtn.removeClass("txp_disabled")},this.dataset.eventsList[f.getUniqueMsgKey("userStopVideo")]=function(b){a.initPlayState(),a.dataset.$playbtn.removeClass("txp_disabled")},this.dataset.eventsList[f.getUniqueMsgKey("disablePlayBtn")]=function(b){a.dataset.$playbtn.addClass("txp_disabled")},e.each(this.dataset.eventsList,function(b,c){a.context.msg.on(b,c)}),f.mobile||this.bindMouseEvent()}},Txplayer.register("v4UiControlPlay",d)},306:function(a,b){a.exports='<txpdiv data-role="<%=stopBtn%>" class="txp_btn txp_btn_play" data-status="stop" aria-label="停止">\n    <svg class="txp_icon txp_icon_play" version="1.1" viewBox="0 0 36 36">\n    <use class="txp_svg_symbol txp_svg_stop" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="<%=svgPrefix%>#txp_svg_stop"></use>\n  </svg>\n    <txpdiv data-role="<%=tips%>" class="txp_tooltip">停止</txpdiv>\n</txpdiv>'}});
/*! Txplayer - v3.0.0 - 2018-11-23 12:20:35
 * Copyright (c) 2018
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(220)},220:function(a,b,c){function d(a){e=Txplayer.$,this.dataset={},this.context=a,this.init()}var e=Txplayer.$,f=Txplayer.util,g=c(221),h=c(222),i=c(223);Txplayer.apiList;d.prototype={init:function(){this.dataset.playerConfig=this.context.config,this.dataset.nextData=null,this.context.dataset.nextVideoInfo={},this.dataset.nextVideoInfoCopy={},this.context.dataset.nextVid=this.dataset.playerConfig.nextVid,this.dataset.getNextVid="function"===e.type(this.dataset.playerConfig.getNextVid)?this.dataset.playerConfig.getNextVid:e.noop,this.write(),this.addEventListerner(),this.bindBrowserEvent(),this.exportsModuleApis()},write:function(){var a={next:"txp-ui-control-play-next",hideClass:Txplayer.dataset.hideClass,tabindex:Txplayer.dataset.tabindex++,nextTip:"txp-next-tip"};this.dataset.renderData=a;var b=e.tmpl(g,a);this.context.$mod.$buttonsleftmod.append(b),this.dataset.$next=this.context.$mod.$buttonsleftmod.find('[data-role="'+a.next+'"]'),this.dataset.$nextTip=this.context.$mod.$buttonsleftmod.find('[data-role="'+a.nextTip+'"]');var c={tipMod:"txp-next-tip-mod",tipText:"txp-next-tip-text",tipPreview:"txp-next-tip-preview",hideClass:Txplayer.dataset.hideClass},d=e.tmpl(h,c);this.context.$mod.$playermod.append(d),this.dataset.$tipMod=this.context.$mod.$playermod.find('[data-role="'+c.tipMod+'"]'),this.dataset.$tipText=this.dataset.$tipMod.find('[data-role="'+c.tipText+'"]'),this.dataset.$tipPreview=this.dataset.$tipMod.find('[data-role="'+c.tipPreview+'"]');var f={tipContentMod:"txp-next-tip-content-mod",tipContentText:"txp-next-tip-content-text",tipContentCancle:"txp-next-tip-content-cancle",tipContentPlay:"txp-next-tip-content-play",tipContentPoster:"txp-next-tip-content-poster",hideClass:Txplayer.dataset.hideClass},j=e.tmpl(i,f);this.context.$mod.$playermod.append(j),this.dataset.$tipContentMod=this.context.$mod.$playermod.find('[data-role="'+f.tipContentMod+'"]'),this.dataset.$tipContentText=this.dataset.$tipContentMod.find('[data-role="'+f.tipContentText+'"]'),this.dataset.$tipContentCancle=this.dataset.$tipContentMod.find('[data-role="'+f.tipContentCancle+'"]'),this.dataset.$tipContentPlay=this.dataset.$tipContentMod.find('[data-role="'+f.tipContentPlay+'"]'),this.dataset.$tipContentPoster=this.dataset.$tipContentMod.find('[data-role="'+f.tipContentPoster+'"]'),this.initDisplay()},remove:function(){this.dataset.$next.remove(),this.dataset.$tipMod.remove(),this.dataset.$tipContentMod.remove()},initDisplay:function(){1==this.context.dataset.nextVid?(this.dataset.$next.removeClass(Txplayer.dataset.hideClass),this.dataset.$next.removeClass("txp_disabled"),this.writeTips()):0==this.context.dataset.nextVid?(this.dataset.$tipMod.addClass(Txplayer.dataset.hideClass),this.dataset.$nextTip.addClass(Txplayer.dataset.hideClass),this.dataset.$next.addClass(Txplayer.dataset.hideClass)):(this.dataset.$next.removeClass(Txplayer.dataset.hideClass),this.dataset.$next.addClass("txp_disabled"))},writeTips:function(){this.dataset.nextData&&this.dataset.nextData.title&&this.dataset.nextData.preview&&(this.dataset.$tipText.html(f.xss(this.dataset.nextData.title)),this.dataset.$tipContentText.html(f.xss(this.dataset.nextData.title)),this.dataset.$tipPreview.attr("src",this.dataset.nextData.preview)),this.dataset.nextData&&this.dataset.nextData.previewPoster&&this.dataset.$tipContentPoster.css({"background-image":"url("+this.dataset.nextData.previewPoster+")"})},canclePlayTheNext:function(){this.dataset.isCancle=!0,clearTimeout(this.dataset.timer),this.dataset.timer=null,this.dataset.$tipContentMod.addClass(Txplayer.dataset.hideClass)},doPlayTheNext:function(a,b){var c=this;if(this.dataset.$tipContentMod.addClass(Txplayer.dataset.hideClass),c.dataset.nextData.showCountdown)return void c.nofreshDoPlayTheNext(c.dataset.nextVideoInfo,b);try{this.context.userMsg.broadcast("beforePlayNext",{vid:a||c.dataset.nextData.pageUrl})}catch(d){}},nofreshDoPlayTheNext:function(a,b){var c=this;if(11===a.vid.length){try{c.context.userMsg.broadcast("beforePlayNext",{vid:a.vid})}catch(d){}var e={vid:a.vid,nextVid:a.nextVid,bullet:a.bullet,bulletId:a.bulletId,duration:a.duration,playStartTime:a.playStartTime,playEndTime:a.playEndTime,isNeedPay:a.isNeedPay,title:a.title,autoplay:!a.hasOwnProperty("autoplay")||a.autoplay,defaultDefinition:a.defaultDefinition};b.hasOwnProperty("connectionPlayType")&&(e.connectionPlayType=b.connectionPlayType),c.context.msg.broadcast("playControl",e)}},playTheNext:function(a){if(f.showInfo("uiPlayNext.playTheNext",a),a=a||{},1==this.context.dataset.nextVid){var b,c=this,d=this.context.dataset.vid;try{b=c.dataset.getNextVid(d),c.dataset.nextVideoInfo=b}catch(e){f.showInfo("[playTheNext.getNextVid.error]",e)}if(!b||!b.vid)return void f.showError("播放下个视频失败","找不到vid");if(this.dataset.playNextOptions=a,this.dataset.isPageStopAutoPlay=!1,f.isPageSupportStopAutoPlay()&&"coolOpen"!==this.context.config.playerType){var g=f.isPageHidden(),h=f.isInScreen(this.context.dataset.$playermod);if("undefined"!=typeof g&&g||!h)return void(this.dataset.isPageStopAutoPlay=!0)}if(c.dataset.nextData&&(c.dataset.nextData.pageUrl||c.dataset.nextData.showCountdown)&&a.isAllEnd&&!f.os.ipad)return this.dataset.$tipContentMod.removeClass(Txplayer.dataset.hideClass),this.reportUserAction("play-next-float-view"),this.dataset.timer&&(clearTimeout(this.dataset.timer),this.dataset.timer=null),void(this.dataset.timer=setTimeout(function(){c.dataset.isCancle||c.doPlayTheNext(c.dataset.nextData.pageUrl,a)},1e4));if(c.dataset.nextData&&c.dataset.nextData.pageUrl&&!c.dataset.nextData.showCountdown)try{c.context.userMsg.broadcast("beforePlayNext",{vid:b.pageUrl})}catch(e){}else c.nofreshDoPlayTheNext(b,a),c.context.msg.broadcast("updateNextVideoInfo")}},toggleAutoPlayNext:function(a){if(a){if(this.dataset.isPageStopAutoPlay=!1,this.dataset.nextData&&this.dataset.nextData.pageUrl&&!this.dataset.nextData.showCountdown){try{this.context.userMsg.broadcast("beforePlayNext",{vid:this.dataset.nextVideoInfo.pageUrl})}catch(b){}return}this.nofreshDoPlayTheNext(this.dataset.nextVideoInfo,this.dataset.playNextOptions),this.context.msg.broadcast("updateNextVideoInfo")}},showTip:function(){var a=this;a.dataset.nextData&&a.dataset.nextData.title&&a.dataset.nextData.preview?a.dataset.$tipMod.removeClass(Txplayer.dataset.hideClass):a.dataset.$nextTip.removeClass(Txplayer.dataset.hideClass)},hideTip:function(){var a=this;a.dataset.nextData&&a.dataset.nextData.title&&a.dataset.nextData.preview?a.dataset.$tipMod.addClass(Txplayer.dataset.hideClass):a.dataset.$nextTip.addClass(Txplayer.dataset.hideClass)},bindMouseEvent:function(){var a=this;this.dataset.$next.on("mouseenter",function(b){e(b.relatedTarget).parents().hasClass("txp_btn_next")||a.showTip()}).on("mouseleave",function(b){e(b.relatedTarget).parents().hasClass("txp_btn_next")||a.hideTip()})},addEventListerner:function(){var a=this;this.dataset.$next.on(Txplayer.dataset.clickEventName,function(){a.context.dataset.nextVid&&(a.hideTip(),a.playTheNext({connectionPlayType:3}))}),this.dataset.$tipContentCancle.on(Txplayer.dataset.clickEventName,function(){a.reportUserAction("play-next-float-cancel-click"),a.canclePlayTheNext(),a.context.msg.broadcast("showUicontrol")}),this.dataset.$tipContentPlay.on(Txplayer.dataset.clickEventName,function(){a.reportUserAction("play-next-float-play-click"),a.doPlayTheNext(a.dataset.nextData.pageUrl,{connectionPlayType:3})}),this.dataset.eventsList={},this.dataset.eventsList[f.getUniqueMsgKey("vidChange")]=function(){a.dataset.isCancle=null,a.dataset.nextData=null,a.dataset.$tipContentMod.addClass(Txplayer.dataset.hideClass)},this.dataset.eventsList[f.getUniqueMsgKey("hideUiControl")]=function(){a.hideTip()},this.dataset.eventsList[f.getUniqueMsgKey("beforeVideoPlay")]=function(){a.canclePlayTheNext(),a.dataset.isCancle=null},this.dataset.eventsList[f.getUniqueMsgKey("userStopVideo")]=function(){a.canclePlayTheNext(),a.dataset.isCancle=null},this.dataset.eventsList[f.getUniqueMsgKey("videoEnd")]=function(b){b.isAllEnd&&a.context.dataset.nextVid&&!a.context.dataset.canPlayTime&&(a.context.dataset.nextVideoInfo.vid||"v3"!=a.context.config.version||a.context.userApi.stop&&a.context.userApi.stop(),a.context.dataset.disableAutoPlayNext||a.context.dataset.isLoopPlay||a.playTheNext({connectionPlayType:2,isAllEnd:!0}))},this.dataset.eventsList[f.getUniqueMsgKey("updateNextVideoInfo")]=function(){var b=!a.context.dataset.isLoopPlay&&!a.context.dataset.disableAutoPlayNext;b?a.context.dataset.nextVideoInfo=a.dataset.nextVideoInfoCopy:a.context.dataset.nextVideoInfo={}},this.dataset.eventsList[f.getUniqueMsgKey("userPlayNext")]=function(b){a.context.dataset.nextVid&&(a.hideTip(),a.playTheNext(b))},e.each(this.dataset.eventsList,function(b,c){a.context.msg.on(b,c)}),f.mobile||this.bindMouseEvent()},bindBrowserEvent:function(){var a=this;if(f.isPageSupportStopAutoPlay()&&"coolOpen"!==a.context.config.playerType){f.addPageVisibilityChangeEvent(function(b){a.dataset.isPageStopAutoPlay&&!b&&f.isInScreen(a.context.dataset.$playermod)&&a.toggleAutoPlayNext(!0)});var b;e(window).scroll(function(){clearTimeout(b),b=setTimeout(function(){a.dataset.isPageStopAutoPlay&&f.isInScreen(a.context.dataset.$playermod)&&a.toggleAutoPlayNext(!0)},300)})}},reportUserAction:function(a){this.context.msg.broadcast("reportUsrAction",{usr_action:a})},exportsModuleApis:function(){var a=this;this.dataset.moduleApis={},this.dataset.moduleApis.getNextData=function(b,c){return a.dataset.nextData},this.dataset.moduleApis.setNextVid=function(b,c){if(a.context.dataset.nextVid=b.nextVid,1==a.context.dataset.nextVid){var d,e=a.context.dataset.vid;try{d=a.dataset.getNextVid(e)}catch(g){f.showInfo("[playTheNext.getNextVid.error]",g)}d&&(a.dataset.nextData={vid:e,nextVid:d.vid},d.title&&(a.dataset.nextData.title=d.title),d.preview&&(a.dataset.nextData.preview=d.preview),d.showCountdown&&(a.dataset.nextData.showCountdown=d.showCountdown),d.pageUrl&&(a.dataset.nextData.pageUrl=d.pageUrl),d.previewPoster&&(a.dataset.nextData.previewPoster=d.previewPoster),"v.qq.com"!==location.hostname||f.os.ipad||a.dataset.nextData.pageUrl||a.context.dataset.canPlayTime||a.context.dataset.isLoopPlay?(a.context.dataset.nextVideoInfo={},a.dataset.nextVideoInfoCopy={}):(a.context.dataset.nextVideoInfo.vid=d.vid,a.context.dataset.nextVideoInfo.cid=d.cid||a.context.dataset.cid,a.dataset.nextVideoInfoCopy.vid=d.vid,a.dataset.nextVideoInfoCopy.cid=d.cid||a.context.dataset.cid))}else a.context.dataset.nextVideoInfo={},a.dataset.nextVideoInfoCopy={};a.initDisplay(),a.context.msg.broadcast("updateNextVideoInfo")},e.extend(this.context.userApi,this.dataset.moduleApis),e.each(this.dataset.moduleApis,function(b,c){a.context.msg.on(b,c)})}},Txplayer.register("UiPlayNext",d)},221:function(a,b){a.exports='<txpdiv data-role="<%=next%>" class="txp_btn txp_btn_next" data-report="play-next" aria-label="下一集">\n  <svg class="txp_icon txp_icon_next" version="1.1" viewBox="0 0 36 36">\n    <use class="txp_svg_symbol txp_svg_next" xlink:href="<%=svgPrefix%>#txp_svg_next" />\n  </svg>\n  <txpdiv class="txp_tooltip <%=hideClass%>" data-role="<%=nextTip%>">下一集</txpdiv>\n</txpdiv>'},222:function(a,b){a.exports='<txpdiv class="txp_hint_next <%=hideClass%>" data-role="<%=tipMod%>">\n<txpdiv class="txp_next_pic"><img data-role="<%=tipPreview%>" alt="" /></txpdiv>\n\t<txpdiv class="txp_next_wording">\n\t\t<txpdiv class="txp_label">下一个</txpdiv>\n\t\t<txpdiv class="txp_next_title" data-role="<%=tipText%>"></txpdiv>\n\t</txpdiv>\n</txpdiv>\n'},223:function(a,b){a.exports='<txpdiv class="txp_overlay_next <%=hideClass%>" data-role="<%=tipContentMod%>">\n<div class="txp_next_poster" data-role="<%=tipContentPoster%>" style="background-image:url()"></div>\n<txpdiv class="txp_next_content">\n\t<txpdiv class="txp_label">即将播放</txpdiv>\n\t<txpdiv class="txp_next_title" data-role="<%=tipContentText%>"></txpdiv>\n\t<a class="txp_cancel" href="javascript:" data-role="<%=tipContentCancle%>">取消</a>\n\t<button class="txp_btn txp_btn_play_lg" data-status="play" data-role="<%=tipContentPlay%>">\n\t\t<svg class="txp_icon txp_icon_play" viewBox="0 0 36 36" >\n\t\t\t<use class="txp_svg_symbol txp_svg_play" xlink:href="<%=svgPrefix%>#txp_svg_play" />\n\t\t</svg>\n\t\t<svg class="txp_icon_cirlce" viewBox="0 0 72 72" >\n\t\t\t<circle r="34" cy="36" cx="36"></circle>\n\t\t</svg>\n\t</button>\n</txpdiv>\n</txpdiv>'}});
/*! Txplayer - v3.0.0 - 2018-11-23 12:20:35
 * Copyright (c) 2018
 * Powered by Tencent-Video Web Front End Team 
*/
!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}({0:function(a,b,c){a.exports=c(200)},200:function(a,b,c){function d(a){this.dataset={},this.context=a,this.support()&&this.init()}var e=Txplayer.$,f=Txplayer.util,g=c(201),h=d.prototype;h.init=function(){this.dataset.hideClass=Txplayer.dataset.hideClass,this.dataset.onStatus="on",this.dataset.offStatus="off",this.dataset.tipsFlag=0,this.dataset.eventsList={},this.dataset.isLoopPlay=!1,this.write(),this.addEventListener()},h.getHistorySetting=function(){var a=f.getData(Txplayer.dataset.localStorageKey.loopPlaySetting);try{a=JSON.parse(a)}catch(b){a={}}this.dataset.tipsFlag=a.tipsFlag},h.setData=function(a,b){var c=f.getData(Txplayer.dataset.localStorageKey.loopPlaySetting)||"{}";try{c=JSON.parse(c)}catch(d){c={}}c[a]=b,f.setData(Txplayer.dataset.localStorageKey.loopPlaySetting,JSON.stringify(c))},h.write=function(){var a=this,b={loopPlayBtn:"txp-ui-control-loop-play-btn",loopPlayStatus:"txp-ui-control-loop-play-status",loopPlayTips:"txp-ui-control-loop-play-tips",loopPlayText:"txp-ui-control-loop-play-text"};this.dataset.renderData=b;var c=e.tmpl(g,b);this.context.$mod.$buttonsleftmod.append(c),["loopPlayBtn","loopPlayStatus","loopPlayTips","loopPlayText"].forEach(function(c){a.dataset["$"+c]=a.context.$mod.$buttonsleftmod.find('[data-role="'+b[c]+'"]')}),this.reset()},h.reset=function(){this.dataset.$loopPlayTips.addClass(this.dataset.hideClass),this.dataset.$loopPlayStatus.attr("data-status",this.dataset.offStatus),this.dataset.$loopPlayText.text("打开循环播放"),this.dataset.hasTrigger=!1,this.context.dataset.isLoopPlay=!1},h.support=function(){return window.VIDEO_INFO&&22==window.VIDEO_INFO.type||this.context.config.showLoopPlay},h.addEventListener=function(){var a=this;this.dataset.$loopPlayTips.on("mouseenter",function(){a.dataset.$loopPlayText.hide()}),this.dataset.$loopPlayBtn.on("click",function(){var b=a.dataset.$loopPlayStatus.attr("data-status"),c="";b===a.dataset.offStatus?(c="关闭循环播放",b=a.dataset.onStatus):(c="打开循环播放",b=a.dataset.offStatus),a.dataset.$loopPlayStatus.attr("data-status",b),a.context.dataset.isLoopPlay=b===a.dataset.onStatus,a.dataset.$loopPlayText.text(c),a.context.msg.broadcast("reportUsrAction",{usr_action:"loop-play-click-"+b}),a.context.msg.broadcast("updateNextVideoInfo")}).on("mouseenter",function(){a.dataset.$loopPlayText.show()}).on("mouseleave",function(){a.dataset.$loopPlayText.hide()}),this.dataset.eventsList[f.getUniqueMsgKey("videoPlay")]=function(b){a.getHistorySetting(),"film"!==b.playListType||a.dataset.hasTrigger||(a.dataset.hasTrigger=!0,a.dataset.tipsFlag?a.dataset.$loopPlayTips.addClass(a.dataset.hideClass):(a.dataset.$loopPlayTips.removeClass(a.dataset.hideClass),a.setData("tipsFlag",1),setTimeout(function(){a.dataset.$loopPlayTips.addClass(a.dataset.hideClass)},5e3)))};var b=!1;this.dataset.eventsList["beforeUiControlShow.showLoopPlay"]=function(){a.context.dataset.isControlShow&&!b&&(b=!0,a.context.msg.broadcast("reportUsrAction",{usr_action:"loop-play-view"}))},this.dataset.eventsList[f.getUniqueMsgKey("videoEnd")]=function(b){("skipPrelude"===b.from||b.isAllEnd)&&a.context.dataset.isLoopPlay&&(a.context.msg.broadcast("beforeVideoRePlay"),a.context.msg.broadcast("playControl",{connectionPlayType:1,vid:a.context.dataset.vid,playStartTime:a.context.dataset.playStartTime,playEndTime:a.context.dataset.playEndTime}))},this.dataset.eventsList[f.getUniqueMsgKey("vidChange")]=function(b){a.reset()},e.each(this.dataset.eventsList,function(b,c){a.context.msg.on(b,c)})},Txplayer.register("UiLoopPlay",d)},201:function(a,b){a.exports='<txpdiv class="txp_btn txp_btn_loop" data-role="<%=loopPlayStatus%>">\n    <svg data-role="<%=loopPlayBtn%>"class="txp_icon txp_icon_loop" version="1.1" viewBox="0 0 36 36">\n        <use class="txp_svg_symbol txp_svg_loop" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="<%=svgPrefix%>#txp_svg_loop"></use>\n        <use class="txp_svg_symbol txp_svg_loop_off" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="<%=svgPrefix%>#txp_svg_loop_off"></use>\n    </svg>\n    <txpdiv class="txp_tooltip" data-role="<%=loopPlayText%>"></txpdiv>\n    <txpdiv class="txp_popup_loop" data-role="<%=loopPlayTips%>">\n        <img src="//i.gtimg.cn/qqlive/images/20170629/loop_tip.png" alt="">\n        <txpdiv class="txp_popup_loop_text">可以打开洗脑循环了哟</txpdiv>\n    </txpdiv>\n</txpdiv>'}});